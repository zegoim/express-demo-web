!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}("undefined"!=typeof self?self:this,(function(){return function(){var __webpack_modules__={4545:function(t,e,n){"undefined"!=typeof self&&self,t.exports=function(t,e){return r=[function(t,e,n){var r=function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}function n(t,e,n){this.low=0|t,this.high=0|e,this.unsigned=!!n}function r(t){return!0===(t&&t.__isLong__)}function i(t){var e=Math.clz32(t&-t);return t?31-e:e}Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var o={},s={};function a(t,e){var n,r,i;return e?(i=0<=(t>>>=0)&&t<256)&&(r=s[t])?r:(n=c(t,0,!0),i&&(s[t]=n),n):(i=-128<=(t|=0)&&t<128)&&(r=o[t])?r:(n=c(t,t<0?-1:0,!1),i&&(o[t]=n),n)}function u(t,e){if(isNaN(t))return e?v:m;if(e){if(t<0)return v;if(p<=t)return T}else{if(t<=-g)return C;if(g<=t+1)return E}return t<0?u(-t,e).neg():c(t%d|0,t/d|0,e)}function c(t,e,r){return new n(t,e,r)}n.fromInt=a,n.fromNumber=u,n.fromBits=c;var l=Math.pow;function h(t,e,n){if(0===t.length)throw Error("empty string");if(e="number"==typeof e?(n=e,!1):!!e,"NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return e?v:m;if((n=n||10)<2||36<n)throw RangeError("radix");var r;if(0<(r=t.indexOf("-")))throw Error("interior hyphen");if(0===r)return h(t.substring(1),e,n).neg();for(var i=u(l(n,8)),o=m,s=0;s<t.length;s+=8){var a=Math.min(8,t.length-s),c=parseInt(t.substring(s,s+a),n);o=(a<8?(a=u(l(n,a)),o.mul(a)):o=o.mul(i)).add(u(c))}return o.unsigned=e,o}function f(t,e){return"number"==typeof t?u(t,e):"string"==typeof t?h(t,e):c(t.low,t.high,"boolean"==typeof e?e:t.unsigned)}n.fromString=h,n.fromValue=f;var d=4294967296,p=d*d,g=p/2,_=a(1<<24),m=a(0),v=(n.ZERO=m,a(0,!0)),y=(n.UZERO=v,a(1)),b=(n.ONE=y,a(1,!0)),S=(n.UONE=b,a(-1)),E=(n.NEG_ONE=S,c(-1,2147483647,!1)),T=(n.MAX_VALUE=E,c(-1,-1,!0)),C=(n.MAX_UNSIGNED_VALUE=T,c(0,-2147483648,!1)),w=(n.MIN_VALUE=C,n.prototype);return w.toInt=function(){return this.unsigned?this.low>>>0:this.low},w.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},w.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";var e,n;if(this.isNegative())return this.eq(C)?(n=u(t),n=(e=this.div(n)).mul(n).sub(this),e.toString(t)+n.toInt().toString(t)):"-"+this.neg().toString(t);for(var r=u(l(t,6),this.unsigned),i=this,o="";;){var s=i.div(r),a=(i.sub(s.mul(r)).toInt()>>>0).toString(t);if((i=s).isZero())return a+o;for(;a.length<6;)a="0"+a;o=""+a+o}},w.getHighBits=function(){return this.high},w.getHighBitsUnsigned=function(){return this.high>>>0},w.getLowBits=function(){return this.low},w.getLowBitsUnsigned=function(){return this.low>>>0},w.getNumBitsAbs=function(){if(this.isNegative())return this.eq(C)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;0<e&&0==(t&1<<e);e--);return 0!=this.high?e+33:e+1},w.isZero=function(){return 0===this.high&&0===this.low},w.eqz=w.isZero,w.isNegative=function(){return!this.unsigned&&this.high<0},w.isPositive=function(){return this.unsigned||0<=this.high},w.isOdd=function(){return 1==(1&this.low)},w.isEven=function(){return 0==(1&this.low)},w.equals=function(t){return r(t)||(t=f(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low},w.eq=w.equals,w.notEquals=function(t){return!this.eq(t)},w.neq=w.notEquals,w.ne=w.notEquals,w.lessThan=function(t){return this.comp(t)<0},w.lt=w.lessThan,w.lessThanOrEqual=function(t){return this.comp(t)<=0},w.lte=w.lessThanOrEqual,w.le=w.lessThanOrEqual,w.greaterThan=function(t){return 0<this.comp(t)},w.gt=w.greaterThan,w.greaterThanOrEqual=function(t){return 0<=this.comp(t)},w.gte=w.greaterThanOrEqual,w.ge=w.greaterThanOrEqual,w.compare=function(t){var e,n;return r(t)||(t=f(t)),this.eq(t)?0:(e=this.isNegative(),n=t.isNegative(),e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1)},w.comp=w.compare,w.negate=function(){return!this.unsigned&&this.eq(C)?C:this.not().add(y)},w.neg=w.negate,w.add=function(t){r(t)||(t=f(t));var e=0,n=0,i=0,o=0;return n+=(i=i+((o+=(65535&this.low)+(65535&t.low))>>>16)+((this.low>>>16)+(t.low>>>16)))>>>16,c((i&=65535)<<16|(o&=65535),((e+=(n+=(65535&this.high)+(65535&t.high))>>>16)+((this.high>>>16)+(t.high>>>16))&65535)<<16|(n&=65535),this.unsigned)},w.subtract=function(t){return r(t)||(t=f(t)),this.add(t.neg())},w.sub=w.subtract,w.multiply=function(t){var n,i,o,s,a,l,h,d,p,g;return this.isZero()?this:(r(t)||(t=f(t)),e?c(e.mul(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned):t.isZero()?this.unsigned?v:m:this.eq(C)?t.isOdd()?C:m:t.eq(C)?this.isOdd()?C:m:this.isNegative()?t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg():t.isNegative()?this.mul(t.neg()).neg():this.lt(_)&&t.lt(_)?u(this.toNumber()*t.toNumber(),this.unsigned):(s=t.high>>>16,a=65535&t.high,l=t.low>>>16,g=(g=p=d=h=0)+((d=d+((p+=(o=65535&this.low)*(t=65535&t.low))>>>16)+(i=this.low>>>16)*t)>>>16)+((d=(65535&d)+o*l)>>>16),c((d&=65535)<<16|(p&=65535),(h=(h=(h+=(g+=(n=65535&this.high)*t)>>>16)+((g=(65535&g)+i*l)>>>16)+((g=(65535&g)+o*a)>>>16))+((this.high>>>16)*t+n*l+i*a+o*s)&65535)<<16|(g&=65535),this.unsigned)))},w.mul=w.multiply,w.divide=function(t){if((t=r(t)?t:f(t)).isZero())throw Error("division by zero");var n,i,o;if(e)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?c((this.unsigned?e.div_u:e.div_s)(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?v:m;if(this.unsigned){if((t=t.unsigned?t:t.toUnsigned()).gt(this))return v;if(t.gt(this.shru(1)))return b;i=v}else{if(this.eq(C))return t.eq(y)||t.eq(S)?C:t.eq(C)?y:(o=this.shr(1).div(t).shl(1)).eq(m)?t.isNegative()?y:S:(n=this.sub(t.mul(o)),o.add(n.div(t)));if(t.eq(C))return this.unsigned?v:m;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();i=m}for(n=this;n.gte(t);){o=Math.max(1,Math.floor(n.toNumber()/t.toNumber()));for(var s=Math.ceil(Math.log(o)/Math.LN2),a=s<=48?1:l(2,s-48),h=u(o),d=h.mul(t);d.isNegative()||d.gt(n);)d=(h=u(o-=a,this.unsigned)).mul(t);h.isZero()&&(h=y),i=i.add(h),n=n.sub(d)}return i},w.div=w.divide,w.modulo=function(t){return r(t)||(t=f(t)),e?c((this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},w.mod=w.modulo,w.rem=w.modulo,w.not=function(){return c(~this.low,~this.high,this.unsigned)},w.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},w.clz=w.countLeadingZeros,w.countTrailingZeros=function(){return this.low?i(this.low):i(this.high)+32},w.ctz=w.countTrailingZeros,w.and=function(t){return r(t)||(t=f(t)),c(this.low&t.low,this.high&t.high,this.unsigned)},w.or=function(t){return r(t)||(t=f(t)),c(this.low|t.low,this.high|t.high,this.unsigned)},w.xor=function(t){return r(t)||(t=f(t)),c(this.low^t.low,this.high^t.high,this.unsigned)},w.shiftLeft=function(t){return r(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?c(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):c(0,this.low<<t-32,this.unsigned)},w.shl=w.shiftLeft,w.shiftRight=function(t){return r(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?c(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):c(this.high>>t-32,0<=this.high?0:-1,this.unsigned)},w.shr=w.shiftRight,w.shiftRightUnsigned=function(t){return r(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?c(this.low>>>t|this.high<<32-t,this.high>>>t,this.unsigned):c(32===t?this.high:this.high>>>t-32,0,this.unsigned)},w.shru=w.shiftRightUnsigned,w.shr_u=w.shiftRightUnsigned,w.rotateLeft=function(t){var e;return r(t)&&(t=t.toInt()),0==(t&=63)?this:32===t?c(this.high,this.low,this.unsigned):t<32?c(this.low<<t|this.high>>>(e=32-t),this.high<<t|this.low>>>e,this.unsigned):c(this.high<<(t-=32)|this.low>>>(e=32-t),this.low<<t|this.high>>>e,this.unsigned)},w.rotl=w.rotateLeft,w.rotateRight=function(t){var e;return r(t)&&(t=t.toInt()),0==(t&=63)?this:32===t?c(this.high,this.low,this.unsigned):t<32?c(this.high<<(e=32-t)|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned):c(this.low<<(e=32-(t-=32))|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)},w.rotr=w.rotateRight,w.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},w.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},w.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},w.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},w.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},n.fromBytes=function(t,e,r){return r?n.fromBytesLE(t,e):n.fromBytesBE(t,e)},n.fromBytesLE=function(t,e){return new n(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},n.fromBytesBE=function(t,e){return new n(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)},t.default=n,"default"in t?t.default:t}({});void 0!==(e=function(){return r}.apply(e,[]))&&(t.exports=e)},function(t,e,n){(function(e){var r;t.exports=(r=function(t){var r;if("undefined"!=typeof window&&window.crypto&&(r=window.crypto),"undefined"!=typeof self&&self.crypto&&(r=self.crypto),!(r=!(r=!(r="undefined"!=typeof globalThis&&globalThis.crypto?globalThis.crypto:r)&&"undefined"!=typeof window&&window.msCrypto?window.msCrypto:r)&&void 0!==e&&e.crypto?e.crypto:r))try{r=n(14)}catch(s){}var i=Object.create||function(t){return o.prototype=t,t=new o,o.prototype=null,t};function o(){}var s={},a=s.lib={},u=a.Base={extend:function(t){var e=i(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),(e.init.prototype=e).$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},c=a.WordArray=u.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||h).stringify(this)},concat:function(t){var e=this.words,n=t.words,r=this.sigBytes,i=t.sigBytes;if(this.clamp(),r%4)for(var o=0;o<i;o++)e[r+o>>>2]|=(n[o>>>2]>>>24-o%4*8&255)<<24-(r+o)%4*8;else for(var s=0;s<i;s+=4)e[r+s>>>2]=n[s>>>2];return this.sigBytes+=i,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=t.ceil(n/4)},clone:function(){var t=u.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e=[],n=0;n<t;n+=4)e.push(function(){if(r){if("function"==typeof r.getRandomValues)try{return r.getRandomValues(new Uint32Array(1))[0]}catch(t){}if("function"==typeof r.randomBytes)try{return r.randomBytes(4).readInt32LE()}catch(t){}}throw new Error("Native crypto module could not be used to get secure random number.")}());return new c.init(e,t)}}),l=s.enc={},h=l.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],i=0;i<n;i++){var o=e[i>>>2]>>>24-i%4*8&255;r.push((o>>>4).toString(16)),r.push((15&o).toString(16))}return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r+=2)n[r>>>3]|=parseInt(t.substr(r,2),16)<<24-r%8*4;return new c.init(n,e/2)}},f=l.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],i=0;i<n;i++)r.push(String.fromCharCode(e[i>>>2]>>>24-i%4*8&255));return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r++)n[r>>>2]|=(255&t.charCodeAt(r))<<24-r%4*8;return new c.init(n,e)}},d=l.Utf8={stringify:function(t){try{return decodeURIComponent(escape(f.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return f.parse(unescape(encodeURIComponent(t)))}},p=a.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=d.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n,r=this._data,i=r.words,o=r.sigBytes,s=this.blockSize,a=o/(4*s),u=(a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0))*s;if(e=t.min(4*u,o),u){for(var l=0;l<u;l+=s)this._doProcessBlock(i,l);n=i.splice(0,u),r.sigBytes-=e}return new c.init(n,e)},clone:function(){var t=u.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),g=(a.Hasher=p.extend({cfg:u.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new g.HMAC.init(t,n).finalize(e)}}}),s.algo={});return s}(Math),r)}).call(this,n(13))},function(e,n){e.exports=t},function(t,e,n){function r(t){var e;return(o[t]||(e=o[t]={i:t,l:!1,exports:{}},i[t].call(e.exports,e,e.exports,r),e.l=!0,e)).exports}var i,o;t.exports=(i=[function(t,e){var n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){var n,r;function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return(n=setTimeout)(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}t=t.exports={};try{n="function"==typeof setTimeout?setTimeout:i}catch(t){n=i}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(t){r=o}var a,u=[],c=!1,l=-1;function h(){c&&a&&(c=!1,a.length?u=a.concat(u):l=-1,u.length)&&f()}function f(){if(!c){var t=s(h);c=!0;for(var e=u.length;e;){for(a=u,u=[];++l<e;)a&&a[l].run();l=-1,e=u.length}a=null,c=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===o||!r)&&clearTimeout)return(r=clearTimeout)(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function p(){}t.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new d(t,e)),1!==u.length||c||s(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=p,t.addListener=p,t.once=p,t.off=p,t.removeListener=p,t.removeAllListeners=p,t.emit=p,t.prependListener=p,t.prependOnceListener=p,t.listeners=function(t){return[]},t.binding=function(t){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(t){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},function(t,e,n){(function(e,n,r,i){t.exports=function t(e,n,r){function i(o,s){if(!n[o]){if(!e[o])throw(a=new Error("Cannot find module '"+o+"'")).code="MODULE_NOT_FOUND",a;var a=n[o]={exports:{}};e[o][0].call(a.exports,(function(t){return i(e[o][1][t]||t)}),a,a.exports,t,e,n,r)}return n[o].exports}for(var o=0;o<r.length;o++)i(r[o]);return i}({1:[function(t,e,n){"use strict";var r=t("./utils"),i=t("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(t){for(var e,n,i,s,a,u,c=[],l=0,h=t.length,f="string"!==r.getTypeOf(t);l<t.length;)u=h-l,i=f?(e=t[l++],n=l<h?t[l++]:0,l<h?t[l++]:0):(e=t.charCodeAt(l++),n=l<h?t.charCodeAt(l++):0,l<h?t.charCodeAt(l++):0),s=(3&e)<<4|n>>4,a=1<u?(15&n)<<2|i>>6:64,u=2<u?63&i:64,c.push(o.charAt(e>>2)+o.charAt(s)+o.charAt(a)+o.charAt(u));return c.join("")},n.decode=function(t){var e,n,r,s,a,u=0,c=0;if("data:"===t.substr(0,5))throw new Error("Invalid base64 input, it looks like a data url.");var l,h=3*(t=t.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(t.charAt(t.length-1)===o.charAt(64)&&h--,t.charAt(t.length-2)===o.charAt(64)&&h--,h%1!=0)throw new Error("Invalid base64 input, bad content length.");for(l=new(i.uint8array?Uint8Array:Array)(0|h);u<t.length;)e=o.indexOf(t.charAt(u++))<<2|(s=o.indexOf(t.charAt(u++)))>>4,n=(15&s)<<4|(s=o.indexOf(t.charAt(u++)))>>2,r=(3&s)<<6|(a=o.indexOf(t.charAt(u++))),l[c++]=e,64!==s&&(l[c++]=n),64!==a&&(l[c++]=r);return l}},{"./support":30,"./utils":32}],2:[function(t,e,n){"use strict";var r=t("./external"),i=t("./stream/DataWorker"),o=t("./stream/Crc32Probe"),s=t("./stream/DataLengthProbe");function a(t,e,n,r,i){this.compressedSize=t,this.uncompressedSize=e,this.crc32=n,this.compression=r,this.compressedContent=i}a.prototype={getContentWorker:function(){var t=new i(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new s("data_length")),e=this;return t.on("end",(function(){if(this.streamInfo.data_length!==e.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),t},getCompressedWorker:function(){return new i(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},a.createWorkerFrom=function(t,e,n){return t.pipe(new o).pipe(new s("uncompressedSize")).pipe(e.compressWorker(n)).pipe(new s("compressedSize")).withStreamInfo("compression",e)},e.exports=a},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,e,n){"use strict";var r=t("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},n.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,e,n){"use strict";var r=t("./utils"),i=function(){for(var t=[],e=0;e<256;e++){for(var n=e,r=0;r<8;r++)n=1&n?3988292384^n>>>1:n>>>1;t[e]=n}return t}();e.exports=function(t,e){return void 0!==t&&t.length?("string"!==r.getTypeOf(t)?function(t,e,n){var r=i,o=0+n;t^=-1;for(var s=0;s<o;s++)t=t>>>8^r[255&(t^e[s])];return-1^t}:function(t,e,n){var r=i,o=0+n;t^=-1;for(var s=0;s<o;s++)t=t>>>8^r[255&(t^e.charCodeAt(s))];return-1^t})(0|e,t,t.length):0}},{"./utils":32}],5:[function(t,e,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(t,e,n){"use strict";t="undefined"!=typeof Promise?Promise:t("lie"),e.exports={Promise:t}},{lie:37}],7:[function(t,e,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=t("pako"),o=t("./utils"),s=t("./stream/GenericWorker"),a=r?"uint8array":"array";function u(t,e){s.call(this,"FlateWorker/"+t),this._pako=null,this._pakoAction=t,this._pakoOptions=e,this.meta={}}n.magic="\b\0",o.inherits(u,s),u.prototype.processChunk=function(t){this.meta=t.meta,null===this._pako&&this._createPako(),this._pako.push(o.transformTo(a,t.data),!1)},u.prototype.flush=function(){s.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var t=this;this._pako.onData=function(e){t.push({data:e,meta:t.meta})}},n.compressWorker=function(t){return new u("Deflate",t)},n.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,e,n){"use strict";function r(t,e){for(var n="",r=0;r<e;r++)n+=String.fromCharCode(255&t),t>>>=8;return n}function i(t,e,n,i,s,l){var h=t.file,f=t.compression,d=l!==a.utf8encode,p=o.transformTo("string",l(h.name)),g=o.transformTo("string",a.utf8encode(h.name)),_=h.comment,m=(l=o.transformTo("string",l(_)),o.transformTo("string",a.utf8encode(_))),v=g.length!==h.name.length,y=(_=m.length!==_.length,""),b=h.dir,S=h.date,E={crc32:0,compressedSize:0,uncompressedSize:0};return e&&!n||(E.crc32=t.crc32,E.compressedSize=t.compressedSize,E.uncompressedSize=t.uncompressedSize),n=0,e&&(n|=8),d||!v&&!_||(n|=2048),t=0,e=0,b&&(t|=16),"UNIX"===s?(e=798,t|=(65535&((d=h.unixPermissions)?d:b?16893:33204))<<16):(e=20,t|=63&(h.dosPermissions||0)),s=S.getUTCHours(),s=(s=((s<<=6)|S.getUTCMinutes())<<5)|S.getUTCSeconds()/2,d=S.getUTCFullYear()-1980,d=(d=((d<<=4)|S.getUTCMonth()+1)<<5)|S.getUTCDate(),v&&(b=r(1,1)+r(u(p),4)+g,y+="up"+r(b.length,2)+b),_&&(h=r(1,1)+r(u(l),4)+m,y+="uc"+r(h.length,2)+h),S="",S=(S=(S=(S=(S=(S=(S=(S=(S=(S+="\n\0")+r(n,2))+f.magic)+r(s,2))+r(d,2))+r(E.crc32,4))+r(E.compressedSize,4))+r(E.uncompressedSize,4))+r(p.length,2))+r(y.length,2),{fileRecord:c.LOCAL_FILE_HEADER+S+p+y,dirRecord:c.CENTRAL_FILE_HEADER+r(e,2)+S+r(l.length,2)+"\0\0\0\0"+r(t,4)+r(i,4)+p+y+l}}var o=t("../utils"),s=t("../stream/GenericWorker"),a=t("../utf8"),u=t("../crc32"),c=t("../signature");function l(t,e,n,r){s.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=e,this.zipPlatform=n,this.encodeFileName=r,this.streamFiles=t,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(l,s),l.prototype.push=function(t){var e=t.meta.percent||0,n=this.entriesCount,r=this._sources.length;this.accumulate?this.contentBuffer.push(t):(this.bytesWritten+=t.data.length,s.prototype.push.call(this,{data:t.data,meta:{currentFile:this.currentFile,percent:n?(e+100*(n-r-1))/n:100}}))},l.prototype.openedSource=function(t){this.currentSourceOffset=this.bytesWritten,this.currentFile=t.file.name;var e=this.streamFiles&&!t.file.dir;e?(t=i(t,e,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName),this.push({data:t.fileRecord,meta:{percent:0}})):this.accumulate=!0},l.prototype.closedSource=function(t){this.accumulate=!1;var e=this.streamFiles&&!t.file.dir,n=i(t,e,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),e)this.push({data:(e=t,c.DATA_DESCRIPTOR+r(e.crc32,4)+r(e.compressedSize,4)+r(e.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},l.prototype.flush=function(){for(var t=this.bytesWritten,e=0;e<this.dirRecords.length;e++)this.push({data:this.dirRecords[e],meta:{percent:100}});var n=this.bytesWritten-t;n=function(t,e,n,i,s){return s=o.transformTo("string",s(i)),c.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(t,2)+r(t,2)+r(e,4)+r(n,4)+r(s.length,2)+s}(this.dirRecords.length,n,t,this.zipComment,this.encodeFileName),this.push({data:n,meta:{percent:100}})},l.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},l.prototype.registerPrevious=function(t){this._sources.push(t);var e=this;return t.on("data",(function(t){e.processChunk(t)})),t.on("end",(function(){e.closedSource(e.previous.streamInfo),e._sources.length?e.prepareNextSource():e.end()})),t.on("error",(function(t){e.error(t)})),this},l.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},l.prototype.error=function(t){var e=this._sources;if(!s.prototype.error.call(this,t))return!1;for(var n=0;n<e.length;n++)try{e[n].error(t)}catch(t){}return!0},l.prototype.lock=function(){s.prototype.lock.call(this);for(var t=this._sources,e=0;e<t.length;e++)t[e].lock()},e.exports=l},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,e,n){"use strict";var r=t("../compressions"),i=t("./ZipFileWorker");n.generateWorker=function(t,e,n){var o=new i(e.streamFiles,n,e.platform,e.encodeFileName),s=0;try{t.forEach((function(t,n){s++;var i=function(t,e){if(e=r[t=t||e])return e;throw new Error(t+" is not a valid compression method !")}(n.options.compression,e.compression),a=n.dir,u=n.date;n._compressWorker(i,n.options.compressionOptions||e.compressionOptions||{}).withStreamInfo("file",{name:t,dir:a,date:u,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(o)})),o.entriesCount=s}catch(t){o.error(t)}return o}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,e,n){"use strict";function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var t,e=new r;for(t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(r.prototype=t("./object")).loadAsync=t("./load"),r.support=t("./support"),r.defaults=t("./defaults"),r.version="3.10.1",r.loadAsync=function(t,e){return(new r).loadAsync(t,e)},r.external=t("./external"),e.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,e,n){"use strict";var r=t("./utils"),i=t("./external"),o=t("./utf8"),s=t("./zipEntries"),a=t("./stream/Crc32Probe"),u=t("./nodejsUtils");e.exports=function(t,e){var n=this;return e=r.extend(e||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),u.isNode&&u.isStream(t)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",t,!0,e.optimizedBinaryString,e.base64).then((function(t){var n=new s(e);return n.load(t),n})).then((function(t){var n=[i.Promise.resolve(t)],r=t.files;if(e.checkCRC32)for(var o=0;o<r.length;o++)n.push(function(t){return new i.Promise((function(e,n){var r=t.decompressed.getContentWorker().pipe(new a);r.on("error",(function(t){n(t)})).on("end",(function(){r.streamInfo.crc32!==t.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):e()})).resume()}))}(r[o]));return i.Promise.all(n)})).then((function(t){for(var i=(t=t.shift()).files,o=0;o<i.length;o++){var s=i[o],a=s.fileNameStr,u=r.resolve(s.fileNameStr);n.file(u,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileCommentStr.length?s.fileCommentStr:null,unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions,createFolders:e.createFolders}),s.dir||(n.file(u).unsafeOriginalName=a)}return t.zipComment.length&&(n.comment=t.zipComment),n}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,e,n){"use strict";var r=t("../utils"),i=t("../stream/GenericWorker");function o(t,e){i.call(this,"Nodejs stream input adapter for "+t),this._upstreamEnded=!1,this._bindStream(e)}r.inherits(o,i),o.prototype._bindStream=function(t){var e=this;(this._stream=t).pause(),t.on("data",(function(t){e.push({data:t,meta:{percent:0}})})).on("error",(function(t){e.isPaused?this.generatedError=t:e.error(t)})).on("end",(function(){e.isPaused?e._upstreamEnded=!0:e.end()}))},o.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},e.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,e,n){"use strict";var r=t("readable-stream").Readable;function i(t,e,n){r.call(this,e),this._helper=t;var i=this;t.on("data",(function(t,e){i.push(t)||i._helper.pause(),n&&n(e)})).on("error",(function(t){i.emit("error",t)})).on("end",(function(){i.push(null)}))}t("../utils").inherits(i,r),i.prototype._read=function(){this._helper.resume()},e.exports=i},{"../utils":32,"readable-stream":16}],14:[function(t,n,r){"use strict";n.exports={isNode:void 0!==e,newBufferFrom:function(t,n){if(e.from&&e.from!==Uint8Array.from)return e.from(t,n);if("number"==typeof t)throw new Error('The "data" argument must not be a number');return new e(t,n)},allocBuffer:function(t){return e.alloc?e.alloc(t):((t=new e(t)).fill(0),t)},isBuffer:function(t){return e.isBuffer(t)},isStream:function(t){return t&&"function"==typeof t.on&&"function"==typeof t.pause&&"function"==typeof t.resume}}},{}],15:[function(t,e,n){"use strict";function r(t,e,n){var r=s.getTypeOf(e),o=s.extend(n||{},c);o.date=o.date||new Date,null!==o.compression&&(o.compression=o.compression.toUpperCase()),"string"==typeof o.unixPermissions&&(o.unixPermissions=parseInt(o.unixPermissions,8)),o.unixPermissions&&16384&o.unixPermissions&&(o.dir=!0),o.dosPermissions&&16&o.dosPermissions&&(o.dir=!0),o.dir&&(t=g(t)),o.createFolders&&(u=function(t){var e=(t="/"===t.slice(-1)?t.substring(0,t.length-1):t).lastIndexOf("/");return 0<e?t.substring(0,e):""}(t))&&i.call(this,u,!0);var u="string"===r&&!1===o.binary&&!1===o.base64;n&&void 0!==n.binary||(o.binary=!u),(e instanceof l&&0===e.uncompressedSize||o.dir||!e||0===e.length)&&(o.base64=!1,o.binary=!0,e="",o.compression="STORE"),r=e instanceof l||e instanceof a?e:d.isNode&&d.isStream(e)?new p(t,e):s.prepareContent(t,e,o.binary,o.optimizedBinaryString,o.base64),n=new h(t,r,o),this.files[t]=n}function i(t,e){return e=void 0!==e?e:c.createFolders,t=g(t),this.files[t]||r.call(this,t,null,{dir:!0,createFolders:e}),this.files[t]}var o=t("./utf8"),s=t("./utils"),a=t("./stream/GenericWorker"),u=t("./stream/StreamHelper"),c=t("./defaults"),l=t("./compressedObject"),h=t("./zipObject"),f=t("./generate"),d=t("./nodejsUtils"),p=t("./nodejs/NodejsStreamInputAdapter"),g=function(t){return"/"!==t.slice(-1)&&(t+="/"),t};function _(t){return"[object RegExp]"===Object.prototype.toString.call(t)}e.exports={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(t){var e,n,r;for(e in this.files)r=this.files[e],(n=e.slice(this.root.length,e.length))&&e.slice(0,this.root.length)===this.root&&t(n,r)},filter:function(t){var e=[];return this.forEach((function(n,r){t(n,r)&&e.push(r)})),e},file:function(t,e,n){var i;return 1!==arguments.length?(r.call(this,t=this.root+t,e,n),this):_(t)?(i=t,this.filter((function(t,e){return!e.dir&&i.test(t)}))):(e=this.files[this.root+t])&&!e.dir?e:null},folder:function(t){var e,n;return t?_(t)?this.filter((function(e,n){return n.dir&&t.test(e)})):(e=i.call(this,e=this.root+t),(n=this.clone()).root=e.name,n):this},remove:function(t){var e=this.files[t=this.root+t];if(e||("/"!==t.slice(-1)&&(t+="/"),e=this.files[t]),e&&!e.dir)delete this.files[t];else for(var n=this.filter((function(e,n){return n.name.slice(0,t.length)===t})),r=0;r<n.length;r++)delete this.files[n[r].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(t){var e={};try{if((e=s.extend(t||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=e.type.toLowerCase(),e.compression=e.compression.toUpperCase(),"binarystring"===e.type&&(e.type="string"),!e.type)throw new Error("No output type specified.");s.checkSupport(e.type),"darwin"!==e.platform&&"freebsd"!==e.platform&&"linux"!==e.platform&&"sunos"!==e.platform||(e.platform="UNIX"),"win32"===e.platform&&(e.platform="DOS");var n=f.generateWorker(this,e,e.comment||this.comment||"")}catch(t){(n=new a("error")).error(t)}return new u(n,e.type||"string",e.mimeType)},generateAsync:function(t,e){return this.generateInternalStream(t).accumulate(e)},generateNodeStream:function(t,e){return(t=t||{}).type||(t.type="nodebuffer"),this.generateInternalStream(t).toNodejsStream(e)}}},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,e,n){"use strict";e.exports=t("stream")},{stream:void 0}],17:[function(t,e,n){"use strict";var r=t("./DataReader");function i(t){r.call(this,t);for(var e=0;e<this.data.length;e++)t[e]=255&t[e]}t("../utils").inherits(i,r),i.prototype.byteAt=function(t){return this.data[this.zero+t]},i.prototype.lastIndexOfSignature=function(t){for(var e=t.charCodeAt(0),n=t.charCodeAt(1),r=t.charCodeAt(2),i=t.charCodeAt(3),o=this.length-4;0<=o;--o)if(this.data[o]===e&&this.data[o+1]===n&&this.data[o+2]===r&&this.data[o+3]===i)return o-this.zero;return-1},i.prototype.readAndCheckSignature=function(t){var e=t.charCodeAt(0),n=t.charCodeAt(1),r=t.charCodeAt(2),i=(t=t.charCodeAt(3),this.readData(4));return e===i[0]&&n===i[1]&&r===i[2]&&t===i[3]},i.prototype.readData=function(t){var e;return this.checkOffset(t),0===t?[]:(e=this.data.slice(this.zero+this.index,this.zero+this.index+t),this.index+=t,e)},e.exports=i},{"../utils":32,"./DataReader":18}],18:[function(t,e,n){"use strict";var r=t("../utils");function i(t){this.data=t,this.length=t.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(){},readInt:function(t){var e,n=0;for(this.checkOffset(t),e=this.index+t-1;e>=this.index;e--)n=(n<<8)+this.byteAt(e);return this.index+=t,n},readString:function(t){return r.transformTo("string",this.readData(t))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var t=this.readInt(4);return new Date(Date.UTC(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1))}},e.exports=i},{"../utils":32}],19:[function(t,e,n){"use strict";var r=t("./Uint8ArrayReader");function i(t){r.call(this,t)}t("../utils").inherits(i,r),i.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,e,n){"use strict";var r=t("./DataReader");function i(t){r.call(this,t)}t("../utils").inherits(i,r),i.prototype.byteAt=function(t){return this.data.charCodeAt(this.zero+t)},i.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)-this.zero},i.prototype.readAndCheckSignature=function(t){return t===this.readData(4)},i.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=i},{"../utils":32,"./DataReader":18}],21:[function(t,e,n){"use strict";var r=t("./ArrayReader");function i(t){r.call(this,t)}t("../utils").inherits(i,r),i.prototype.readData=function(t){var e;return this.checkOffset(t),0===t?new Uint8Array(0):(e=this.data.subarray(this.zero+this.index,this.zero+this.index+t),this.index+=t,e)},e.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(t,e,n){"use strict";var r=t("../utils"),i=t("../support"),o=t("./ArrayReader"),s=t("./StringReader"),a=t("./NodeBufferReader"),u=t("./Uint8ArrayReader");e.exports=function(t){var e=r.getTypeOf(t);return r.checkSupport(e),"string"!==e||i.uint8array?"nodebuffer"===e?new a(t):i.uint8array?new u(r.transformTo("uint8array",t)):new o(r.transformTo("array",t)):new s(t)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,e,n){"use strict";n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\b"},{}],24:[function(t,e,n){"use strict";var r=t("./GenericWorker"),i=t("../utils");function o(t){r.call(this,"ConvertWorker to "+t),this.destType=t}i.inherits(o,r),o.prototype.processChunk=function(t){this.push({data:i.transformTo(this.destType,t.data),meta:t.meta})},e.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(t,e,n){"use strict";var r=t("./GenericWorker"),i=t("../crc32");function o(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(o,r),o.prototype.processChunk=function(t){this.streamInfo.crc32=i(t.data,this.streamInfo.crc32||0),this.push(t)},e.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,e,n){"use strict";var r=t("../utils"),i=t("./GenericWorker");function o(t){i.call(this,"DataLengthProbe for "+t),this.propName=t,this.withStreamInfo(t,0)}r.inherits(o,i),o.prototype.processChunk=function(t){t&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+t.data.length),i.prototype.processChunk.call(this,t)},e.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(t,e,n){"use strict";var r=t("../utils"),i=t("./GenericWorker");function o(t){i.call(this,"DataWorker");var e=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,t.then((function(t){e.dataIsReady=!0,e.data=t,e.max=t&&t.length||0,e.type=r.getTypeOf(t),e.isPaused||e._tickAndRepeat()}),(function(t){e.error(t)}))}r.inherits(o,i),o.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished)||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0)},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var t=null,e=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":t=this.data.substring(this.index,e);break;case"uint8array":t=this.data.subarray(this.index,e);break;case"array":case"nodebuffer":t=this.data.slice(this.index,e)}return this.index=e,this.push({data:t,meta:{percent:this.max?this.index/this.max*100:0}})},e.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(t,e,n){"use strict";function r(t){this.name=t||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(t){this.emit("data",t)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(t){this.emit("error",t)}return!0},error:function(t){return!this.isFinished&&(this.isPaused?this.generatedError=t:(this.isFinished=!0,this.emit("error",t),this.previous&&this.previous.error(t),this.cleanUp()),!0)},on:function(t,e){return this._listeners[t].push(e),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(t,e){if(this._listeners[t])for(var n=0;n<this._listeners[t].length;n++)this._listeners[t][n].call(this,e)},pipe:function(t){return t.registerPrevious(this)},registerPrevious:function(t){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=t.streamInfo,this.mergeStreamInfo(),this.previous=t;var e=this;return t.on("data",(function(t){e.processChunk(t)})),t.on("end",(function(){e.end()})),t.on("error",(function(t){e.error(t)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){var t;return!(!this.isPaused||this.isFinished||(t=this.isPaused=!1,this.generatedError&&(this.error(this.generatedError),t=!0),this.previous&&this.previous.resume(),t))},flush:function(){},processChunk:function(t){this.push(t)},withStreamInfo:function(t,e){return this.extraStreamInfo[t]=e,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var t in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,t)&&(this.streamInfo[t]=this.extraStreamInfo[t])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var t="Worker "+this.name;return this.previous?this.previous+" -> "+t:t}},e.exports=r},{}],29:[function(t,n,r){"use strict";var i=t("../utils"),o=t("./ConvertWorker"),s=t("./GenericWorker"),a=t("../base64"),u=t("../support"),c=t("../external"),l=null;if(u.nodestream)try{l=t("../nodejs/NodejsStreamOutputAdapter")}catch(t){}function h(t,e,n){var r=e;switch(e){case"blob":case"arraybuffer":r="uint8array";break;case"base64":r="string"}try{this._internalType=r,this._outputType=e,this._mimeType=n,i.checkSupport(r),this._worker=t.pipe(new o(r)),t.lock()}catch(t){this._worker=new s("error"),this._worker.error(t)}}h.prototype={accumulate:function(t){return n=this,r=t,new c.Promise((function(t,o){var s=[],u=n._internalType,c=n._outputType,l=n._mimeType;n.on("data",(function(t,e){s.push(t),r&&r(e)})).on("error",(function(t){s=[],o(t)})).on("end",(function(){try{var n=function(t,e,n){switch(t){case"blob":return i.newBlob(i.transformTo("arraybuffer",e),n);case"base64":return a.encode(e);default:return i.transformTo(t,e)}}(c,function(t,n){for(var r=0,i=null,o=0,s=0;s<n.length;s++)o+=n[s].length;switch(t){case"string":return n.join("");case"array":return Array.prototype.concat.apply([],n);case"uint8array":for(i=new Uint8Array(o),s=0;s<n.length;s++)i.set(n[s],r),r+=n[s].length;return i;case"nodebuffer":return e.concat(n);default:throw new Error("concat : unsupported type '"+t+"'")}}(u,s),l);t(n)}catch(n){o(n)}s=[]})).resume()}));var n,r},on:function(t,e){var n=this;return this._worker.on(t,"data"===t?function(t){e.call(n,t.data,t.meta)}:function(){i.delay(e,arguments,n)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(t){if(i.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new l(this,{objectMode:"nodebuffer"!==this._outputType},t)}},n.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,n,r){"use strict";if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,r.nodebuffer=void 0!==e,r.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)r.blob=!1;else{var i=new ArrayBuffer(0);try{r.blob=0===new Blob([i],{type:"application/zip"}).size}catch(t){try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(i),r.blob=0===o.getBlob("application/zip").size}catch(t){r.blob=!1}}}try{r.nodestream=!!t("readable-stream").Readable}catch(t){r.nodestream=!1}},{"readable-stream":16}],31:[function(t,e,n){"use strict";for(var r=t("./utils"),i=t("./support"),o=t("./nodejsUtils"),s=t("./stream/GenericWorker"),a=new Array(256),u=0;u<256;u++)a[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;function c(){s.call(this,"utf-8 decode"),this.leftOver=null}function l(){s.call(this,"utf-8 encode")}a[254]=a[254]=1,n.utf8encode=function(t){if(i.nodebuffer)return o.newBufferFrom(t,"utf-8");for(var e,n,r,s,a=t,u=a.length,c=0,l=0;l<u;l++)55296==(64512&(n=a.charCodeAt(l)))&&l+1<u&&56320==(64512&(r=a.charCodeAt(l+1)))&&(n=65536+(n-55296<<10)+(r-56320),l++),c+=n<128?1:n<2048?2:n<65536?3:4;for(e=new(i.uint8array?Uint8Array:Array)(c),l=s=0;s<c;l++)55296==(64512&(n=a.charCodeAt(l)))&&l+1<u&&56320==(64512&(r=a.charCodeAt(l+1)))&&(n=65536+(n-55296<<10)+(r-56320),l++),n<128?e[s++]=n:(n<2048?e[s++]=192|n>>>6:(n<65536?e[s++]=224|n>>>12:(e[s++]=240|n>>>18,e[s++]=128|n>>>12&63),e[s++]=128|n>>>6&63),e[s++]=128|63&n);return e},n.utf8decode=function(t){if(i.nodebuffer)return r.transformTo("nodebuffer",t).toString("utf-8");for(var e,n,o,s=t=r.transformTo(i.uint8array?"uint8array":"array",t),u=s.length,c=new Array(2*u),l=e=0;l<u;)if((n=s[l++])<128)c[e++]=n;else if(4<(o=a[n]))c[e++]=65533,l+=o-1;else{for(n&=2===o?31:3===o?15:7;1<o&&l<u;)n=n<<6|63&s[l++],o--;1<o?c[e++]=65533:n<65536?c[e++]=n:(c[e++]=55296|(n-=65536)>>10&1023,c[e++]=56320|1023&n)}return c.length!==e&&(c.subarray?c=c.subarray(0,e):c.length=e),r.applyFromCharCode(c)},r.inherits(c,s),c.prototype.processChunk=function(t){var e=r.transformTo(i.uint8array?"uint8array":"array",t.data),o=(this.leftOver&&this.leftOver.length&&(i.uint8array?(o=e,(e=new Uint8Array(o.length+this.leftOver.length)).set(this.leftOver,0),e.set(o,this.leftOver.length)):e=this.leftOver.concat(e),this.leftOver=null),function(t,e){for(var n=(e=(e=e||t.length)>t.length?t.length:e)-1;0<=n&&128==(192&t[n]);)n--;return!(n<0||0===n)&&n+a[t[n]]>e?n:e}(e)),s=e;o!==e.length&&(i.uint8array?(s=e.subarray(0,o),this.leftOver=e.subarray(o,e.length)):(s=e.slice(0,o),this.leftOver=e.slice(o,e.length))),this.push({data:n.utf8decode(s),meta:t.meta})},c.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=c,r.inherits(l,s),l.prototype.processChunk=function(t){this.push({data:n.utf8encode(t.data),meta:t.meta})},n.Utf8EncodeWorker=l},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,e,r){"use strict";var i=t("./support"),o=t("./base64"),s=t("./nodejsUtils"),a=t("./external");function u(t){return t}function c(t,e){for(var n=0;n<t.length;++n)e[n]=255&t.charCodeAt(n);return e}t("setimmediate"),r.newBlob=function(t,e){r.checkSupport("blob");try{return new Blob([t],{type:e})}catch(r){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return n.append(t),n.getBlob(e)}catch(t){throw new Error("Bug : can't construct the Blob.")}}};var l={stringifyByChunk:function(t,e,n){var r=[],i=0,o=t.length;if(o<=n)return String.fromCharCode.apply(null,t);for(;i<o;)r.push(String.fromCharCode.apply(null,"array"===e||"nodebuffer"===e?t.slice(i,Math.min(i+n,o)):t.subarray(i,Math.min(i+n,o)))),i+=n;return r.join("")},stringifyByChar:function(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(t){return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&1===String.fromCharCode.apply(null,s.allocBuffer(1)).length}catch(t){return!1}}()}};function h(t){var e=65536,n=r.getTypeOf(t),i=!0;if("uint8array"===n?i=l.applyCanBeUsed.uint8array:"nodebuffer"===n&&(i=l.applyCanBeUsed.nodebuffer),i)for(;1<e;)try{return l.stringifyByChunk(t,n,e)}catch(t){e=Math.floor(e/2)}return l.stringifyByChar(t)}function f(t,e){for(var n=0;n<t.length;n++)e[n]=t[n];return e}r.applyFromCharCode=h;var d={};d.string={string:u,array:function(t){return c(t,new Array(t.length))},arraybuffer:function(t){return d.string.uint8array(t).buffer},uint8array:function(t){return c(t,new Uint8Array(t.length))},nodebuffer:function(t){return c(t,s.allocBuffer(t.length))}},d.array={string:h,array:u,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return s.newBufferFrom(t)}},d.arraybuffer={string:function(t){return h(new Uint8Array(t))},array:function(t){return f(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:u,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return s.newBufferFrom(new Uint8Array(t))}},d.uint8array={string:h,array:function(t){return f(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:u,nodebuffer:function(t){return s.newBufferFrom(t)}},d.nodebuffer={string:h,array:function(t){return f(t,new Array(t.length))},arraybuffer:function(t){return d.nodebuffer.uint8array(t).buffer},uint8array:function(t){return f(t,new Uint8Array(t.length))},nodebuffer:u},r.transformTo=function(t,e){if(e=e||"",!t)return e;r.checkSupport(t);var n=r.getTypeOf(e);return d[n][t](e)},r.resolve=function(t){for(var e=t.split("/"),n=[],r=0;r<e.length;r++){var i=e[r];"."===i||""===i&&0!==r&&r!==e.length-1||(".."===i?n.pop():n.push(i))}return n.join("/")},r.getTypeOf=function(t){return"string"==typeof t?"string":"[object Array]"===Object.prototype.toString.call(t)?"array":i.nodebuffer&&s.isBuffer(t)?"nodebuffer":i.uint8array&&t instanceof Uint8Array?"uint8array":i.arraybuffer&&t instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(t){if(!i[t.toLowerCase()])throw new Error(t+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(t){for(var e,n="",r=0;r<(t||"").length;r++)n+="\\x"+((e=t.charCodeAt(r))<16?"0":"")+e.toString(16).toUpperCase();return n},r.delay=function(t,e,r){n((function(){t.apply(r||null,e||[])}))},r.inherits=function(t,e){function n(){}n.prototype=e.prototype,t.prototype=new n},r.extend=function(){for(var t,e={},n=0;n<arguments.length;n++)for(t in arguments[n])Object.prototype.hasOwnProperty.call(arguments[n],t)&&void 0===e[t]&&(e[t]=arguments[n][t]);return e},r.prepareContent=function(t,e,n,s,u){return a.Promise.resolve(e).then((function(t){return i.blob&&(t instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(t)))&&"undefined"!=typeof FileReader?new a.Promise((function(e,n){var r=new FileReader;r.onload=function(t){e(t.target.result)},r.onerror=function(t){n(t.target.error)},r.readAsArrayBuffer(t)})):t})).then((function(e){var l=r.getTypeOf(e);return l?("arraybuffer"===l?e=r.transformTo("uint8array",e):"string"===l&&(u?e=o.decode(e):n&&!0!==s&&(e=c(l=e,new(i.uint8array?Uint8Array:Array)(l.length)))),e):a.Promise.reject(new Error("Can't read the data of '"+t+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,e,n){"use strict";var r=t("./reader/readerFor"),i=t("./utils"),o=t("./signature"),s=t("./zipEntry"),a=t("./support");function u(t){this.files=[],this.loadOptions=t}u.prototype={checkSignature:function(t){var e;if(!this.reader.readAndCheckSignature(t))throw this.reader.index-=4,e=this.reader.readString(4),new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(e)+", expected "+i.pretty(t)+")")},isSignature:function(t,e){var n=this.reader.index;return this.reader.setIndex(t),t=this.reader.readString(4)===e,this.reader.setIndex(n),t},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var t=this.reader.readData(this.zipCommentLength),e=a.uint8array?"uint8array":"array";e=i.transformTo(e,t),this.zipComment=this.loadOptions.decodeFileName(e)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t,e,n,r=this.zip64EndOfCentralSize-44;0<r;)t=this.reader.readInt(2),e=this.reader.readInt(4),n=this.reader.readData(e),this.zip64ExtensibleData[t]={id:t,length:e,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){for(var t,e=0;e<this.files.length;e++)this.reader.setIndex((t=this.files[e]).localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(t=new s({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(t);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(t<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(t);var e=t;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(t=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(t),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}if(t=this.centralDirOffset+this.centralDirSize,0<(t=e-(t=this.zip64?t+20+(12+this.zip64EndOfCentralSize):t)))this.isSignature(e,o.CENTRAL_FILE_HEADER)||(this.reader.zero=t);else if(t<0)throw new Error("Corrupted zip: missing "+Math.abs(t)+" bytes.")},prepareReader:function(t){this.reader=r(t)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,e,n){"use strict";var r=t("./reader/readerFor"),i=t("./utils"),o=t("./compressedObject"),s=t("./crc32"),a=t("./utf8"),u=t("./compressions"),c=t("./support");function l(t,e){this.options=t,this.loadOptions=e}l.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(t){var e;if(t.skip(22),this.fileNameLength=t.readInt(2),e=t.readInt(2),this.fileName=t.readData(this.fileNameLength),t.skip(e),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(e=function(t){for(var e in u)if(Object.prototype.hasOwnProperty.call(u,e)&&u[e].magic===t)return u[e];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,e,t.readData(this.compressedSize))},readCentralPart:function(t){this.versionMadeBy=t.readInt(2),t.skip(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4);var e=t.readInt(2);if(this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");t.skip(e),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==t&&(this.dosPermissions=63&this.externalFileAttributes),3==t&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){var t;this.extraFields[1]&&(t=r(this.extraFields[1].value),this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS)&&(this.diskNumberStart=t.readInt(4))},readExtraFields:function(t){var e,n,r,i=t.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});t.index+4<i;)e=t.readInt(2),n=t.readInt(2),r=t.readData(n),this.extraFields[e]={id:e,length:n,value:r};t.setIndex(i)},handleUTF8:function(){var t,e=c.uint8array?"uint8array":"array";this.useUTF8()?(this.fileNameStr=a.utf8decode(this.fileName),this.fileCommentStr=a.utf8decode(this.fileComment)):(null!==(t=this.findExtraFieldUnicodePath())?this.fileNameStr=t:(t=i.transformTo(e,this.fileName),this.fileNameStr=this.loadOptions.decodeFileName(t)),null!==(t=this.findExtraFieldUnicodeComment())?this.fileCommentStr=t:(t=i.transformTo(e,this.fileComment),this.fileCommentStr=this.loadOptions.decodeFileName(t)))},findExtraFieldUnicodePath:function(){var t,e=this.extraFields[28789];return e&&1===(t=r(e.value)).readInt(1)&&s(this.fileName)===t.readInt(4)?a.utf8decode(t.readData(e.length-5)):null},findExtraFieldUnicodeComment:function(){var t,e=this.extraFields[25461];return e&&1===(t=r(e.value)).readInt(1)&&s(this.fileComment)===t.readInt(4)?a.utf8decode(t.readData(e.length-5)):null}},e.exports=l},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,e,n){"use strict";function r(t,e,n){this.name=t,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=e,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}}var i=t("./stream/StreamHelper"),o=t("./stream/DataWorker"),s=t("./utf8"),a=t("./compressedObject"),u=t("./stream/GenericWorker");r.prototype={internalStream:function(t){var e=null,n="string";try{if(!t)throw new Error("No output type specified.");var r="string"===(n=t.toLowerCase())||"text"===n,o=("binarystring"!==n&&"text"!==n||(n="string"),e=this._decompressWorker(),!this._dataBinary);o&&!r&&(e=e.pipe(new s.Utf8EncodeWorker)),!o&&r&&(e=e.pipe(new s.Utf8DecodeWorker))}catch(t){(e=new u("error")).error(t)}return new i(e,n,"")},async:function(t,e){return this.internalStream(t).accumulate(e)},nodeStream:function(t,e){return this.internalStream(t||"nodebuffer").toNodejsStream(e)},_compressWorker:function(t,e){var n;return this._data instanceof a&&this._data.compression.magic===t.magic?this._data.getCompressedWorker():(n=this._decompressWorker(),this._dataBinary||(n=n.pipe(new s.Utf8EncodeWorker)),a.createWorkerFrom(n,t,e))},_decompressWorker:function(){return this._data instanceof a?this._data.getContentWorker():this._data instanceof u?this._data:new o(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],l=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<c.length;h++)r.prototype[c[h]]=l;e.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,e,n){(function(t){"use strict";var n,r,i,o,s=t.MutationObserver||t.WebKitMutationObserver,a=s?(r=0,s=new s(c),i=t.document.createTextNode(""),s.observe(i,{characterData:!0}),function(){i.data=r=++r%2}):t.setImmediate||void 0===t.MessageChannel?"document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){c(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(c,0)}:((o=new t.MessageChannel).port1.onmessage=c,function(){o.port2.postMessage(0)}),u=[];function c(){var t,e;n=!0;for(var r=u.length;r;){for(e=u,u=[],t=-1;++t<r;)e[t]();r=u.length}n=!1}e.exports=function(t){1!==u.push(t)||n||a()}}).call(this,void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(t,e,n){"use strict";var r=t("immediate");function i(){}var o={},s=["REJECTED"],a=["FULFILLED"],u=["PENDING"];function c(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,t!==i&&d(this,t)}function l(t,e,n){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function h(t,e,n){r((function(){var r;try{r=e(n)}catch(r){return o.reject(t,r)}r===t?o.reject(t,new TypeError("Cannot resolve promise with itself")):o.resolve(t,r)}))}function f(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function d(t,e){var n=!1;function r(e){n||(n=!0,o.reject(t,e))}function i(e){n||(n=!0,o.resolve(t,e))}var s=p((function(){e(i,r)}));"error"===s.status&&r(s.value)}function p(t,e){var n={};try{n.value=t(e),n.status="success"}catch(t){n.status="error",n.value=t}return n}(e.exports=c).prototype.finally=function(t){var e;return"function"!=typeof t?this:(e=this.constructor,this.then((function(n){return e.resolve(t()).then((function(){return n}))}),(function(n){return e.resolve(t()).then((function(){throw n}))})))},c.prototype.catch=function(t){return this.then(null,t)},c.prototype.then=function(t,e){var n;return"function"!=typeof t&&this.state===a||"function"!=typeof e&&this.state===s?this:(n=new this.constructor(i),this.state!==u?h(n,this.state===a?t:e,this.outcome):this.queue.push(new l(n,t,e)),n)},l.prototype.callFulfilled=function(t){o.resolve(this.promise,t)},l.prototype.otherCallFulfilled=function(t){h(this.promise,this.onFulfilled,t)},l.prototype.callRejected=function(t){o.reject(this.promise,t)},l.prototype.otherCallRejected=function(t){h(this.promise,this.onRejected,t)},o.resolve=function(t,e){var n=p(f,e);if("error"===n.status)return o.reject(t,n.value);if(n=n.value)d(t,n);else{t.state=a,t.outcome=e;for(var r=-1,i=t.queue.length;++r<i;)t.queue[r].callFulfilled(e)}return t},o.reject=function(t,e){t.state=s,t.outcome=e;for(var n=-1,r=t.queue.length;++n<r;)t.queue[n].callRejected(e);return t},c.resolve=function(t){return t instanceof this?t:o.resolve(new this(i),t)},c.reject=function(t){var e=new this(i);return o.reject(e,t)},c.all=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return this.resolve([]);for(var s=new Array(n),a=0,u=-1,c=new this(i);++u<n;)!function(t,i){e.resolve(t).then((function(t){s[i]=t,++a!==n||r||(r=!0,o.resolve(c,s))}),(function(t){r||(r=!0,o.reject(c,t))}))}(t[u],u);return c},c.race=function(t){if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var e=t.length,n=!1;if(!e)return this.resolve([]);for(var r=-1,s=new this(i);++r<e;)this.resolve(t[r]).then((function(t){n||(n=!0,o.resolve(s,t))}),(function(t){n||(n=!0,o.reject(s,t))}));return s}},{immediate:36}],38:[function(t,e,n){"use strict";var r={};(0,t("./lib/utils/common").assign)(r,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),e.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,e,n){"use strict";var r=t("./zlib/deflate"),i=t("./utils/common"),o=t("./utils/strings"),s=t("./zlib/messages"),a=t("./zlib/zstream"),u=Object.prototype.toString;function c(t){if(!(this instanceof c))return new c(t);this.options=i.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},t||{});var e=((t=this.options).raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0,r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy));if(0!==e)throw new Error(s[e]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){if(t="string"==typeof t.dictionary?o.string2buf(t.dictionary):"[object ArrayBuffer]"===u.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(e=r.deflateSetDictionary(this.strm,t)))throw new Error(s[e]);this._dict_set=!0}}function l(t,e){if((e=new c(e)).push(t,!0),e.err)throw e.msg||s[e.err];return e.result}c.prototype.push=function(t,e){var n,s,a=this.strm,c=this.options.chunkSize;if(this.ended)return!1;s=e===~~e?e:!0===e?4:0,a.input="string"==typeof t?o.string2buf(t):"[object ArrayBuffer]"===u.call(t)?new Uint8Array(t):t,a.next_in=0,a.avail_in=a.input.length;do{if(0===a.avail_out&&(a.output=new i.Buf8(c),a.next_out=0,a.avail_out=c),1!==(n=r.deflate(a,s))&&0!==n)return this.onEnd(n),!(this.ended=!0)}while(0!==a.avail_out&&(0!==a.avail_in||4!==s&&2!==s)||this.onData("string"===this.options.to?o.buf2binstring(i.shrinkBuf(a.output,a.next_out)):i.shrinkBuf(a.output,a.next_out)),(0<a.avail_in||0===a.avail_out)&&1!==n);return 4===s?(n=r.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n):2!==s||(this.onEnd(0),!(a.avail_out=0))},c.prototype.onData=function(t){this.chunks.push(t)},c.prototype.onEnd=function(t){0===t&&(this.result="string"===this.options.to?this.chunks.join(""):i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},n.Deflate=c,n.deflate=l,n.deflateRaw=function(t,e){return(e=e||{}).raw=!0,l(t,e)},n.gzip=function(t,e){return(e=e||{}).gzip=!0,l(t,e)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,e,n){"use strict";var r=t("./zlib/inflate"),i=t("./utils/common"),o=t("./utils/strings"),s=t("./zlib/constants"),a=t("./zlib/messages"),u=t("./zlib/zstream"),c=t("./zlib/gzheader"),l=Object.prototype.toString;function h(t){if(!(this instanceof h))return new h(t);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;if(e.raw&&0<=e.windowBits&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits)&&(e.windowBits=-15),!(0<=e.windowBits&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),15<e.windowBits&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0,(t=r.inflateInit2(this.strm,e.windowBits))!==s.Z_OK)throw new Error(a[t]);this.header=new c,r.inflateGetHeader(this.strm,this.header)}function f(t,e){if((e=new h(e)).push(t,!0),e.err)throw e.msg||a[e.err];return e.result}h.prototype.push=function(t,e){var n,a,u,c,h,f=this.strm,d=this.options.chunkSize,p=this.options.dictionary,g=!1;if(this.ended)return!1;a=e===~~e?e:!0===e?s.Z_FINISH:s.Z_NO_FLUSH,f.input="string"==typeof t?o.binstring2buf(t):"[object ArrayBuffer]"===l.call(t)?new Uint8Array(t):t,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new i.Buf8(d),f.next_out=0,f.avail_out=d),(n=r.inflate(f,s.Z_NO_FLUSH))===s.Z_NEED_DICT&&p&&(h="string"==typeof p?o.string2buf(p):"[object ArrayBuffer]"===l.call(p)?new Uint8Array(p):p,n=r.inflateSetDictionary(this.strm,h)),n===s.Z_BUF_ERROR&&!0===g&&(n=s.Z_OK,g=!1),n!==s.Z_STREAM_END&&n!==s.Z_OK)return this.onEnd(n),!(this.ended=!0)}while(!f.next_out||0!==f.avail_out&&n!==s.Z_STREAM_END&&(0!==f.avail_in||a!==s.Z_FINISH&&a!==s.Z_SYNC_FLUSH)||("string"===this.options.to?(h=o.utf8border(f.output,f.next_out),u=f.next_out-h,c=o.buf2string(f.output,h),f.next_out=u,f.avail_out=d-u,u&&i.arraySet(f.output,f.output,h,u,0),this.onData(c)):this.onData(i.shrinkBuf(f.output,f.next_out))),0===f.avail_in&&0===f.avail_out&&(g=!0),(0<f.avail_in||0===f.avail_out)&&n!==s.Z_STREAM_END);return(a=n===s.Z_STREAM_END?s.Z_FINISH:a)===s.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===s.Z_OK):a!==s.Z_SYNC_FLUSH||(this.onEnd(s.Z_OK),!(f.avail_out=0))},h.prototype.onData=function(t){this.chunks.push(t)},h.prototype.onEnd=function(t){t===s.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},n.Inflate=h,n.inflate=f,n.inflateRaw=function(t,e){return(e=e||{}).raw=!0,f(t,e)},n.ungzip=f},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,e,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array,i=(n.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var n=e.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])}}return t},n.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)},{arraySet:function(t,e,n,r,i){if(e.subarray&&t.subarray)t.set(e.subarray(n,n+r),i);else for(var o=0;o<r;o++)t[i+o]=e[n+o]},flattenChunks:function(t){for(var e,n,r,i,o=e=0,s=t.length;o<s;o++)e+=t[o].length;for(i=new Uint8Array(e),o=n=0,s=t.length;o<s;o++)i.set(r=t[o],n),n+=r.length;return i}}),o={arraySet:function(t,e,n,r,i){for(var o=0;o<r;o++)t[i+o]=e[n+o]},flattenChunks:function(t){return[].concat.apply([],t)}};n.setTyped=function(t){t?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,i)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,o))},n.setTyped(r)},{}],42:[function(t,e,n){"use strict";var r=t("./common"),i=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(t){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){o=!1}for(var s=new r.Buf8(256),a=0;a<256;a++)s[a]=252<=a?6:248<=a?5:240<=a?4:224<=a?3:192<=a?2:1;function u(t,e){if(e<65537&&(t.subarray&&o||!t.subarray&&i))return String.fromCharCode.apply(null,r.shrinkBuf(t,e));for(var n="",s=0;s<e;s++)n+=String.fromCharCode(t[s]);return n}s[254]=s[254]=1,n.string2buf=function(t){for(var e,n,i,o,s=t.length,a=0,u=0;u<s;u++)55296==(64512&(n=t.charCodeAt(u)))&&u+1<s&&56320==(64512&(i=t.charCodeAt(u+1)))&&(n=65536+(n-55296<<10)+(i-56320),u++),a+=n<128?1:n<2048?2:n<65536?3:4;for(e=new r.Buf8(a),u=o=0;o<a;u++)55296==(64512&(n=t.charCodeAt(u)))&&u+1<s&&56320==(64512&(i=t.charCodeAt(u+1)))&&(n=65536+(n-55296<<10)+(i-56320),u++),n<128?e[o++]=n:(n<2048?e[o++]=192|n>>>6:(n<65536?e[o++]=224|n>>>12:(e[o++]=240|n>>>18,e[o++]=128|n>>>12&63),e[o++]=128|n>>>6&63),e[o++]=128|63&n);return e},n.buf2binstring=function(t){return u(t,t.length)},n.binstring2buf=function(t){for(var e=new r.Buf8(t.length),n=0,i=e.length;n<i;n++)e[n]=t.charCodeAt(n);return e},n.buf2string=function(t,e){for(var n,r,i,o=e||t.length,a=new Array(2*o),c=n=0;c<o;)if((r=t[c++])<128)a[n++]=r;else if(4<(i=s[r]))a[n++]=65533,c+=i-1;else{for(r&=2===i?31:3===i?15:7;1<i&&c<o;)r=r<<6|63&t[c++],i--;1<i?a[n++]=65533:r<65536?a[n++]=r:(a[n++]=55296|(r-=65536)>>10&1023,a[n++]=56320|1023&r)}return u(a,n)},n.utf8border=function(t,e){for(var n=(e=(e=e||t.length)>t.length?t.length:e)-1;0<=n&&128==(192&t[n]);)n--;return!(n<0||0===n)&&n+s[t[n]]>e?n:e}},{"./common":41}],43:[function(t,e,n){"use strict";e.exports=function(t,e,n,r){for(var i=65535&t|0,o=t>>>16&65535|0,s=0;0!==n;){for(n-=s=2e3<n?2e3:n;o=o+(i=i+e[r++]|0)|0,--s;);i%=65521,o%=65521}return i|o<<16|0}},{}],44:[function(t,e,n){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,e,n){"use strict";var r=function(){for(var t=[],e=0;e<256;e++){for(var n=e,r=0;r<8;r++)n=1&n?3988292384^n>>>1:n>>>1;t[e]=n}return t}();e.exports=function(t,e,n,i){var o=r,s=i+n;t^=-1;for(var a=i;a<s;a++)t=t>>>8^o[255&(t^e[a])];return-1^t}},{}],46:[function(t,e,n){"use strict";var r,i=t("../utils/common"),o=t("./trees"),s=t("./adler32"),a=t("./crc32"),u=t("./messages"),c=-2,l=258,h=262,f=113;function d(t,e){return t.msg=u[e],e}function p(t){return(t<<1)-(4<t?9:0)}function g(t){for(var e=t.length;0<=--e;)t[e]=0}function _(t){var e=t.state,n=e.pending;0!==(n=n>t.avail_out?t.avail_out:n)&&(i.arraySet(t.output,e.pending_buf,e.pending_out,n,t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending)&&(e.pending_out=0)}function m(t,e){o._tr_flush_block(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,_(t.strm)}function v(t,e){t.pending_buf[t.pending++]=e}function y(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function b(t,e){var n,r,i=t.max_chain_length,o=t.strstart,s=t.prev_length,a=t.nice_match,u=t.strstart>t.w_size-h?t.strstart-(t.w_size-h):0,c=t.window,f=t.w_mask,d=t.prev,p=t.strstart+l,g=c[o+s-1],_=c[o+s];t.prev_length>=t.good_match&&(i>>=2),a>t.lookahead&&(a=t.lookahead);do{if(c[(n=e)+s]===_&&c[n+s-1]===g&&c[n]===c[o]&&c[++n]===c[o+1]){for(o+=2,n++;c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&o<p;);if(r=l-(p-o),o=p-l,s<r){if(t.match_start=e,a<=(s=r))break;g=c[o+s-1],_=c[o+s]}}}while((e=d[e&f])>u&&0!=--i);return s<=t.lookahead?s:t.lookahead}function S(t){var e,n,r,o,u,c,l,f,d,p=t.w_size;do{if(f=t.window_size-t.lookahead-t.strstart,t.strstart>=p+(p-h)){for(i.arraySet(t.window,t.window,p,p,0),t.match_start-=p,t.strstart-=p,t.block_start-=p,e=n=t.hash_size;r=t.head[--e],t.head[e]=p<=r?r-p:0,--n;);for(e=n=p;r=t.prev[--e],t.prev[e]=p<=r?r-p:0,--n;);f+=p}if(0===t.strm.avail_in)break;if(c=t.window,l=t.strstart+t.lookahead,d=void 0,n=0===(d=f<(d=(u=t.strm).avail_in)?f:d)?0:(u.avail_in-=d,i.arraySet(c,u.input,u.next_in,d,l),1===u.state.wrap?u.adler=s(u.adler,c,d,l):2===u.state.wrap&&(u.adler=a(u.adler,c,d,l)),u.next_in+=d,u.total_in+=d,d),t.lookahead+=n,3<=t.lookahead+t.insert)for(t.ins_h=t.window[o=t.strstart-t.insert],t.ins_h=(t.ins_h<<t.hash_shift^t.window[o+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[o+3-1])&t.hash_mask,t.prev[o&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=o,o++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<h&&0!==t.strm.avail_in)}function E(t,e){for(var n,r;;){if(t.lookahead<h){if(S(t),t.lookahead<h&&0===e)return 1;if(0===t.lookahead)break}if(n=0,3<=t.lookahead&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==n&&t.strstart-n<=t.w_size-h&&(t.match_length=b(t,n)),3<=t.match_length)if(r=o._tr_tally(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&3<=t.lookahead){for(t.match_length--;t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,0!=--t.match_length;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else r=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(r&&(m(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,4===e?(m(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(m(t,!1),0===t.strm.avail_out)?1:2}function T(t,e){for(var n,r,i;;){if(t.lookahead<h){if(S(t),t.lookahead<h&&0===e)return 1;if(0===t.lookahead)break}if(n=0,3<=t.lookahead&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==n&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-h&&(t.match_length=b(t,n),t.match_length<=5)&&(1===t.strategy||3===t.match_length&&4096<t.strstart-t.match_start)&&(t.match_length=2),3<=t.prev_length&&t.match_length<=t.prev_length){for(i=t.strstart+t.lookahead-3,r=o._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=i&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!=--t.prev_length;);if(t.match_available=0,t.match_length=2,t.strstart++,r&&(m(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((r=o._tr_tally(t,0,t.window[t.strstart-1]))&&m(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(r=o._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,4===e?(m(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(m(t,!1),0===t.strm.avail_out)?1:2}function C(t,e,n,r,i){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=r,this.func=i}function w(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(1146),this.dyn_dtree=new i.Buf16(122),this.bl_tree=new i.Buf16(78),g(this.dyn_ltree),g(this.dyn_dtree),g(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(16),this.heap=new i.Buf16(573),g(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(573),g(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function R(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=2,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:f,t.adler=2===e.wrap?0:1,e.last_flush=0,o._tr_init(e),0):d(t,c)}function I(t){var e=R(t);return 0===e&&((t=t.state).window_size=2*t.w_size,g(t.head),t.max_lazy_match=r[t.level].max_lazy,t.good_match=r[t.level].good_length,t.nice_match=r[t.level].nice_length,t.max_chain_length=r[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),e}function k(t,e,n,r,o,s){if(!t)return c;var a=1;if(-1===e&&(e=6),r<0?(a=0,r=-r):15<r&&(a=2,r-=16),o<1||9<o||8!==n||r<8||15<r||e<0||9<e||s<0||4<s)return d(t,c);8===r&&(r=9);var u=new w;return(t.state=u).strm=t,u.wrap=a,u.gzhead=null,u.w_bits=r,u.w_size=1<<u.w_bits,u.w_mask=u.w_size-1,u.hash_bits=o+7,u.hash_size=1<<u.hash_bits,u.hash_mask=u.hash_size-1,u.hash_shift=~~((u.hash_bits+3-1)/3),u.window=new i.Buf8(2*u.w_size),u.head=new i.Buf16(u.hash_size),u.prev=new i.Buf16(u.w_size),u.lit_bufsize=1<<o+6,u.pending_buf_size=4*u.lit_bufsize,u.pending_buf=new i.Buf8(u.pending_buf_size),u.d_buf=+u.lit_bufsize,u.l_buf=3*u.lit_bufsize,u.level=e,u.strategy=s,u.method=n,I(t)}r=[new C(0,0,0,0,(function(t,e){var n=65535;for(n>t.pending_buf_size-5&&(n=t.pending_buf_size-5);;){if(t.lookahead<=1){if(S(t),0===t.lookahead&&0===e)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var r=t.block_start+n;if((0===t.strstart||t.strstart>=r)&&(t.lookahead=t.strstart-r,t.strstart=r,m(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-h&&(m(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(m(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&m(t,!1),1)})),new C(4,4,8,4,E),new C(4,5,16,8,E),new C(4,6,32,32,E),new C(4,4,16,16,T),new C(8,16,32,32,T),new C(8,16,128,128,T),new C(8,32,128,256,T),new C(32,128,258,1024,T),new C(32,258,258,4096,T)],n.deflateInit=function(t,e){return k(t,e,8,15,8,0)},n.deflateInit2=k,n.deflateReset=I,n.deflateResetKeep=R,n.deflateSetHeader=function(t,e){return t&&t.state&&2===t.state.wrap?(t.state.gzhead=e,0):c},n.deflate=function(t,e){var n,i,s,u;if(!t||!t.state||5<e||e<0)return t?d(t,c):c;if(i=t.state,!t.output||!t.input&&0!==t.avail_in||666===i.status&&4!==e)return d(t,0===t.avail_out?-5:c);if(i.strm=t,n=i.last_flush,i.last_flush=e,42===i.status&&(2===i.wrap?(t.adler=0,v(i,31),v(i,139),v(i,8),i.gzhead?(v(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),v(i,255&i.gzhead.time),v(i,i.gzhead.time>>8&255),v(i,i.gzhead.time>>16&255),v(i,i.gzhead.time>>24&255),v(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),v(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(v(i,255&i.gzhead.extra.length),v(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=a(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(v(i,0),v(i,0),v(i,0),v(i,0),v(i,0),v(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),v(i,3),i.status=f)):(h=8+(i.w_bits-8<<4)<<8,h|=(2<=i.strategy||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(h|=32),h+=31-h%31,i.status=f,y(i,h),0!==i.strstart&&(y(i,t.adler>>>16),y(i,65535&t.adler)),t.adler=1)),69===i.status)if(i.gzhead.extra){for(s=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>s&&(t.adler=a(t.adler,i.pending_buf,i.pending-s,s)),_(t),s=i.pending,i.pending!==i.pending_buf_size));)v(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>s&&(t.adler=a(t.adler,i.pending_buf,i.pending-s,s)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){s=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>s&&(t.adler=a(t.adler,i.pending_buf,i.pending-s,s)),_(t),s=i.pending,i.pending===i.pending_buf_size)){u=1;break}}while(u=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,v(i,u),0!==u);i.gzhead.hcrc&&i.pending>s&&(t.adler=a(t.adler,i.pending_buf,i.pending-s,s)),0===u&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){s=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>s&&(t.adler=a(t.adler,i.pending_buf,i.pending-s,s)),_(t),s=i.pending,i.pending===i.pending_buf_size)){u=1;break}}while(u=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,v(i,u),0!==u);i.gzhead.hcrc&&i.pending>s&&(t.adler=a(t.adler,i.pending_buf,i.pending-s,s)),0===u&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&_(t),i.pending+2<=i.pending_buf_size&&(v(i,255&t.adler),v(i,t.adler>>8&255),t.adler=0,i.status=f)):i.status=f),0!==i.pending){if(_(t),0===t.avail_out)return i.last_flush=-1,0}else if(0===t.avail_in&&p(e)<=p(n)&&4!==e)return d(t,-5);if(666===i.status&&0!==t.avail_in)return d(t,-5);if(0!==t.avail_in||0!==i.lookahead||0!==e&&666!==i.status){var h=2===i.strategy?function(t,e){for(var n;;){if(0===t.lookahead&&(S(t),0===t.lookahead)){if(0===e)return 1;break}if(t.match_length=0,n=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(m(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(m(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(m(t,!1),0===t.strm.avail_out)?1:2}(i,e):3===i.strategy?function(t,e){for(var n,r,i,s,a=t.window;;){if(t.lookahead<=l){if(S(t),t.lookahead<=l&&0===e)return 1;if(0===t.lookahead)break}if(t.match_length=0,3<=t.lookahead&&0<t.strstart&&(r=a[i=t.strstart-1])===a[++i]&&r===a[++i]&&r===a[++i]){for(s=t.strstart+l;r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&i<s;);t.match_length=l-(s-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(3<=t.match_length?(n=o._tr_tally(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(m(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(m(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(m(t,!1),0===t.strm.avail_out)?1:2}(i,e):r[i.level].func(i,e);if(3!==h&&4!==h||(i.status=666),1===h||3===h)return 0===t.avail_out&&(i.last_flush=-1),0;if(2===h&&(1===e?o._tr_align(i):5!==e&&(o._tr_stored_block(i,0,0,!1),3===e)&&(g(i.head),0===i.lookahead)&&(i.strstart=0,i.block_start=0,i.insert=0),_(t),0===t.avail_out))return i.last_flush=-1,0}return 4===e&&(i.wrap<=0||(2===i.wrap?(v(i,255&t.adler),v(i,t.adler>>8&255),v(i,t.adler>>16&255),v(i,t.adler>>24&255),v(i,255&t.total_in),v(i,t.total_in>>8&255),v(i,t.total_in>>16&255),v(i,t.total_in>>24&255)):(y(i,t.adler>>>16),y(i,65535&t.adler)),_(t),0<i.wrap&&(i.wrap=-i.wrap),0===i.pending))?1:0},n.deflateEnd=function(t){var e;return t&&t.state?42!==(e=t.state.status)&&69!==e&&73!==e&&91!==e&&103!==e&&e!==f&&666!==e?d(t,c):(t.state=null,e===f?d(t,-3):0):c},n.deflateSetDictionary=function(t,e){var n,r,o,a,u,l,h,f=e.length;if(!t||!t.state)return c;if(2===(a=(n=t.state).wrap)||1===a&&42!==n.status||n.lookahead)return c;for(1===a&&(t.adler=s(t.adler,e,f,0)),n.wrap=0,f>=n.w_size&&(0===a&&(g(n.head),n.strstart=0,n.block_start=0,n.insert=0),h=new i.Buf8(n.w_size),i.arraySet(h,e,f-n.w_size,n.w_size,0),e=h,f=n.w_size),h=t.avail_in,u=t.next_in,l=t.input,t.avail_in=f,t.next_in=0,t.input=e,S(n);3<=n.lookahead;){for(r=n.strstart,o=n.lookahead-2;n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+3-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++,--o;);n.strstart=r,n.lookahead=2,S(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,t.next_in=u,t.input=l,t.avail_in=h,n.wrap=a,0},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,e,n){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,e,n){"use strict";e.exports=function(t,e){var n,r,i,o,s,a,u=t.state,c=t.next_in,l=t.input,h=c+(t.avail_in-5),f=t.next_out,d=t.output,p=f-(e-t.avail_out),g=f+(t.avail_out-257),_=u.dmax,m=u.wsize,v=u.whave,y=u.wnext,b=u.window,S=u.hold,E=u.bits,T=u.lencode,C=u.distcode,w=(1<<u.lenbits)-1,R=(1<<u.distbits)-1;t:do{for(E<15&&(S+=l[c++]<<E,S+=l[c++]<<(E+=8),E+=8),n=T[S&w];;){if(S>>>=r=n>>>24,E-=r,0==(r=n>>>16&255))d[f++]=65535&n;else{if(!(16&r)){if(0==(64&r)){n=T[(65535&n)+(S&(1<<r)-1)];continue}if(32&r){u.mode=12;break t}t.msg="invalid literal/length code",u.mode=30;break t}for(i=65535&n,(r&=15)&&(E<r&&(S+=l[c++]<<E,E+=8),i+=S&(1<<r)-1,S>>>=r,E-=r),E<15&&(S+=l[c++]<<E,S+=l[c++]<<(E+=8),E+=8),n=C[S&R];;){if(S>>>=r=n>>>24,E-=r,!(16&(r=n>>>16&255))){if(0==(64&r)){n=C[(65535&n)+(S&(1<<r)-1)];continue}t.msg="invalid distance code",u.mode=30;break t}if(o=65535&n,E<(r&=15)&&(S+=l[c++]<<E,(E+=8)<r)&&(S+=l[c++]<<E,E+=8),_<(o+=S&(1<<r)-1)){t.msg="invalid distance too far back",u.mode=30;break t}if(S>>>=r,E-=r,(r=f-p)<o){if(v<(r=o-r)&&u.sane){t.msg="invalid distance too far back",u.mode=30;break t}if(a=b,(s=0)===y){if(s+=m-r,r<i){for(i-=r;d[f++]=b[s++],--r;);s=f-o,a=d}}else if(y<r){if(s+=m+y-r,(r-=y)<i){for(i-=r;d[f++]=b[s++],--r;);if(s=0,y<i){for(i-=r=y;d[f++]=b[s++],--r;);s=f-o,a=d}}}else if(s+=y-r,r<i){for(i-=r;d[f++]=b[s++],--r;);s=f-o,a=d}for(;2<i;)d[f++]=a[s++],d[f++]=a[s++],d[f++]=a[s++],i-=3;i&&(d[f++]=a[s++],1<i)&&(d[f++]=a[s++])}else{for(s=f-o;d[f++]=d[s++],d[f++]=d[s++],d[f++]=d[s++],2<(i-=3););i&&(d[f++]=d[s++],1<i)&&(d[f++]=d[s++])}break}}break}}while(c<h&&f<g);c-=i=E>>3,S&=(1<<(E-=i<<3))-1,t.next_in=c,t.next_out=f,t.avail_in=c<h?h-c+5:5-(c-h),t.avail_out=f<g?g-f+257:257-(f-g),u.hold=S,u.bits=E}},{}],49:[function(t,e,n){"use strict";var r=t("../utils/common"),i=t("./adler32"),o=t("./crc32"),s=t("./inffast"),a=t("./inftrees"),u=-2;function c(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function l(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function h(t){var e;return t&&t.state?(t.total_in=t.total_out=(e=t.state).total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new r.Buf32(852),e.distcode=e.distdyn=new r.Buf32(592),e.sane=1,e.back=-1,0):u}function f(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,h(t)):u}function d(t,e){var n,r;return!t||!t.state||(r=t.state,e<0?(n=0,e=-e):(n=1+(e>>4),e<48&&(e&=15)),e&&(e<8||15<e))?u:(null!==r.window&&r.wbits!==e&&(r.window=null),r.wrap=n,r.wbits=e,f(t))}function p(t,e){var n;return t?(n=new l,(t.state=n).window=null,0!==(n=d(t,e))&&(t.state=null),n):u}var g,_,m=!0;function v(t,e,n,i){var o;return null===(t=t.state).window&&(t.wsize=1<<t.wbits,t.wnext=0,t.whave=0,t.window=new r.Buf8(t.wsize)),i>=t.wsize?(r.arraySet(t.window,e,n-t.wsize,t.wsize,0),t.wnext=0,t.whave=t.wsize):(i<(o=t.wsize-t.wnext)&&(o=i),r.arraySet(t.window,e,n-i,o,t.wnext),(i-=o)?(r.arraySet(t.window,e,n-i,i,0),t.wnext=i,t.whave=t.wsize):(t.wnext+=o,t.wnext===t.wsize&&(t.wnext=0),t.whave<t.wsize&&(t.whave+=o))),0}n.inflateReset=f,n.inflateReset2=d,n.inflateResetKeep=h,n.inflateInit=function(t){return p(t,15)},n.inflateInit2=p,n.inflate=function(t,e){var n,l,h,f,d,p,y,b,S,E,T,C,w,R,I,k,O,N,A,L,P,M,D,x,U=0,B=new r.Buf8(4),H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return u;12===(n=t.state).mode&&(n.mode=13),d=t.next_out,h=t.output,f=t.next_in,l=t.input,b=n.hold,S=n.bits,E=p=t.avail_in,T=y=t.avail_out,M=0;t:for(;;)switch(n.mode){case 1:if(0===n.wrap)n.mode=13;else{for(;S<16;){if(0===p)break t;p--,b+=l[f++]<<S,S+=8}if(2&n.wrap&&35615===b)B[n.check=0]=255&b,B[1]=b>>>8&255,n.check=o(n.check,B,2,0),S=b=0,n.mode=2;else if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&b)<<8)+(b>>8))%31)t.msg="incorrect header check",n.mode=30;else if(8!=(15&b))t.msg="unknown compression method",n.mode=30;else{if(S-=4,P=8+(15&(b>>>=4)),0===n.wbits)n.wbits=P;else if(P>n.wbits){t.msg="invalid window size",n.mode=30;break}n.dmax=1<<P,t.adler=n.check=1,n.mode=512&b?10:12,S=b=0}}break;case 2:for(;S<16;){if(0===p)break t;p--,b+=l[f++]<<S,S+=8}if(n.flags=b,8!=(255&n.flags)){t.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=b>>8&1),512&n.flags&&(B[0]=255&b,B[1]=b>>>8&255,n.check=o(n.check,B,2,0)),S=b=0,n.mode=3;case 3:for(;S<32;){if(0===p)break t;p--,b+=l[f++]<<S,S+=8}n.head&&(n.head.time=b),512&n.flags&&(B[0]=255&b,B[1]=b>>>8&255,B[2]=b>>>16&255,B[3]=b>>>24&255,n.check=o(n.check,B,4,0)),S=b=0,n.mode=4;case 4:for(;S<16;){if(0===p)break t;p--,b+=l[f++]<<S,S+=8}n.head&&(n.head.xflags=255&b,n.head.os=b>>8),512&n.flags&&(B[0]=255&b,B[1]=b>>>8&255,n.check=o(n.check,B,2,0)),S=b=0,n.mode=5;case 5:if(1024&n.flags){for(;S<16;){if(0===p)break t;p--,b+=l[f++]<<S,S+=8}n.length=b,n.head&&(n.head.extra_len=b),512&n.flags&&(B[0]=255&b,B[1]=b>>>8&255,n.check=o(n.check,B,2,0)),S=b=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((C=p<(C=n.length)?p:C)&&(n.head&&(P=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,l,f,C,P)),512&n.flags&&(n.check=o(n.check,l,C,f)),p-=C,f+=C,n.length-=C),n.length))break t;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===p)break t;for(C=0;P=l[f+C++],n.head&&P&&n.length<65536&&(n.head.name+=String.fromCharCode(P)),P&&C<p;);if(512&n.flags&&(n.check=o(n.check,l,C,f)),p-=C,f+=C,P)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===p)break t;for(C=0;P=l[f+C++],n.head&&P&&n.length<65536&&(n.head.comment+=String.fromCharCode(P)),P&&C<p;);if(512&n.flags&&(n.check=o(n.check,l,C,f)),p-=C,f+=C,P)break t}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;S<16;){if(0===p)break t;p--,b+=l[f++]<<S,S+=8}if(b!==(65535&n.check)){t.msg="header crc mismatch",n.mode=30;break}S=b=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=12;break;case 10:for(;S<32;){if(0===p)break t;p--,b+=l[f++]<<S,S+=8}t.adler=n.check=c(b),S=b=0,n.mode=11;case 11:if(0===n.havedict)return t.next_out=d,t.avail_out=y,t.next_in=f,t.avail_in=p,n.hold=b,n.bits=S,2;t.adler=n.check=1,n.mode=12;case 12:if(5===e||6===e)break t;case 13:if(n.last)b>>>=7&S,S-=7&S,n.mode=27;else{for(;S<3;){if(0===p)break t;p--,b+=l[f++]<<S,S+=8}switch(n.last=1&b,--S,3&(b>>>=1)){case 0:n.mode=14;break;case 1:z=G=void 0;var z,G=n;if(m){for(g=new r.Buf32(512),_=new r.Buf32(32),z=0;z<144;)G.lens[z++]=8;for(;z<256;)G.lens[z++]=9;for(;z<280;)G.lens[z++]=7;for(;z<288;)G.lens[z++]=8;for(a(1,G.lens,0,288,g,0,G.work,{bits:9}),z=0;z<32;)G.lens[z++]=5;a(2,G.lens,0,32,_,0,G.work,{bits:5}),m=!1}if(G.lencode=g,G.lenbits=9,G.distcode=_,G.distbits=5,n.mode=20,6!==e)break;b>>>=2,S-=2;break t;case 2:n.mode=17;break;case 3:t.msg="invalid block type",n.mode=30}b>>>=2,S-=2}break;case 14:for(b>>>=7&S,S-=7&S;S<32;){if(0===p)break t;p--,b+=l[f++]<<S,S+=8}if((65535&b)!=(b>>>16^65535)){t.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&b,S=b=0,n.mode=15,6===e)break t;case 15:n.mode=16;case 16:if(C=n.length){if(0===(C=y<(C=p<C?p:C)?y:C))break t;r.arraySet(h,l,f,C,d),p-=C,f+=C,y-=C,d+=C,n.length-=C}else n.mode=12;break;case 17:for(;S<14;){if(0===p)break t;p--,b+=l[f++]<<S,S+=8}if(n.nlen=257+(31&b),S-=5,n.ndist=1+(31&(b>>>=5)),S-=5,n.ncode=4+(15&(b>>>=5)),b>>>=4,S-=4,286<n.nlen||30<n.ndist){t.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;S<3;){if(0===p)break t;p--,b+=l[f++]<<S,S+=8}n.lens[H[n.have++]]=7&b,b>>>=3,S-=3}for(;n.have<19;)n.lens[H[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,M=a(0,n.lens,0,19,n.lencode,0,n.work,D={bits:n.lenbits}),n.lenbits=D.bits,M){t.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;k=(U=n.lencode[b&(1<<n.lenbits)-1])>>>16&255,O=65535&U,!((I=U>>>24)<=S);){if(0===p)break t;p--,b+=l[f++]<<S,S+=8}if(O<16)b>>>=I,S-=I,n.lens[n.have++]=O;else{if(16===O){for(x=I+2;S<x;){if(0===p)break t;p--,b+=l[f++]<<S,S+=8}if(b>>>=I,S-=I,0===n.have){t.msg="invalid bit length repeat",n.mode=30;break}P=n.lens[n.have-1],C=3+(3&b),b>>>=2,S-=2}else if(17===O){for(x=I+3;S<x;){if(0===p)break t;p--,b+=l[f++]<<S,S+=8}P=0,C=3+(7&(b>>>=I)),b>>>=3,S=S-I-3}else{for(x=I+7;S<x;){if(0===p)break t;p--,b+=l[f++]<<S,S+=8}P=0,C=11+(127&(b>>>=I)),b>>>=7,S=S-I-7}if(n.have+C>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=30;break}for(;C--;)n.lens[n.have++]=P}}if(30===n.mode)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,M=a(1,n.lens,0,n.nlen,n.lencode,0,n.work,D={bits:n.lenbits}),n.lenbits=D.bits,M){t.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,M=a(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,D={bits:n.distbits}),n.distbits=D.bits,M){t.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===e)break t;case 20:n.mode=21;case 21:if(6<=p&&258<=y){t.next_out=d,t.avail_out=y,t.next_in=f,t.avail_in=p,n.hold=b,n.bits=S,s(t,T),d=t.next_out,h=t.output,y=t.avail_out,f=t.next_in,l=t.input,p=t.avail_in,b=n.hold,S=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;k=(U=n.lencode[b&(1<<n.lenbits)-1])>>>16&255,O=65535&U,!((I=U>>>24)<=S);){if(0===p)break t;p--,b+=l[f++]<<S,S+=8}if(k&&0==(240&k)){for(N=I,A=k,L=O;k=(U=n.lencode[L+((b&(1<<N+A)-1)>>N)])>>>16&255,O=65535&U,!(N+(I=U>>>24)<=S);){if(0===p)break t;p--,b+=l[f++]<<S,S+=8}b>>>=N,S-=N,n.back+=N}if(b>>>=I,S-=I,n.back+=I,n.length=O,0===k){n.mode=26;break}if(32&k){n.back=-1,n.mode=12;break}if(64&k){t.msg="invalid literal/length code",n.mode=30;break}n.extra=15&k,n.mode=22;case 22:if(n.extra){for(x=n.extra;S<x;){if(0===p)break t;p--,b+=l[f++]<<S,S+=8}n.length+=b&(1<<n.extra)-1,b>>>=n.extra,S-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;k=(U=n.distcode[b&(1<<n.distbits)-1])>>>16&255,O=65535&U,!((I=U>>>24)<=S);){if(0===p)break t;p--,b+=l[f++]<<S,S+=8}if(0==(240&k)){for(N=I,A=k,L=O;k=(U=n.distcode[L+((b&(1<<N+A)-1)>>N)])>>>16&255,O=65535&U,!(N+(I=U>>>24)<=S);){if(0===p)break t;p--,b+=l[f++]<<S,S+=8}b>>>=N,S-=N,n.back+=N}if(b>>>=I,S-=I,n.back+=I,64&k){t.msg="invalid distance code",n.mode=30;break}n.offset=O,n.extra=15&k,n.mode=24;case 24:if(n.extra){for(x=n.extra;S<x;){if(0===p)break t;p--,b+=l[f++]<<S,S+=8}n.offset+=b&(1<<n.extra)-1,b>>>=n.extra,S-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===y)break t;if(n.offset>(C=T-y)){if((C=n.offset-C)>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=30;break}w=C>n.wnext?n.wsize-(C-=n.wnext):n.wnext-C,C>n.length&&(C=n.length),R=n.window}else R=h,w=d-n.offset,C=n.length;for(y-=C=y<C?y:C,n.length-=C;h[d++]=R[w++],--C;);0===n.length&&(n.mode=21);break;case 26:if(0===y)break t;h[d++]=n.length,y--,n.mode=21;break;case 27:if(n.wrap){for(;S<32;){if(0===p)break t;p--,b|=l[f++]<<S,S+=8}if(t.total_out+=T-=y,n.total+=T,T&&(t.adler=n.check=(n.flags?o:i)(n.check,h,T,d-T)),T=y,(n.flags?b:c(b))!==n.check){t.msg="incorrect data check",n.mode=30;break}S=b=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;S<32;){if(0===p)break t;p--,b+=l[f++]<<S,S+=8}if(b!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=30;break}S=b=0}n.mode=29;case 29:M=1;break t;case 30:M=-3;break t;case 31:return-4;default:return u}return t.next_out=d,t.avail_out=y,t.next_in=f,t.avail_in=p,n.hold=b,n.bits=S,(n.wsize||T!==t.avail_out&&n.mode<30&&(n.mode<27||4!==e))&&v(t,t.output,t.next_out,T-t.avail_out)?(n.mode=31,-4):(T-=t.avail_out,t.total_in+=E-=t.avail_in,t.total_out+=T,n.total+=T,n.wrap&&T&&(t.adler=n.check=(n.flags?o:i)(n.check,h,T,t.next_out-T)),t.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),M=(0==E&&0===T||4===e)&&0===M?-5:M)},n.inflateEnd=function(t){var e;return t&&t.state?((e=t.state).window&&(e.window=null),t.state=null,0):u},n.inflateGetHeader=function(t,e){return t&&t.state&&0!=(2&(t=t.state).wrap)?((t.head=e).done=!1,0):u},n.inflateSetDictionary=function(t,e){var n,r=e.length;return!t||!t.state||0!==(n=t.state).wrap&&11!==n.mode?u:11===n.mode&&i(1,e,r,0)!==n.check?-3:v(t,e,r,r)?(n.mode=31,-4):(n.havedict=1,0)},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,e,n){"use strict";var r=t("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(t,e,n,u,c,l,h,f){var d,p,g,_,m,v,y,b,S,E=f.bits,T=0,C=0,w=0,R=0,I=0,k=0,O=0,N=0,A=0,L=0,P=null,M=0,D=new r.Buf16(16),x=new r.Buf16(16),U=null,B=0;for(T=0;T<=15;T++)D[T]=0;for(C=0;C<u;C++)D[e[n+C]]++;for(I=E,R=15;1<=R&&0===D[R];R--);if(R<I&&(I=R),0===R)c[l++]=20971520,c[l++]=20971520,f.bits=1;else{for(w=1;w<R&&0===D[w];w++);for(I<w&&(I=w),T=N=1;T<=15;T++)if((N=(N<<1)-D[T])<0)return-1;if(0<N&&(0===t||1!==R))return-1;for(x[1]=0,T=1;T<15;T++)x[T+1]=x[T]+D[T];for(C=0;C<u;C++)0!==e[n+C]&&(h[x[e[n+C]]++]=C);if(v=0===t?(P=U=h,19):1===t?(P=i,M-=257,U=o,B-=257,256):(P=s,U=a,-1),T=w,m=l,O=C=L=0,g=-1,_=(A=1<<(k=I))-1,1===t&&852<A||2===t&&592<A)return 1;for(;;){for(S=h[C]<v?(b=0,h[C]):h[C]>v?(b=U[B+h[C]],P[M+h[C]]):(b=96,0),d=1<<(y=T-O),w=p=1<<k;c[m+(L>>O)+(p-=d)]=y<<24|b<<16|S|0,0!==p;);for(d=1<<T-1;L&d;)d>>=1;if(L=0!==d?(L&d-1)+d:0,C++,0==--D[T]){if(T===R)break;T=e[n+h[C]]}if(I<T&&(L&_)!==g){for(m+=w,N=1<<(k=T-(O=0===O?I:O));k+O<R&&!((N-=D[k+O])<=0);)k++,N<<=1;if(A+=1<<k,1===t&&852<A||2===t&&592<A)return 1;c[g=L&_]=I<<24|k<<16|m-l|0}}0!==L&&(c[m+L]=T-O<<24|64<<16|0),f.bits=I}return 0}},{"../utils/common":41}],51:[function(t,e,n){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,e,n){"use strict";var r=t("../utils/common");function i(t){for(var e=t.length;0<=--e;)t[e]=0}var o=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],s=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],u=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],c=new Array(576),l=(i(c),new Array(60)),h=(i(l),new Array(512)),f=(i(h),new Array(256)),d=(i(f),new Array(29));i(d);var p,g,_,m=new Array(30);function v(t,e,n,r,i){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=t&&t.length}function y(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function b(t){return t<256?h[t]:h[256+(t>>>7)]}function S(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function E(t,e,n){t.bi_valid>16-n?(t.bi_buf|=e<<t.bi_valid&65535,S(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=n-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)}function T(t,e,n){E(t,n[2*e],n[2*e+1])}function C(t,e){for(var n=0;n|=1&t,t>>>=1,n<<=1,0<--e;);return n>>>1}function w(t,e,n){for(var r,i=new Array(16),o=0,s=1;s<=15;s++)i[s]=o=o+n[s-1]<<1;for(r=0;r<=e;r++){var a=t[2*r+1];0!==a&&(t[2*r]=C(i[a]++,a))}}function R(t){for(var e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function I(t){8<t.bi_valid?S(t,t.bi_buf):0<t.bi_valid&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function k(t,e,n,r){var i=2*e,o=2*n;return t[i]<t[o]||t[i]===t[o]&&r[e]<=r[n]}function O(t,e,n){for(var r=t.heap[n],i=n<<1;i<=t.heap_len&&(i<t.heap_len&&k(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!k(e,r,t.heap[i],t.depth));)t.heap[n]=t.heap[i],n=i,i<<=1;t.heap[n]=r}function N(t,e,n){var r,i,a,u,c=0;if(0!==t.last_lit)for(;r=t.pending_buf[t.d_buf+2*c]<<8|t.pending_buf[t.d_buf+2*c+1],i=t.pending_buf[t.l_buf+c],c++,0==r?T(t,i,e):(T(t,(a=f[i])+256+1,e),0!==(u=o[a])&&E(t,i-=d[a],u),T(t,a=b(--r),n),0!==(u=s[a])&&E(t,r-=m[a],u)),c<t.last_lit;);T(t,256,e)}function A(t,e){var n,r,i,o=e.dyn_tree,s=e.stat_desc.static_tree,a=e.stat_desc.has_stree,u=e.stat_desc.elems,c=-1;for(t.heap_len=0,t.heap_max=573,n=0;n<u;n++)0!==o[2*n]?(t.heap[++t.heap_len]=c=n,t.depth[n]=0):o[2*n+1]=0;for(;t.heap_len<2;)o[2*(i=t.heap[++t.heap_len]=c<2?++c:0)]=1,t.depth[i]=0,t.opt_len--,a&&(t.static_len-=s[2*i+1]);for(e.max_code=c,n=t.heap_len>>1;1<=n;n--)O(t,o,n);for(i=u;n=t.heap[1],t.heap[1]=t.heap[t.heap_len--],O(t,o,1),r=t.heap[1],t.heap[--t.heap_max]=n,t.heap[--t.heap_max]=r,o[2*i]=o[2*n]+o[2*r],t.depth[i]=(t.depth[n]>=t.depth[r]?t.depth[n]:t.depth[r])+1,o[2*n+1]=o[2*r+1]=i,t.heap[1]=i++,O(t,o,1),2<=t.heap_len;);t.heap[--t.heap_max]=t.heap[1];for(var l,h,f,d,p,g=t,_=e.dyn_tree,m=e.max_code,v=e.stat_desc.static_tree,y=e.stat_desc.has_stree,b=e.stat_desc.extra_bits,S=e.stat_desc.extra_base,E=e.stat_desc.max_length,T=0,C=0;C<=15;C++)g.bl_count[C]=0;for(_[2*g.heap[g.heap_max]+1]=0,l=g.heap_max+1;l<573;l++)E<(C=_[2*_[2*(h=g.heap[l])+1]+1]+1)&&(C=E,T++),_[2*h+1]=C,m<h||(g.bl_count[C]++,d=0,S<=h&&(d=b[h-S]),g.opt_len+=(p=_[2*h])*(C+d),y&&(g.static_len+=p*(v[2*h+1]+d)));if(0!==T){do{for(C=E-1;0===g.bl_count[C];)C--}while(g.bl_count[C]--,g.bl_count[C+1]+=2,g.bl_count[E]--,0<(T-=2));for(C=E;0!==C;C--)for(h=g.bl_count[C];0!==h;)m<(f=g.heap[--l])||(_[2*f+1]!==C&&(g.opt_len+=(C-_[2*f+1])*_[2*f],_[2*f+1]=C),h--)}w(o,c,t.bl_count)}function L(t,e,n){var r,i,o=-1,s=e[1],a=0,u=7,c=4;for(0===s&&(u=138,c=3),e[2*(n+1)+1]=65535,r=0;r<=n;r++)i=s,s=e[2*(r+1)+1],++a<u&&i===s||(a<c?t.bl_tree[2*i]+=a:0!==i?(i!==o&&t.bl_tree[2*i]++,t.bl_tree[32]++):a<=10?t.bl_tree[34]++:t.bl_tree[36]++,o=i,c=(a=0)===s?(u=138,3):i===s?(u=6,3):(u=7,4))}function P(t,e,n){var r,i,o=-1,s=e[1],a=0,u=7,c=4;for(0===s&&(u=138,c=3),r=0;r<=n;r++)if(i=s,s=e[2*(r+1)+1],!(++a<u&&i===s)){if(a<c)for(;T(t,i,t.bl_tree),0!=--a;);else 0!==i?(i!==o&&(T(t,i,t.bl_tree),a--),T(t,16,t.bl_tree),E(t,a-3,2)):a<=10?(T(t,17,t.bl_tree),E(t,a-3,3)):(T(t,18,t.bl_tree),E(t,a-11,7));o=i,c=(a=0)===s?(u=138,3):i===s?(u=6,3):(u=7,4)}}i(m);var M=!1;function D(t,e,n,i){E(t,0+(i?1:0),3),i=e,e=n,I(n=t),S(n,e),S(n,~e),r.arraySet(n.pending_buf,n.window,i,e,n.pending),n.pending+=e}n._tr_init=function(t){if(!M){for(var e,n,r,i,u=new Array(16),b=r=0;b<28;b++)for(d[b]=r,e=0;e<1<<o[b];e++)f[r++]=b;for(f[r-1]=b,b=i=0;b<16;b++)for(m[b]=i,e=0;e<1<<s[b];e++)h[i++]=b;for(i>>=7;b<30;b++)for(m[b]=i<<7,e=0;e<1<<s[b]-7;e++)h[256+i++]=b;for(n=0;n<=15;n++)u[n]=0;for(e=0;e<=143;)c[2*e+1]=8,e++,u[8]++;for(;e<=255;)c[2*e+1]=9,e++,u[9]++;for(;e<=279;)c[2*e+1]=7,e++,u[7]++;for(;e<=287;)c[2*e+1]=8,e++,u[8]++;for(w(c,287,u),e=0;e<30;e++)l[2*e+1]=5,l[2*e]=C(e,5);p=new v(c,o,257,286,15),g=new v(l,s,0,30,15),_=new v(new Array(0),a,0,19,7),M=!0}t.l_desc=new y(t.dyn_ltree,p),t.d_desc=new y(t.dyn_dtree,g),t.bl_desc=new y(t.bl_tree,_),t.bi_buf=0,t.bi_valid=0,R(t)},n._tr_stored_block=D,n._tr_flush_block=function(t,e,n,r){var i,o,s,a=0;if(0<t.level?(2===t.strm.data_type&&(t.strm.data_type=function(t){for(var e=4093624447,n=0;n<=31;n++,e>>>=1)if(1&e&&0!==t.dyn_ltree[2*n])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(n=32;n<256;n++)if(0!==t.dyn_ltree[2*n])return 1;return 0}(t)),A(t,t.l_desc),A(t,t.d_desc),a=function(t){var e;for(L(t,t.dyn_ltree,t.l_desc.max_code),L(t,t.dyn_dtree,t.d_desc.max_code),A(t,t.bl_desc),e=18;3<=e&&0===t.bl_tree[2*u[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),(o=t.static_len+3+7>>>3)<=(i=t.opt_len+3+7>>>3)&&(i=o)):i=o=n+5,n+4<=i&&-1!==e)D(t,e,n,r);else if(4===t.strategy||o===i)E(t,2+(r?1:0),3),N(t,c,l);else{E(t,4+(r?1:0),3);var h=t,f=(e=t.l_desc.max_code+1,n=t.d_desc.max_code+1,a+1);for(E(h,e-257,5),E(h,n-1,5),E(h,f-4,4),s=0;s<f;s++)E(h,h.bl_tree[2*u[s]+1],3);P(h,h.dyn_ltree,e-1),P(h,h.dyn_dtree,n-1),N(t,t.dyn_ltree,t.dyn_dtree)}R(t),r&&I(t)},n._tr_tally=function(t,e,n){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&n,t.last_lit++,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(f[n]+256+1)]++,t.dyn_dtree[2*b(e)]++),t.last_lit===t.lit_bufsize-1},n._tr_align=function(t){E(t,2,3),T(t,256,c),16===t.bi_valid?(S(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}},{"../utils/common":41}],53:[function(t,e,n){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,e,n){(function(t){!function(t){"use strict";var e,n,r,o,s,a,u,c,l;function h(t){delete s[t]}function f(t){if(a)setTimeout(f,0,t);else{var e=s[t];if(e){a=!0;try{var n=e.callback,r=e.args;switch(r.length){case 0:n();break;case 1:n(r[0]);break;case 2:n(r[0],r[1]);break;case 3:n(r[0],r[1],r[2]);break;default:n.apply(void 0,r)}}finally{h(t),a=!1}}}}function d(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(r)&&f(+e.data.slice(r.length))}t.setImmediate||(o=1,a=!(s={}),u=t.document,c=(c=Object.getPrototypeOf&&Object.getPrototypeOf(t))&&c.setTimeout?c:t,l="[object process]"==={}.toString.call(t.process)?function(t){i.nextTick((function(){f(t)}))}:function(){var e,n;if(t.postMessage&&!t.importScripts)return e=!0,n=t.onmessage,t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}()?(r="setImmediate$"+Math.random()+"$",t.addEventListener?t.addEventListener("message",d,!1):t.attachEvent("onmessage",d),function(e){t.postMessage(r+e,"*")}):t.MessageChannel?((n=new MessageChannel).port1.onmessage=function(t){f(t.data)},function(t){n.port2.postMessage(t)}):u&&"onreadystatechange"in u.createElement("script")?(e=u.documentElement,function(t){var n=u.createElement("script");n.onreadystatechange=function(){f(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}):function(t){setTimeout(f,0,t)},c.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];return s[o]={callback:t,args:e},l(o),o++},c.clearImmediate=h)}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)}).call(this,n(4).Buffer,n(8).setImmediate,n(0),n(1))},,function(t,e,n){"use strict";(function(t){var r=n(5),i=n(6),o=n(7);function s(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(t=null===t?new u(e):t).length=e,t}function u(t,e,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,n);if("number"!=typeof t)return c(this,t,e,n);if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}function c(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer){var i=t,s=e,c=n;if(c<0||s.byteLength<c)throw new RangeError("'offset' is out of bounds");if(s.byteLength<c+(r||0))throw new RangeError("'length' is out of bounds");return s=void 0===c&&void 0===r?new Uint8Array(s):void 0===r?new Uint8Array(s,c):new Uint8Array(s,c,r),u.TYPED_ARRAY_SUPPORT?(i=s).__proto__=u.prototype:i=f(i,s),i}if("string"==typeof e){if(c=t,r=e,u.isEncoding(s="string"==typeof(s=n)&&""!==s?s:"utf8"))return(r=(c=a(c,i=0|p(r,s))).write(r,s))!==i?c.slice(0,r):c;throw new TypeError('"encoding" must be a valid string encoding')}var l;if(n=t,u.isBuffer(r=e))return 0!==(n=a(n,l=0|d(r.length))).length&&r.copy(n,0,0,l),n;if(r){if("undefined"!=typeof ArrayBuffer&&r.buffer instanceof ArrayBuffer||"length"in r)return"number"!=typeof r.length||(l=r.length)!=l?a(n,0):f(n,r);if("Buffer"===r.type&&o(r.data))return f(n,r.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function l(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e){if(l(e),t=a(t,e<0?0:0|d(e)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function f(t,e){var n=e.length<0?0:0|d(e.length);t=a(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function d(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function p(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;var n=(t="string"!=typeof t?""+t:t).length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return O(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return N(t).length;default:if(r)return O(t).length;e=(""+e).toLowerCase(),r=!0}}function g(t,e,n){var i,o=!1;if((e=void 0===e||e<0?0:e)>this.length)return"";if((n=void 0===n||n>this.length?this.length:n)<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t=t||"utf8";;)switch(t){case"hex":var s=e,a=n,u=this.length;(!a||a<0||u<a)&&(a=u);for(var c="",l=s=!s||s<0?0:s;l<a;++l)c+=function(t){return t<16?"0"+t.toString(16):t.toString(16)}(this[l]);return c;case"utf8":case"utf-8":return b(this,e,n);case"ascii":u=e;var h=n,f="";h=Math.min(this.length,h);for(var d=u;d<h;++d)f+=String.fromCharCode(127&this[d]);return f;case"latin1":case"binary":s=e;var p=n,g="";p=Math.min(this.length,p);for(var _=s;_<p;++_)g+=String.fromCharCode(this[_]);return g;case"base64":return m=this,i=n,0===(v=e)&&i===m.length?r.fromByteArray(m):r.fromByteArray(m.slice(v,i));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(var m=e,v=n,y=this.slice(m,v),S="",E=0;E<y.length;E+=2)S+=String.fromCharCode(y[E]+256*y[E+1]);return S;default:if(o)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),o=!0}}function _(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function m(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,(n=(n=isNaN(n)?i?0:t.length-1:n)<0?t.length+n:n)>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:v(t,e,n,r,i);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?(i?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(t,e,n):v(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function v(t,e,n,r,i){var o=1,s=t.length,a=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s/=o=2,a/=2,n/=2}function u(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(i)for(var c=-1,l=n;l<s;l++)if(u(t,l)===u(e,-1===c?0:l-c)){if(l-(c=-1===c?l:c)+1===a)return c*o}else-1!==c&&(l-=l-c),c=-1;else for(l=n=s<n+a?s-a:n;0<=l;l--){for(var h=!0,f=0;f<a;f++)if(u(t,l+f)!==u(e,f)){h=!1;break}if(h)return l}return-1}function y(t,e,n,r){return A(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function b(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,s,a,u,c=t[i],l=null,h=239<c?4:223<c?3:191<c?2:1;if(i+h<=n)switch(h){case 1:c<128&&(l=c);break;case 2:128==(192&(o=t[i+1]))&&127<(u=(31&c)<<6|63&o)&&(l=u);break;case 3:s=t[i+2],128==(192&(o=t[i+1]))&&128==(192&s)&&2047<(u=(15&c)<<12|(63&o)<<6|63&s)&&(u<55296||57343<u)&&(l=u);break;case 4:s=t[i+2],a=t[i+3],128==(192&(o=t[i+1]))&&128==(192&s)&&128==(192&a)&&65535<(u=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)&&u<1114112&&(l=u)}null===l?(l=65533,h=1):65535<l&&(r.push((l-=65536)>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=h}var f=r,d=f.length;if(d<=4096)return String.fromCharCode.apply(String,f);for(var p="",g=0;g<d;)p+=String.fromCharCode.apply(String,f.slice(g,g+=4096));return p}function S(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(n<t+e)throw new RangeError("Trying to access beyond buffer length")}function E(t,e,n,r,i,o){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(i<e||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function T(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function C(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function w(t,e,n,r){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function R(t,e,n,r,o){return o||w(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function I(t,e,n,r,o){return o||w(t,0,n,8),i.write(t,e,n,r,52,8),n+8}e.Buffer=u,e.SlowBuffer=function(t){return u.alloc(+(t=+t!=t?0:t))},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=s(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return c(null,t,e,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol)&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0}),u.alloc=function(t,e,n){return l(t),t<=0||void 0===e?a(null,t):"string"==typeof n?a(null,t).fill(e,n):a(null,t).fill(e)},u.allocUnsafe=function(t){return h(null,t)},u.allocUnsafeSlow=function(t){return h(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);if(void 0===e)for(i=e=0;i<t.length;++i)e+=t[i].length;for(var n=u.allocUnsafe(e),r=0,i=0;i<t.length;++i){var s=t[i];if(!u.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,r),r+=s.length}return n},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)_(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)_(this,e,e+3),_(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)_(this,e,e+7),_(this,e+1,e+6),_(this,e+2,e+5),_(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0==t?"":0===arguments.length?b(this,0,t):g.apply(this,arguments)},u.prototype.equals=function(t){if(u.isBuffer(t))return this===t||0===u.compare(this,t);throw new TypeError("Argument must be a Buffer")},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return 0<this.length&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n)&&(t+=" ... "),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,r,i){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),(e=void 0===e?0:e)<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(i<=r&&n<=e)return 0;if(i<=r)return-1;if(n<=e)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0),a=Math.min(o,s),c=this.slice(r,i),l=t.slice(e,n),h=0;h<a;++h)if(c[h]!==l[h]){o=c[h],s=l[h];break}return o<s?-1:s<o?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return m(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return m(this,t,e,n,!1)},u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||i<n)&&(n=i),0<t.length&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r=r||"utf8";for(var o,s,a,u,c=!1;;)switch(r){case"hex":var l=t,h=e,f=n,d=(h=Number(h)||0,this.length-h);if((!f||(f=Number(f))>d)&&(f=d),(d=l.length)%2!=0)throw new TypeError("Invalid hex string");d/2<f&&(f=d/2);for(var p=0;p<f;++p){var g=parseInt(l.substr(2*p,2),16);if(isNaN(g))return p;this[h+p]=g}return p;case"utf8":case"utf-8":return u=n,A(O(t,(a=this).length-(d=e)),a,d,u);case"ascii":case"latin1":case"binary":return y(this,t,e,n);case"base64":return a=this,u=e,s=n,A(N(t),a,u,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return o=n,A(function(t,e){for(var n,r,i=[],o=0;o<t.length&&!((e-=2)<0);++o)r=(n=t.charCodeAt(o))>>8,i.push(n%256),i.push(r);return i}(t,this.length-(s=e)),this,s,o);default:if(c)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),c=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},u.prototype.slice=function(t,e){var n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):n<t&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):n<e&&(e=n),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(i=this.subarray(t,e)).__proto__=u.prototype;else for(var r=e-t,i=new u(r,void 0),o=0;o<r;++o)i[o]=this[o+t];return i},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||S(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||S(t,e,this.length);for(var r=this[t+--e],i=1;0<e&&(i*=256);)r+=this[t+--e]*i;return r},u.prototype.readUInt8=function(t,e){return e||S(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||S(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||S(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||S(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||S(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||S(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||S(t,e,this.length);for(var r=e,i=1,o=this[t+--r];0<r&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},u.prototype.readInt8=function(t,e){return e||S(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){return e||S(t,2,this.length),32768&(e=this[t]|this[t+1]<<8)?4294901760|e:e},u.prototype.readInt16BE=function(t,e){return e||S(t,2,this.length),32768&(e=this[t+1]|this[t]<<8)?4294901760|e:e},u.prototype.readInt32LE=function(t,e){return e||S(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||S(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||S(t,4,this.length),i.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||S(t,4,this.length),i.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||S(t,8,this.length),i.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||S(t,8,this.length),i.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,r){t=+t,e|=0,n|=0,r||E(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,r){t=+t,e|=0,n|=0,r||E(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;0<=--i&&(o*=256);)this[e+i]=t/o&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||E(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||E(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):T(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||E(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):T(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||E(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):C(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||E(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):C(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,r){t=+t,e|=0,r||E(this,t,e,n,(r=Math.pow(2,8*n-1))-1,-r);var i=0,o=1,s=0;for(this[e]=255&t;++i<n&&(o*=256);)t<0&&0===s&&0!==this[e+i-1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+n},u.prototype.writeIntBE=function(t,e,n,r){t=+t,e|=0,r||E(this,t,e,n,(r=Math.pow(2,8*n-1))-1,-r);var i=n-1,o=1,s=0;for(this[e+i]=255&t;0<=--i&&(o*=256);)t<0&&0===s&&0!==this[e+i+1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||E(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&(t=t<0?255+t+1:t),e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||E(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):T(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||E(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):T(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||E(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):C(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||E(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):C(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return R(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return R(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return I(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return I(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(n=n||0,r||0===r||(r=this.length),e>=t.length&&(e=t.length),(r=0<r&&r<n?n:r)===n)return 0;if(0===t.length||0===this.length)return 0;if((e=e||0)<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length);var i,o=(r=t.length-e<r-n?t.length-e+n:r)-n;if(this===t&&n<e&&e<r)for(i=o-1;0<=i;--i)t[i+e]=this[i+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},u.prototype.fill=function(t,e,n,r){if("string"==typeof t){var i;if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length&&(i=t.charCodeAt(0))<256&&(t=i),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(!(n<=e))if(e>>>=0,n=void 0===n?this.length:n>>>0,"number"==typeof(t=t||0))for(a=e;a<n;++a)this[a]=t;else for(var o=u.isBuffer(t)?t:O(new u(t,r).toString()),s=o.length,a=0;a<n-e;++a)this[a+e]=o[a%s];return this};var k=/[^+\/0-9A-Za-z-_]/g;function O(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],s=0;s<r;++s){if(55295<(n=t.charCodeAt(s))&&n<57344){if(!i){if(56319<n){-1<(e-=3)&&o.push(239,191,189);continue}if(s+1===r){-1<(e-=3)&&o.push(239,191,189);continue}i=n;continue}if(n<56320){-1<(e-=3)&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&-1<(e-=3)&&o.push(239,191,189);if(i=null,n<128){if(--e<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function N(t){return r.toByteArray(function(t){if((t=((e=t).trim?e.trim():e.replace(/^\s+|\s+$/g,"")).replace(k,"")).length<2)return"";for(var e;t.length%4!=0;)t+="=";return t}(t))}function A(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(0))},function(t,e,n){"use strict";e.byteLength=function(t){return 3*((t=u(t))[0]+(t=t[1]))/4-t},e.toByteArray=function(t){for(var e,n=(r=u(t))[0],r=r[1],s=new o(3*(n+r)/4-r),a=0,c=0<r?n-4:n,l=0;l<c;l+=4)e=i[t.charCodeAt(l)]<<18|i[t.charCodeAt(l+1)]<<12|i[t.charCodeAt(l+2)]<<6|i[t.charCodeAt(l+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=255&e;return 2===r&&(e=i[t.charCodeAt(l)]<<2|i[t.charCodeAt(l+1)]>>4,s[a++]=255&e),1===r&&(e=i[t.charCodeAt(l)]<<10|i[t.charCodeAt(l+1)]<<4|i[t.charCodeAt(l+2)]>>2,s[a++]=e>>8&255,s[a++]=255&e),s},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o=[],s=0,a=n-i;s<a;s+=16383)o.push(function(t,e,n){for(var i,o=[],s=e;s<n;s+=3)o.push(r[(i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]))>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return o.join("")}(t,s,a<s+16383?a:s+16383));return 1==i?o.push(r[(e=t[n-1])>>2]+r[e<<4&63]+"=="):2==i&&o.push(r[(e=(t[n-2]<<8)+t[n-1])>>10]+r[e>>4&63]+r[e<<2&63]+"="),o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)r[a]=s[a],i[s.charCodeAt(a)]=a;function u(t){var e=t.length;if(0<e%4)throw new Error("Invalid string. Length must be a multiple of 4");return[t=-1===(t=t.indexOf("="))?e:t,t===e?0:4-t%4]}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,l=-7,h=n?i-1:0,f=n?-1:1;for(i=t[e+h],h+=f,o=i&(1<<-l)-1,i>>=-l,l+=a;0<l;o=256*o+t[e+h],h+=f,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;0<l;s=256*s+t[e+h],h+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(i?-1:1);s+=Math.pow(2,r),o-=c}return(i?-1:1)*s*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var s,a,u=8*o-i-1,c=(1<<u)-1,l=c>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,d=r?1:-1;for(o=e<0||0===e&&1/e<0?1:0,e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(r=Math.pow(2,-s))<1&&(s--,r*=2),2<=(e+=1<=s+l?h/r:h*Math.pow(2,1-l))*r&&(s++,r/=2),c<=s+l?(a=0,s=c):1<=s+l?(a=(e*r-1)*Math.pow(2,i),s+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,i),s=0));8<=i;t[n+f]=255&a,f+=d,a/=256,i-=8);for(s=s<<i|a,u+=i;0<u;t[n+f]=255&s,f+=d,s/=256,u-=8);t[n+f-d]|=128*o}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;0<=e&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n(9),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(0))},function(t,e,n){(function(t,e){!function(t){"use strict";var n,r,i,o,s,a,u,c,l,h;function f(t){delete a[t]}function d(t){if(u)setTimeout(d,0,t);else{var e=a[t];if(e){u=!0;try{var n=e.callback,r=e.args;switch(r.length){case 0:n();break;case 1:n(r[0]);break;case 2:n(r[0],r[1]);break;case 3:n(r[0],r[1],r[2]);break;default:n.apply(void 0,r)}}finally{f(t),u=!1}}}}t.setImmediate||(s=1,u=!(a={}),c=t.document,l=(l=Object.getPrototypeOf&&Object.getPrototypeOf(t))&&l.setTimeout?l:t,h="[object process]"==={}.toString.call(t.process)?function(t){e.nextTick((function(){d(t)}))}:function(){var e,n;if(t.postMessage&&!t.importScripts)return e=!0,n=t.onmessage,t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}()?(i="setImmediate$"+Math.random()+"$",o=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(i)&&d(+e.data.slice(i.length))},t.addEventListener?t.addEventListener("message",o,!1):t.attachEvent("onmessage",o),function(e){t.postMessage(i+e,"*")}):t.MessageChannel?((r=new MessageChannel).port1.onmessage=function(t){d(t.data)},function(t){r.port2.postMessage(t)}):c&&"onreadystatechange"in c.createElement("script")?(n=c.documentElement,function(t){var e=c.createElement("script");e.onreadystatechange=function(){d(t),e.onreadystatechange=null,n.removeChild(e),e=null},n.appendChild(e)}):function(t){setTimeout(d,0,t)},l.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];return a[s]={callback:t,args:e},h(s),s++},l.clearImmediate=f)}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(0),n(1))},function(t,e,n){"use strict";n.r(e),n.d(e,"ZegoLogger",(function(){return Pt})),n.d(e,"ZegoDataReport",(function(){return d})),n.d(e,"createZegoWebSocket",(function(){return h})),n.d(e,"LoggerStateCenter",(function(){return s})),a.getInstance=function(){return a.instance||(a.instance=new a).init(),a.instance},a.prototype.init=function(){},Object.defineProperty(a.prototype,"testEnvironment",{get:function(){return this._testEnvironment},set:function(t){this._testEnvironment=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"ENV",{get:function(){return this._ENV},set:function(t){this._ENV=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"debug",{get:function(){return this._debug},set:function(t){this._debug=t},enumerable:!1,configurable:!0}),a.instance=new a;var r,i,o,s=a;function a(){this._testEnvironment=!0,this._ENV=0,this._debug=!0}(e=r=r||{})[e.BROWSER=0]="BROWSER",e[e.WEIXINMINI=1]="WEIXINMINI",(i=i||{})[i.DEFAULT=0]="DEFAULT",(e=o=o||{})[e.DISABLE=0]="DISABLE",e[e.WEBSOCKET=1]="WEBSOCKET",e[e.HTTPS=2]="HTTPS";var u={DEBUG:0,INFO:1,WARN:2,ERROR:3,REPORT:99,DISABLE:100,debug:0,info:1,warn:2,error:3,report:99,disable:100},c=(l.prototype.init=function(){var t=this;this._websocket&&(this.readyState=0,this._websocket.onOpen((function(e){t.readyState=t._websocket.readyState,"function"==typeof t.onopen&&(t.onopen(e),t._websocket.onClose((function(e){t.readyState=t._websocket.readyState,"function"==typeof t.onclose&&t.onclose(e)})),t._websocket.onMessage((function(e){"function"==typeof t.onmessage&&t.onmessage(e)})))})),this._websocket.onError((function(e){t.readyState=t._websocket.readyState,"function"==typeof t.onerror&&t.onerror(e)})))},l.prototype.onopen=function(t){},l.prototype.onerror=function(t){},l.prototype.onclose=function(t){},l.prototype.onmessage=function(t){},l.prototype.send=function(t){this._websocket&&this._websocket.send({data:t})},l.prototype.close=function(){this._websocket&&this._websocket.close()},l);function l(t,e){this.url=t,this.readyState=3,this.init()}function h(t,e){return new(e%2===r.BROWSER?WebSocket:c)(t)}var f=function(){return(f=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},d=(p.prototype.newReport=function(t,e){this.dataStatistics[t]={event_time:Date.now(),time_consumed:0,seq:t,error:0,message:"success",event:e,events:[]}},p.prototype.addMsgExt=function(t,e){this.dataStatistics[t]?this.dataStatistics[t].msg_ext=e:console.warn("".concat(t," not exist"))},p.prototype.addMsgInfo=function(t,e){this.dataStatistics[t]?Object.assign(this.dataStatistics[t],e):console.warn("".concat(t," not exist"))},p.prototype.eventStart=function(t,e){this.dataStatistics[t]?null!=this.dataStatistics[t].events?this.dataStatistics[t].events.push({event:e,event_time:Date.now(),time_consumed:0}):this.logger.warn("zd.es.0 no events"):this.logger.warn("zd.es.0 no seq match")},p.prototype.eventEnd=function(t,e,n){if(this.dataStatistics[t]){var r=this.dataStatistics[t].events;if(r&&0!==r.length){for(var i=r.length-1;0<=i;i--)if(r[i].event==e&&0==r[i].time_consumed){r[i].time_consumed=Date.now()-r[i].event_time;break}}else this.logger.info("zd.ee.0 no events")}else this.logger.info("zd.ee.0 no seq match")},p.prototype.eventEndWithMsg=function(t,e,n){if(this.dataStatistics[t]){var r=this.dataStatistics[t].events;if(r){for(var i=r.length-1;0<=i;i--)if(r[i].event==e&&0==r[i].time_consumed){r[i].time_consumed=Date.now()-r[i].event_time,null==r[i].msg_ext&&(r[i].msg_ext={}),r[i].msg_ext=f({},n);break}}else this.logger.warn("zd.ee.0 no events")}else this.logger.warn("zd.ee.0 no seq match")},p.prototype.eventEndWithMsgInfo=function(t,e,n){if(this.dataStatistics[t]){var r=this.dataStatistics[t].events;if(r){for(var i=r.length-1;0<=i;i--)if(r[i].event==e&&0==r[i].time_consumed){r[i].time_consumed=Date.now()-r[i].event_time,Object.assign(r[i],n);break}}else this.logger.warn("zd.ee.0 no events")}else this.logger.warn("zd.ee.0 no seq match")},p.prototype.addEventInfo=function(t,e,n,r){if(this.dataStatistics[t]){var i=this.dataStatistics[t].events;if(null!=i){for(var o=i.length-1;0<=o;o--)if(i[o].event==e&&null!=i[o].time_consumed){null==i[o].msg_ext?i[o].msg_ext={}:i[o].msg_ext&&(i[o].msg_ext[n]=r);break}}else this.logger.warn("zd.aei.0 no events")}else this.logger.warn("zd.aei.0 no seq match")},p.prototype.addEventMsg=function(t,e,n,r){if(this.dataStatistics[t]){var i=this.dataStatistics[t].events;if(null!=i){for(var o=i.length-1;0<=o;o--)if(i[o].event==e){i[o][n]=r;break}}else this.logger.warn("zd.aem.0 no events")}else this.logger.warn("zd.aem.0 no seq match")},p.prototype.addEvent=function(t,e,n){this.dataStatistics[t]?this.dataStatistics[t].events&&this.dataStatistics[t].events.push(n?{event:e,event_time:Date.now(),msg_ext:n}:{event:e,event_time:Date.now()}):this.logger.warn("zd.ae.0 no seq match")},p.prototype.uploadReport=function(t,e,n,r){var i=this.dataStatistics[t];null!=i&&(e&&(i.event=e),i.time_consumed=Date.now()-i.event_time,n&&this.addMsgInfo(t,{error:n.code,message:n.message||n.msg+" "+(r||"")}),this.logger.report(i),delete this.dataStatistics[t])},p);function p(t){this.dataStatistics={},this.logger=t}var g,_=["00","01","02","03","04","05","06","07","08","09"];function m(){var t=new Date;return[t.getFullYear()+"/",(_[t.getMonth()+1]||t.getMonth()+1)+"/",(_[t.getDate()]||t.getDate())+" ",(_[t.getHours()]||t.getHours())+":",(_[t.getMinutes()]||t.getMinutes())+":",_[t.getSeconds()]||t.getSeconds(),"."+t.getTime()%1e3].join("")}function v(t){this.cache=t}(e=g=g||{}).WEBSOCKET_STATE_CHANGE="zl.net.wsc",e.OPEN_WS="zl.net.opws",Object.defineProperty(Ct.prototype,"url",{get:function(){return this.configState.url},set:function(t){this.configState.url=t},enumerable:!1,configurable:!0}),Object.defineProperty(Ct.prototype,"strategy",{get:function(){return this.senderBuilder.strategy},enumerable:!1,configurable:!0}),Ct.prototype.setStrategy=function(t){this.senderBuilder.setStrategy(t),this.sender=this.senderBuilder.build()},Ct.prototype.addRemoteWsLog=function(t){if(this.configState.env!=r.BROWSER)throw new Error("cannot use net strategy on  mini program");var e;this.closed()&&(e=this.url,this.url="",this.openWebSocketLogServer(e)),this.cache.push(t),this.connected()&&this.sender&&this.sender.active()},Ct.prototype.stopWebSocketServer=function(){this.websocket&&(this.websocket.onclose=null,this.websocket.onerror=null,this.websocket.close(),this.websocket=null)},Ct.prototype.updateSender=function(){this.websocket instanceof WebSocket&&this.configState.useStrategy&&(this.senderBuilder.setWs(this.websocket),this.senderBuilder.setCache(this.cache),this.sender=this.senderBuilder.build())},Ct.prototype.updateWebSocketState=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=this.websocketState,i="";switch(t){case"onconnecting":this.websocketState="never_opened"===this.websocketState?"first_connecting":"reconnecting";break;case"onopen":this.websocketState="connected";break;case"onclosed":this.websocketState="closed";var o=e[0];o&&(i+=" close code=".concat(o.code));break;case"onerror":this.websocketState="error"}t=g.WEBSOCKET_STATE_CHANGE+" log ws state change: ".concat(r," -> ").concat(this.websocketState),i&&(t+=i),this.innerLogger.info(t)},Ct.prototype.openWebSocketLogServer=function(t){var e=this;this.url!=t&&((this.url&&""!==this.url||"never_opened"===this.websocketState)&&this.innerLogger.info(g.OPEN_WS+" log url change to: ".concat(t)),this.url=t)&&(this.stopWebSocketServer(),this.websocket=h(t,this.configState.env),this.updateSender(),this.updateWebSocketState("onconnecting"),this.websocket.onopen=function(){var t;e.configState.useStrategy&&null!=(t=e.sender)&&t.active(),e.updateWebSocketState("onopen")},this.websocket.onclose=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];console.warn("onclose   websocket error:",t),e.updateWebSocketState.apply(e,function(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||((r=r||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}(["onclosed"],t,!1))},this.websocket.onmessage=function(){},this.websocket.onerror=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];console.warn("open log websocket error:",t),e.updateWebSocketState("onerror")})},Ct.prototype.closed=function(){return null==this.websocket||2==this.websocket.readyState||3==this.websocket.readyState},Ct.prototype.connected=function(){return null!==this.websocket&&1==this.websocket.readyState},Ct.prototype.connecting=function(){return null!==this.websocket&&0==this.websocket.readyState},Ct.prototype.wsSend=function(t){this.websocket&&this.websocket.send(t)},Ct.prototype.destroy=function(){this.websocket=null};var y,b=Ct,S=(Tt.prototype.active=function(){var t=this;this.ws&&1===this.ws.readyState&&0!==this.cache.size()&&this.strategy.canSendLog()&&(this.strategy.getLog().forEach((function(e){t.ws.send(e)})),this.strategy.onSendLog())},Tt),E=(y=function(t,e){return(y=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t){function e(e){return t.call(this,e)||this}var n=e,r=t;if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=n}return y(n,r),n.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i),e.prototype.getLog=function(){return this.cache.clear()},e.prototype.canSendLog=function(){return 0<this.cache.size()},e.prototype.onSendLog=function(){},e}(v));nt=function(t,e){return(nt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}nt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(Et,et=v),Et.prototype.canSendLog=function(){return!this.locked&&0<this.cache.size()},Et.prototype.getLog=function(){for(var t=[],e=0;e<this.maxPacketLen-4e3;){var n=this.cache.getOneLogPacket();if(!n||n.length<=0)break;e+=n.length||0,t.push(n)}return t},Et.prototype.onSendLog=function(){var t=this;this.locked=!0,setTimeout((function(){t.locked=!1,t.onCanSendActive&&t.onCanSendActive()}),this.maxDelay)},tt=function(t,e){return(tt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}tt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(St,J=e=Et);var T=St,C=(X=function(t,e){return(X=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(){return null!==Q&&Q.apply(this,arguments)||this});if("function"!=typeof(A=Q=e)&&null!==A)throw new TypeError("Class extends value "+String(A)+" is not a constructor or null");function w(){this.constructor=C}X(C,A),C.prototype=null===A?Object.create(A):(w.prototype=A.prototype,new w),$=function(t,e){return($=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)};var R=function(){return null!==K&&K.apply(this,arguments)||this};if("function"!=typeof(A=K=e)&&null!==A)throw new TypeError("Class extends value "+String(A)+" is not a constructor or null");function I(){this.constructor=R}function k(){this.url="",this.env=r.BROWSER,this.useStrategy=!0,this.token="",this.deviceid=N.id()}$(R,A),R.prototype=null===A?Object.create(A):(I.prototype=A.prototype,new I),Z=function(t,e){return(Z=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Z(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}((function(){return null!==Y&&Y.apply(this,arguments)||this}),Y=e),Object.defineProperty(bt.prototype,"strategy",{get:function(){return this._strategy},enumerable:!1,configurable:!0}),bt.prototype.setWs=function(t){this.ws=t},bt.prototype.setCache=function(t){this.cache=t},bt.prototype.setStrategy=function(t){t&&(this._strategy=t)},bt.prototype.build=function(){if(this.ws&&this.cache)return new S(this.ws,this.cache,this._strategy!==i.DEFAULT?new E(this.cache):new T(this.cache));throw new Error("cannot build log sender")};var O=bt,N=(yt.isEnvSupport=function(){return!(!window||!window.localStorage)},yt.bin2hex=function(t){for(var e,n="",r=0,i=(t+="").length;r<i;r++)n+=(e=t.charCodeAt(r).toString(16)).length<2?"0"+e:e;return n},yt.getCanvasFingerprint=function(t){var e=document.createElement("canvas"),n=((n=e.getContext("2d")).textBaseline="top",n.font="14px 'Arial'",n.fillStyle="#f60",n.fillRect(125,1,62,20),n.fillStyle="#069",n.fillText(t,2,15),n.fillStyle="rgba(102, 204, 0, 0.7)",n.fillText(t,4,17),e.toDataURL().replace("data:image/png;base64,",""));return t=atob(n),this.bin2hex(t.slice(-16,-12))},yt.generateUUID=function(){var t,e,n;return(e=localStorage.getItem(this.storageKey))||(t=(new Date).getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(36)})),n=this.getCanvasFingerprint("hello, zego")+e.slice(8),localStorage.setItem(this.storageKey,n),e)},yt.id=function(){var t;return yt.isEnvSupport()?((t=localStorage.getItem(this.storageKey))||(t=yt.generateUUID(),localStorage.setItem(this.storageKey,t)),t):""},yt.storageKey="z_deviceID",yt),A=(Object.defineProperty(vt.prototype,"buffer",{get:function(){return this.queue},set:function(t){this.queue=t},enumerable:!1,configurable:!0}),vt.prototype.push=function(t){if(!t)throw new Error("item null!");t&&this.queue.push(t)},vt.prototype.pop=function(){return this.queue.shift()},vt.prototype.front=function(){return this.queue[0]},vt);function L(t,e,n,r){return new(n=n||Promise)((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):((e=t.value)instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function P(t,e){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s={next:a(0),throw:a(1),return:a(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(u){var c=[a,u];if(n)throw new TypeError("Generator is already executing.");for(;o=s&&c[s=0]?0:o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,(c=i?[2&c[0],i.value]:c)[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!((i=0<(i=o.trys).length&&i[i.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3]))o.label=c[1];else if(6===c[0]&&o.label<i[1])o.label=i[1],i=c;else{if(!(i&&o.label<i[2])){i[2]&&o.ops.pop(),o.trys.pop();continue}o.label=i[2],o.ops.push(c)}}c=e.call(t,o)}catch(u){c=[6,u],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}W=function(t,e){return(W=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)};var M=function(){return(M=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},D=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}W(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(mt,V=A),mt.prototype.size=function(){return this.queue.length},mt.prototype.getOneLogPacket=function(){for(var t="";0<this.queue.length;){if(4e3<(t+this.queue[0]).length)return t;var e=JSON.parse(this.queue[0]);e=M(M({},e),{userid:e.userid||this.configState.roomid,roomid:e.roomid||this.configState.roomid,userName:e.userName||this.configState.userName}),t=t+JSON.stringify(e)+"\n",this.queue.shift()}return""===t?void 0:t},mt.prototype.clear=function(){for(var t=[];0<this.queue.length;){var e=this.getOneLogPacket();if(!e)break;t.push(e)}return t},mt),x=(_t.prototype.save=function(t){return this.dbSaver.save(this.tableName,{log:t})},_t.prototype.queryList=function(t){return this.dbSaver.queryByCursor(this.tableName,t)},_t.prototype.delete=function(t){return this.dbSaver.deleteItems(this.tableName,t)},_t.prototype.storedBytesSize=function(){var t=this;return new Promise((function(e,n){return r=t,o=function(){var t,r;return function(t,e){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s={next:a(0),throw:a(1),return:a(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(u){var c=[a,u];if(n)throw new TypeError("Generator is already executing.");for(;o=s&&c[s=0]?0:o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,(c=i?[2&c[0],i.value]:c)[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!((i=0<(i=o.trys).length&&i[i.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3]))o.label=c[1];else if(6===c[0]&&o.label<i[1])o.label=i[1],i=c;else{if(!(i&&o.label<i[2])){i[2]&&o.ops.pop(),o.trys.pop();continue}o.label=i[2],o.ops.push(c)}}c=e.call(t,o)}catch(u){c=[6,u],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,(function(i){return t=this.dbSaver.openCursor(this.tableName),r=0,t.onsuccess=function(t){(t=null==(t=t.target)?void 0:t.result)?(r+=t.value.log.length,t.continue()):e(r)},t.onerror=function(t){n(t)},[2]}))},new(i=(i=void 0)||Promise)((function(t,e){function n(t){try{a(o.next(t))}catch(t){e(t)}}function s(t){try{a(o.throw(t))}catch(t){e(t)}}function a(e){var r;e.done?t(e.value):((r=e.value)instanceof i?r:new i((function(t){t(r)}))).then(n,s)}a((o=o.apply(r,[])).next())}));var r,i,o}))},_t.prototype.lines=function(){return this.dbSaver.lines(this.tableName)},_t.prototype.deleteByCount=function(t){return this.dbSaver.deleteByCount(this.tableName,t)},_t.prototype.deleteAll=function(){return this.dbSaver.deleteAll(this.tableName)},_t),U=(gt.prototype.openDB=function(t){return L(this,void 0,void 0,(function(){var e,n,r=this;return P(this,(function(i){switch(i.label){case 0:return e=window.indexedDB.open(t.database,t.version),n=this,[4,new Promise((function(n){e.onupgradeneeded=function(e){var n=e.target&&e.target.result;t.tableList.forEach((function(t){var e;n.objectStoreNames.contains(t.tableName)||(e=n.createObjectStore(t.tableName,{keyPath:"id",autoIncrement:!0}),t.tableItems.forEach((function(t){t.index&&e.createIndex(t.itemName,t.itemName,{unique:t.unique})})))}))},e.onsuccess=function(t){r.db=t=t.target&&t.target.result,n(e)}}))];case 1:return n.dbRequest=i.sent(),[2]}}))}))},gt.prototype.checkConn=function(){if(!this.dbRequest&&!this.db)throw new Error("indexDB not open")},gt.prototype.save=function(t,e){var n=this;return new Promise((function(r,i){return L(n,void 0,void 0,(function(){var n,o;return P(this,(function(s){return this.checkConn(),n=this.db.transaction([t],"readwrite").objectStore(t),(o=n.add(e)).onsuccess=function(t){r(o.result)},o.onerror=function(t){i("save item fail")},[2]}))}))}))},gt.prototype.update=function(t,e){var n=this;return new Promise((function(t,e){n.checkConn(),t()}))},gt.prototype.queryById=function(t,e){var n=this;return new Promise((function(r,i){return L(n,void 0,void 0,(function(){var n,o;return P(this,(function(s){return this.checkConn(),n=this.db.transaction([t]).objectStore(t),(o=n.get(e)).onsuccess=function(t){r(o.result?o.result:null)},o.onerror=function(t){i()},[2]}))}))}))},gt.prototype.queryByCursor=function(t,e){var n=this;return new Promise((function(r,i){return L(n,void 0,void 0,(function(){var n,o;return P(this,(function(s){return this.checkConn(),o=this.db.transaction([t]).objectStore(t),n=[],(o=o.openCursor()).onsuccess=function(t){(t=null==(t=t.target)?void 0:t.result)&&(!e||n.length<e)?(n.push(t.value),t.continue()):r(n)},o.onerror=function(t){i()},[2]}))}))}))},gt.prototype.lines=function(t){var e=this;return new Promise((function(n,r){return L(e,void 0,void 0,(function(){var e,i;return P(this,(function(o){return this.checkConn(),e=(e=this.db.transaction([t]).objectStore(t)).openCursor(),i=0,e.onsuccess=function(t){(t=null==(t=t.target)?void 0:t.result)?(i++,t.continue()):n(i)},e.onerror=function(t){r()},[2]}))}))}))},gt.prototype.openCursor=function(t){return this.checkConn(),this.db.transaction([t]).objectStore(t).openCursor()},gt.prototype.deleteById=function(t,e){var n=this;return new Promise((function(r,i){return L(n,void 0,void 0,(function(){var n;return P(this,(function(o){return this.checkConn(),(n=(n=this.db.transaction([t],"readwrite").objectStore(t)).delete(e)).onsuccess=function(t){r()},n.onerror=function(t){i()},[2]}))}))}))},gt.prototype.deleteByCount=function(t,e){var n=this;return new Promise((function(r,i){return L(n,void 0,void 0,(function(){var n,i;return P(this,(function(o){switch(o.label){case 0:this.checkConn(),n=8192,o.label=1;case 1:return 0<e?[4,this.queryByCursor(t,Math.min(e,n))]:[3,4];case 2:return 0===(i=o.sent()).length?[3,4]:(e-=n,[4,this.deleteItems(t,i)]);case 3:return o.sent(),[3,1];case 4:return r(),[2]}}))}))}))},gt.prototype.deleteAll=function(t){var e=this;return new Promise((function(n,r){return L(e,void 0,void 0,(function(){var e;return P(this,(function(i){return this.checkConn(),(e=(e=this.db.transaction([t],"readwrite").objectStore(t)).clear()).onsuccess=function(t){n()},e.onerror=function(t){r()},[2]}))}))}))},gt.prototype.deleteItems=function(t,e){var n=this;return new Promise((function(r){return L(n,void 0,void 0,(function(){var n;return P(this,(function(i){switch(i.label){case 0:return this.checkConn(),n=this.db.transaction([t],"readwrite").objectStore(t),[4,Promise.all(e.map((function(t){return new Promise((function(e,r){var i=n.delete(t.id);i.onsuccess=function(t){e()},i.onerror=function(t){r()}}))})))];case 1:return i.sent(),r(),[2]}}))}))}))},gt),B={version:1,database:"zego_logger_db",tableList:[{tableName:"zego_log",tableItems:[{itemName:"log",index:!1,unique:!1}]}]};function H(t,e,n,r){return new(n=n||Promise)((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):((e=t.value)instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function z(t,e){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s={next:a(0),throw:a(1),return:a(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(u){var c=[a,u];if(n)throw new TypeError("Generator is already executing.");for(;o=s&&c[s=0]?0:o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,(c=i?[2&c[0],i.value]:c)[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!((i=0<(i=o.trys).length&&i[i.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3]))o.label=c[1];else if(6===c[0]&&o.label<i[1])o.label=i[1],i=c;else{if(!(i&&o.label<i[2])){i[2]&&o.ops.pop(),o.trys.pop();continue}o.label=i[2],o.ops.push(c)}}c=e.call(t,o)}catch(u){c=[6,u],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}function G(t,e,n,r){return new(n=n||Promise)((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):((e=t.value)instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function F(t,e){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s={next:a(0),throw:a(1),return:a(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(u){var c=[a,u];if(n)throw new TypeError("Generator is already executing.");for(;o=s&&c[s=0]?0:o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,(c=i?[2&c[0],i.value]:c)[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!((i=0<(i=o.trys).length&&i[i.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3]))o.label=c[1];else if(6===c[0]&&o.label<i[1])o.label=i[1],i=c;else{if(!(i&&o.label<i[2])){i[2]&&o.ops.pop(),o.trys.pop();continue}o.label=i[2],o.ops.push(c)}}c=e.call(t,o)}catch(u){c=[6,u],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}j=function(t,e){return(j=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}j(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(pt,q=A);var q,j,V,W,Y,Z,K,$,Q,X,J,tt,et,nt,rt=pt,it=function(){return(it=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},ot=(dt.prototype.pushTask=function(t,e,n,r,i){t={task:t},e&&(t=it(it({},t),{args:e})),n&&(t=it(it({},t),{successCallback:n})),r&&(t=it(it({},t),{errorCallback:r})),i&&(t=it(it({},t),{completeCallback:i})),this.queue.push(t)},dt.prototype.runTaskQueueItem=function(t){return H(this,void 0,void 0,(function(){var e,n;return z(this,(function(r){switch(r.label){case 0:e=null,r.label=1;case 1:return r.trys.push([1,4,5,6]),t&&t.args?e=t.task.apply(t,t.args):t&&(e=t.task()),e instanceof Promise?[4,e]:[3,3];case 2:e=r.sent(),r.label=3;case 3:return t.successCallback&&t.successCallback(e),[3,6];case 4:if(n=r.sent(),t.errorCallback)return t.errorCallback(n),[3,6];throw n;case 5:return t.completeCallback&&t.completeCallback(),[7];case 6:return[2]}}))}))},dt.prototype.runATask=function(){return H(this,void 0,void 0,(function(){var t;return z(this,(function(e){switch(e.label){case 0:return this.queue.length<=0?[2]:(t=this.queue.shift())?[4,this.runTaskQueueItem(t)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},dt.prototype.runAllTask=function(){return H(this,void 0,void 0,(function(){var t;return z(this,(function(e){switch(e.label){case 0:return 0<this.queue.length?(t=this.queue.shift())?[4,this.runTaskQueueItem(t)]:[3,2]:[3,3];case 1:e.sent(),e.label=2;case 2:return[3,0];case 3:return[2]}}))}))},dt.prototype.size=function(){return this.queue.length},dt),st=(e=n(2),n.n(e)),at=(ft.prototype.writeLine=function(t){t&&""!==t&&this.cacheLines.push(t)},ft.prototype.saveAs=function(t,e){var n=document.createElement("a");n.href=URL.createObjectURL(t),n.download=e,n.click()},ft.prototype.createZip=function(){return t=this,n=function(){var t,e;return function(t,e){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s={next:a(0),throw:a(1),return:a(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(u){var c=[a,u];if(n)throw new TypeError("Generator is already executing.");for(;o=s&&c[s=0]?0:o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,(c=i?[2&c[0],i.value]:c)[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!((i=0<(i=o.trys).length&&i[i.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3]))o.label=c[1];else if(6===c[0]&&o.label<i[1])o.label=i[1],i=c;else{if(!(i&&o.label<i[2])){i[2]&&o.ops.pop(),o.trys.pop();continue}o.label=i[2],o.ops.push(c)}}c=e.call(t,o)}catch(u){c=[6,u],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,(function(n){switch(n.label){case 0:t=new st.a,e="",0<this.cacheLines.length&&(e=this.cacheLines.join("\n"),this.cacheLines=[]),e=new Blob([e],{type:"text/plain;charset=utf-8"}),t.file("log.txt",e),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,t.generateAsync({type:"blob"})];case 2:return[2,n.sent()];case 3:throw e=n.sent(),console.error("create zip file failed",e),e;case 4:return[2]}}))},new(e=(e=void 0)||Promise)((function(r,i){function o(t){try{a(n.next(t))}catch(t){i(t)}}function s(t){try{a(n.throw(t))}catch(t){i(t)}}function a(t){var n;t.done?r(t.value):((n=t.value)instanceof e?n:new e((function(t){t(n)}))).then(o,s)}a((n=n.apply(t,[])).next())}));var t,e,n},ft),ut=(ht.prototype.isUploadFieldReady=function(){return!!(this.configState.appid&&this.configState.userid&&""!==this.configState.userid&&this.configState.token&&""!==this.configState.token&&this.configState.deviceid&&""!==this.configState.deviceid)},ht.prototype.setUploadUrl=function(t){this.uploadUrl=t},ht.prototype.upload=function(t){return G(this,void 0,void 0,(function(){var e=this;return F(this,(function(n){if(this.isUploadFieldReady())return[2,new Promise((function(n,r){return G(e,void 0,void 0,(function(){var e,i=this;return F(this,(function(o){switch(o.label){case 0:return e=function(){return G(i,void 0,void 0,(function(){var e,n,i=this;return F(this,(function(o){switch(o.label){case 0:this.updateLocked=!0,(e=new FormData).append("logs",t),e.append("hello",this.configState.appid.toString()),e.append("appid",this.configState.appid.toString()),e.append("uin",this.configState.userid.toString()),e.append("timestamp",(new Date).getTime().toString()),e.append("token",this.configState.token),e.append("deviceid",this.configState.deviceid),o.label=1;case 1:return o.trys.push([1,3,4,5]),[4,ct.post(this.uploadUrl,e)];case 2:if(0!==(n=o.sent()).code)throw new Error("upload logs failed, error=".concat(JSON.stringify(n)));return[3,5];case 3:return n=o.sent(),r(n),[3,5];case 4:return setTimeout((function(){return G(i,void 0,void 0,(function(){return F(this,(function(t){switch(t.label){case 0:return this.updateLocked=!1,[4,this.taskQueue.runATask()];case 1:return t.sent(),[2]}}))}))}),100),[7];case 5:return[2]}}))}))},this.updateLocked?(this.taskQueue.pushTask(e,[],(function(){n()}),(function(t){r(t)})),[3,3]):[3,1];case 1:return[4,e()];case 2:o.sent(),n(),o.label=3;case 3:return[2]}}))}))}))];throw new Error("cannot upload logs, please login room before you upload logs.")}))}))},ht),ct=(lt.post=function(t,e){return new Promise((function(n,r){try{var i=new XMLHttpRequest;i.open("POST",t,!0),i.responseType="json",i.send(e),i.onreadystatechange=function(){i.readyState===XMLHttpRequest.DONE&&(200===i.status?n(i.response):r("request fail. status="+i.status))}}catch(n){r(n)}}))},lt);function lt(){}function ht(t){this.configState=t,this.defaultDomain="detaillog-global.zego.im",this.uploadUrl="https://".concat(this.defaultDomain,"/log/userupload"),this.taskQueue=new ot,this.updateLocked=!1}function ft(){this.cacheLines=[]}function dt(){this.queue=[]}function pt(){return null!==q&&q.apply(this,arguments)||this}function gt(){}function _t(t){this.dbSaver=t,this.tableName="zego_log"}function mt(t){var e=V.call(this)||this;return e.configState=t,e}function vt(){this.queue=[]}function yt(){}function bt(){this._strategy=i.DEFAULT}function St(t){return(t=J.call(this,t)||this).maxDelay=10,t.maxPacketLen=20480,t}function Et(){var t=null!==et&&et.apply(this,arguments)||this;return t.maxDelay=10,t.maxPacketLen=20480,t.locked=!1,t}function Tt(t,e,n){this.ws=t,this.cache=e,this.strategy=n,this.strategy.onCanSendActive=this.active.bind(this)}function Ct(t,e,n){this.cache=t,this.configState=e,this.innerLogger=n,this.websocket=null,this.websocketState="never_opened",this.senderBuilder=new O,this.sender=null}function wt(t,e,n,r){return new(n=n||Promise)((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):((e=t.value)instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function Rt(t,e){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s={next:a(0),throw:a(1),return:a(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(u){var c=[a,u];if(n)throw new TypeError("Generator is already executing.");for(;o=s&&c[s=0]?0:o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,(c=i?[2&c[0],i.value]:c)[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!((i=0<(i=o.trys).length&&i[i.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3]))o.label=c[1];else if(6===c[0]&&o.label<i[1])o.label=i[1],i=c;else{if(!(i&&o.label<i[2])){i[2]&&o.ops.pop(),o.trys.pop();continue}o.label=i[2],o.ops.push(c)}}c=e.call(t,o)}catch(u){c=[6,u],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}function It(t,e,n,r){return new(n=n||Promise)((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):((e=t.value)instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function kt(t,e){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s={next:a(0),throw:a(1),return:a(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(u){var c=[a,u];if(n)throw new TypeError("Generator is already executing.");for(;o=s&&c[s=0]?0:o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,(c=i?[2&c[0],i.value]:c)[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!((i=0<(i=o.trys).length&&i[i.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3]))o.label=c[1];else if(6===c[0]&&o.label<i[1])o.label=i[1],i=c;else{if(!(i&&o.label<i[2])){i[2]&&o.ops.pop(),o.trys.pop();continue}o.label=i[2],o.ops.push(c)}}c=e.call(t,o)}catch(u){c=[6,u],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var Ot=function(){return(Ot=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},Nt=(xt.prototype.build=function(t){var e=Ot(Ot({},JSON.parse(t)),{sdkid:this.sdkid});if(++this.buildedCount%100==0)return(t=JSON.stringify(e)).substring(1,t.length-1);for(n in e)this.excludedKeys.includes(n)||(e[n]===this.logCtx[n]?delete e[n]:this.logCtx[n]=e[n]);var n,r=[];for(n in e)this.excludedKeys.includes(n)?r.push(e[n]):r.push("".concat(n,":").concat(e[n]));return r.join(",")},xt.prototype.buildFullMessageLog=function(t){return t=JSON.parse(t),t=Ot(Ot(Ot({},this.logCtx),t),{sdkid:this.sdkid}),JSON.stringify(t)},xt),At=(Object.defineProperty(Dt.prototype,"dbOpened",{get:function(){return this._dbOpened},enumerable:!1,configurable:!0}),Object.defineProperty(Dt.prototype,"dbTryOpened",{get:function(){return this._dbTryOpen},enumerable:!1,configurable:!0}),Dt.prototype.makeStorageSpace=function(){return wt(this,void 0,void 0,(function(){var t;return Rt(this,(function(e){switch(e.label){case 0:return[4,this.logModel.lines()];case 1:return 153600<(t=e.sent())?[4,this.logModel.deleteByCount(t/2)]:[3,3];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},Dt.prototype.makeStorageSpaceUpload=function(){return wt(this,void 0,void 0,(function(){var t,e=this;return Rt(this,(function(n){return this.zipLogEnabled?(t=function(){return wt(e,void 0,void 0,(function(){return Rt(this,(function(t){switch(t.label){case 0:return[4,this.logModel.lines()];case 1:return 3072<t.sent()?[4,this.startASdkUploadTask()]:[3,3];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},[2,new Promise((function(n,r){return wt(e,void 0,void 0,(function(){var e;return Rt(this,(function(i){switch(i.label){case 0:return this.dbOpened?[3,1]:(this.dbTaskQueue.pushTask(t,[],(function(){n()}),(function(t){r(t)})),[3,5]);case 1:return i.trys.push([1,3,,4]),[4,t()];case 2:return i.sent(),[3,4];case 3:return e=i.sent(),r(e),[2];case 4:n(),i.label=5;case 5:return[2]}}))}))}))]):[2]}))}))},Dt.prototype.openDB=function(){return wt(this,void 0,void 0,(function(){return Rt(this,(function(t){switch(t.label){case 0:return this._dbTryOpen?[2]:(this._dbTryOpen=!0,[4,this.dbSaver.openDB(B)]);case 1:return t.sent(),this._dbOpened=!0,[4,this.makeStorageSpace()];case 2:return t.sent(),[4,this.dbTaskQueue.runAllTask()];case 3:return t.sent(),[4,this.uploadTaskQueue.runATask()];case 4:return t.sent(),this.activeSaving(),[2]}}))}))},Dt.prototype.shouldOpenDB=function(){return this.zipLogEnabled&&Dt.isEnvSupport()&&!this._dbOpened&&!this._dbTryOpen},Dt.prototype.enable=function(){this.zipLogEnabled||(this.zipLogEnabled=!0,this.shouldOpenDB()&&this.openDB())},Dt.prototype.saveLog=function(t){this.shouldOpenDB()&&this.openDB(),this.cache.push(this.zipLogBuilder.build(t)),this.activeSaving()},Dt.prototype.removeLogList=function(t){return wt(this,void 0,void 0,(function(){return Rt(this,(function(e){switch(e.label){case 0:return 0===t.length?[2]:[4,this.logModel.delete(t)];case 1:return e.sent(),[2]}}))}))},Dt.prototype.empty=function(){return wt(this,void 0,void 0,(function(){return Rt(this,(function(t){switch(t.label){case 0:return[4,this.logModel.queryList(1)];case 1:return[2,0===t.sent().length]}}))}))},Dt.prototype.activeSaving=function(){var t,e=this;this.zipLogEnabled&&this.dbOpened&&!this.activating&&(this.activating=!0,(t=function(){var n=e.cache.front();n?e.logModel.save(n).then((function(){e.cache.pop(),t()})).catch((function(t){e.activating=!1,console.error(t)})):e.activating=!1})())},Dt.isEnvSupport=function(){return!(!window||!("indexedDB"in window))},Dt.prototype.uploadTask=function(){return wt(this,void 0,void 0,(function(){var t,e,n;return Rt(this,(function(r){switch(r.label){case 0:return[4,this.logModel.lines()];case 1:t=r.sent(),e=function(){var e,r,i;return Rt(this,(function(o){switch(o.label){case 0:return[4,n.logModel.queryList(Math.min(3145728,t))];case 1:return e=o.sent(),t-=3145728,e.length<=0?[2,"break"]:(r=new at,e.forEach((function(t){r.writeLine(t.log)})),[4,r.createZip()]);case 2:return i=o.sent(),[4,n.zipLogUploader.upload(i)];case 3:return o.sent(),[4,n.logModel.delete(e)];case 4:return o.sent(),[2]}}))},n=this,r.label=2;case 2:return 0<t?[5,e()]:[3,4];case 3:return"break"===r.sent()?[3,4]:[3,2];case 4:return[2]}}))}))},Dt.prototype.startASdkUploadTask=function(){var t=this;return new Promise((function(e,n){return wt(t,void 0,void 0,(function(){var t=this;return Rt(this,(function(r){return this.uploadTaskQueue.pushTask((function(){return wt(t,void 0,void 0,(function(){return Rt(this,(function(t){switch(t.label){case 0:return[4,this.uploadTask()];case 1:return t.sent(),[2]}}))}))}),[],(function(){e()}),(function(t){n(t)}),(function(){0<t.uploadTaskQueue.size()&&t.uploadTaskQueue.runATask()})),this.dbOpened&&1===this.uploadTaskQueue.size()&&this.uploadTaskQueue.runATask(),[2]}))}))}))},Dt.prototype.startAUserUploadTask=function(){var t=this;return new Promise((function(e,n){return wt(t,void 0,void 0,(function(){var t=this;return Rt(this,(function(r){return this.userLastUploadSuccess=!1,this.userUploading=!0,this.uploadTaskQueue.pushTask((function(){return wt(t,void 0,void 0,(function(){return Rt(this,(function(t){switch(t.label){case 0:return this.userUploading=!0,[4,this.uploadTask()];case 1:return t.sent(),[2]}}))}))}),[],(function(){t.userLastUploadSuccess=!0,t.userUploading=!1,e()}),(function(e){t.userUploading=!1,n(e)}),(function(){0<t.uploadTaskQueue.size()&&t.uploadTaskQueue.runATask()})),this.dbOpened&&1===this.uploadTaskQueue.size()&&this.uploadTaskQueue.runATask(),[2]}))}))}))},Dt.prototype.setUploadUrl=function(t){this.zipLogUploader.setUploadUrl(t)},Dt.prototype.startUpload=function(){return wt(this,void 0,void 0,(function(){return Rt(this,(function(t){switch(t.label){case 0:if(!this.zipLogEnabled)throw new Error("zip logs upload is not enabled.");if(0!==this.userLastUploadTime&&performance.now()-this.userLastUploadTime<6e4&&this.userLastUploadSuccess||this.userUploading)throw new Error("Logs upload failed. Do not report frequently.");return this.userLastUploadTime=performance.now(),[4,this.startAUserUploadTask()];case 1:return t.sent(),[2]}}))}))},Dt.prototype.destroy=function(){},Dt),Lt=function(){return(Lt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},Pt=(Object.defineProperty(Mt.prototype,"url",{get:function(){return this.configState.url||""},set:function(t){this.configState.url=t},enumerable:!1,configurable:!0}),Object.defineProperty(Mt.prototype,"logType",{get:function(){return this.configState.logType||o.DISABLE},set:function(t){this.configState.logType=t},enumerable:!1,configurable:!0}),Object.defineProperty(Mt.prototype,"env",{get:function(){return this.configState.env},set:function(t){this.configState.env=t},enumerable:!1,configurable:!0}),Object.defineProperty(Mt.prototype,"appid",{get:function(){return this.configState.appid},set:function(t){this.configState.appid=t},enumerable:!1,configurable:!0}),Object.defineProperty(Mt.prototype,"roomid",{get:function(){return this.configState.roomid},set:function(t){this.configState.roomid=t},enumerable:!1,configurable:!0}),Object.defineProperty(Mt.prototype,"sessionid",{get:function(){return this.configState.sessionid},set:function(t){this.configState.sessionid=t},enumerable:!1,configurable:!0}),Object.defineProperty(Mt.prototype,"userid",{get:function(){return this.configState.userid},set:function(t){this.configState.userid=t},enumerable:!1,configurable:!0}),Object.defineProperty(Mt.prototype,"userName",{get:function(){return this.configState.userName},set:function(t){this.configState.userName=t},enumerable:!1,configurable:!0}),Object.defineProperty(Mt.prototype,"version",{get:function(){return this.configState.userName},set:function(t){this.configState.version=t},enumerable:!1,configurable:!0}),Mt.prototype.setLogLevel=function(t){return void 0!==(t=u[t])&&(this.logLevel=t,!0)},Mt.prototype.setRemoteLogLevel=function(t){return void 0!==(t=u[t])&&(this.logRemoteLevel=t,!0)},Mt.prototype.setSessionInfo=function(t,e,n,r,i,o){this.appid=t,this.roomid=e,this.sessionid=n,this.userid=r,this.userName=i,this.version=o},Mt.prototype.setTokenInfo=function(t,e){this.configState.token=t,e&&(this.configState.userid=e)},Mt.prototype.setZipLogConfig=function(t,e){1===t&&this.zipLogContext?this.zipLogContext.enable():0==t&&e&&this.zipLogContext&&(this.zipLogContext.destroy(),this.zipLogContext=null)},Mt.prototype.setZipLogUploadUrl=function(t){this.zipLogContext&&this.zipLogContext.setUploadUrl(t)},Mt.prototype.makeZipLogSpaceUpload=function(){return It(this,void 0,void 0,(function(){return kt(this,(function(t){switch(t.label){case 0:return this.zipLogContext?[4,this.zipLogContext.makeStorageSpaceUpload()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},Mt.prototype.uploadStorageLog=function(){return It(this,void 0,void 0,(function(){return kt(this,(function(t){switch(t.label){case 0:return this.zipLogContext?[4,this.zipLogContext.startUpload()]:[3,2];case 1:return t.sent(),[3,3];case 2:throw new Error("cannot use zip log module");case 3:return[2]}}))}))},Mt.prototype.report=function(t){t=this.logReportParamList(u.REPORT,t),this.logLevel!==u.DISABLE&&this.logLevel<=u.REPORT&&console.debug(t),this.RemoteLog(u.REPORT,t,!0)},Mt.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this.logParamList(u.DEBUG,t.join(""));this.logLevel!==u.DISABLE&&this.logLevel<=u.DEBUG&&console.debug(n),this.log(u.DEBUG,n)},Mt.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this.logParamList(u.INFO,t.join(""));this.logLevel!==u.DISABLE&&this.logLevel<=u.INFO&&console.info(n),this.log(u.INFO,n)},Mt.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this.logParamList(u.WARN,t.join(""));this.logLevel!==u.DISABLE&&this.logLevel<=u.WARN&&console.warn(n),this.log(u.WARN,n)},Mt.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this.logParamList(u.ERROR,t.join(""));this.logLevel!==u.DISABLE&&this.logLevel<=u.ERROR&&(console.error(n),this.env%2===r.BROWSER&&window&&this.stateCenter.debug&&window.alert(t.join("").substr(t.join("").indexOf(" ")+1,4500))),this.log(u.ERROR,n)},Mt.prototype.log=function(t,e){this.logRemoteLevel!==u.DISABLE&&this.logRemoteLevel<=t&&(this.RemoteLog(t,e),this.zipLogContext)&&this.zipLogContext.saveLog(e)},Mt.prototype.setLogServer=function(t){if(this.isDestroy)return!1;try{return t.startsWith("wss:")?(this.logType=o.WEBSOCKET,this.netContext.openWebSocketLogServer(t)):t.startsWith("https:")?(this.logType=o.HTTPS,this.openHttpsLogServer(t)):this.logType=o.DISABLE,!0}catch(t){return this.error(JSON.stringify(t)),!1}},Mt.prototype.stopLogServer=function(){this.logType==o.WEBSOCKET?this.stopWebSocketServer():this.logType==o.HTTPS&&(this.SendHttpsLog(),this.stopHttpsServer()),this.logType=o.DISABLE},Mt.prototype.stopWebSocketServer=function(){this.netContext.stopWebSocketServer()},Mt.prototype.openHttpsLogServer=function(t){var e=this;(this.url=t)&&(this.stopHttpsServer(),this.logUploadTimer||(this.logUploadTimer=setInterval((function(){e.SendHttpsLog()}),this.logUploadInterval)))},Mt.prototype.stopHttpsServer=function(){this.logUploadTimer&&(clearInterval(this.logUploadTimer),this.logUploadTimer=null)},Mt.prototype.RemoteLog=function(t,e,n){return void 0===n&&(n=!1),It(this,void 0,void 0,(function(){return kt(this,(function(r){if(""!=this.url&&!this.isDestroy)if(this.logType==o.WEBSOCKET)this.RemoteWebSocketLog(t,e);else if(this.logType==o.HTTPS)this.RemoteHttpsLog(t,e,n);else if(this.logLevel!==u.DISABLE&&this.logLevel<=t)for(this.logCache.push(e);this.logCache.size()>this.logCacheMax;)this.logCache.pop();return[2]}))}))},Mt.prototype.clearLogCache=function(){var t=this;this.netContext.connected()&&this.logCache.clear().forEach((function(e){t.netContext.wsSend(e)}))},Mt.prototype.clearCache=function(){0!==this.logCache.size()&&this.clearLogCache()},Mt.prototype.saveLog=function(t){this.logCache.size()<this.logCacheMax&&this.logCache.push(t)},Mt.prototype.websocketSendLog=function(t){this.netContext.connected()?this.netContext.wsSend(t):this.saveLog(t)},Mt.prototype.RemoteWebSocketLog=function(t,e){return It(this,void 0,void 0,(function(){var t;return kt(this,(function(n){return"string"==typeof e&&4e3<e.length?console.info("log over maximum, ignore"):this.configState.useStrategy&&this.env==r.BROWSER?this.netContext.addRemoteWsLog(e):this.netContext.closed()?(t=this.url,this.url="",this.setLogServer(t),this.saveLog(e)):this.netContext.connecting()?this.saveLog(e):this.netContext.connected()&&(this.clearCache(),this.websocketSendLog(e)),[2]}))}))},Mt.prototype.RemoteHttpsLog=function(t,e,n){this.logCache.push(e),(this.logCache.size()>=this.logCacheMax||!0===n)&&this.SendHttpsLog()},Mt.prototype.logParamList=function(t,e){var n={time:n=m(),level:t,action:(e=[e.substr(0,e.indexOf(" "))||e,e.substr(e.indexOf(" ")+1,4500)||e])[0],content:e[1],appid:this.appid,roomid:this.roomid,userid:this.userid,userName:this.userName,sessionid:this.sessionid};return JSON.stringify(n)},Mt.prototype.logReportParamList=function(t,e){var n=m(),i=this.env%2===r.BROWSER?"rtc":"ali";return e=Lt(Lt({},e),{time:n,level:t,console:i,appid:this.appid,room_id:this.roomid,roomid:this.roomid,userid:this.userid,id_name:this.userid,userName:this.userName,sessionid:this.sessionid,sdk_version:this.version,test_environment:this.stateCenter.testEnvironment,version:this.version,event_id:this.appid+"_"+this.userid+"_"+e.event_time+"_"+e.seq}),JSON.stringify(e)},Mt.prototype.SendHttpsLog=function(){0!=this.logCache.size()&&(this.env%2===r.BROWSER?this.SendHttpsLogWeb():this.SendHttpsLogWeChatMini())},Mt.prototype.SendHttpsLogWeb=function(){var t=this,e=this.logCache.buffer.join("\n"),n=this.logCache.buffer,r=new XMLHttpRequest;r.onreadystatechange=function(){if(4==r.readyState){if(200==r.status){if(0==r.responseText.length)return;try{var e=JSON.parse(r.responseText).interval;"number"==typeof e&&t.logUploadInterval!==e&&(t.timeInterval=e,t.openHttpsLogServer(t.url))}catch(e){t.logCache.buffer=n.concat(t.logCache.buffer),console.log("send result failed "+e)}}else t.logCache.buffer=n.concat(t.logCache.buffer),console.log("send failed "+r.status);n=null}},r.open("POST",this.url,!0),0==this.env?r.send(e):1==this.env&&(r.setRequestHeader("content-type","application/json"),r.send(JSON.stringify({user_id:this.userid,log:e}))),this.logCache.buffer=[]},Mt.prototype.SendHttpsLogWeChatMini=function(){},Mt.prototype.destroy=function(){this.stopLogServer(),this.logUploadTimer&&clearTimeout(this.logUploadTimer),s.instance=void 0,this.netContext.destroy(),this.zipLogContext&&this.zipLogContext.destroy(),this.url=""},Mt.logVersion="1.4.0",Mt);function Mt(t){var e=this;this.logLevel=u.INFO,this.logRemoteLevel=0,this.logUploadTimer=null,this.logUploadInterval=1e4,this.existUserID=!1,this.isDestroy=!1,this.logCacheMax=8192,this.innerLogger={debug:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.debug.apply(e,t)},info:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.info.apply(e,t)},warn:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.warn.apply(e,t)},error:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.error.apply(e,t)}},this.stateCenter=s.getInstance(),this.configState=new k,this.configState.env=t,this.logCache=new D(this.configState),this.netContext=new b(this.logCache,this.configState,this.innerLogger),this.env==r.BROWSER&&At.isEnvSupport()&&(this.zipLogContext=new At(this.configState))}function Dt(t){this.configState=t,this.dbSaver=new U,this.logModel=new x(this.dbSaver),this._dbOpened=!1,this._dbTryOpen=!1,this.cache=new rt,this.activating=!1,this.dbTaskQueue=new ot,this.uploadTaskQueue=new ot,this.zipLogEnabled=!1,this.userLastUploadTime=0,this.userLastUploadSuccess=!1,this.userUploading=!1,this.zipLogUploader=new ut(this.configState),this.zipLogBuilder=new Nt(this.configState)}function xt(t){this.configState=t,this.logCtx={},this.excludedKeys=["time","action","content","sdkid"],this.buildedCount=0,this.sdkid=crypto.getRandomValues(new Uint8Array(5)).reduce(((t,e)=>t+((e&=63)<36?e.toString(36):e<62?(e-26).toString(36).toUpperCase():62<e?"-":"_")),"")}}],o={},r.m=i,r.c=o,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=10))},function(t,e,n){t.exports=function(t){for(var e=Math,n=t,r=n.lib,i=r.WordArray,o=r.Hasher,s=n.algo,a=[],u=0;u<64;u++)a[u]=4294967296*e.abs(e.sin(u+1))|0;var c=s.MD5=o.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,e){for(var n=0;n<16;n++){var r=e+n,i=t[r];t[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var o=this._hash.words,s=t[e+0],u=t[e+1],c=t[e+2],p=t[e+3],g=t[e+4],_=t[e+5],m=t[e+6],v=t[e+7],y=t[e+8],b=t[e+9],S=t[e+10],E=t[e+11],T=t[e+12],C=t[e+13],w=t[e+14],R=t[e+15],I=o[0],k=o[1],O=o[2],N=o[3];I=l(I,k,O,N,s,7,a[0]),N=l(N,I,k,O,u,12,a[1]),O=l(O,N,I,k,c,17,a[2]),k=l(k,O,N,I,p,22,a[3]),I=l(I,k,O,N,g,7,a[4]),N=l(N,I,k,O,_,12,a[5]),O=l(O,N,I,k,m,17,a[6]),k=l(k,O,N,I,v,22,a[7]),I=l(I,k,O,N,y,7,a[8]),N=l(N,I,k,O,b,12,a[9]),O=l(O,N,I,k,S,17,a[10]),k=l(k,O,N,I,E,22,a[11]),I=l(I,k,O,N,T,7,a[12]),N=l(N,I,k,O,C,12,a[13]),O=l(O,N,I,k,w,17,a[14]),I=h(I,k=l(k,O,N,I,R,22,a[15]),O,N,u,5,a[16]),N=h(N,I,k,O,m,9,a[17]),O=h(O,N,I,k,E,14,a[18]),k=h(k,O,N,I,s,20,a[19]),I=h(I,k,O,N,_,5,a[20]),N=h(N,I,k,O,S,9,a[21]),O=h(O,N,I,k,R,14,a[22]),k=h(k,O,N,I,g,20,a[23]),I=h(I,k,O,N,b,5,a[24]),N=h(N,I,k,O,w,9,a[25]),O=h(O,N,I,k,p,14,a[26]),k=h(k,O,N,I,y,20,a[27]),I=h(I,k,O,N,C,5,a[28]),N=h(N,I,k,O,c,9,a[29]),O=h(O,N,I,k,v,14,a[30]),I=f(I,k=h(k,O,N,I,T,20,a[31]),O,N,_,4,a[32]),N=f(N,I,k,O,y,11,a[33]),O=f(O,N,I,k,E,16,a[34]),k=f(k,O,N,I,w,23,a[35]),I=f(I,k,O,N,u,4,a[36]),N=f(N,I,k,O,g,11,a[37]),O=f(O,N,I,k,v,16,a[38]),k=f(k,O,N,I,S,23,a[39]),I=f(I,k,O,N,C,4,a[40]),N=f(N,I,k,O,s,11,a[41]),O=f(O,N,I,k,p,16,a[42]),k=f(k,O,N,I,m,23,a[43]),I=f(I,k,O,N,b,4,a[44]),N=f(N,I,k,O,T,11,a[45]),O=f(O,N,I,k,R,16,a[46]),I=d(I,k=f(k,O,N,I,c,23,a[47]),O,N,s,6,a[48]),N=d(N,I,k,O,v,10,a[49]),O=d(O,N,I,k,w,15,a[50]),k=d(k,O,N,I,_,21,a[51]),I=d(I,k,O,N,T,6,a[52]),N=d(N,I,k,O,p,10,a[53]),O=d(O,N,I,k,S,15,a[54]),k=d(k,O,N,I,u,21,a[55]),I=d(I,k,O,N,y,6,a[56]),N=d(N,I,k,O,R,10,a[57]),O=d(O,N,I,k,m,15,a[58]),k=d(k,O,N,I,C,21,a[59]),I=d(I,k,O,N,g,6,a[60]),N=d(N,I,k,O,E,10,a[61]),O=d(O,N,I,k,c,15,a[62]),k=d(k,O,N,I,b,21,a[63]),o[0]=o[0]+I|0,o[1]=o[1]+k|0,o[2]=o[2]+O|0,o[3]=o[3]+N|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;n[i>>>5]|=128<<24-i%32;var o=e.floor(r/4294967296),s=r;n[15+(i+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),n[14+(i+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),t.sigBytes=4*(n.length+1),this._process();for(var a=this._hash,u=a.words,c=0;c<4;c++){var l=u[c];u[c]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}return a},clone:function(){var t=o.clone.call(this);return t._hash=this._hash.clone(),t}});function l(t,e,n,r,i,o,s){var a=t+(e&n|~e&r)+i+s;return(a<<o|a>>>32-o)+e}function h(t,e,n,r,i,o,s){var a=t+(e&r|n&~r)+i+s;return(a<<o|a>>>32-o)+e}function f(t,e,n,r,i,o,s){var a=t+(e^n^r)+i+s;return(a<<o|a>>>32-o)+e}function d(t,e,n,r,i,o,s){var a=t+(n^(e|~r))+i+s;return(a<<o|a>>>32-o)+e}return n.MD5=o._createHelper(c),n.HmacMD5=o._createHmacHelper(c),t.MD5}(n(1))},function(t,e,n){t.exports=function(t){for(var e=t,n=e.lib.BlockCipher,r=e.algo,i=[],o=[],s=[],a=[],u=[],c=[],l=[],h=[],f=[],d=[],p=[],g=0;g<256;g++)p[g]=g<128?g<<1:g<<1^283;var _=0,m=0;for(g=0;g<256;g++){var v=m^m<<1^m<<2^m<<3^m<<4;i[_]=v=v>>>8^255&v^99,o[v]=_;var y=p[_],b=p[y],S=p[b],E=257*p[v]^16843008*v;s[_]=E<<24|E>>>8,a[_]=E<<16|E>>>16,u[_]=E<<8|E>>>24,c[_]=E,l[v]=(E=16843009*S^65537*b^257*y^16843008*_)<<24|E>>>8,h[v]=E<<16|E>>>16,f[v]=E<<8|E>>>24,d[v]=E,_?(_=y^p[p[p[S^y]]],m^=p[p[m]]):_=m=1}var T=[0,1,2,4,8,16,32,64,128,27,54],C=r.AES=n.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var t=this._keyPriorReset=this._key,e=t.words,n=t.sigBytes/4,r=4*((this._nRounds=n+6)+1),o=this._keySchedule=[],s=0;s<r;s++)s<n?o[s]=e[s]:(c=o[s-1],s%n?n>6&&s%n==4&&(c=i[c>>>24]<<24|i[c>>>16&255]<<16|i[c>>>8&255]<<8|i[255&c]):(c=i[(c=c<<8|c>>>24)>>>24]<<24|i[c>>>16&255]<<16|i[c>>>8&255]<<8|i[255&c],c^=T[s/n|0]<<24),o[s]=o[s-n]^c);for(var a=this._invKeySchedule=[],u=0;u<r;u++){if(s=r-u,u%4)var c=o[s];else c=o[s-4];a[u]=u<4||s<=4?c:l[i[c>>>24]]^h[i[c>>>16&255]]^f[i[c>>>8&255]]^d[i[255&c]]}}},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,s,a,u,c,i)},decryptBlock:function(t,e){var n=t[e+1];t[e+1]=t[e+3],t[e+3]=n,this._doCryptBlock(t,e,this._invKeySchedule,l,h,f,d,o),n=t[e+1],t[e+1]=t[e+3],t[e+3]=n},_doCryptBlock:function(t,e,n,r,i,o,s,a){for(var u=this._nRounds,c=t[e]^n[0],l=t[e+1]^n[1],h=t[e+2]^n[2],f=t[e+3]^n[3],d=4,p=1;p<u;p++){var g=r[c>>>24]^i[l>>>16&255]^o[h>>>8&255]^s[255&f]^n[d++],_=r[l>>>24]^i[h>>>16&255]^o[f>>>8&255]^s[255&c]^n[d++],m=r[h>>>24]^i[f>>>16&255]^o[c>>>8&255]^s[255&l]^n[d++],v=r[f>>>24]^i[c>>>16&255]^o[l>>>8&255]^s[255&h]^n[d++];c=g,l=_,h=m,f=v}g=(a[c>>>24]<<24|a[l>>>16&255]<<16|a[h>>>8&255]<<8|a[255&f])^n[d++],_=(a[l>>>24]<<24|a[h>>>16&255]<<16|a[f>>>8&255]<<8|a[255&c])^n[d++],m=(a[h>>>24]<<24|a[f>>>16&255]<<16|a[c>>>8&255]<<8|a[255&l])^n[d++],v=(a[f>>>24]<<24|a[c>>>16&255]<<16|a[l>>>8&255]<<8|a[255&h])^n[d++],t[e]=g,t[e+1]=_,t[e+2]=m,t[e+3]=v},keySize:8});return e.AES=n._createHelper(C),t.AES}(n(1),(n(15),n(4),n(9),n(18)))},function(t,e,n){t.exports=n(1).enc.Utf8},function(t,e,n){function r(t){var e;return(c[t]||(e=c[t]={i:t,l:!1,exports:{}},u[t].call(e.exports,e,e.exports,r),e.l=!0,e)).exports}var i,o,s,a,u,c;t.exports=(i=n(8),o=n(4),s=n(5),a=n(6),u=[function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LinkedList=e.ListNode=e.ENUM_CONNECT_STATE=e.ENUM_NETWORK_STATE=e.SOCKET_DISCONNECT=e.errorList=e.Queue=e.getSeq=e.E_CLIENT_TYPE=e.ENUM_LOG_LEVEL=e.ENUM_REMOTE_TYPE=e.ZEGO_BROWSER_TYPE=e.ZEGO_ENV=e.PROTO_VERSION=void 0,e.PROTO_VERSION="1.0.2",(i=e.ZEGO_ENV||(e.ZEGO_ENV={}))[i.BROWSER=0]="BROWSER",i[i.WEIXINMINI=1]="WEIXINMINI",(i=e.ZEGO_BROWSER_TYPE||(e.ZEGO_BROWSER_TYPE={}))[i.IE=0]="IE",i[i.FIREFOX=1]="FIREFOX",i[i.CHROME=2]="CHROME",i[i.SAFARI=3]="SAFARI",i[i.OPERA=4]="OPERA",i[i.WEIXIN=5]="WEIXIN",i[i.WEIXINMINI=6]="WEIXINMINI",i[i.UNKOWN=7]="UNKOWN",(i=e.ENUM_REMOTE_TYPE||(e.ENUM_REMOTE_TYPE={}))[i.DISABLE=0]="DISABLE",i[i.WEBSOCKET=1]="WEBSOCKET",i[i.HTTPS=2]="HTTPS",e.ENUM_LOG_LEVEL={DEBUG:0,INFO:1,WARN:2,ERROR:3,REPORT:99,DISABLE:100,debug:0,info:1,warn:2,error:3,report:99,disable:100},(i=e.E_CLIENT_TYPE||(e.E_CLIENT_TYPE={}))[i.ClientType_None=0]="ClientType_None",i[i.ClientType_H5=1]="ClientType_H5",i[i.ClientType_SmallPragram=2]="ClientType_SmallPragram",i[i.ClientType_Webrtc=3]="ClientType_Webrtc",e.getSeq=(r=1,function(){return r++}),o.prototype.isEmpty=function(){return 0==this.items.length},o.prototype.enqueue=function(t){this.items.push(t)},o.prototype.dequeue=function(){return this.isEmpty()?"Underflow":this.items.shift()},o.prototype.front=function(){return this.isEmpty()?"No elements in Queue":this.items[0]},o.prototype.size=function(){return this.items.length},o.prototype.clear=function(){this.items=[]},o.prototype.all=function(){return this.items};var r,i=o;function o(){this.items=[],this.items=[]}e.Queue=i,e.errorList={TIMEOUT:{code:100001,msg:"network timeout"},DATAEXIST:{code:100002,msg:"data exist"},BROKEN:{code:100003,msg:"network broken"}},e.SOCKET_DISCONNECT=-1,(i=e.ENUM_NETWORK_STATE||(e.ENUM_NETWORK_STATE={}))[i.offline=0]="offline",i[i.online=1]="online",(i=e.ENUM_CONNECT_STATE||(e.ENUM_CONNECT_STATE={}))[i.disconnected=0]="disconnected",i[i.connecting=1]="connecting",i[i.connected=2]="connected",Object.defineProperty(a.prototype,"id",{get:function(){return this._id||null},set:function(t){this._id=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t},enumerable:!1,configurable:!0}),a.prototype.hasNext=function(){return this.next&&this.next.id},a.prototype.hasPrev=function(){return this.prev&&this.prev.id};var s=a;function a(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.next=null,this.prev=null,this._id=t,this._data=e}function u(){this.start=new s,this.end=new s,this._idCounter=0,this._numNodes=0,this.start.next=this.end,this.start.prev=null,this.end.prev=this.start,this.end.next=null}e.ListNode=s,u.prototype.insertBefore=function(t,e){return(e=new s(this._idCounter,e)).next=t,e.prev=t.prev,t.prev&&(t.prev.next=e),t.prev=e,++this._idCounter,++this._numNodes,e},u.prototype.addLast=function(t){return this.insertBefore(this.end,t)},u.prototype.add=function(t){return this.addLast(t)},u.prototype.getFirst=function(){return 0===this._numNodes?null:this.start.next},u.prototype.getLast=function(){return 0===this._numNodes?null:this.end.prev},u.prototype.size=function(){return this._numNodes},u.prototype.getFromFirst=function(t){var e=0,n=this.start.next;if(0<=t)for(;e<t&&null!==n;)n=n.next,++e;else n=null;if(null===n)throw"Index out of bounds.";return n},u.prototype.get=function(t){return 0===t?this.getFirst():t===this._numNodes-1?this.getLast():this.getFromFirst(t)},u.prototype.remove=function(t){return t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),--this._numNodes,t},u.prototype.removeFirst=function(){return 0<this._numNodes&&this.start.next?this.remove(this.start.next):null},u.prototype.removeLast=function(){return 0<this._numNodes&&this.end.prev?this.remove(this.end.prev):null},u.prototype.removeAll=function(){this.start.next=this.end,this.end.prev=this.start,this._numNodes=0,this._idCounter=0},u.prototype.each=function(t){for(var e=this.start;e.hasNext();)t(e=e.next)},u.prototype.find=function(t){for(var e=this.start,n=!1,r=null;e.hasNext()&&!n;)t(e=e.next)&&(r=e,n=!0);return r},u.prototype.map=function(t){for(var e=this.start,n=[];e.hasNext();)t(e=e.next)&&n.push(e);return n},u.prototype.push=function(t){return this.addLast(t)},u.prototype.unshift=function(t){this.insertBefore(0<this._numNodes?this.start.next:this.end,t)},u.prototype.pop=function(){return this.removeLast()},u.prototype.shift=function(){return this.removeFirst()},e.LinkedList=u},function(t,e,n){"use strict";var r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(r(arguments[e]));return t},o=(Object.defineProperty(e,"__esModule",{value:!0}),e.ContextAPI=e.suppressInstrumentation=e.ROOT_CONTEXT=e.BaseContext=e.setSpan=e.getSpanContext=e.getSpan=e.createContextKey=void 0,n(16));function s(t){return Symbol.for(t)}var a=(e.createContextKey=s)("OpenTelemetry Context Key SUPPRESS_INSTRUMENTATION"),u=s("OpenTelemetry Context Key SPAN");function c(t){return t.getValue(u)||void 0}function l(t){this.name=t,this.contextManager=new o.StackContextManager}e.getSpan=c,e.getSpanContext=function(t){return null==(t=c(t))?void 0:t.context()},e.setSpan=function(t,e){return t.setValue(u,e)},e.BaseContext=n=function t(e){var n=this;n._currentContext=e?new Map(e):new Map,n.getValue=function(t){return n._currentContext.get(t)},n.setValue=function(e,r){var i=new t(n._currentContext);return i._currentContext.set(e,r),i},n.deleteValue=function(e){var r=new t(n._currentContext);return r._currentContext.delete(e),r}},e.ROOT_CONTEXT=new n,e.suppressInstrumentation=function(t){return t.setValue(a,!0)},l.getInstance=function(t){return void 0===t&&(t="context"),this._instance||(this._instance=new l(t)),this._instance},l.prototype.active=function(){return this.contextManager.active()},l.prototype.with=function(t,e,n){for(var r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return(r=this._getContextManager()).with.apply(r,i([t,e,n],o))},l.prototype._getContextManager=function(){return this.contextManager},e.ContextAPI=l},function(t,e,n){"use strict";var r,i;Object.defineProperty(e,"__esModule",{value:!0}),e.INVALID_SPAN_CONTEXT=e.INVALID_TRACEID=e.INVALID_SPANID=e.TraceFlags=e.SpanKind=e.SpanStatusCode=void 0,(r=e.SpanStatusCode||(e.SpanStatusCode={}))[r.UNSET=0]="UNSET",r[r.OK=1]="OK",r[r.ERROR=2]="ERROR",(r=e.SpanKind||(e.SpanKind={}))[r.INTERNAL=0]="INTERNAL",r[r.SERVER=1]="SERVER",r[r.CLIENT=2]="CLIENT",r[r.PRODUCER=3]="PRODUCER",r[r.CONSUMER=4]="CONSUMER",(i=r=e.TraceFlags||(e.TraceFlags={}))[i.NONE=0]="NONE",i[i.SAMPLED=1]="SAMPLED",e.INVALID_SPANID="0000000000000000",e.INVALID_TRACEID="00000000000000000000000000000000",e.INVALID_SPAN_CONTEXT={traceId:e.INVALID_TRACEID,spanId:e.INVALID_SPANID,traceFlags:r.NONE}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.log=e.ZegoLog=void 0,i.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.join("");console.log(n)},i.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.join("");console.debug(n)},i.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.join("");console.info(n)},i.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.join("");console.warn(n)},i.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.join("");console.error(n)};var r=i;function i(){}r=new(e.ZegoLog=r),e.log=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FAIL_TIME=e.FAIL_MAX_COUNT=e.FAIL_COUNT=e.STORE_SIZE=e.CACHE_SIZE=e.BUCKET_CONFIG=e.DEFAULT_CONFIG=void 0,e.DEFAULT_CONFIG={importantLevel:0,reportSize:3e3,reportNum:10,bps:16e3,netTimeout:10},e.BUCKET_CONFIG={bucketSize:1e4,tokensPerInterval:1600},e.CACHE_SIZE={totalAvailCache:102400,cacheMaxSize:2e4,cacheDelPer:.2},e.STORE_SIZE={totalDBSize:2048e3,storeDelPer:.2},e.FAIL_COUNT=5,e.FAIL_MAX_COUNT=10,e.FAIL_TIME=30},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},i=(Object.defineProperty(e,"__esModule",{value:!0}),e.uuid=e.calculateMemSize=e.analyzeKey=e.getCurrentTime=e.getCurrentEnv=e.getBrowser=void 0,n(0)),o=r(n(31)),s=(e.getBrowser=function(){var t=window.navigator.userAgent,e=null!=window.ActiveXObject&&-1!=t.indexOf("MSIE"),n=-1!=t.indexOf("Firefox"),r=null!=window.opr,o=t.indexOf("Chrome")&&window.chrome,s=-1!=t.indexOf("Safari")&&-1!=t.indexOf("Version");return t=t.toLowerCase().match(/MicroMessenger/i)&&"micromessenger"===t.toLowerCase().match(/MicroMessenger/i)[0],e?i.ZEGO_BROWSER_TYPE.IE:n?i.ZEGO_BROWSER_TYPE.FIREFOX:r?i.ZEGO_BROWSER_TYPE.OPERA:o?i.ZEGO_BROWSER_TYPE.CHROME:s?i.ZEGO_BROWSER_TYPE.SAFARI:t?i.ZEGO_BROWSER_TYPE.WEIXIN:i.ZEGO_BROWSER_TYPE.UNKOWN},e.getCurrentEnv=function(){var t=window.navigator.userAgent;return new Promise((function(e){-1==t.indexOf("MicroMessage")?e(i.ZEGO_ENV.BROWSER):wx.miniProgram.getEnv((function(t){}))}))},["00","01","02","03","04","05","06","07","08","09"]);e.getCurrentTime=function(){var t=new Date;return[t.getFullYear()+"/",(s[t.getMonth()+1]||t.getMonth()+1)+"/",(s[t.getDate()]||t.getDate())+" ",(s[t.getHours()]||t.getHours())+":",(s[t.getMinutes()]||t.getMinutes())+":",s[t.getSeconds()]||t.getSeconds(),"."+t.getTime()%1e3].join("")},e.analyzeKey=function(t){return t=t.split("_"),{level:Number(t[0]),timestamp:t[1],seq:t[2]}},e.calculateMemSize=function(t){return o.default(t)},e.uuid=function(t,e){var n,r,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),o=[];if(e=e||i.length,t)for(n=0;n<t;n++)o[n]=i[0|Math.random()*e];else for(o[8]=o[13]=o[18]=o[23]="-",o[14]="4",n=0;n<36;n++)o[n]||(r=0|16*Math.random(),o[n]=i[19==n?3&r|8:r]);return o.join("")}},function(t,e,n){"use strict";var r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s};function o(t){var e,n,i;if(null!=t&&Array.isArray(t))try{for(var o=r(t),s=o.next();!s.done;s=o.next()){var a=s.value;if(null!=a)if(i){if(typeof a!==i)return!1}else i=typeof a}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return!0}Object.defineProperty(e,"__esModule",{value:!0}),e.sanitizeAttributes=e.isAttributeValue=void 0,e.isAttributeValue=o,e.sanitizeAttributes=function(t){var e,n,s={};if(null!=t&&"object"==typeof t)try{for(var a=r(Object.entries(t)),u=a.next();!u.done;u=a.next()){var c=i(u.value,2),l=c[0],h=c[1];o(h)&&(s[l]=Array.isArray(h)?h.slice():h)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return s}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.IdGenerator=void 0;var r=Array(32);function i(t){return function(){for(var e=0;e<2*t;e++)r[e]=Math.floor(16*Math.random())+48,58<=r[e]&&(r[e]+=39);return String.fromCharCode.apply(null,r.slice(0,2*t))}}e.IdGenerator=function(){this.generateTraceId=i(16),this.generateSpanId=i(8),this.generateEventId=i(4)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Resource=e.SDK_INFO=e.SemanticResourceAttributes=void 0,e.SemanticResourceAttributes={PROCESS_RUNTIME_NAME:"process.runtime.name",TELEMETRY_SDK_NAME:"telemetry.sdk.name",TELEMETRY_SDK_LANGUAGE:"telemetry.sdk.language",TELEMETRY_SDK_VERSION:"telemetry.sdk.version"},e.SDK_INFO=((r={})[e.SemanticResourceAttributes.TELEMETRY_SDK_NAME]="opentelemetry",r[e.SemanticResourceAttributes.PROCESS_RUNTIME_NAME]="browser",r[e.SemanticResourceAttributes.TELEMETRY_SDK_LANGUAGE]="webjs",r[e.SemanticResourceAttributes.TELEMETRY_SDK_VERSION]=e.VERSION,r),i.empty=function(){return i.EMPTY},i.createTelemetrySDKResource=function(){var t;return new i(((t={})[e.SemanticResourceAttributes.TELEMETRY_SDK_LANGUAGE]=e.SDK_INFO[e.SemanticResourceAttributes.TELEMETRY_SDK_LANGUAGE],t[e.SemanticResourceAttributes.TELEMETRY_SDK_NAME]=e.SDK_INFO[e.SemanticResourceAttributes.TELEMETRY_SDK_NAME],t[e.SemanticResourceAttributes.TELEMETRY_SDK_VERSION]=e.SDK_INFO[e.SemanticResourceAttributes.TELEMETRY_SDK_VERSION],t))},i.prototype.merge=function(t){return t&&Object.keys(t.attributes).length?new i(Object.assign({},this.attributes,t.attributes)):this},i.EMPTY=new i({});var r=i;function i(t){this.attributes=t}e.Resource=r},function(t,e,n){"use strict";var r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},o=(Object.defineProperty(e,"__esModule",{value:!0}),e.Span=void 0,n(6)),s=n(1),a=n(2),u=n(7),c=n(17);function l(t,e,n,r,i,o,s,c){void 0===c&&(c=[]),this.attributes={},this.links=[],this.events=[],this.status={code:a.SpanStatusCode.UNSET},this.endTime=0,this._ended=!1,this._duration=0,this.exported=!0,this.contextAPI=t.context,this.reporter=t.reporter,this.spanProcessor=t.spanProcessor,this.parentTracer=t,this.name=n,this.level=r,this.spanContext=i,this.parentSpanId=s,this.kind=o,this.links=c,this.startTime=Date.now(),this.resource=t.resource,this.instrumentationLibrary=t.instrumentationLibrary,this._traceParams=t.getActiveTraceParams(),this._idGenerator=new u.IdGenerator}l.prototype.context=function(){return this.spanContext},l.prototype.setAttribute=function(t,e){return null==e||0===t.length||!o.isAttributeValue(e)||Object.keys(this.attributes).length>=this._traceParams.numberOfAttributesPerSpan&&!Object.prototype.hasOwnProperty.call(this.attributes,t)||(this.attributes[t]=e),this},l.prototype.appendAttribute=function(t,e){return null==e||0===t.length||!o.isAttributeValue(e)||Object.keys(this.attributes).length>=this._traceParams.numberOfAttributesPerSpan&&!Object.prototype.hasOwnProperty.call(this.attributes,t)||(this.attributes[t]&&Array.isArray(this.attributes[t])?this.attributes[t].push(e):this.attributes[t]=[e]),this},l.prototype.setAttributes=function(t){var e,n;try{for(var o=r(Object.entries(t)),s=o.next();!s.done;s=o.next()){var a=i(s.value,2);this.setAttribute(a[0],a[1])}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return this},l.prototype.addEvent=function(t,e,n){this.events.length>=this._traceParams.numberOfEventsPerSpan&&this.events.shift();var r=this._idGenerator.generateEventId();return c.isTimeInput(e)&&(void 0===n&&(n=e),e=void 0),void 0===n&&(n=c.hrTime()),this.events.push({name:t,attributes:e,time:c.timeInputToHrTime(n),event_id:r}),this},l.prototype.setStatus=function(t){return this.status=t,this},l.prototype.updateName=function(t){return this.name=t,this},l.prototype.end=function(t){var e,n=this;this._isSpanEnded()||(this._ended=!0,this.resource=this.parentTracer.resource,this.spanProcessor.spanBeforeEnd&&this.spanProcessor.spanBeforeEnd(this),e=c.getCurrentTime(),this.setAttribute("e_time_s",e),this.endTime=Date.now(),this._duration=this.endTime-this.startTime,this.contextAPI.with(s.suppressInstrumentation(this.contextAPI.active()),(function(){var e=n.toReporterSpan(n);n.spanProcessor.spanEnd&&n.spanProcessor.spanEnd(e,n.level),e.droped||!1===t||(delete e.droped,n.reporter.report(JSON.stringify(e),n.level))})))},l.prototype.spanReport=function(){var t=this.toReporterSpan(this);this.reporter.report(JSON.stringify(t),this.level)},l.prototype.isRecording=function(){return!1===this._ended},Object.defineProperty(l.prototype,"duration",{get:function(){return this._duration},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"ended",{get:function(){return this._ended},enumerable:!1,configurable:!0}),l.prototype._isSpanEnded=function(){return this._ended},l.prototype.toReporterSpan=function(t){var e=[],n=(t.events.forEach((function(t){var n={};Object.keys(t).forEach((function(e){"name"===e&&(n[e]=t[e]),"time"===e&&(n.timestamp=c.hrTimeToMilliseconds(t[e])),"attributes"===e&&(n.tags=t[e])})),e.push(n)})),[]);return t.links.forEach((function(t){n.push({span_id:t.context.spanId,trace_id:t.context.traceId})})),{trace_id:t.spanContext.traceId,parent_span_id:t.parentSpanId,name:t.name,span_id:t.spanContext.spanId,kind:t.kind,start_time:t.startTime,end_time:t.endTime,duration:t.duration,logs:e,tags:t.attributes,links:n}},e.Span=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ZegoSpan=void 0;var r=n(3),i=n(9);function o(t,e){this.spanId=t,this.span=e}o.prototype.setAttribute=function(t,e){var n=this;return this.span?this.span.setAttribute(t,e):this._activeSpan().then((function(){n.span&&n.span.setAttribute(t,e)})),this},o.prototype.setAttributes=function(t){var e=this;return this.span?this.span.setAttributes(t):this._activeSpan().then((function(){e.span&&e.span.setAttributes(t)})),this},o.prototype.appendAttribute=function(t,e){var n=this;return this.span?this.span.appendAttribute(t,e):this._activeSpan().then((function(){n.span&&n.span.appendAttribute(t,e)})),this},o.prototype.addEvent=function(t,e,n){var r=this;return this.span?this.span.addEvent(t,e,n):this._activeSpan().then((function(){r.span&&r.span.addEvent(t,e,n)})),this},o.prototype.setStatus=function(t){var e=this;return this.span?this.span.setStatus(t):this._activeSpan().then((function(){e.span&&e.span.setStatus(t)})),this},o.prototype.updateName=function(t){var e=this;return this.span?this.span.updateName(t):this._activeSpan().then((function(){e.span&&e.span.updateName(t)})),this},o.prototype.end=function(t){var e=this;void 0===t&&(t=!0),this.span?this.span.end(t):this._activeSpan(!0).then((function(){e.span&&e.span.end(t),e._spanEnd()}))},o.prototype.setSpanActive=function(t){this.activeCallback=t},o.prototype.setSpanEnd=function(t){this.endCallback=t},o.prototype.spanReport=function(){var t;null!=(t=this.span)&&t.spanReport()},o.prototype._spanEnd=function(){this._isSpanNoop()||(this.removeStoreItem(this.spanId),this.endCallback&&this.endCallback(this.spanInfo))},o.prototype._isSpanNoop=function(){return"noop"===this.spanId},o.prototype._activeSpan=function(t){var e=this;return void 0===t&&(t=!1),new Promise((function(n,r){e.store.getItem(e.spanId).then((function(r){var s=new i.Span(o.tracer,o.tracer.context.active(),r.name,r.level,r.spanContext,r.kind,r.parentSpanId,r.links);s.setStatus(r.status),s.setAttributes(r.attributes),e.span=s,e.activeCallback&&e.activeCallback(e.spanId,t),n()})).catch((function(t){r(t)}))}))},o.prototype.removeStoreItem=function(t){var e=this;this.store.getItem(t).then((function(n){n&&e.store.removeItem(t).then((function(){r.log.log("remove suc")})).catch((function(t){r.log.warn("remove fail")}))}))},e.ZegoSpan=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createZegoStore=e.ZegoWechatMiniStore=e.ZEGO_ENV=void 0;var r,i,o=n(12),s=((i=r=e.ZEGO_ENV||(e.ZEGO_ENV={}))[i.BROWSER=0]="BROWSER",i[i.WEIXINMINI=1]="WEIXINMINI",n(3)),a=(u.prototype.getItem=function(t){var e=this;return new Promise((function(n,r){try{n(wx.getStorageSync(e.keyPrefix+t))}catch(n){r(n)}}))},u.prototype.setItem=function(t,e){var n=this;return new Promise((function(r,i){try{wx.setStorageSync(n.keyPrefix+t,e),r()}catch(r){i(r)}}))},u.prototype.removeItem=function(t){var e=this;return new Promise((function(n,r){try{n(wx.removeStorageSync(e.keyPrefix+t))}catch(n){r(n)}}))},u.prototype.clear=function(){return new Promise((function(t,e){try{wx.clearStorageSync(),t()}catch(t){e(t)}}))},u.prototype.keys=function(){var t=this;return new Promise((function(e,n){try{var r=wx.getStorageInfoSync().keys,i=(s.log.warn("keys",r),[]);r.forEach((function(e){0==e.indexOf(t.keyPrefix)&&i.push(e.replace(t.keyPrefix,""))})),s.log.warn("keyArr",JSON.stringify(i)),i.sort(),e(i)}catch(e){n(e)}}))},u);function u(t){this.storeName=t,this.keyPrefix=t+"/"}e.ZegoWechatMiniStore=a,e.createZegoStore=function(t,e,n){return e===r.BROWSER?o.createInstance({name:t+":"+(n||"store")}):new a(t)}},function(t,e){t.exports=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DynamicCode=e.ZegoTracer=e.ZegoSpan=void 0;var r=n(14),i=(Object.defineProperty(e,"ZegoTracer",{enumerable:!0,get:function(){return r.ZegoTracer}}),n(46)),o=(Object.defineProperty(e,"DynamicCode",{enumerable:!0,get:function(){return i.DynamicCode}}),n(10));Object.defineProperty(e,"ZegoSpan",{enumerable:!0,get:function(){return o.ZegoSpan}})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ZegoTracer=void 0;var r=n(15),i=n(21),o=n(10),s=n(22),a=n(3),u=n(1),c=n(8),l=n(23),h=n(39),f=n(11),d=n(44),p=n(45);function g(){this._maxTracingSpanSize=s.DEFAULT_MAX_SPAN_SIZE,this.level=0,this.log=new d.ZegoLog,this.stateCenter=new p.StateCenter(this.log)}g.prototype.init=function(t){this.options=t,this.name=t.product,this.reporter=new l.ZegoDataReport(this.name,this.stateCenter),this.reporter.init({appID:t.appID,env:t.env||0,importantLevel:t.importantLevel,levels:t.levels,deviceID:t.deviceID,bps:t.bps,serverUrl:t.serverUrl}),this.tracer=new r.Tracer({name:this.name,version:t.version},{resource:new c.Resource(t.resources)},this.reporter,{spanStart:t.spanStart,spanBeforeEnd:t.spanBeforeEnd,spanEnd:t.spanEnd}),this.reporter.setProcessData(this.tracer.resource.attributes),this.initRoot(this.options),this.dyStore=f.createZegoStore(t.product+"_"+t.appID+"_dy",t.env||0)},g.prototype.initRoot=function(t){this.rootSpan=this.tracer.startSpan("root",0);var e=u.setSpan(this.tracer.context.active(),this.rootSpan);this.tracer.context._getContextManager()._currentContext=e,this.rootSpan.end()},g.prototype.createSpan=function(t,e,n){var r,c;return t<=this.level?(r=u.setSpan(this.tracer.context.active(),n&&n.parent?n.parent.span:this.rootSpan),c=[],n&&n.linkSpans&&(n.linkSpans.forEach((function(t){c.push({context:t.span.context()})})),delete n.linkSpans),e=this.tracer.startSpan(e,t,Object.assign({},n,{links:c}),r),t=new o.ZegoSpan(e.spanContext.spanId,e),o.ZegoSpan.tracer=this.tracer,t):(a.log.warn("createSpan level not fix"),new o.ZegoSpan(s.NOOP_SPAN_ID,new i.NoopSpan))},g.prototype.setLogger=function(t){this.stateCenter.logger=t},g.prototype.setTimeOffset=function(t){this.reporter.setTimeOffset(t)},g.prototype.setWaitNtpTimeout=function(t){this.reporter.setWaitNtpTimeout(t)},g.prototype.setLogLevel=function(t){return this.stateCenter._log.setLogLevel(t)},g.prototype.startReport=function(t){return this.reporter.startReport(t)},g.prototype.setConfig=function(t){this.reporter.setConfig(t)},g.prototype.loadJs=function(t,e,n,r,i,o){return h.loadJS(t,this.dyStore,e,n,r,i,o)},g.prototype.flush=function(t){this.reporter.flush(t)},g.prototype.setUnloadState=function(t){this.reporter.setUnloadState(t)},g.prototype.shutdown=function(){this.reporter.saveDataBeforeUnload()},g.prototype.destroy=function(){this.reporter.uninit()},g.prototype.setSampleConfig=function(t){this.level=t.level||this.level},g.prototype.setResource=function(t){this.tracer.setResource(t),this.reporter.setProcessData(this.tracer.resource.attributes)},g.prototype.setNetStateCheck=function(){this.reporter.setNetStateCheck()},e.ZegoTracer=g},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Tracer=void 0;var r=n(6),i=n(1),o=n(2),s=n(7),a=n(8),u=n(9),c=n(18),l=n(19);function h(t,e,n,r){var o=l.mergeConfig(e);this._traceParams=o.traceParams,this._idGenerator=new s.IdGenerator,this.resource=null!=(o=e.resource)?o:a.Resource.createTelemetrySDKResource(),this.instrumentationLibrary=t,e=Math.random().toString(36).slice(-6),this.context=new i.ContextAPI(e),this.reporter=n,this.spanProcessor=r||{}}h.prototype.startSpan=function(t,e,n,s){var a,l,h,f=function(t,e){if(!t.root)return i.getSpanContext(e)}(n=void 0===n?{}:n,s=void 0===s?this.context.active():s),d=this._idGenerator.generateSpanId(),p=(f&&c.isSpanContextValid(f)?(a=f.traceId,l=f.traceState,h=f.spanId):a=this._idGenerator.generateTraceId(),f=null!=(f=n.kind)?f:o.SpanKind.INTERNAL,null!=(p=n.links)?p:[]),g=(n=r.sanitizeAttributes(n.attributes),o.TraceFlags.NONE);return(s=new u.Span(this,s,t,e,{traceId:a,spanId:d,traceFlags:g,traceState:l},f,h,p)).setAttributes(n),this.spanProcessor.spanStart&&this.spanProcessor.spanStart(s),s},h.prototype.setResource=function(t){this.resource=this.resource.merge(new a.Resource(t))},h.prototype.getActiveTraceParams=function(){return this._traceParams},e.Tracer=h},function(t,e,n){"use strict";var r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(r(arguments[e]));return t},o=(Object.defineProperty(e,"__esModule",{value:!0}),e.StackContextManager=void 0,n(1));function s(){this._enabled=!1,this._currentContext=o.ROOT_CONTEXT}s.prototype._bindFunction=function(t,e){function n(){for(var n=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return r.with(e,(function(){return t.apply(n,i)}))}void 0===e&&(e=o.ROOT_CONTEXT);var r=this;return Object.defineProperty(n,"length",{enumerable:!1,configurable:!0,writable:!1,value:t.length}),n},s.prototype.active=function(){return this._currentContext},s.prototype.bind=function(t,e){return void 0===(e=void 0===e?o.ROOT_CONTEXT:e)&&(e=this.active()),"function"==typeof t?this._bindFunction(t,e):t},s.prototype.disable=function(){return this._currentContext=o.ROOT_CONTEXT,this._enabled=!1,this},s.prototype.enable=function(){return this._enabled||(this._enabled=!0,this._currentContext=o.ROOT_CONTEXT),this},s.prototype.with=function(t,e,n){for(var r=[],s=3;s<arguments.length;s++)r[s-3]=arguments[s];var a=this._currentContext;this._currentContext=t||o.ROOT_CONTEXT;try{return e.call.apply(e,i([n],r))}finally{this._currentContext=a}},e.StackContextManager=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getCurrentTime=e.isTimeInput=e.hrTimeToMilliseconds=e.hrTimeDuration=e.timeInputToHrTime=e.isTimeInputHrTime=e.hrTime=void 0;var r=Math.pow(10,9),i=["00","01","02","03","04","05","06","07","08","09"];function o(t){t/=1e3;var e=Math.trunc(t);return[e,Number((t-e).toFixed(9))*r]}function s(){var t,e=performance.timeOrigin;return"number"!=typeof e?(t=performance).timing&&t.timing.fetchStart:e}function a(t){var e=o(s()),n=(t=o("number"==typeof t?t:performance.now()),e[0]+t[0]);return r<(e=e[1]+t[1])&&(e-=r,n+=1),[n,e]}function u(t){return Array.isArray(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]}e.hrTime=a,e.isTimeInputHrTime=u,e.timeInputToHrTime=function(t){if(u(t))return t;if("number"==typeof t)return(t<s()?a:o)(t);if(t instanceof Date)return o(t.getTime());throw TypeError("Invalid input type")},e.hrTimeDuration=function(t,e){var n=e[0]-t[0];return(e=e[1]-t[1])<0&&(--n,e+=r),[n,e]},e.hrTimeToMilliseconds=function(t){return Math.round(1e3*t[0]+t[1]/1e6)},e.isTimeInput=function(t){return u(t)||"number"==typeof t||t instanceof Date},e.getCurrentTime=function(){var t=new Date;return[t.getFullYear()+"/",(i[t.getMonth()+1]||t.getMonth()+1)+"/",(i[t.getDate()]||t.getDate())+" ",(i[t.getHours()]||t.getHours())+":",(i[t.getMinutes()]||t.getMinutes())+":",i[t.getSeconds()]||t.getSeconds(),"."+t.getTime()%1e3].join("")}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isSpanContextValid=e.isValidSpanId=e.isValidTraceId=e.INVALID_SPAN_CONTEXT=e.INVALID_TRACEID=e.INVALID_SPANID=void 0,n=n(2);var r=/^([0-9a-f]{32})$/i,i=/^[0-9a-f]{16}$/i;function o(t){return r.test(t)&&t!==e.INVALID_TRACEID}function s(t){return i.test(t)&&t!==e.INVALID_SPANID}e.INVALID_SPANID="0000000000000000",e.INVALID_TRACEID="00000000000000000000000000000000",e.INVALID_SPAN_CONTEXT={traceId:e.INVALID_TRACEID,spanId:e.INVALID_SPANID,traceFlags:n.TraceFlags.NONE},e.isValidTraceId=o,e.isValidSpanId=s,e.isSpanContextValid=function(t){return o(t.traceId)&&s(t.spanId)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.mergeConfig=void 0;var r=n(20);e.mergeConfig=function(t){var e=Object.assign({},r.DEFAULT_CONFIG,t);return e.traceParams=Object.assign({},r.DEFAULT_CONFIG.traceParams,t.traceParams||{}),e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_CONFIG=void 0,e.DEFAULT_CONFIG={traceParams:{numberOfAttributesPerSpan:128,numberOfLinksPerSpan:128,numberOfEventsPerSpan:128}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NoopSpan=void 0;var r=n(2);function i(t){void 0===t&&(t=r.INVALID_SPAN_CONTEXT),this._spanContext=t}i.prototype.context=function(){return this._spanContext},i.prototype.setAttribute=function(t,e){return this},i.prototype.appendAttribute=function(t,e){return this},i.prototype.setAttributes=function(t){return this},i.prototype.addEvent=function(t,e,n){return this},i.prototype.setStatus=function(t){return this},i.prototype.updateName=function(t){return this},i.prototype.end=function(t){},i.prototype.isRecording=function(){return!1},i.prototype.spanReport=function(){},i.prototype.recordException=function(t,e){},e.NoopSpan=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NOOP_SPAN_ID=e.SCHEDULED_DELAY_MILLIS=e.DEFAULT_MAX_SPAN_SIZE=e.readSpanKeys=void 0,e.readSpanKeys=["name","level","kind","spanContext","parentSpanId","startTime","endTime","status","attributes","links","events","duration","ended","resource","instrumentationLibrary"],e.DEFAULT_MAX_SPAN_SIZE=1e3,e.SCHEDULED_DELAY_MILLIS=3e3,e.NOOP_SPAN_ID="noop"},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},i=this&&this.__awaiter||function(t,e,n,r){return new(n=n||Promise)((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):((e=t.value)instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s={next:a(0),throw:a(1),return:a(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){var u=[s,a];if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&u[0]?r.return:u[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,u[1])).done)return i;switch(r=0,(u=i?[2&u[0],i.value]:u)[0]){case 0:case 1:i=u;break;case 4:return o.label++,{value:u[1],done:!1};case 5:o.label++,r=u[1],u=[0];continue;case 7:u=o.ops.pop(),o.trys.pop();continue;default:if(!(i=0<(i=o.trys).length&&i[i.length-1])&&(6===u[0]||2===u[0])){o=0;continue}if(3===u[0]&&(!i||u[1]>i[0]&&u[1]<i[3]))o.label=u[1];else if(6===u[0]&&o.label<i[1])o.label=i[1],i=u;else{if(!(i&&o.label<i[2])){i[2]&&o.ops.pop(),o.trys.pop();continue}o.label=i[2],o.ops.push(u)}}u=e.call(t,o)}catch(a){u=[6,a],r=0}finally{n=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}},s=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},a=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t},u=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=(Object.defineProperty(e,"__esModule",{value:!0}),e.ZegoDataReport=void 0,n(0)),l=n(24),h=n(30),f=n(38),d=n(5),p=n(4);function g(t,e){this.stateCenter=e,this.QUEUE_MAX=100,this.cacheMaxSize=p.CACHE_SIZE.cacheMaxSize,this.cacheDelPer=p.CACHE_SIZE.cacheDelPer,this.state="normal",this.forceDataTotalLen=0,this.reportPackagesSize=0,this.staticConfig={totalAvailCache:p.CACHE_SIZE.totalAvailCache,totalDBSize:p.STORE_SIZE.totalDBSize,bps:1600},this.dataInDb=[],this.listenerList={progressUpdate:[],forceResult:[],postFail:[],dataDroped:[]},this.tempBuffer=[],this.traceType={MEM_I_API:0,MEM_O_DONE:0,MEM_O_DUMP:0,MEM_I_LOAD:0,DB_O_DROP:0,DB_O_DONE:0,DB_I_BACKUP:0},this.isPaused=!1,this.pro="json",this.isLoadReportData=!1,this.dropCount=0,this.timeInterval=!1,this.isWaitNtpTimeout=!1,this.waitNtpTimeout=2e3,this.postDataState="",this.product=t,this.reportMap=new Map}g.prototype.init=function(t){return i(this,void 0,void 0,(function(){var e=this;return o(this,(function(n){switch(n.label){case 0:return this.config=r(r({},p.DEFAULT_CONFIG),t),this.config.env%2!=1&&this.bindWindowListener(),this.zegoService=new l.ZegoService(this.config.env||c.ZEGO_ENV.BROWSER,this.config.bps||p.DEFAULT_CONFIG.bps,this.product,this.pro,this.stateCenter),this.zegoService.setLogUrlParams({product:this.product,signature:this.config.token||"",appid:this.config.appID,id_name:this.config.userID||"",deviceid:this.config.deviceID||""}),this.config.serverUrl&&this.zegoService.setLogServer(this.config.serverUrl),this.zegoService.setPostSucCallback(this.product,this.postSucHandler.bind(this)),this.zegoService.setPostFailCallback(this.product,(function(t){return i(e,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return this.stateCenter.logger.warn("zt.zd.i fail"),this.postDataState="fail",this.dropCount++,this.storePackagesDataToDB(t),[4,this.storePendingDataToDB(1)];case 1:return e.sent(),this._actionListener("postFail"),[2]}}))}))})),this.initPendingQueue(),this.storeHandler=new h.ZegoStoreHandler(this.product+"_"+this.config.appID+"_datareporter",d.uuid(6),this.config,this.traceType,this.staticConfig,this.stateCenter),this.storeHandler.setDropCallBack((function(t){e.traceType.DB_O_DROP+=d.calculateMemSize(t),e._actionListener("dataDroped",t)})),[4,this.storeHandler.loadPendingData()];case 1:return n.sent(),this.storeHandler.init().then((function(){e.loadReportData()})).catch((function(t){console.warn(t)})),this.startReportTimer(),this.setWaitNtpTimer(),this.checkCacheDataTimer(),[2]}}))}))},g.prototype.uninit=function(){this.isWaitNtpTimeout=!1,this.ntpTimer&&(clearTimeout(this.ntpTimer),this.ntpTimer=null),this.zegoService.destroy()},g.prototype.setConfig=function(t){"object"==typeof t&&"number"==typeof t.bps&&(this.config.bps=t.bps,this.zegoService.setBps(this.config.bps)),"object"==typeof t&&"number"==typeof t.totalDBSize&&(this.staticConfig.totalDBSize=t.totalDBSize),"object"==typeof t&&"string"==typeof t.serverUrl&&""!==t.serverUrl&&(this.config.serverUrl=t.serverUrl,this.zegoService.setLogServer(this.config.serverUrl))},g.prototype.pause=function(){this.isPaused=!0},g.prototype.resume=function(){this.isPaused=!1;var t=(e=this.pendingQueue.getPendingDataInfo()).pendingDataSize,e=e.size;this.checkPendingQueue(t,e)},g.prototype.startReport=function(t){var e=t.get("userID"),n=t.get("token");return!(!e||"string"!=typeof e||!n||"string"!=typeof n||(this.startCommonField=t,this.config.userID=e,this.config.token=n,this.zegoService.setLogUrlParams({product:this.product,signature:this.config.token,appid:this.config.appID,id_name:this.config.userID||"",deviceid:this.config.deviceID||""}),this.isWithNtp()&&this.bufferDump(),(e=t.get("serverUrl"))&&(this.config.serverUrl=e,this.zegoService.setLogServer(this.config.serverUrl)),this.isConfigOK(this.config)&&(t=(n=this.pendingQueue.getPendingDataInfo()).pendingDataSize,e=n.size,this.checkPendingQueue(t,e)),0))},g.prototype.setTimeOffset=function(t){var e=this;this.clientTimeOffset=t,this.tempBuffer.forEach((function(t){(t=t.data).tags.time_offset||(t.tags.time_offset=e.clientTimeOffset)})),this.config.userID&&this.bufferDump()},g.prototype.setProcessData=function(t){this.stateCenter.processData=t},g.prototype.on=function(t,e){return this._bindListener(t,e)},g.prototype.off=function(t,e){return this._deleteListener(t,e)},g.prototype.report=function(t,e){var n;if(15e3<t.length)return!1;try{n=JSON.parse(t)}catch(t){return!1}return this.stateCenter._log.debug(t+" "+e),(null!=n&&n.id_name||null!=(t=null==n?void 0:n.tags)&&t.id_name||this.config.userID)&&this.isWithNtp()?(null!=n&&n.id_name||null!=(t=null==n?void 0:n.tags)&&t.id_name?this.clientTimeOffset&&(n.tags.time_offset=this.clientTimeOffset):(this.clientTimeOffset&&(n.tags.time_offset=this.clientTimeOffset),n.tags.id_name=this.config.userID),this.dumpData(JSON.stringify(n),e)):this.tempBuffer.push({data:n,level:e}),!0},g.prototype.setUnloadState=function(t){this.unloadLevel=t,this.state="unload"},g.prototype.dumpData=function(t,e){var n=this,r=d.calculateMemSize(t),i=(this.traceType.MEM_I_API+=r,c.getSeq()),o=(new Date).getTime(),s={seq:i,content:t,level:e,timestamp:o};"unload"===this.state?void 0!==this.unloadLevel&&e<=this.unloadLevel?(this.storeHandler.saveDataToStorage(s),this.pendingQueue.enqueue(s,e)):this.stateCenter._log.debug("level is low"):e<=this.config.importantLevel?(s.key=e+"_"+o+"_"+i,this.dataInDb.push(s.key),this.storeHandler.storeData(s).then((function(t){n.pendingQueue.enqueue(s,e),n.traceType.DB_I_BACKUP+=r})).catch((function(t){var r=n.dataInDb.findIndex((function(t){return t===s.key}));-1<r&&n.dataInDb.splice(r,1),n.pendingQueue.enqueue(s,e)}))):this.pendingQueue.enqueue(s,e),"force"===this.state&&(o=d.calculateMemSize(t),this.forceDataTotalLen+=o)},g.prototype.isWithNtp=function(){return this.isWaitNtpTimeout||void 0!==this.clientTimeOffset},g.prototype.bufferDump=function(){var t,e=this.tempBuffer.shift();e&&(t=e.data,e=e.level,t.tags.id_name=this.config.userID,this.dumpData(JSON.stringify(t),e),this.bufferDump())},g.prototype.isConfigOK=function(t){return""!==t.userID&&""!==t.token&&""!==t.server},g.prototype.testSize=function(t){},g.prototype.flush=function(t){var e;"force"!==this.state&&(this.state="force",e=16e6,"object"==typeof t&&"number"==typeof t.bps&&(e=t.bps),this.zegoService.setBps(e),this.forceDataTotalLen=this.storeHandler.storeSize+this.pendingQueue.pendingDataSize+this.reportPackagesSize,e=(t=this.pendingQueue.getPendingDataInfo()).pendingDataSize,t=t.size,0<e?this.checkPendingQueue(e,t):this.loadReportData())},g.prototype.setWaitNtpTimeout=function(t){this.waitNtpTimeout=t},g.prototype.setWaitNtpTimer=function(){var t=this;this.ntpTimer=setTimeout((function(){t.isWaitNtpTimeout=!0,t.config.userID&&t.bufferDump()}),this.waitNtpTimeout)},g.prototype.startReportTimer=function(){var t=this,e=(this.stateCenter._log.debug("startReportTimer "+new Date),this.timeInterval=!0,(n=this.pendingQueue.getPendingDataInfo()).pendingDataSize),n=n.size;this.checkPendingQueue(e,n),this.reportTimer=window.setTimeout((function(){t.startReportTimer()}),3e4)},g.prototype.checkCacheDataTimer=function(){return i(this,void 0,void 0,(function(){var t,e,n=this;return o(this,(function(r){switch(r.label){case 0:return e=this.pendingQueue.getPendingDataInfo(),t=e.pendingDataSize,e=e.size,t>this.config.reportSize||e>this.config.reportNum?[4,this.checkPendingQueue(t,e)]:[3,2];case 1:return r.sent(),[3,3];case 2:this.loadReportData(),r.label=3;case 3:return this.checkDataTimer=window.setTimeout((function(){n.checkCacheDataTimer()}),15e3),[2]}}))}))},g.prototype.bindWindowListener=function(){var t=this,e=navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone/i);navigator.userAgent.indexOf("Firefox"),window.addEventListener(e?"pagehide":"beforeunload",(function(){window.event&&(window.event.cancelBubble=!0),t.saveDataBeforeUnload()}))},g.prototype.saveDataBeforeUnload=function(){var t=(t=this.pendingQueue.readStoreData(1)).storeArr,e=(this.storeHandler.resetCommonStore(),[]);e.push.apply(e,a(t)),t=this.zegoService.readReportQueueData(),e.push.apply(e,a(t)),0<e.length&&this.storeHandler.storePendingData(e)},g.prototype.setNetStateCheck=function(){"fail"===this.postDataState&&this.zegoService.handleNetConnect()},g.prototype.postSucHandler=function(t,e,n){return i(this,void 0,void 0,(function(){var n,r,i,s,a,u=this;return o(this,(function(o){switch(o.label){case 0:for(this.stateCenter._log.debug("post suc"),this.postDataState="suc",t.forEach((function(t){u.traceType.MEM_O_DONE+=d.calculateMemSize(t.content)})),n=function(e){var n=t[e];r.storeHandler.removeDataItem(n).then((function(t){n.key&&u.reportMap.delete(n.key)})).catch((function(t){}))},r=this,i=0;i<t.length;i++)n(i);return this.reportPackagesSize-=e,a=this.pendingQueue.getPendingDataInfo(),s=a.pendingDataSize,a=a.size,s>this.config.reportSize||a>this.config.reportNum?[4,this.checkPendingQueue(s,a)]:[3,2];case 1:return o.sent(),[3,3];case 2:this.loadReportData(),o.label=3;case 3:return"force"===this.state&&0==this.reportPackagesSize&&(s=this.reportPackagesSize+this.pendingQueue.pendingDataSize+this.storeHandler.storeSize,a=1-Number((s/this.forceDataTotalLen).toFixed(2)),this.listenerList.progressUpdate&&this._actionListener("progressUpdate",a),0<this.storeHandler.storeSize)&&this.loadReportData((function(t){0===t&&(u.state="normal",u.zegoService.setBps(u.config.bps||p.DEFAULT_CONFIG.bps),u.listenerList.forceSuccessCallback)&&u._actionListener("forceResult","SUCCESS")})),[2]}}))}))},g.prototype.checkPendingQueue=function(t,e){return i(this,void 0,void 0,(function(){var n,r,i,s,a;return o(this,(function(o){switch(o.label){case 0:return t>this.config.reportSize||e>this.config.reportNum||["force","unload"].includes(this.state)||this.timeInterval?(this.timeInterval=!1,!this.isPaused&&this.config.userID&&this.config.token&&this.config.serverUrl?[3,3]:(this.stateCenter._log.debug("isPaused "+this.isPaused+" "+this.userID+" "+this.config.token+" "+this.config.serverUrl),t>=this.cacheMaxSize||this.staticConfig.totalAvailCache<=0?[4,this.storePendingDataToDB(this.cacheDelPer)]:[3,2])):[3,7];case 1:o.sent(),o.label=2;case 2:return[2];case 3:return this.zegoService.reportAllowed()?[3,6]:(this.zegoService.resumeReport(),t>=this.cacheMaxSize||this.staticConfig.totalAvailCache<=0?[4,this.storePendingDataToDB(this.cacheDelPer)]:[3,5]);case 4:o.sent(),o.label=5;case 5:return[2];case 6:if(i=this.pendingQueue.readReportData(this.config.reportSize),n=i.totalLen,i=i.reportDataArr,n<=0)return[2];for(i=this.setCommonField(i),this.zegoService.report(r=i.packageArr,i=i.packageLen,this.product,"unload"===this.state),s=0;s<r.length;s++)this.reportMap.set((a=r[s]).key,a);this.reportPackagesSize+=i,this.pendingQueue.refresh(n),o.label=7;case 7:return[2]}}))}))},g.prototype.initPendingQueue=function(){var t=this;this.pendingQueue=new f.PendingQueue(this.config.levels,this.product,this.staticConfig,this.stateCenter),this.pendingQueue.setListener({enCallback:function(e,n,r){return i(t,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,this.checkPendingQueue(r,n)];case 1:return t.sent(),[2]}}))}))}})},g.prototype.loadDBDataToMem=function(){var t=this;this.storeHandler.readStoreDataItem().then((function(e){var n=d.calculateMemSize(e.content);t.traceType.MEM_I_LOAD+=n,t.pendingQueue.enqueue(e,e.level)})).catch((function(t){}))},g.prototype.storePendingDataToDB=function(t){return i(this,void 0,void 0,(function(){var e,n,r,i,s,a,c,l,h;return o(this,(function(f){switch(f.label){case 0:n=this.pendingQueue.readStoreData(t),e=n.totalLen,n=n.storeArr,r=function(t){var n,r;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,i.storeDataItem(t,e)];case 1:return o.sent(),n=t.level+"_"+t.timestamp+"_"+t.seq,-1<(r=i.dataInDb.findIndex((function(t){return t===n})))&&i.dataInDb.splice(r,1),[3,3];case 2:return o.sent(),[3,3];case 3:return[2]}}))},i=this,f.label=1;case 1:f.trys.push([1,6,7,8]),s=u(n),a=s.next(),f.label=2;case 2:return a.done?[3,5]:[5,r(c=a.value)];case 3:f.sent(),f.label=4;case 4:return a=s.next(),[3,2];case 5:return[3,8];case 6:return c=f.sent(),l={error:c},[3,8];case 7:try{a&&!a.done&&(h=s.return)&&h.call(s)}finally{if(l)throw l.error}return[7];case 8:return[2]}}))}))},g.prototype.storePackagesDataToDB=function(t){var e=this;t.length&&t.forEach((function(t){e.storeHandler.storeData(t).then((function(n){var r=d.calculateMemSize(t.content);e.traceType.MEM_O_DUMP+=r})).catch((function(t){}))}))},g.prototype.storeDataItem=function(t,e){var n=this;return new Promise((function(e,r){return i(n,void 0,void 0,(function(){var n;return o(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.storeHandler.storeData(t)];case 1:return i.sent(),n=d.calculateMemSize(t.content),this.traceType.MEM_O_DUMP+=n,e(),[3,3];case 2:return n=i.sent(),r(n),[3,3];case 3:return[2]}}))}))}))},g.prototype.loadReportData=function(t){var e=this;this.storeHandler.storeSize<=0||this.isLoadReportData||(this.isLoadReportData=!0,this.storeHandler.loadDBData(this.config.reportSize,5,Math.floor(this.cacheMaxSize/3),(function(t){return-1<e.dataInDb.indexOf(t)})).then((function(n){e.isLoadReportData=!1,n.datas.forEach((function(t){var n;e.reportMap.has(t.key)||e.pendingQueue.findInQueue(t)||(n=d.calculateMemSize(t.content),e.traceType.MEM_I_LOAD+=n,e.pendingQueue.enqueue(t,t.level),e.dataInDb.push(t.key))})),t&&t(n.len)})).catch((function(t){e.isLoadReportData=!1})))},g.prototype.setCommonField=function(t){var e=this,n=0;return t.forEach((function(t){var r,i,o=JSON.parse(t.content);if(e.startCommonField)try{for(var a=u(e.startCommonField),c=a.next();!c.done;c=a.next()){var l=s(c.value,2),h=l[0];"userID"!==h&&"token"!==h&&"serverUrl"!==h&&(o[h]=l[1])}}catch(t){r={error:t}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}n+=d.calculateMemSize(o),t.content=JSON.stringify(o)})),{packageArr:t,packageLen:n}},g.prototype._bindListener=function(t,e){return!!this.listenerList[t]&&"function"==typeof e&&(-1==this.listenerList[t].indexOf(e)&&this.listenerList[t].push(e),!0)},g.prototype._deleteListener=function(t,e){var n;return!!this.listenerList[t]&&(n=this.listenerList[t],e?n.splice(n.indexOf(e),1):this.listenerList[t]=[],!0)},g.prototype._actionListener=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.listenerList[t]&&this.listenerList[t].forEach((function(t){try{t.apply(void 0,a(e))}catch(t){}}))},e.ZegoDataReport=g},function(t,e,n){"use strict";var r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(r(arguments[e]));return t},o=(Object.defineProperty(e,"__esModule",{value:!0}),e.ZegoService=void 0,n(0)),s=n(25),a=n(29),u=n(4);function c(t,e,n,r,i){var a,u,c,l=this;this.env=t,this.product=n,this.pro=r,this.stateCenter=i,this.isDestroy=!1,this.websocket=null,this.packageLen=0,this.packagesDataSize=0,this.PACKAGE_MAX_LEN=5,this.msgID=0,this.logUploadTimer=null,this.logUploadInterval=1e4,this.logCacheSend=[],this.logCacheMax=100,this.reportDataCheckInterval=1e3,this.postSucCallbackList={},this.postFailCallbackList={},this.failCount=0,this.failStartTime=0,this.netWorkFail=!1,this.networkState=o.ENUM_NETWORK_STATE.online,this.state=o.ENUM_CONNECT_STATE.disconnected,this.wsFrequentShutdownCounter=(u=a=0,c=function(){u=a=0},{onOpen:function(){a=performance.now()},onClose:function(){0<a&&(performance.now()-a<100?(u++,l.stateCenter.logger.info("zt.rzs.wfsc frequently shutdown.")):c())},isOutOfMaxTimes:function(){return 10<=u}}),this.bindWindowListener(),this.networkState=o.ENUM_NETWORK_STATE.online,this.service=new s.LogService(t,n,r,i),this.setBps(e),this.reportQueue=new o.Queue}c.prototype.destroy=function(){var t;null!=(t=this.websocket)&&t.close(),this.service.closeSocket(),this.logUploadTimer&&clearTimeout(this.logUploadTimer),this.reportQueue.clear(),this.isDestroy=!0},c.prototype.bindWindowListener=function(){var t=this;window.addEventListener("offline",(function(){t.networkState=o.ENUM_NETWORK_STATE.offline})),window.addEventListener("online",(function(e){t.handleNetConnect()}))},c.prototype.handleNetConnect=function(){this.networkState=o.ENUM_NETWORK_STATE.online;var t=this.url;this.url="",this.setLogServer(t),this.netWorkFail=!1},c.prototype.setLogServer=function(t){try{return t.startsWith("wss:")||t.startsWith("ws:")?(this.logType=o.ENUM_REMOTE_TYPE.WEBSOCKET,this.openWebSocketLogServer(t)):t.startsWith("https:")||t.startsWith("http:")?(this.logType=o.ENUM_REMOTE_TYPE.HTTPS,this.openHttpsLogServer(t)):this.logType=o.ENUM_REMOTE_TYPE.DISABLE,!0}catch(t){return!1}},c.prototype.setLogUrlParams=function(t){this.logParams=t},c.prototype.openWebSocketLogServer=function(t){var e=this;this.url!=t&&(this.url=t)&&(this.stopWebSocketServer(),this.logParams.id_name)&&(this.wsFrequentShutdownCounter.isOutOfMaxTimes()?(this.stateCenter.logger.warn("zt.rzs.owsls frequently shutdown too many times. cannot create socket anymore."),this.state=o.ENUM_CONNECT_STATE.disconnected):(this.state=o.ENUM_CONNECT_STATE.connecting,t=t+"?product="+this.logParams.product+"&appid="+this.logParams.appid+"&token="+encodeURIComponent(this.logParams.signature)+"&deviceid="+this.logParams.deviceid+"&id_name="+this.logParams.id_name,this.service.createSocket(t),this.service.openHandler((function(){e.service.onPush(),e.service.startCheck(),e.stateCenter.logger.info("zt.rzs.owsls socket open"),e.openHandler(),e.wsFrequentShutdownCounter.onOpen()})),this.service.closeHandler((function(t){e.stateCenter.logger.warn("zt.rzs.owsls socket close "+JSON.stringify(t.code||t)),e.state=o.ENUM_CONNECT_STATE.disconnected,e.service.closeSocket(),e.wsFrequentShutdownCounter.onClose()})),this.service.errorHandler((function(t){e.stateCenter.logger.warn("zt.rzs.owsls socket error "+JSON.stringify(t.code||t)),e.state=o.ENUM_CONNECT_STATE.disconnected,e.service.closeSocket()}))))},c.prototype.stopWebSocketServer=function(){this.service.closeSocket()},c.prototype.openHttpsLogServer=function(t){(this.url=t)&&this.stopHttpsServer()},c.prototype.stopHttpsServer=function(){this.logUploadTimer&&(clearInterval(this.logUploadTimer),this.logUploadTimer=null)},c.prototype.SendHttpsLog=function(t,e,n,r){this.env===o.ZEGO_ENV.BROWSER?this.SendHttpsLogWeb(t,e,n,r):this.SendHttpsLogWeChatMini(t,e,n,r)},c.prototype.SendHttpsLogWeb=function(t,e,n,r){var i=this,o=(t=JSON.stringify({body:{data:t}}),new XMLHttpRequest);o.onreadystatechange=function(){if(4==o.readyState)if(200==o.status){if(0!=o.responseText.length)try{var t=JSON.parse(o.responseText).interval;"number"==typeof t&&i.logUploadInterval!==t&&i.openHttpsLogServer(i.url),n&&n()}catch(t){r&&r()}}else r&&r()},o.open("POST",this.url,!0),o.send(t)},c.prototype.SendHttpsLogWeChatMini=function(t,e,n,r){var i=this;t={appid:this.logParams.appid+"",timestamp:(new Date).getTime()+"",token:this.logParams.signature,id_name:this.logParams.id_name,product:this.logParams.product,message_id:++this.msgID,req_sdk:1,s:JSON.stringify({speed_detail:t})},wx.request({url:this.url,data:JSON.stringify(t),method:"POST",success:function(t){0!=t.data.length&&("number"==typeof(t=t&&t.data&&t.data.interval)&&i.logUploadInterval!==t&&i.openHttpsLogServer(i.url),n)&&n()},fail:function(t){r&&r()}})},c.prototype.openHandler=function(){this.state=o.ENUM_CONNECT_STATE.connected,this.startReport()},c.prototype.setPostSucCallback=function(t,e){this.postSucCallbackList[t]=e},c.prototype.setPostFailCallback=function(t,e){this.postFailCallbackList[t]=e},c.prototype.reportAllowed=function(){return this.packageLen<this.PACKAGE_MAX_LEN},c.prototype.report=function(t,e,n,r){this.packageLen++,this.packagesDataSize+=e,this.reportQueue.enqueue({reportDatas:t,dataLen:e,product:n}),this.netWorkFail=!1,this.failCount=0,this.failStartTime=0,this.startReport(r)},c.prototype.setBps=function(t){this.tokenBucket=new a.TokenBucket(u.BUCKET_CONFIG.bucketSize,t/8,"sec")},c.prototype.startReport=function(t){var e,n,r,i,s=this;this.isDestroy||(this.logType===o.ENUM_REMOTE_TYPE.WEBSOCKET&&this.state===o.ENUM_CONNECT_STATE.disconnected?(e=this.url,this.url="",this.setLogServer(e)):0<this.reportQueue.size()&&(e=this.reportQueue.dequeue(),n=e.reportDatas,r=e.dataLen,i=e.product,new Date,t?this.sendReport(n,r,i):this.tokenBucket.removeTokens(r,(function(){s.sendReport(n,r,i)}))))},c.prototype.failTooMuch=function(){if(this.failCount<=0)return!1;1==this.failCount&&(this.failStartTime=Date.now());var t=(Date.now()-this.failStartTime)/1e3;return this.failCount>=u.FAIL_COUNT&&t>u.FAIL_TIME||this.failCount>=u.FAIL_MAX_COUNT},c.prototype.sendReport=function(t,e,n){var r=this;this.reportData(t,e,n,(function(){r.failCount=0,r.failStartTime=0,r.packageLen--,r.packagesDataSize-=e,r.postSucCallbackList[n]&&r.postSucCallbackList[n](t,e,n)}),(function(i){var o;r.reportQueue.enqueue({reportDatas:t,dataLen:e,product:n}),r.failCount++,r.failTooMuch()?(r.netWorkFail=!0,o=r.decodeReportQueue(),Object.keys(r.postFailCallbackList).forEach((function(t){r.postFailCallbackList[n](o[t])}))):r.startReport()}))},c.prototype.resumeReport=function(){!0===this.netWorkFail&&this.networkState===o.ENUM_NETWORK_STATE.online&&(this.netWorkFail=!1,this.startReport())},c.prototype.reportData=function(t,e,n,r,i){var s=this,a=[];t.forEach((function(t){a.push(JSON.parse(t.content))})),this.logType==o.ENUM_REMOTE_TYPE.WEBSOCKET?this.networkState===o.ENUM_NETWORK_STATE.offline?i&&i(o.errorList.BROKEN):this.service.sendMessage("report",a,r,(function(t){var e;s.state===o.ENUM_CONNECT_STATE.disconnected&&t===o.SOCKET_DISCONNECT&&(e=s.url,s.url="",s.setLogServer(e)),i&&i(t)})):this.logType==o.ENUM_REMOTE_TYPE.HTTPS&&this.SendHttpsLog(a,e,r,(function(){i&&i()}))},c.prototype.unsigned2signed=function(t){var e=parseInt(t,10);if(256<e)return e%256;for(var n=[];0<e;)n.push(e%2!=0?1:0),e=Number(e/2);for(n.reverse();n.length<8;)n.unshift(0);var r="";if(1==(n=n.join("")).substr(0,1)){for(var i=1;i<n.length;i++)1==n.substr(i,1)?r+=0:r+=1;return"-"+(parseInt(r,2)+1)}for(i=0;i<n.length;i++)r+=n.substr(i,1);return parseInt(r,2)},c.prototype.decodeReportQueue=function(){for(var t={},e=this.reportQueue.size(),n=0;n<e;n++){var r,o=(r=this.reportQueue.dequeue()).reportDatas,s=r.dataLen;t[r=r.product]||(t[r]=[]),t[r]=i(t[r],o),this.reportQueue.enqueue({reportDatas:o,dataLen:s,product:r})}return t},c.prototype.readReportQueueData=function(){for(var t=[],e=this.reportQueue.size(),n=0;n<e;n++){var r=this.reportQueue.dequeue();t.push.apply(t,i(r.reportDatas))}return t},e.ZegoService=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LogService=void 0;var r=n(26),i=n(4),o=n(0);function s(t,e,n,i){this.env=t,this.product=e,this.pro=n,this.stateCenter=i,this.service=new r.ZegoSocketService(this.env,this.product,this.pro,this.stateCenter),this.cmdSeq=0,this.responseRouters={}}s.prototype.handleSendCommandMsgRsp=function(t){var e,n,r=this,i=this.service.sendCommandMap[t.messageId||(null==(i=null==t?void 0:t.data)?void 0:i.message_id)];null!=i&&(n=i._data,delete this.service.sendCommandMap[t.messageId||(null==(e=null==t?void 0:t.data)?void 0:e.message_id)],this.service.sendCommandList.remove(i),0===t.code?setTimeout((function(){n&&null!=n.success&&n.success(t,r.cmdSeq)}),0):setTimeout((function(){n&&null!=n.error&&n.error(t,r.cmdSeq)}),0))},s.prototype.onPush=function(){var t=this;this.service.onMessage=function(e){t.handleSendCommandMsgRsp(e)}},s.prototype.closeHandler=function(t){this.service.closeHandler(t)},s.prototype.openHandler=function(t){this.service.openHandler(t)},s.prototype.errorHandler=function(t){this.service.errorHandler(t)},s.prototype.getHeader=function(t){return{Protocol:"req",cmd:t,appid:123,seq:++this.cmdSeq,session_id:""}},s.prototype.startCheck=function(){this.service.startCheck()},s.prototype.stopCheck=function(){this.service.stopCheck()},s.prototype.isDisConnect=function(){return!this.service||this.service.isDisConnect()},s.prototype.createSocket=function(t){this.service.createSocket(t),this.responseRouters={}},s.prototype.closeSocket=function(){this.service.closeSocket()},s.prototype.sendMessage=function(t,e,n,r,s,a){return this.service.isDisConnect()?(r&&r(o.SOCKET_DISCONNECT),0):(s=s||this.getHeader(t),this.service.sendMessage(s,e,n,r,{timeOut:1e3*i.DEFAULT_CONFIG.netTimeout}))},s.prototype.on=function(t,e){this.responseRouters[t]=e},e.LogService=s},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},i=(Object.defineProperty(e,"__esModule",{value:!0}),e.ZegoSocketService=void 0,n(27)),o=n(0),s=n(28);function a(t,e,n,r){this.product=e,this.pro=n,this.stateCenter=r,this.socket=null,this.sendCommandList=new o.LinkedList,this.sendCommandMap={},this.sendDataCheckOnceCount=100,this.sendDataDropTimeout=3e4,this.sendDataCheckInterval=2e3,this.ENV=t}a.prototype.createSocket=function(t){this.socket=i.createZegoWebSocket(t,this.ENV),this.socket.binaryType="arraybuffer"},a.prototype.closeSocket=function(){this.socket&&(this.socket.onclose=null,this.socket.onerror=null,this.socket.close(),this.socket=null)},a.prototype.isDisConnect=function(){return!this.socket||1!==this.socket.readyState},a.prototype.sendMessage=function(t,e,n,i,o){void 0===n&&(n=null),void 0===i&&(i=null),void 0===o&&(o={timeOut:6e3});var a=r(r({},this.stateCenter.processData),{time_upload:Date.now()});return a={data:e={message_id:t.seq,product:this.product,s:JSON.stringify({speed_detail:e,process:a})},seq:t.seq,deleted:!1,sendTime:Date.parse(new Date+""),timeOut:o.timeOut,success:n,error:i},o=this.sendCommandList.push(a),this.sendCommandMap[a.seq]=o,this.socket&&"pb"!==this.pro&&(this.stateCenter._log.debug("upload data",JSON.stringify(e)),n=s.deflate(JSON.stringify(e),{to:"string"}),this.socket.send(n)),t.seq},a.prototype.checkSendMessageList=function(t){for(var e=t.getFirst();null!=e;)t.remove(e),e._data&&e._data.error&&setTimeout((function(){e&&e._data&&e._data.error&&e._data.error(o.errorList.TIMEOUT,e._data.data.message_id,e._data.data.s)}),0),e=t.getFirst()},a.prototype.checkMessageListTimeout=function(t,e){for(var n=t.getFirst(),r=Date.parse(new Date+""),i=0;!(null==n||n._data&&n._data.sendTime+n._data.timeOut>r||(n._data&&delete e[n._data.data.message_id],t.remove(n),n._data&&null==n._data.error||n._data&&n._data.sendTime+this.sendDataDropTimeout<r||n&&n._data&&n._data.error&&n._data.error(o.errorList.TIMEOUT,n._data.data.message_id,n._data.data.s),++i>=this.sendDataCheckOnceCount));)n=t.getFirst()},a.prototype.startCheck=function(){var t=this;this.checkMessageListTimeout(this.sendCommandList,this.sendCommandMap),this.sendDataCheckTimer=setTimeout((function(){t.startCheck()}),this.sendDataCheckInterval)},a.prototype.stopCheck=function(){this.checkSendMessageList(this.sendCommandList),clearTimeout(this.sendDataCheckTimer)},a.prototype.openHandler=function(t){var e=this;this.socket&&(this.socket.onopen=function(n){e.responseHandler(),t(n)})},a.prototype.responseHandler=function(){var t=this;this.socket&&(this.socket.onmessage=function(e){e="string"==typeof e.data?JSON.parse(e.data):JSON.parse(String.fromCharCode.apply(null,new Uint8Array(e.data))),t.onMessage(e)})},a.prototype.closeHandler=function(t){this.socket&&(this.socket.onclose=function(e){t(e)})},a.prototype.errorHandler=function(t){this.socket&&(this.socket.onerror=t)},a.prototype.onMessage=function(t){},e.ZegoSocketService=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createZegoWebSocket=e.ZegoWeiXinMiniWebSocket=void 0;var r=n(0),i=(o.prototype.init=function(){var t=this;this._websocket&&(this.readyState=0,this._websocket.onOpen((function(e){t.readyState=t._websocket.readyState,"function"==typeof t.onopen&&(t.onopen(e),t._websocket.onClose((function(e){t.readyState=t._websocket.readyState,"function"==typeof t.onclose&&t.onclose(e)})),t._websocket.onMessage((function(e){"function"==typeof t.onmessage&&t.onmessage(e)})))})),this._websocket.onError((function(e){t.readyState=t._websocket.readyState,"function"==typeof t.onerror&&t.onerror(e)})))},o.prototype.onopen=function(t){},o.prototype.onerror=function(t){},o.prototype.onclose=function(t){},o.prototype.onmessage=function(t){},o.prototype.send=function(t){this._websocket&&this._websocket.send({data:t})},o.prototype.close=function(){this._websocket&&this._websocket.close()},o);function o(t,e){this.url=t,this.readyState=3,this._websocket=wx.connectSocket({url:t}),this.init()}e.ZegoWeiXinMiniWebSocket=i,e.createZegoWebSocket=function(t,e){return new(e===r.ZEGO_ENV.BROWSER?WebSocket:i)(t)}},function(t,e,n){!function(t){"use strict";function e(t){for(var e=t.length;0<=--e;)t[e]=0}var n=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),r=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),i=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),o=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s=new Array(576),a=(e(s),new Array(60)),u=(e(a),new Array(512)),c=(e(u),new Array(256)),l=(e(c),new Array(29));e(l);var h,f,d,p=new Array(30);function g(t,e,n,r,i){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=t&&t.length}function _(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function m(t){for(var e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0}function v(t){8<t.bi_valid?D(t,t.bi_buf):0<t.bi_valid&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function y(t,e,n,r){var i=2*e,o=2*n;return t[i]<t[o]||t[i]===t[o]&&r[e]<=r[n]}function b(t,e,i){var o,s,a,u,h=0;if(0!==t.sym_next)for(;o=255&t.pending_buf[t.sym_buf+h++],o+=(255&t.pending_buf[t.sym_buf+h++])<<8,s=t.pending_buf[t.sym_buf+h++],0==o?U(t,s,e):(U(t,(a=c[s])+256+1,e),0!==(u=n[a])&&x(t,s-=l[a],u),a=M(--o),U(t,a,i),0!==(u=r[a])&&x(t,o-=p[a],u)),h<t.sym_next;);U(t,256,e)}function S(t,e){var n,r,i,o=e.dyn_tree,s=e.stat_desc.static_tree,a=e.stat_desc.has_stree,u=e.stat_desc.elems,c=-1;for(t.heap_len=0,t.heap_max=573,n=0;n<u;n++)0!==o[2*n]?(t.heap[++t.heap_len]=c=n,t.depth[n]=0):o[2*n+1]=0;for(;t.heap_len<2;)o[2*(i=t.heap[++t.heap_len]=c<2?++c:0)]=1,t.depth[i]=0,t.opt_len--,a&&(t.static_len-=s[2*i+1]);for(e.max_code=c,n=t.heap_len>>1;1<=n;n--)z(t,o,n);for(i=u;n=t.heap[1],t.heap[1]=t.heap[t.heap_len--],z(t,o,1),r=t.heap[1],t.heap[--t.heap_max]=n,t.heap[--t.heap_max]=r,o[2*i]=o[2*n]+o[2*r],t.depth[i]=(t.depth[n]>=t.depth[r]?t.depth[n]:t.depth[r])+1,o[2*n+1]=o[2*r+1]=i,t.heap[1]=i++,z(t,o,1),2<=t.heap_len;);t.heap[--t.heap_max]=t.heap[1];for(var l,h,f,d,p,g=t,_=e.dyn_tree,m=e.max_code,v=e.stat_desc.static_tree,y=e.stat_desc.has_stree,b=e.stat_desc.extra_bits,S=e.stat_desc.extra_base,E=e.stat_desc.max_length,T=0,C=0;C<=15;C++)g.bl_count[C]=0;for(_[2*g.heap[g.heap_max]+1]=0,l=g.heap_max+1;l<573;l++)(C=_[2*_[2*(h=g.heap[l])+1]+1]+1)>E&&(C=E,T++),_[2*h+1]=C,m<h||(g.bl_count[C]++,d=0,S<=h&&(d=b[h-S]),g.opt_len+=(p=_[2*h])*(C+d),y&&(g.static_len+=p*(v[2*h+1]+d)));if(0!==T){do{for(C=E-1;0===g.bl_count[C];)C--}while(g.bl_count[C]--,g.bl_count[C+1]+=2,g.bl_count[E]--,0<(T-=2));for(C=E;0!==C;C--)for(h=g.bl_count[C];0!==h;)(f=g.heap[--l])>m||(_[2*f+1]!==C&&(g.opt_len+=(C-_[2*f+1])*_[2*f],_[2*f+1]=C),h--)}H(o,c,t.bl_count)}function E(t,e,n){var r,i,o=-1,s=e[1],a=0,u=7,c=4;for(0===s&&(u=138,c=3),e[2*(n+1)+1]=65535,r=0;r<=n;r++)i=s,s=e[2*(r+1)+1],++a<u&&i===s||(a<c?t.bl_tree[2*i]+=a:0!==i?(i!==o&&t.bl_tree[2*i]++,t.bl_tree[32]++):a<=10?t.bl_tree[34]++:t.bl_tree[36]++,o=i,c=(a=0)===s?(u=138,3):i===s?(u=6,3):(u=7,4))}function T(t,e,n){var r,i,o=-1,s=e[1],a=0,u=7,c=4;for(0===s&&(u=138,c=3),r=0;r<=n;r++)if(i=s,s=e[2*(r+1)+1],!(++a<u&&i===s)){if(a<c)for(;U(t,i,t.bl_tree),0!=--a;);else 0!==i?(i!==o&&(U(t,i,t.bl_tree),a--),U(t,16,t.bl_tree),x(t,a-3,2)):a<=10?(U(t,17,t.bl_tree),x(t,a-3,3)):(U(t,18,t.bl_tree),x(t,a-11,7));o=i,c=(a=0)===s?(u=138,3):i===s?(u=6,3):(u=7,4)}}function C(t,e,n,r){x(t,0+(r?1:0),3),v(t),D(t,n),D(t,~n),n&&t.pending_buf.set(t.window.subarray(e,e+n),t.pending),t.pending+=n}function w(t,e){return t.msg=W[e],e}function R(t){return 2*t-(4<t?9:0)}function I(t,e){K(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,Tt(t.strm)}function k(t,e){t.pending_buf[t.pending++]=e}function O(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function N(t,e){var n,r,i=t.max_chain_length,o=t.strstart,s=t.prev_length,a=t.nice_match,u=t.strstart>t.w_size-_t?t.strstart-(t.w_size-_t):0,c=t.window,l=t.w_mask,h=t.prev,f=t.strstart+gt,d=c[o+s-1],p=c[o+s];t.prev_length>=t.good_match&&(i>>=2),a>t.lookahead&&(a=t.lookahead);do{if(c[(n=e)+s]===p&&c[n+s-1]===d&&c[n]===c[o]&&c[++n]===c[o+1]){for(o+=2,n++;c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&o<f;);if(r=gt-(f-o),o=f-gt,s<r){if(t.match_start=e,a<=(s=r))break;d=c[o+s-1],p=c[o+s]}}}while((e=h[e&l])>u&&0!=--i);return s<=t.lookahead?s:t.lookahead}function A(t,e){for(var n,r,i,o=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,s=0,a=t.strm.avail_in;n=65535,!(t.strm.avail_out<(i=t.bi_valid+42>>3)||(n=(i=t.strm.avail_out-i)<(n=n>(r=t.strstart-t.block_start)+t.strm.avail_in?r+t.strm.avail_in:n)?i:n)<o&&(0===n&&e!==et||e===X||n!==r+t.strm.avail_in)||(s=e===et&&n===r+t.strm.avail_in?1:0,Z(t,0,0,s),t.pending_buf[t.pending-4]=n,t.pending_buf[t.pending-3]=n>>8,t.pending_buf[t.pending-2]=~n,t.pending_buf[t.pending-1]=~n>>8,Tt(t.strm),r&&(n<r&&(r=n),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+r),t.strm.next_out),t.strm.next_out+=r,t.strm.avail_out-=r,t.strm.total_out+=r,t.block_start+=r,n-=r),n&&(Ct(t.strm,t.strm.output,t.strm.next_out,n),t.strm.next_out+=n,t.strm.avail_out-=n,t.strm.total_out+=n),0!==s)););return(a-=t.strm.avail_in)&&(a>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=a&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart)&&(t.insert=t.strstart),t.window.set(t.strm.input.subarray(t.strm.next_in-a,t.strm.next_in),t.strstart),t.strstart+=a,t.insert+=a>t.w_size-t.insert?t.w_size-t.insert:a),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),s?4:e!==X&&e!==et&&0===t.strm.avail_in&&t.strstart===t.block_start?2:(t.strm.avail_in>(i=t.window_size-t.strstart)&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,i+=t.w_size,t.insert>t.strstart)&&(t.insert=t.strstart),(i=i>t.strm.avail_in?t.strm.avail_in:i)&&(Ct(t.strm,t.window,t.strstart,i),t.strstart+=i,t.insert+=i>t.w_size-t.insert?t.w_size-t.insert:i),t.high_water<t.strstart&&(t.high_water=t.strstart),o=(i=65535<t.pending_buf_size-(i=t.bi_valid+42>>3)?65535:t.pending_buf_size-i)>t.w_size?t.w_size:i,((r=t.strstart-t.block_start)>=o||(r||e===et)&&e!==X&&0===t.strm.avail_in&&r<=i)&&(Z(t,t.block_start,n=i<r?i:r,s=e===et&&0===t.strm.avail_in&&n===r?1:0),t.block_start+=n,Tt(t.strm)),s?3:1)}function L(t,e){for(var n,r;;){if(t.lookahead<_t){if(wt(t),t.lookahead<_t&&e===X)return 1;if(0===t.lookahead)break}if(n=0,3<=t.lookahead&&(t.ins_h=Et(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==n&&t.strstart-n<=t.w_size-_t&&(t.match_length=N(t,n)),3<=t.match_length)if(r=$(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&3<=t.lookahead){for(t.match_length--;t.strstart++,t.ins_h=Et(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,0!=--t.match_length;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=Et(t,t.ins_h,t.window[t.strstart+1]);else r=$(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(r&&(I(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===et?(I(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(I(t,!1),0===t.strm.avail_out)?1:2}function P(t,e){for(var n,r,i;;){if(t.lookahead<_t){if(wt(t),t.lookahead<_t&&e===X)return 1;if(0===t.lookahead)break}if(n=0,3<=t.lookahead&&(t.ins_h=Et(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==n&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-_t&&(t.match_length=N(t,n),t.match_length<=5)&&(t.strategy===ct||3===t.match_length&&4096<t.strstart-t.match_start)&&(t.match_length=2),3<=t.prev_length&&t.match_length<=t.prev_length){for(i=t.strstart+t.lookahead-3,r=$(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=i&&(t.ins_h=Et(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!=--t.prev_length;);if(t.match_available=0,t.match_length=2,t.strstart++,r&&(I(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((r=$(t,0,t.window[t.strstart-1]))&&I(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(r=$(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===et?(I(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(I(t,!1),0===t.strm.avail_out)?1:2}e(p);var M=function(t){return t<256?u[t]:u[256+(t>>>7)]},D=function(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},x=function(t,e,n){t.bi_valid>16-n?(t.bi_buf|=e<<t.bi_valid&65535,D(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=n-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)},U=function(t,e,n){x(t,n[2*e],n[2*e+1])},B=function(t,e){for(var n=0;n|=1&t,t>>>=1,n<<=1,0<--e;);return n>>>1},H=function(t,e,n){for(var r,i=new Array(16),o=0,s=1;s<=15;s++)i[s]=o=o+n[s-1]<<1;for(r=0;r<=e;r++){var a=t[2*r+1];0!==a&&(t[2*r]=B(i[a]++,a))}},z=function(t,e,n){for(var r=t.heap[n],i=n<<1;i<=t.heap_len&&(i<t.heap_len&&y(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!y(e,r,t.heap[i],t.depth));)t.heap[n]=t.heap[i],n=i,i<<=1;t.heap[n]=r},G=!1,F=C,q=function(t,e,n,r){for(var i=65535&t|0,o=t>>>16&65535|0,s=0;0!==n;){for(n-=s=2e3<n?2e3:n;o=o+(i=i+e[r++]|0)|0,--s;);i%=65521,o%=65521}return i|o<<16|0},j=new Uint32Array(function(){for(var t=[],e=0;e<256;e++){for(var n=e,r=0;r<8;r++)n=1&n?3988292384^n>>>1:n>>>1;t[e]=n}return t}()),V=function(t,e,n,r){var i=j,o=r+n;t^=-1;for(var s=r;s<o;s++)t=t>>>8^i[255&(t^e[s])];return-1^t},W={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Y={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},Z=F,K=function(t,e,n,r){var i,u,c,l=0;if(0<t.level?(2===t.strm.data_type&&(t.strm.data_type=function(t){for(var e=4093624447,n=0;n<=31;n++,e>>>=1)if(1&e&&0!==t.dyn_ltree[2*n])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(n=32;n<256;n++)if(0!==t.dyn_ltree[2*n])return 1;return 0}(t)),S(t,t.l_desc),S(t,t.d_desc),l=function(t){var e;for(E(t,t.dyn_ltree,t.l_desc.max_code),E(t,t.dyn_dtree,t.d_desc.max_code),S(t,t.bl_desc),e=18;3<=e&&0===t.bl_tree[2*o[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),(u=t.static_len+3+7>>>3)<=(i=t.opt_len+3+7>>>3)&&(i=u)):i=u=n+5,n+4<=i&&-1!==e)C(t,e,n,r);else if(4===t.strategy||u===i)x(t,2+(r?1:0),3),b(t,s,a);else{x(t,4+(r?1:0),3);var h=t,f=(e=t.l_desc.max_code+1,n=t.d_desc.max_code+1,l+1);for(x(h,e-257,5),x(h,n-1,5),x(h,f-4,4),c=0;c<f;c++)x(h,h.bl_tree[2*o[c]+1],3);T(h,h.dyn_ltree,e-1),T(h,h.dyn_dtree,n-1),b(t,t.dyn_ltree,t.dyn_dtree)}m(t),r&&v(t)},$=function(t,e,n){return t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=n,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(c[n]+256+1)]++,t.dyn_dtree[2*M(e)]++),t.sym_next===t.sym_end},Q=function(t){x(t,2,3),U(t,256,s),16===t.bi_valid?(D(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)},X=Y.Z_NO_FLUSH,J=Y.Z_PARTIAL_FLUSH,tt=Y.Z_FULL_FLUSH,et=Y.Z_FINISH,nt=Y.Z_BLOCK,rt=Y.Z_OK,it=Y.Z_STREAM_END,ot=Y.Z_STREAM_ERROR,st=Y.Z_DATA_ERROR,at=Y.Z_BUF_ERROR,ut=Y.Z_DEFAULT_COMPRESSION,ct=Y.Z_FILTERED,lt=Y.Z_HUFFMAN_ONLY,ht=Y.Z_RLE,ft=Y.Z_FIXED,dt=Y.Z_UNKNOWN,pt=Y.Z_DEFLATED,gt=258,_t=262,mt=42,vt=113,yt=666,bt=function(t){for(var e=t.length;0<=--e;)t[e]=0},St=function(t){for(var e,n,r=t.w_size,i=e=t.hash_size;n=t.head[--i],t.head[i]=r<=n?n-r:0,--e;);for(i=e=r;n=t.prev[--i],t.prev[i]=r<=n?n-r:0,--e;);},Et=function(t,e,n){return(e<<t.hash_shift^n)&t.hash_mask},Tt=function(t){var e=t.state,n=e.pending;0!==(n=n>t.avail_out?t.avail_out:n)&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+n),t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending)&&(e.pending_out=0)},Ct=function(t,e,n,r){var i=t.avail_in;return 0===(i=r<i?r:i)?0:(t.avail_in-=i,e.set(t.input.subarray(t.next_in,t.next_in+i),n),1===t.state.wrap?t.adler=q(t.adler,e,i,n):2===t.state.wrap&&(t.adler=V(t.adler,e,i,n)),t.next_in+=i,t.total_in+=i,i)},wt=function(t){var e,n,r=t.w_size;do{if(e=t.window_size-t.lookahead-t.strstart,t.strstart>=r+(r-_t)&&(t.window.set(t.window.subarray(r,r+r-e),0),t.match_start-=r,t.strstart-=r,t.block_start-=r,t.insert>t.strstart&&(t.insert=t.strstart),St(t),e+=r),0===t.strm.avail_in)break;if(e=Ct(t.strm,t.window,t.strstart+t.lookahead,e),t.lookahead+=e,3<=t.lookahead+t.insert)for(t.ins_h=t.window[n=t.strstart-t.insert],t.ins_h=Et(t,t.ins_h,t.window[n+1]);t.insert&&(t.ins_h=Et(t,t.ins_h,t.window[n+3-1]),t.prev[n&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=n,n++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<_t&&0!==t.strm.avail_in)};function Rt(t,e,n,r,i){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=r,this.func=i}var It=[new Rt(0,0,0,0,A),new Rt(4,4,8,4,L),new Rt(4,5,16,8,L),new Rt(4,6,32,32,L),new Rt(4,4,16,16,P),new Rt(8,16,32,32,P),new Rt(8,16,128,128,P),new Rt(8,32,128,256,P),new Rt(32,128,258,1024,P),new Rt(32,258,258,4096,P)];function kt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=pt,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),bt(this.dyn_ltree),bt(this.dyn_dtree),bt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),bt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),bt(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var Ot=function(t){var e;return!t||!(e=t.state)||e.strm!==t||e.status!==mt&&57!==e.status&&69!==e.status&&73!==e.status&&91!==e.status&&103!==e.status&&e.status!==vt&&e.status!==yt?1:0},Nt=function(t){if(Ot(t))return w(t,ot);t.total_in=t.total_out=0,t.data_type=dt;var e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=2===e.wrap?57:e.wrap?mt:vt,t.adler=2===e.wrap?0:1,e.last_flush=-2,function(t){if(!G){for(var e,o,v,y=new Array(16),b=0,S=0;S<28;S++)for(l[S]=b,e=0;e<1<<n[S];e++)c[b++]=S;for(c[b-1]=S,S=v=0;S<16;S++)for(p[S]=v,e=0;e<1<<r[S];e++)u[v++]=S;for(v>>=7;S<30;S++)for(p[S]=v<<7,e=0;e<1<<r[S]-7;e++)u[256+v++]=S;for(o=0;o<=15;o++)y[o]=0;for(e=0;e<=143;)s[2*e+1]=8,e++,y[8]++;for(;e<=255;)s[2*e+1]=9,e++,y[9]++;for(;e<=279;)s[2*e+1]=7,e++,y[7]++;for(;e<=287;)s[2*e+1]=8,e++,y[8]++;for(H(s,287,y),e=0;e<30;e++)a[2*e+1]=5,a[2*e]=B(e,5);h=new g(s,n,257,286,15),f=new g(a,r,0,30,15),d=new g(new Array(0),i,0,19,7),G=!0}t.l_desc=new _(t.dyn_ltree,h),t.d_desc=new _(t.dyn_dtree,f),t.bl_desc=new _(t.bl_tree,d),t.bi_buf=0,t.bi_valid=0,m(t)}(e),rt},At=function(t,e,n,r,i,o){if(!t)return ot;var s=1;if(e===ut&&(e=6),r<0?(s=0,r=-r):15<r&&(s=2,r-=16),i<1||9<i||n!==pt||r<8||15<r||e<0||9<e||o<0||ft<o||8===r&&1!==s)return w(t,ot);8===r&&(r=9);var a=new kt;return(t.state=a).strm=t,a.status=mt,a.wrap=s,a.gzhead=null,a.w_bits=r,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=i+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<i+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=e,a.strategy=o,a.method=n,(r=Nt(s=t))===rt&&((s=s.state).window_size=2*s.w_size,bt(s.head),s.max_lazy_match=It[s.level].max_lazy,s.good_match=It[s.level].good_length,s.nice_match=It[s.level].nice_length,s.max_chain_length=It[s.level].max_chain,s.strstart=0,s.block_start=0,s.lookahead=0,s.insert=0,s.match_length=s.prev_length=2,s.match_available=0,s.ins_h=0),r};function Lt(t){return(Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){}for(var Pt=new Uint8Array(256),Mt=0;Mt<256;Mt++)Pt[Mt]=252<=Mt?6:248<=Mt?5:240<=Mt?4:224<=Mt?3:192<=Mt?2:1;function Dt(t){if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);for(var e,n,r,i,o=t.length,s=0,a=0;a<o;a++)55296==(64512&(n=t.charCodeAt(a)))&&a+1<o&&56320==(64512&(r=t.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),s+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(s),a=i=0;i<s;a++)55296==(64512&(n=t.charCodeAt(a)))&&a+1<o&&56320==(64512&(r=t.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),n<128?e[i++]=n:(n<2048?e[i++]=192|n>>>6:(n<65536?e[i++]=224|n>>>12:(e[i++]=240|n>>>18,e[i++]=128|n>>>12&63),e[i++]=128|n>>>6&63),e[i++]=128|63&n);return e}function xt(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}Pt[254]=Pt[254]=1;var Ut=Object.prototype.toString,Bt=Y.Z_NO_FLUSH,Ht=Y.Z_SYNC_FLUSH,zt=Y.Z_FULL_FLUSH,Gt=Y.Z_FINISH,Ft=Y.Z_OK,qt=Y.Z_STREAM_END,jt=Y.Z_DEFAULT_COMPRESSION,Vt=Y.Z_DEFAULT_STRATEGY,Wt=Y.Z_DEFLATED;function Yt(t){this.options=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var n=e.shift();if(n){if("object"!==Lt(n))throw new TypeError(n+"must be non-object");for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}}return t}({level:jt,method:Wt,chunkSize:16384,windowBits:15,memLevel:8,strategy:Vt},t||{});var e,n=((t=this.options).raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new xt,this.strm.avail_out=0,At(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy));if(n!==Ft)throw new Error(W[n]);if(t.header&&(e=t.header,Ot(r=this.strm)||2!==r.state.wrap||(r.state.gzhead=e)),t.dictionary){var r="string"==typeof t.dictionary?Dt(t.dictionary):"[object ArrayBuffer]"===Ut.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary;if((n=function(t,e){var n=e.length;if(Ot(t))return ot;var r=t.state,i=r.wrap;if(2===i||1===i&&r.status!==mt||r.lookahead)return ot;1===i&&(t.adler=q(t.adler,e,n,0)),r.wrap=0,n>=r.w_size&&(0===i&&(bt(r.head),r.strstart=0,r.block_start=0,r.insert=0),(o=new Uint8Array(r.w_size)).set(e.subarray(n-r.w_size,n),0),e=o,n=r.w_size);var o=t.avail_in,s=t.next_in,a=t.input;for(t.avail_in=n,t.next_in=0,t.input=e,wt(r);3<=r.lookahead;){for(var u=r.strstart,c=r.lookahead-2;r.ins_h=Et(r,r.ins_h,r.window[u+3-1]),r.prev[u&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=u,u++,--c;);r.strstart=u,r.lookahead=2,wt(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,t.next_in=s,t.input=a,t.avail_in=o,r.wrap=i,rt}(this.strm,r))!==Ft)throw new Error(W[n]);this._dict_set=!0}}function Zt(t,e){if((e=new Yt(e)).push(t,!0),e.err)throw e.msg||W[e.err];return e.result}function Kt(t,e){return(e=e||{}).raw=!0,Zt(t,e)}function $t(t,e){return(e=e||{}).gzip=!0,Zt(t,e)}Yt.prototype.push=function(t,e){var n,r,i,o,s=this.strm,a=this.options.chunkSize;if(this.ended)return!1;for(r=e===~~e?e:!0===e?Gt:Bt,s.input="string"==typeof t?Dt(t):"[object ArrayBuffer]"===Ut.call(t)?new Uint8Array(t):t,s.next_in=0,s.avail_in=s.input.length;;)if(0===s.avail_out&&(s.output=new Uint8Array(a),s.next_out=0,s.avail_out=a),(r===Ht||r===zt)&&s.avail_out<=6)this.onData(s.output.subarray(0,s.next_out)),s.avail_out=0;else{if((n=function(t,e){if(Ot(t)||nt<e||e<0)return t?w(t,ot):ot;var n=t.state;if(!t.output||0!==t.avail_in&&!t.input||n.status===yt&&e!==et)return w(t,0===t.avail_out?at:ot);var r=n.last_flush;if(n.last_flush=e,0!==n.pending){if(Tt(t),0===t.avail_out)return n.last_flush=-1,rt}else if(0===t.avail_in&&R(e)<=R(r)&&e!==et)return w(t,at);if(n.status===yt&&0!==t.avail_in)return w(t,at);if(n.status===mt&&0===n.wrap&&(n.status=vt),n.status===mt&&(r=pt+(n.w_bits-8<<4)<<8,r|=(n.strategy>=lt||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(r|=32),O(n,r+=31-r%31),0!==n.strstart&&(O(n,t.adler>>>16),O(n,65535&t.adler)),t.adler=1,n.status=vt,Tt(t),0!==n.pending))return n.last_flush=-1,rt;if(57===n.status)if(t.adler=0,k(n,31),k(n,139),k(n,8),n.gzhead)k(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),k(n,255&n.gzhead.time),k(n,n.gzhead.time>>8&255),k(n,n.gzhead.time>>16&255),k(n,n.gzhead.time>>24&255),k(n,9===n.level?2:n.strategy>=lt||n.level<2?4:0),k(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(k(n,255&n.gzhead.extra.length),k(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(t.adler=V(t.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(k(n,0),k(n,0),k(n,0),k(n,0),k(n,0),k(n,9===n.level?2:n.strategy>=lt||n.level<2?4:0),k(n,3),n.status=vt,Tt(t),0!==n.pending)return n.last_flush=-1,rt;if(69===n.status){if(n.gzhead.extra){for(var i=n.pending,o=(65535&n.gzhead.extra.length)-n.gzindex;n.pending+o>n.pending_buf_size;){var s=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+s),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>i&&(t.adler=V(t.adler,n.pending_buf,n.pending-i,i)),n.gzindex+=s,Tt(t),0!==n.pending)return n.last_flush=-1,rt;i=0,o-=s}r=new Uint8Array(n.gzhead.extra),n.pending_buf.set(r.subarray(n.gzindex,n.gzindex+o),n.pending),n.pending+=o,n.gzhead.hcrc&&n.pending>i&&(t.adler=V(t.adler,n.pending_buf,n.pending-i,i)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){var a,u=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>u&&(t.adler=V(t.adler,n.pending_buf,n.pending-u,u)),Tt(t),0!==n.pending)return n.last_flush=-1,rt;u=0}}while(a=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,k(n,a),0!=a);n.gzhead.hcrc&&n.pending>u&&(t.adler=V(t.adler,n.pending_buf,n.pending-u,u)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){var c,l=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>l&&(t.adler=V(t.adler,n.pending_buf,n.pending-l,l)),Tt(t),0!==n.pending)return n.last_flush=-1,rt;l=0}}while(c=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,k(n,c),0!=c);n.gzhead.hcrc&&n.pending>l&&(t.adler=V(t.adler,n.pending_buf,n.pending-l,l))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(Tt(t),0!==n.pending))return n.last_flush=-1,rt;k(n,255&t.adler),k(n,t.adler>>8&255),t.adler=0}if(n.status=vt,Tt(t),0!==n.pending)return n.last_flush=-1,rt}if(0!==t.avail_in||0!==n.lookahead||e!==X&&n.status!==yt){if(r=0===n.level?A(n,e):n.strategy===lt?function(t,e){for(var n;;){if(0===t.lookahead&&(wt(t),0===t.lookahead)){if(e===X)return 1;break}if(t.match_length=0,n=$(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(I(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===et?(I(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(I(t,!1),0===t.strm.avail_out)?1:2}(n,e):n.strategy===ht?function(t,e){for(var n,r,i,o,s=t.window;;){if(t.lookahead<=gt){if(wt(t),t.lookahead<=gt&&e===X)return 1;if(0===t.lookahead)break}if(t.match_length=0,3<=t.lookahead&&0<t.strstart&&(r=s[i=t.strstart-1])===s[++i]&&r===s[++i]&&r===s[++i]){for(o=t.strstart+gt;r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&i<o;);t.match_length=gt-(o-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(3<=t.match_length?(n=$(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=$(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(I(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===et?(I(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(I(t,!1),0===t.strm.avail_out)?1:2}(n,e):It[n.level].func(n,e),3!==r&&4!==r||(n.status=yt),1===r||3===r)return 0===t.avail_out&&(n.last_flush=-1),rt;if(2===r&&(e===J?Q(n):e!==nt&&(Z(n,0,0,!1),e===tt)&&(bt(n.head),0===n.lookahead)&&(n.strstart=0,n.block_start=0,n.insert=0),Tt(t),0===t.avail_out))return n.last_flush=-1,rt}return e===et&&(n.wrap<=0||(2===n.wrap?(k(n,255&t.adler),k(n,t.adler>>8&255),k(n,t.adler>>16&255),k(n,t.adler>>24&255),k(n,255&t.total_in),k(n,t.total_in>>8&255),k(n,t.total_in>>16&255),k(n,t.total_in>>24&255)):(O(n,t.adler>>>16),O(n,65535&t.adler)),Tt(t),0<n.wrap&&(n.wrap=-n.wrap),0===n.pending))?it:rt}(s,r))===qt)return 0<s.next_out&&this.onData(s.output.subarray(0,s.next_out)),o=void 0,n=Ot(i=this.strm)?ot:(o=i.state.status,i.state=null,o===vt?w(i,st):rt),this.onEnd(n),this.ended=!0,n===Ft;if(0!==s.avail_out){if(0<r&&0<s.next_out)this.onData(s.output.subarray(0,s.next_out)),s.avail_out=0;else if(0===s.avail_in)break}else this.onData(s.output)}return!0},Yt.prototype.onData=function(t){this.chunks.push(t)},Yt.prototype.onEnd=function(t){t===Ft&&(this.result=function(t){for(var e=0,n=0,r=t.length;n<r;n++)e+=t[n].length;for(var i=new Uint8Array(e),o=0,s=0,a=t.length;o<a;o++){var u=t[o];i.set(u,s),s+=u.length}return i}(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Qt={Deflate:Yt,deflate:F=Zt,deflateRaw:Kt,gzip:$t,constants:Y};t.Deflate=Yt,t.constants=Y,t.default=Qt,t.deflate=F,t.deflateRaw=Kt,t.gzip=$t,Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,n){"use strict";function r(t,e,n,r){if(this.bucketSize=1,this.tokensPerInterval=1,this.interval=1e3,this.parentBucket=null,this.content=0,this.lastDrip=0,this.bucketSize=t,this.tokensPerInterval=e,"string"==typeof n)switch(n){case"sec":case"second":this.interval=1e3;break;case"min":case"minute":this.interval=6e4;break;case"hr":case"hour":this.interval=36e5;break;case"day":this.interval=864e5;break;default:throw new Error("Invaid interval "+n)}else this.interval=n;this.parentBucket=r,this.content=0,this.lastDrip=+new Date}Object.defineProperty(e,"__esModule",{value:!0}),e.TokenBucket=void 0,r.prototype.removeTokens=function(t,e){var n=this;return this.bucketSize?t>this.bucketSize?(setTimeout(e.bind(null,"Requested tokens "+t+" exceeds bucket size "+this.bucketSize,null),0),!1):(this.drip(),t>this.content?r():this.parentBucket?this.parentBucket.removeTokens(t,(function(i,o){return i?e(i,null):t>n.content?r():(n.content-=t,void e(null,Math.min(o,n.content)))})):(this.content-=t,setTimeout(e.bind(null,null,this.content),0),!0)):(setTimeout(e.bind(null,null,t,Number.POSITIVE_INFINITY),0),!0);function r(){var r=Math.ceil(n.interval/n.tokensPerInterval*(t-n.content));return setTimeout((function(){n.removeTokens(t,e)}),r),!1}},r.prototype.tryRemoveTokens=function(t){if(this.bucketSize){if(t>this.bucketSize)return!1;if(this.drip(),t>this.content)return!1;if(this.parentBucket&&!this.parentBucket.tryRemoveTokens(t))return!1;this.content-=t}return!0},r.prototype.drip=function(){var t,e;this.tokensPerInterval?(e=+new Date,t=Math.max(e-this.lastDrip,0),this.lastDrip=e,e=t*(this.tokensPerInterval/this.interval),this.content=Math.min(this.content+e,this.bucketSize)):this.content=this.bucketSize},e.TokenBucket=r},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n=n||Promise)((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):((e=t.value)instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s={next:a(0),throw:a(1),return:a(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){var u=[s,a];if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&u[0]?r.return:u[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,u[1])).done)return i;switch(r=0,(u=i?[2&u[0],i.value]:u)[0]){case 0:case 1:i=u;break;case 4:return o.label++,{value:u[1],done:!1};case 5:o.label++,r=u[1],u=[0];continue;case 7:u=o.ops.pop(),o.trys.pop();continue;default:if(!(i=0<(i=o.trys).length&&i[i.length-1])&&(6===u[0]||2===u[0])){o=0;continue}if(3===u[0]&&(!i||u[1]>i[0]&&u[1]<i[3]))o.label=u[1];else if(6===u[0]&&o.label<i[1])o.label=i[1],i=u;else{if(!(i&&o.label<i[2])){i[2]&&o.ops.pop(),o.trys.pop();continue}o.label=i[2],o.ops.push(u)}}u=e.call(t,o)}catch(a){u=[6,a],r=0}finally{n=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},s=(Object.defineProperty(e,"__esModule",{value:!0}),e.ZegoStoreHandler=void 0,n(11)),a=n(5),u=n(4),c=o(n(12));function l(t,e,n,r,i,o){this.name=t,this.storeName=e,this.config=n,this.traceType=r,this.staticConfig=i,this.stateCenter=o,this.storeSize=0,this.storeTime=0,this.storeDelPer=u.STORE_SIZE.storeDelPer,this.updateTimeFreq=6e4,this.storeSleepInterval=6e5,this.droping=!1,this.bufferData=[],this.updateTimer=null,this.interSymbol="#",this.drops=[],this.storesKeys="",this.transStores=[],this.store=s.createZegoStore(t,n.env,e),this.commonStore=s.createZegoStore("data_common",n.env,"reporter")}Object.defineProperty(l.prototype,"KEY",{get:function(){return"z_t_"+this.config.appID},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"STORES_KEY",{get:function(){return"z_store_keys"},enumerable:!1,configurable:!0}),l.prototype.init=function(){return r(this,void 0,void 0,(function(){var t,e;return i(this,(function(n){switch(n.label){case 0:return n.trys.push([0,6,,7]),this.setCommonStoreState(),[4,this.transferStoreData()];case 1:return n.sent(),[4,this.commonStore.getItem(this.name+this.interSymbol+this.storeName)];case 2:return(t=n.sent())?[3,4]:[4,this.commonStore.setItem(this.name+this.interSymbol+this.storeName,e={storeSize:this.storeSize,lock:0,pros:1})];case 3:return n.sent(),[3,5];case 4:e="string"==typeof t?JSON.parse(t):t,this.storeSize=e.storeSize,n.label=5;case 5:return[3,7];case 6:return n.sent(),[3,7];case 7:return[2]}}))}))},l.prototype.uninit=function(){this.updateTimer&&(clearTimeout(this.updateTimer),this.updateTimer=null)},l.prototype.setCommonStoreState=function(){var t=this,e=(this.getStorage(this.STORES_KEY)||"").split(";");this.transStores=e.filter((function(e){return e.includes(t.config.appID+"")})),e=e.filter((function(e){return!e.includes(t.config.appID+"")})),this.storesKeys=e.join(";")},l.prototype.resetCommonStore=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return this.saveStorage(this.STORES_KEY,this.storesKeys+(0<this.storesKeys.length?";":"")+this.name+this.interSymbol+this.storeName),[4,this.commonStore.setItem(this.name+this.interSymbol+this.storeName,{storeSize:this.storeSize,lock:0,pros:0})];case 1:return t.sent(),[2]}}))}))},l.prototype.transferStoreData=function(){return r(this,void 0,void 0,(function(){var t,e,n,o,u=this;return i(this,(function(c){switch(c.label){case 0:return[4,this.commonStore.keys()];case 1:t=c.sent(),e=function(e){var o,c,l,h,f,d,p,g;return i(this,(function(_){switch(_.label){case 0:return(o=t[e])===n.name+n.interSymbol+n.storeName?[3,9]:[4,n.commonStore.getItem(o)];case 1:return(c="string"==typeof(c=_.sent())?JSON.parse(c):c).lock||c.pros&&!n.transStores.includes(o)?[3,9]:(h=o.split(n.interSymbol),[4,(f=s.createZegoStore(l=h[0],n.config.env,h=h[1])).keys()]);case 2:return 0!=(d=_.sent()).length?[3,3]:[3,8];case 3:return c.lock=1,[4,n.commonStore.setItem(o,c)];case 4:_.sent(),p=function(t){var e,o,s;return i(this,(function(c){switch(c.label){case 0:return[4,f.getItem(e=d[t])];case 1:return o=c.sent(),-1!==e.indexOf("pending")?o&&JSON.parse(o).forEach((function(t){return r(u,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.storeData(t)];case 1:return e.sent(),[2]}}))}))})):(s=a.analyzeKey(e),n.storeData({level:s.level,timestamp:s.timestamp,seq:s=s.seq,content:o})),setTimeout((function(){return r(u,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,f.removeItem(e)];case 1:return t.sent(),[2]}}))}))}),300),[2]}}))},g=0,_.label=5;case 5:return g<d.length?[5,p(g)]:[3,8];case 6:_.sent(),_.label=7;case 7:return g++,[3,5];case 8:n.drops.push({name:l,storeName:h}),_.label=9;case 9:return[2]}}))},n=this,o=0,c.label=2;case 2:return o<t.length?[5,e(o)]:[3,5];case 3:c.sent(),c.label=4;case 4:return o++,[3,2];case 5:return this.transportStorageData(),setTimeout((function(){return r(u,void 0,void 0,(function(){var t,e,n;return i(this,(function(r){switch(r.label){case 0:t=0,r.label=1;case 1:if(!(t<this.drops.length))return[3,7];e=(n=this.drops[t]).name,n=n.storeName,r.label=2;case 2:return r.trys.push([2,5,,6]),[4,this.dropInstance(e,n)];case 3:return r.sent(),[4,this.commonStore.removeItem(e+this.interSymbol+n)];case 4:case 5:return r.sent(),[3,6];case 6:return t++,[3,1];case 7:return[2]}}))}))}),1e3),[2]}}))}))},l.prototype.dropInstance=function(t,e){return new Promise((function(n,r){c.default.dropInstance({name:t+":"+e}).then((function(){n()})).catch((function(t){r(t)}))}))},l.prototype.setDropCallBack=function(t){this.dropCallBack=t},l.prototype.storeData=function(t){var e=this;return new Promise((function(n,o){return r(e,void 0,void 0,(function(){var e,r,o,s,u=this;return i(this,(function(i){switch(i.label){case 0:r=t.content,o=(e=t.level)+"_"+(o=t.timestamp)+"_"+t.seq,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.store.getItem(o)];case 2:return i.sent()?(n(),[2]):[3,4];case 3:return i.sent(),[3,4];case 4:if(this.droping)return this.bufferData.push(t),[2];if(s=a.calculateMemSize(o)+a.calculateMemSize(r),this.staticConfig.totalDBSize-s<=0)return this.dropDBData(e,o,r).then((function(){u.droping=!1,u.bufferDump()})).catch((function(t){})),n(),[2];i.label=5;case 5:return i.trys.push([5,8,,9]),[4,this.store.setItem(o,r)];case 6:return i.sent(),this.storeSize+=s,this.staticConfig.totalDBSize-=s,[4,this.refreshStoreInfo()];case 7:return i.sent(),n(),[3,9];case 8:return"QuotaExceededError"===i.sent().name&&this.dropDBData(e,o,r).then((function(){u.droping=!1,u.bufferDump()})).catch((function(t){})),[3,9];case 9:return[2]}}))}))}))},l.prototype.loadPendingData=function(){return r(this,void 0,void 0,(function(){var t=this;return i(this,(function(e){switch(e.label){case 0:return[4,this.store.keys()];case 1:return e.sent().forEach((function(e){return r(t,void 0,void 0,(function(){var t,n=this;return i(this,(function(o){switch(o.label){case 0:return-1===e.indexOf("pending")?[3,3]:[4,this.store.getItem(e)];case 1:return(t=o.sent())?(JSON.parse(t).forEach((function(t){return r(n,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.storeData(t)];case 1:return e.sent(),[2]}}))}))})),[4,this.store.removeItem(e)]):[3,3];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))})),[2]}}))}))},l.prototype.storePendingData=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.store.setItem("pending"+(new Date).getTime(),JSON.stringify(t))];case 1:return e.sent(),[2]}}))}))},l.prototype.bufferDump=function(){return r(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return(t=this.bufferData.pop())?[4,this.storeData(t)]:[3,2];case 1:e.sent(),this.bufferDump(),e.label=2;case 2:return[2]}}))}))},l.prototype.dropDBData=function(t,e,n){return r(this,void 0,void 0,(function(){var t=this;return i(this,(function(o){return this.droping=!0,[2,new Promise((function(o,s){return r(t,void 0,void 0,(function(){var t,r,u,c,l;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,10,,11]),[4,this.store.keys()];case 1:(t=i.sent()).reverse(),r=Math.ceil(t.length*this.storeDelPer),u=0,i.label=2;case 2:return u<r?[4,this.store.getItem(t[u])]:[3,7];case 3:return null==(c=i.sent())?[3,6]:[4,this.store.removeItem(t[u])];case 4:return i.sent(),l=a.calculateMemSize(t[u])+a.calculateMemSize(c),this.staticConfig.totalDBSize+=l,this.storeSize-=l,[4,this.refreshStoreInfo()];case 5:i.sent(),this.dropCallBack(c),i.label=6;case 6:return u++,[3,2];case 7:return[4,this.store.setItem(e,n)];case 8:return i.sent(),this.storeSize+=a.calculateMemSize(e)+a.calculateMemSize(n),[4,this.refreshStoreInfo()];case 9:return i.sent(),o(),[3,11];case 10:return l=i.sent(),s(l),[3,11];case 11:return[2]}}))}))}))]}))}))},l.prototype.removeDataItem=function(t){var e=this;return new Promise((function(n,o){return r(e,void 0,void 0,(function(){var e,r,s,u,c;return i(this,(function(i){switch(i.label){case 0:e=(e=t.level)+"_"+(s=t.timestamp)+"_"+(u=t.seq),i.label=1;case 1:return i.trys.push([1,6,,7]),[4,this.store.getItem(e)];case 2:return(r=i.sent())?[4,this.store.removeItem(e)]:[3,5];case 3:return i.sent(),s=a.calculateMemSize(1==this.config.env?JSON.parse(r):r),u=a.calculateMemSize(e)+s,this.storeSize-=u,this.staticConfig.totalDBSize+=u,this.traceType.DB_O_DONE+=u,[4,this.refreshStoreInfo()];case 4:i.sent(),n(),i.label=5;case 5:return[3,7];case 6:return c=i.sent(),o(c),[3,7];case 7:return[2]}}))}))}))},l.prototype.refreshStoreInfo=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),[4,this.commonStore.getItem(this.name+this.interSymbol+this.storeName)];case 1:return t.sent()?[4,this.commonStore.setItem(this.name+this.interSymbol+this.storeName,{storeSize:this.storeSize,lock:0,pros:1})]:[3,3];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:return t.sent(),[3,5];case 5:return[2]}}))}))},l.prototype.readStoreDataItem=function(){var t=this;return new Promise((function(e,n){return r(t,void 0,void 0,(function(){var t,r,o,s;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,this.store.keys()];case 1:return t=i.sent(),[4,this.store.getItem(t[0])];case 2:return r=i.sent(),o=a.analyzeKey(t[0]),e({level:s=o.level,timestamp:o.timestamp,seq:o=o.seq,content:r}),[3,4];case 3:return s=i.sent(),n(s),[3,4];case 4:return[2]}}))}))}))},l.prototype.loadDBData=function(t,e,n,o){var s=this;return new Promise((function(u,c){return r(s,void 0,void 0,(function(){var r,s,l,h,f,d,p,g,_,m;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,6,,7]),[4,this.store.keys()];case 1:r=i.sent(),s=[],d=f=h=l=0,i.label=2;case 2:return d<r.length?o(r[d])?[3,4]:[4,this.store.getItem(r[d])]:[3,5];case 3:if(null==(p=i.sent()))return[3,4];if(g=a.analyzeKey(r[d]),s.push({level:_=g.level,timestamp:m=g.timestamp,seq:g=g.seq,content:p,key:r[d]}),_=a.calculateMemSize(p),h+=_,t<=(l+=_)&&(l=0,f++),e<=f&&n<=h)return[3,5];i.label=4;case 4:return d++,[3,2];case 5:return u({datas:s,len:h}),[3,7];case 6:return m=i.sent(),c(m),[3,7];case 7:return[2]}}))}))}))},l.prototype.sortKeys=function(t,e){void 0===e&&(e=!1),t.sort((function(t,e){return t=t.split("_"),+(e=e.split("_"))[0]-+t[0]||+e[1]-+t[1]||+e[2]-+t[2]})),e&&t.reverse()},l.prototype.saveStorage=function(t,e){try{localStorage.setItem(t,e)}catch(t){this.stateCenter._log.debug("storage set err")}},l.prototype.getStorage=function(t){try{return localStorage.getItem(t)}catch(t){this.stateCenter._log.debug("storage get err")}},l.prototype.saveDataToStorage=function(t){try{this.saveStorage(this.KEY+"_"+t.level+"_"+t.timestamp+"_"+t.seq,t.content)}catch(t){this.stateCenter._log.debug("saveDataToStorage "+JSON.stringify(t))}},l.prototype.transportStorageData=function(){for(var t=[],e=0;e<localStorage.length;e++){var n,r,i,o,s=localStorage.key(e);this.stateCenter._log.debug("transportStorageData "+s),null!=s&&s.startsWith(this.KEY)&&(i=s.replace(this.KEY+"_",""),n=(i=a.analyzeKey(i)).level,r=i.timestamp,i=i.seq,"string"==typeof(o=this.getStorage(s))&&this.storeData({level:n,timestamp:r,seq:i,content:o}),t.push(s))}setTimeout((function(){for(var e=0;e<t.length;e++)localStorage.removeItem(t[e])}),100)},e.ZegoStoreHandler=l},function(t,e,n){"use strict";var r=n(32),i=n(33).Buffer;function o(t){return function(e){if(i.isBuffer(e))return e.length;switch(typeof e){case"string":return e.length*r.STRING;case"boolean":return r.BOOLEAN;case"number":return r.NUMBER;case"symbol":return Symbol.keyFor&&Symbol.keyFor(e)?Symbol.keyFor(e).length*r.STRING:(e.toString().length-8)*r.STRING;case"object":if(Array.isArray(e))return e.map(o(t)).reduce((function(t,e){return t+e}),0);var n=t,s=e;if(null==s)return 0;for(var a=0,u=function(t){var e,n=[];for(e in t)n.push(e);return Object.getOwnPropertySymbols&&(t=Object.getOwnPropertySymbols(t),Array.prototype.push.apply(n,t)),n}(s),c=0;c<u.length;c++){var l=u[c];if("object"==typeof s[l]&&null!==s[l]){if(n.has(s[l]))continue;n.add(s[l])}a+=o(n)(l);try{a+=o(n)(s[l])}catch(n){n instanceof RangeError&&(a=0)}}return a;default:return 0}}}t.exports=function(t){return o(new WeakSet)(t)}},function(t,e){t.exports={STRING:2,BOOLEAN:4,NUMBER:8}},function(t,e,n){"use strict";(function(t){var r=n(35),i=n(36),o=n(37);function s(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(t=null===t?new u(e):t).length=e,t}function u(t,e,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,n);if("number"!=typeof t)return c(this,t,e,n);if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}function c(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer){var i=t,s=e,c=n;if(c<0||s.byteLength<c)throw new RangeError("'offset' is out of bounds");if(s.byteLength<c+(r||0))throw new RangeError("'length' is out of bounds");return s=void 0===c&&void 0===r?new Uint8Array(s):void 0===r?new Uint8Array(s,c):new Uint8Array(s,c,r),u.TYPED_ARRAY_SUPPORT?(i=s).__proto__=u.prototype:i=f(i,s),i}if("string"!=typeof e){if(c=t,u.isBuffer(r=e))return 0!==(c=a(c,s=0|d(r.length))).length&&r.copy(c,0,0,s),c;if(r){if("undefined"!=typeof ArrayBuffer&&r.buffer instanceof ArrayBuffer||"length"in r)return"number"!=typeof r.length||(s=r.length)!=s?a(c,0):f(c,r);if("Buffer"===r.type&&o(r.data))return f(c,r.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}if(i=t,r=e,u.isEncoding(t="string"==typeof(t=n)&&""!==t?t:"utf8"))return(r=(i=a(i,e=0|p(r,t))).write(r,t))!==e?i.slice(0,r):i;throw new TypeError('"encoding" must be a valid string encoding')}function l(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e){if(l(e),t=a(t,e<0?0:0|d(e)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function f(t,e){var n=e.length<0?0:0|d(e.length);t=a(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function d(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function p(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;var n=(t="string"!=typeof t?""+t:t).length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return O(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return N(t).length;default:if(r)return O(t).length;e=(""+e).toLowerCase(),r=!0}}function g(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function _(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,(n=(n=isNaN(n)?i?0:t.length-1:n)<0?t.length+n:n)>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:m(t,e,n,r,i);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?(i?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(t,e,n):m(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function m(t,e,n,r,i){var o=1,s=t.length,a=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s/=o=2,a/=2,n/=2}function u(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(i)for(var c=-1,l=n;l<s;l++)if(u(t,l)===u(e,-1===c?0:l-c)){if(l-(c=-1===c?l:c)+1===a)return c*o}else-1!==c&&(l-=l-c),c=-1;else for(l=n=s<n+a?s-a:n;0<=l;l--){for(var h=!0,f=0;f<a;f++)if(u(t,l+f)!==u(e,f)){h=!1;break}if(h)return l}return-1}function v(t,e,n,r){return A(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function y(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,s,a,u,c=t[i],l=null,h=239<c?4:223<c?3:191<c?2:1;if(i+h<=n)switch(h){case 1:c<128&&(l=c);break;case 2:128==(192&(o=t[i+1]))&&127<(u=(31&c)<<6|63&o)&&(l=u);break;case 3:s=t[i+2],128==(192&(o=t[i+1]))&&128==(192&s)&&2047<(u=(15&c)<<12|(63&o)<<6|63&s)&&(u<55296||57343<u)&&(l=u);break;case 4:s=t[i+2],a=t[i+3],128==(192&(o=t[i+1]))&&128==(192&s)&&128==(192&a)&&65535<(u=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)&&u<1114112&&(l=u)}null===l?(l=65533,h=1):65535<l&&(r.push((l-=65536)>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=h}var f=r,d=f.length;if(d<=b)return String.fromCharCode.apply(String,f);for(var p="",g=0;g<d;)p+=String.fromCharCode.apply(String,f.slice(g,g+=b));return p}e.Buffer=u,e.SlowBuffer=function(t){return u.alloc(+(t=+t!=t?0:t))},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=s(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return c(null,t,e,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol)&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0}),u.alloc=function(t,e,n){return l(t),t<=0||void 0===e?a(null,t):"string"==typeof n?a(null,t).fill(e,n):a(null,t).fill(e)},u.allocUnsafe=function(t){return h(null,t)},u.allocUnsafeSlow=function(t){return h(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);if(void 0===e)for(i=e=0;i<t.length;++i)e+=t[i].length;for(var n=u.allocUnsafe(e),r=0,i=0;i<t.length;++i){var s=t[i];if(!u.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,r),r+=s.length}return n},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0==t?"":0===arguments.length?y(this,0,t):function(t,e,n){var i,o,s=!1;if((e=void 0===e||e<0?0:e)>this.length)return"";if((n=void 0===n||n>this.length?this.length:n)<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t=t||"utf8";;)switch(t){case"hex":var a=e,u=n,c=this.length;(!u||u<0||c<u)&&(u=c);for(var l="",h=a=!a||a<0?0:a;h<u;++h)l+=(o=this[h])<16?"0"+o.toString(16):o.toString(16);return l;case"utf8":case"utf-8":return y(this,e,n);case"ascii":c=e;for(var f=n,d="",p=(f=Math.min(this.length,f),c);p<f;++p)d+=String.fromCharCode(127&this[p]);return d;case"latin1":case"binary":a=e;for(var g=n,_="",m=(g=Math.min(this.length,g),a);m<g;++m)_+=String.fromCharCode(this[m]);return _;case"base64":return v=this,i=n,0===(b=e)&&i===v.length?r.fromByteArray(v):r.fromByteArray(v.slice(b,i));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(var v=e,b=n,S=this.slice(v,b),E="",T=0;T<S.length;T+=2)E+=String.fromCharCode(S[T]+256*S[T+1]);return E;default:if(s)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),s=!0}}.apply(this,arguments)},u.prototype.equals=function(t){if(u.isBuffer(t))return this===t||0===u.compare(this,t);throw new TypeError("Argument must be a Buffer")},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return 0<this.length&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n)&&(t+=" ... "),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,r,i){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),(e=void 0===e?0:e)<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(i<=r&&n<=e)return 0;if(i<=r)return-1;if(n<=e)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0),a=Math.min(o,s),c=this.slice(r,i),l=t.slice(e,n),h=0;h<a;++h)if(c[h]!==l[h]){o=c[h],s=l[h];break}return o<s?-1:s<o?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return _(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return _(this,t,e,n,!1)},u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||i<n)&&(n=i),0<t.length&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r=r||"utf8";for(var o,s,a,u,c=!1;;)switch(r){case"hex":var l,h=t,f=n,d=(l=Number(e)||0,this.length-l);if((!f||d<(f=Number(f)))&&(f=d),(d=h.length)%2!=0)throw new TypeError("Invalid hex string");d/2<f&&(f=d/2);for(var p=0;p<f;++p){var g=parseInt(h.substr(2*p,2),16);if(isNaN(g))return p;this[l+p]=g}return p;case"utf8":case"utf-8":return s=n,A(O(t,(o=this).length-(d=e)),o,d,s);case"ascii":case"latin1":case"binary":return v(this,t,e,n);case"base64":return o=this,s=e,a=n,A(N(t),o,s,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return u=n,A(function(t,e){for(var n,r,i=[],o=0;o<t.length&&!((e-=2)<0);++o)r=(n=t.charCodeAt(o))>>8,i.push(n%256),i.push(r);return i}(t,this.length-(a=e)),this,a,u);default:if(c)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),c=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var b=4096;function S(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(n<t+e)throw new RangeError("Trying to access beyond buffer length")}function E(t,e,n,r,i,o){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(i<e||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function T(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function C(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function w(t,e,n,r){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function R(t,e,n,r,o){return o||w(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function I(t,e,n,r,o){return o||w(t,0,n,8),i.write(t,e,n,r,52,8),n+8}u.prototype.slice=function(t,e){var n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):n<t&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):n<e&&(e=n),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(i=this.subarray(t,e)).__proto__=u.prototype;else for(var r=e-t,i=new u(r,void 0),o=0;o<r;++o)i[o]=this[o+t];return i},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||S(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||S(t,e,this.length);for(var r=this[t+--e],i=1;0<e&&(i*=256);)r+=this[t+--e]*i;return r},u.prototype.readUInt8=function(t,e){return e||S(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||S(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||S(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||S(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||S(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||S(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return(i*=128)<=r&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||S(t,e,this.length);for(var r=e,i=1,o=this[t+--r];0<r&&(i*=256);)o+=this[t+--r]*i;return(i*=128)<=o&&(o-=Math.pow(2,8*e)),o},u.prototype.readInt8=function(t,e){return e||S(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){return e||S(t,2,this.length),32768&(e=this[t]|this[t+1]<<8)?4294901760|e:e},u.prototype.readInt16BE=function(t,e){return e||S(t,2,this.length),32768&(e=this[t+1]|this[t]<<8)?4294901760|e:e},u.prototype.readInt32LE=function(t,e){return e||S(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||S(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||S(t,4,this.length),i.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||S(t,4,this.length),i.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||S(t,8,this.length),i.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||S(t,8,this.length),i.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,r){t=+t,e|=0,n|=0,r||E(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,r){t=+t,e|=0,n|=0,r||E(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;0<=--i&&(o*=256);)this[e+i]=t/o&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||E(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||E(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):T(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||E(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):T(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||E(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):C(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||E(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):C(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,r){t=+t,e|=0,r||E(this,t,e,n,(r=Math.pow(2,8*n-1))-1,-r);var i=0,o=1,s=0;for(this[e]=255&t;++i<n&&(o*=256);)t<0&&0===s&&0!==this[e+i-1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+n},u.prototype.writeIntBE=function(t,e,n,r){t=+t,e|=0,r||E(this,t,e,n,(r=Math.pow(2,8*n-1))-1,-r);var i=n-1,o=1,s=0;for(this[e+i]=255&t;0<=--i&&(o*=256);)t<0&&0===s&&0!==this[e+i+1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||E(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&(t=t<0?255+t+1:t),e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||E(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):T(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||E(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):T(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||E(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):C(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||E(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):C(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return R(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return R(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return I(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return I(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(n=n||0,r||0===r||(r=this.length),e>=t.length&&(e=t.length),(r=0<r&&r<n?n:r)===n)return 0;if(0===t.length||0===this.length)return 0;if((e=e||0)<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length);var i,o=(r=t.length-e<r-n?t.length-e+n:r)-n;if(this===t&&n<e&&e<r)for(i=o-1;0<=i;--i)t[i+e]=this[i+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},u.prototype.fill=function(t,e,n,r){if("string"==typeof t){var i;if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length&&(i=t.charCodeAt(0))<256&&(t=i),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(!(n<=e))if(e>>>=0,n=void 0===n?this.length:n>>>0,"number"==typeof(t=t||0))for(a=e;a<n;++a)this[a]=t;else for(var o=u.isBuffer(t)?t:O(new u(t,r).toString()),s=o.length,a=0;a<n-e;++a)this[a+e]=o[a%s];return this};var k=/[^+\/0-9A-Za-z-_]/g;function O(t,e){e=e||1/0;for(var n,r=t.length,i=null,o=[],s=0;s<r;++s){if(55295<(n=t.charCodeAt(s))&&n<57344){if(!i){if(56319<n){-1<(e-=3)&&o.push(239,191,189);continue}if(s+1===r){-1<(e-=3)&&o.push(239,191,189);continue}i=n;continue}if(n<56320){-1<(e-=3)&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&-1<(e-=3)&&o.push(239,191,189);if(i=null,n<128){if(--e<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function N(t){return r.toByteArray(function(t){var e;if((t=((e=t).trim?e.trim():e.replace(/^\s+|\s+$/g,"")).replace(k,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function A(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(34))},function(t,e){var n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";e.byteLength=function(t){return 3*((t=u(t))[0]+(t=t[1]))/4-t},e.toByteArray=function(t){for(var e,n=(r=u(t))[0],r=r[1],s=new o(3*(n+r)/4-r),a=0,c=0<r?n-4:n,l=0;l<c;l+=4)e=i[t.charCodeAt(l)]<<18|i[t.charCodeAt(l+1)]<<12|i[t.charCodeAt(l+2)]<<6|i[t.charCodeAt(l+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=255&e;return 2===r&&(e=i[t.charCodeAt(l)]<<2|i[t.charCodeAt(l+1)]>>4,s[a++]=255&e),1===r&&(e=i[t.charCodeAt(l)]<<10|i[t.charCodeAt(l+1)]<<4|i[t.charCodeAt(l+2)]>>2,s[a++]=e>>8&255,s[a++]=255&e),s},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o=[],s=0,a=n-i;s<a;s+=16383)o.push(function(t,e){for(var n,i=[],o=s;o<e;o+=3)i.push(r[(n=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]))>>18&63]+r[n>>12&63]+r[n>>6&63]+r[63&n]);return i.join("")}(t,a<s+16383?a:s+16383));return 1==i?o.push(r[(e=t[n-1])>>2]+r[e<<4&63]+"=="):2==i&&o.push(r[(e=(t[n-2]<<8)+t[n-1])>>10]+r[e>>4&63]+r[e<<2&63]+"="),o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)r[a]=s[a],i[s.charCodeAt(a)]=a;function u(t){var e=t.length;if(0<e%4)throw new Error("Invalid string. Length must be a multiple of 4");return e=(t=-1===(t=t.indexOf("="))?e:t)===e?0:4-t%4,[t,e]}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,l=-7,h=n?i-1:0,f=n?-1:1;for(i=t[e+h],h+=f,o=i&(1<<-l)-1,i>>=-l,l+=a;0<l;o=256*o+t[e+h],h+=f,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;0<l;s=256*s+t[e+h],h+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(i?-1:1);s+=Math.pow(2,r),o-=c}return(i?-1:1)*s*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var s,a,u=8*o-i-1,c=(1<<u)-1,l=c>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,d=r?1:-1;for(o=e<0||0===e&&1/e<0?1:0,e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(r=Math.pow(2,-s))<1&&(s--,r*=2),2<=(e+=1<=s+l?h/r:h*Math.pow(2,1-l))*r&&(s++,r/=2),c<=s+l?(a=0,s=c):1<=s+l?(a=(e*r-1)*Math.pow(2,i),s+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,i),s=0));8<=i;t[n+f]=255&a,f+=d,a/=256,i-=8);for(s=s<<i|a,u+=i;0<u;t[n+f]=255&s,f+=d,s/=256,u-=8);t[n+f-d]|=128*o}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){"use strict";var r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(r(arguments[e]));return t},o=(Object.defineProperty(e,"__esModule",{value:!0}),e.PendingQueue=void 0,n(0)),s=n(5);function a(t,e,n,r){var i=this;this.levels=t,this.product=e,this.staticConfig=n,this.stateCenter=r,this.byteLength=0,this.size=0,this.pendingDataSize=0,this.cacheMap=new Map,t.forEach((function(t){i.cacheMap.set(t,new o.Queue)}))}a.prototype.enqueue=function(t,e){(e=this.cacheMap.get(e))&&!e.all().find((function(e){return e.content==t.content}))&&(e.enqueue(t),e=s.calculateMemSize(t.content),this.pendingDataSize+=e,this.size++,this.staticConfig.totalAvailCache-=e,this.enCallback)&&this.enCallback(this.byteLength,this.size,this.pendingDataSize)},a.prototype.dequeue=function(t){return t=null==(t=this.cacheMap.get(t))?void 0:t.dequeue(),this.size--,this.deCallback&&this.deCallback(),t},a.prototype.findInQueue=function(t){var e=null==(e=this.cacheMap.get(t.level))?void 0:e.all();return null==e?void 0:e.find((function(e){return e.key===t.key}))},a.prototype.readReportData=function(t){var e=i(this.cacheMap.entries());return e=this.readData(e,t,!0),this.reset(),{totalLen:e.totalLen,reportDataArr:e.resArr}},a.prototype.readStoreData=function(t){t=Math.ceil(this.pendingDataSize*t);var e=i(this.cacheMap.entries()).reverse();return e=this.readData(e,t,!1),this.refresh(e.totalLen),{totalLen:e.totalLen,storeArr:e.resArr}},a.prototype.readData=function(t,e,n){var i=[],o=0;t:for(var a=0;a<t.length;a++)for(var u=r(t[a],2),c=u[0],l=u[1];l.size();){var h=this.dequeue(c);if(i.push(h),e<(o+=s.calculateMemSize(h.content)))break t}return{totalLen:o,resArr:i}},a.prototype.decodeReportData=function(t){var e=this;t.forEach((function(t){e.enqueue(t,t.level)}))},a.prototype.setListener=function(t){this.enCallback=t.enCallback,this.deCallback=t.deCallback},a.prototype.getPendingDataInfo=function(){return{pendingDataSize:this.pendingDataSize,size:this.size}},a.prototype.refresh=function(t){this.pendingDataSize-=t,this.staticConfig.totalAvailCache+=t},a.prototype.reset=function(){this.byteLength=0},e.PendingQueue=a},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n=n||Promise)((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):((e=t.value)instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s={next:a(0),throw:a(1),return:a(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){var u=[s,a];if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&u[0]?r.return:u[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,u[1])).done)return i;switch(r=0,(u=i?[2&u[0],i.value]:u)[0]){case 0:case 1:i=u;break;case 4:return o.label++,{value:u[1],done:!1};case 5:o.label++,r=u[1],u=[0];continue;case 7:u=o.ops.pop(),o.trys.pop();continue;default:if(!(i=0<(i=o.trys).length&&i[i.length-1])&&(6===u[0]||2===u[0])){o=0;continue}if(3===u[0]&&(!i||u[1]>i[0]&&u[1]<i[3]))o.label=u[1];else if(6===u[0]&&o.label<i[1])o.label=i[1],i=u;else{if(!(i&&o.label<i[2])){i[2]&&o.ops.pop(),o.trys.pop();continue}o.label=i[2],o.ops.push(u)}}u=e.call(t,o)}catch(a){u=[6,a],r=0}finally{n=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}},o=(Object.defineProperty(e,"__esModule",{value:!0}),e.loadJS=void 0,n(40));function s(t,e,n){return(t=o.decrypt(t,e))&&o.hashMd5(t)===n?t:""}e.loadJS=function(t,e,n,o,a,u,c){var l=this;return new Promise((function(h,f){return r(l,void 0,void 0,(function(){var l,d,p,g,_;return i(this,(function(m){switch(m.label){case 0:if(l="dy",t)return[3,7];m.label=1;case 1:return m.trys.push([1,5,,6]),[4,e.getItem("code")];case 2:return d=m.sent(),[4,e.getItem("key")];case 3:return p=m.sent(),[4,e.getItem("hash")];case 4:g=m.sent();var v=s(d,p,g)||u,y=l,b=c,S=document.getElementsByTagName("HEAD").item(0),E=document.createElement("script");E.language="javascript",E.type="text/javascript",E.id=y,E.param=b;try{E.appendChild(document.createTextNode(v))}catch(y){E.text=v}return S.appendChild(E),h(),[3,6];case 5:return m.sent(),f(),[3,6];case 6:return[2];case 7:if(window.ActiveXObject)try{_=new ActiveXObject("Msxml2.XMLHTTP")}catch(m){_=new ActiveXObject("Microsoft.XMLHTTP")}else window.XMLHttpRequest&&(_=new XMLHttpRequest);return _.open("GET",n,!0),_.send(null),_.onreadystatechange=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:if(4!=_.readyState)return[3,10];if(!(200<=_.status&&_.status<300||0==_.status||304==_.status))return[3,8];t.label=1;case 1:return t.trys.push([1,6,,7]),s(_.responseText,o,a)?[4,e.setItem("code",_.responseText)]:[3,5];case 2:return t.sent(),[4,e.setItem("key",o)];case 3:return t.sent(),[4,e.setItem("hash",a)];case 4:t.sent(),t.label=5;case 5:return h(),[3,7];case 6:return t.sent(),f(),[3,7];case 7:return[2];case 8:return f(),[2];case 9:return[3,11];case 10:case 11:return[2]}}))}))},[2]}}))}))}))}},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},i=(Object.defineProperty(e,"__esModule",{value:!0}),e.hashMd5=e.decrypt=void 0,r(n(41))),o=r(n(42)),s=r(n(43));e.decrypt=function(t,e){var n="";try{n=o.default.decrypt(t,e).toString(s.default)}catch(t){}return n},e.hashMd5=function(t){return i.default(t).toString()}},function(t,e){t.exports=o},function(t,e){t.exports=s},function(t,e){t.exports=a},function(t,e,n){"use strict";function r(){this.logLevel=e.ENUM_LOG_LEVEL.DISABLE}Object.defineProperty(e,"__esModule",{value:!0}),e.ZegoLog=e.ENUM_LOG_LEVEL=void 0,e.ENUM_LOG_LEVEL={DEBUG:0,INFO:1,WARN:2,ERROR:3,REPORT:99,DISABLE:100,debug:0,info:1,warn:2,error:3,report:99,disable:100},r.prototype.setLogLevel=function(t){return void 0!==(t=e.ENUM_LOG_LEVEL[t])&&(this.logLevel=t,!0)},r.prototype.debug=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=t.join(" ");this.logLevel!==e.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=e.ENUM_LOG_LEVEL.DEBUG&&console.debug(r)},r.prototype.log=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=t.join(" ");this.logLevel!==e.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=e.ENUM_LOG_LEVEL.INFO&&console.log(r)},r.prototype.info=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=t.join(" ");this.logLevel!==e.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=e.ENUM_LOG_LEVEL.INFO&&console.info(r)},r.prototype.warn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=t.join(" ");this.logLevel!==e.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=e.ENUM_LOG_LEVEL.WARN&&console.warn(r)},r.prototype.error=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=t.join(" ");this.logLevel!==e.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=e.ENUM_LOG_LEVEL.ERROR&&console.error(r)},e.ZegoLog=r},function(t,e,n){"use strict";function r(t){this.logger=t,this._log=t}Object.defineProperty(e,"__esModule",{value:!0}),e.StateCenter=void 0,r.prototype.isLogin=function(){return!0},e.StateCenter=r},function(t,e,n){"use strict";var r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(r(arguments[e]));return t},o=(Object.defineProperty(e,"__esModule",{value:!0}),e.DynamicCode=void 0,n(3));function s(){this.init()}s.prototype.init=function(){window.dyObj={}},s.prototype.runExecution=function(t,e,n){t=new(Function.bind.apply(Function,i([void 0],t,[n])));try{t.apply(void 0,i(e))}catch(t){o.log.error(t)}},e.DynamicCode=s}],c={},r.m=u,r.c=c,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=13))},function(t,n){t.exports=e},function(t,e,n){var r,i,o,s,a;t.exports=(t=n(1),n(16),n(17),r=(o=(n=t).lib).Base,i=o.WordArray,s=(o=n.algo).MD5,a=o.EvpKDF=r.extend({cfg:r.extend({keySize:4,hasher:s,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var n,r=this.cfg,o=r.hasher.create(),s=i.create(),a=s.words,u=r.keySize,c=r.iterations;a.length<u;){n&&o.update(n),n=o.update(t).finalize(e),o.reset();for(var l=1;l<c;l++)n=o.finalize(n),o.reset();s.concat(n)}return s.sigBytes=4*u,s}}),n.EvpKDF=function(t,e,n){return a.create(n).compute(t,e)},t.EvpKDF)},function(t,e,n){function r(t){var e;return(a[t]||(e=a[t]={i:t,l:!1,exports:{}},s[t].call(e.exports,e,e.exports,r),e.l=!0,e)).exports}var i,o,s,a;t.exports=(i=n(0),o=n(2),s=[function(t,e){t.exports=i},function(t,e){t.exports=o},function(t,e,n){"use strict";var r,i,o,s,a,u,c,l;n.r(e),n.d(e,"ZegoConnectionAgent",(function(){return wt})),n.d(e,"NetAgentPCRequest",(function(){return gt})),n.d(e,"NetAgentHttpRequest",(function(){return St})),n.d(e,"BusinessService",(function(){return o})),n.d(e,"BrokenType",(function(){return g})),n.d(e,"NET_ACCESS_CONFIG",(function(){return ut})),n.d(e,"ConnectedType",(function(){return p})),n.d(e,"DisconnectedType",(function(){return d})),n.d(e,"Mode",(function(){return a})),n.d(e,"Method",(function(){return f})),(e=r=r||{})[e.offline=0]="offline",e[e.online=1]="online",(e=i=i||{})[e.MSG_TYPE_STREAM_CLOSED=2]="MSG_TYPE_STREAM_CLOSED",e[e.MSG_TYPE_CLOSE_CONNECTION=3]="MSG_TYPE_CLOSE_CONNECTION",e[e.MSG_TYPE_HTTP_REQUEST=4]="MSG_TYPE_HTTP_REQUEST",e[e.MSG_TYPE_HTTP_RESPONSE=5]="MSG_TYPE_HTTP_RESPONSE",e[e.MSG_TYPE_HB_REQUEST=12]="MSG_TYPE_HB_REQUEST",e[e.MSG_TYPE_HB_RESPONSE=13]="MSG_TYPE_HB_RESPONSE",e[e.MSG_TYPE_GET_CONFIG_REQUEST=14]="MSG_TYPE_GET_CONFIG_REQUEST",e[e.MSG_TYPE_GET_CONFIG_RESPONSE=15]="MSG_TYPE_GET_CONFIG_RESPONSE",e[e.MSG_TYPE_HTTP_REQUEST_ACK=16]="MSG_TYPE_HTTP_REQUEST_ACK",e[e.MSG_TYPE_PC_UPWARD_MESSAGE=17]="MSG_TYPE_PC_UPWARD_MESSAGE",e[e.MSG_TYPE_PC_UPWARD_MESSAGE_ACK=18]="MSG_TYPE_PC_UPWARD_MESSAGE_ACK",e[e.MSG_TYPE_PC_ESTABLISHED=19]="MSG_TYPE_PC_ESTABLISHED",e[e.MSG_TYPE_PC_BROKEN=20]="MSG_TYPE_PC_BROKEN",e[e.MSG_TYPE_PC_DOWNWARD_MESSAGE=21]="MSG_TYPE_PC_DOWNWARD_MESSAGE",e[e.MSG_TYPE_REDIRECT=22]="MSG_TYPE_REDIRECT",e[e.MSG_TYPE_GET_APPCONFIG_REQUEST=23]="MSG_TYPE_GET_APPCONFIG_REQUEST",e[e.MSG_TYPE_GET_APPCONFIG_RESPONSE=24]="MSG_TYPE_GET_APPCONFIG_RESPONSE",e[e.MSG_TYPE_PUSH_APPCONFIG=25]="MSG_TYPE_PUSH_APPCONFIG",e[e.MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST=26]="MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST",e[e.MSG_TYPE_ACCESSHUB_DISPATCH_RESPONSE=27]="MSG_TYPE_ACCESSHUB_DISPATCH_RESPONSE",e[e.MSG_TYPE_PUSH_EXCEPTION=30]="MSG_TYPE_PUSH_EXCEPTION",e[e.MSG_TYPE_HTTP_REQUEST2=33]="MSG_TYPE_HTTP_REQUEST2",e[e.MSG_TYPE_REDIRECT2=34]="MSG_TYPE_REDIRECT2",e[e.MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST2=35]="MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST2",e[e.MSG_TYPE_ACCESSHUB_DISPATCH_RESPONSE2=36]="MSG_TYPE_ACCESSHUB_DISPATCH_RESPONSE2",e[e.MSG_TYPE_GET_SVRADDR_REQUEST=39]="MSG_TYPE_GET_SVRADDR_REQUEST",e[e.MSG_TYPE_GET_SVRADDR_RESPONSE=40]="MSG_TYPE_GET_SVRADDR_RESPONSE",(e=v=v||{})[e.ACCESSHUB_INVALID_FRAME=2e4]="ACCESSHUB_INVALID_FRAME",e[e.ACCESSHUB_NEED_ENCRYPT=20001]="ACCESSHUB_NEED_ENCRYPT",e[e.ACCESSHUB_DECRYPT=20002]="ACCESSHUB_DECRYPT",e[e.ACCESSHUB_MSGTYPE=20003]="ACCESSHUB_MSGTYPE",e[e.ACCESSHUB_UNMARSHAL=20004]="ACCESSHUB_UNMARSHAL",e[e.ACCESSHUB_TIMEOUT=20005]="ACCESSHUB_TIMEOUT",e[e.ACCESSHUB_CONNECT=20006]="ACCESSHUB_CONNECT",e[e.ACCESSHUB_BROKEN=20007]="ACCESSHUB_BROKEN",e[e.ACCESSHUB_INTERNAL_ERROR=20008]="ACCESSHUB_INTERNAL_ERROR",e[e.ACCESSHUB_MARSHAL=20009]="ACCESSHUB_MARSHAL",e[e.ACCESSHUB_UNSUPPORTED_SERVICE=20010]="ACCESSHUB_UNSUPPORTED_SERVICE",e[e.ACCESSHUB_TOO_FREQUENTLY=20011]="ACCESSHUB_TOO_FREQUENTLY",e[e.ACCESSHUB_INVALID_APPID=20012]="ACCESSHUB_INVALID_APPID",e[e.ACCESSHUB_HB_TIMEOUT=20013]="ACCESSHUB_HB_TIMEOUT",e[e.ACCESSHUB_INVALID_SIGNATURE=20014]="ACCESSHUB_INVALID_SIGNATURE",(e=o=o||{})[e.SERVICE_UNSET=0]="SERVICE_UNSET",e[e.SERVICE_MEDIAGW=1]="SERVICE_MEDIAGW",e[e.SERVICE_LIVEROOM=2]="SERVICE_LIVEROOM",e[e.SERVICE_MIX=3]="SERVICE_MIX",e[e.SERVICE_ZEUS=4]="SERVICE_ZEUS",e[e.SERVICE_ZPUSH=5]="SERVICE_ZPUSH",e[e.SERVICE_L3=6]="SERVICE_L3",e[e.SERVICE_TALKLINE=7]="SERVICE_TALKLINE",e[e.SERVICE_EDUSUITE=8]="SERVICE_EDUSUITE",e[e.SERVICE_ZIM=9]="SERVICE_ZIM",e[e.SERVICE_ClOUD_SETTING=10]="SERVICE_ClOUD_SETTING",e[e.SERVICE_ZEUSHB=11]="SERVICE_ZEUSHB",e[e.SERVICE_USER_LOGIC=12]="SERVICE_USER_LOGIC",e[e.SERVICE_UNIFYDISPATCH=13]="SERVICE_UNIFYDISPATCH",e[e.SERVICE_QUALITY=14]="SERVICE_QUALITY",e[e.SERVICE_SECURITY=15]="SERVICE_SECURITY",e[e.SERVICE_KTVCPR=16]="SERVICE_KTVCPR",e[e.SERVICE_SWITCH4LIVEROOM=17]="SERVICE_SWITCH4LIVEROOM",e[e.SERVICE_WEBRTC_SIGNAL=18]="SERVICE_WEBRTC_SIGNAL",e[e.SERVICE_L3_WEBRTC_SIGNAL=19]="SERVICE_L3_WEBRTC_SIGNAL",e[e.SERVICE_VIDEOCPR=20]="SERVICE_VIDEOCPR",e[e.SERVICE_CDN=21]="SERVICE_CDN",e[e.SERVICE_CLOUDRECORD=22]="SERVICE_CLOUDRECORD",e[e.SERVICE_INNER_ECHO=23]="SERVICE_INNER_ECHO",e[e.SERVICE_OUTER_ECHO=24]="SERVICE_OUTER_ECHO",e[e.SERVICE_LOCALHOST_ECHO=25]="SERVICE_LOCALHOST_ECHO",e[e.SERVICE_ECHO=26]="SERVICE_ECHO",e[e.SERVICE_DOCSERVICE=27]="SERVICE_DOCSERVICE",e[e.SERVICE_AUTHSVR=28]="SERVICE_AUTHSVR",(e=s=s||{})[e.ZEGOCONN_RUN_ENV_UNSET=0]="ZEGOCONN_RUN_ENV_UNSET",e[e.ZEGOCONN_RUN_ENV_BROWSER=1]="ZEGOCONN_RUN_ENV_BROWSER",e[e.ZEGOCONN_RUN_ENV_APPLET=2]="ZEGOCONN_RUN_ENV_APPLET",(e=a=a||{})[e.Mode_UNSET=0]="Mode_UNSET",e[e.MODE_ONLINE=1]="MODE_ONLINE",e[e.MODE_TEST=2]="MODE_TEST",e[e.MODE_ALPHA=3]="MODE_ALPHA",(e=u=u||{})[e.HTTP=0]="HTTP",e[e.PC=1]="PC",e[e.OTHER=2]="OTHER",(e=c=c||{})[e.NONE=0]="NONE",e[e.BROKEN=1]="BROKEN",e[e.DISCONNECT=2]="DISCONNECT",(e=l=l||{})[e.CONNECTED=0]="CONNECTED",e[e.DISCONNECT=1]="DISCONNECT",e[e.BROKEN=2]="BROKEN";var h,f,d,p,g,_=[v.ACCESSHUB_INVALID_APPID,v.ACCESSHUB_INVALID_SIGNATURE],m=((e=h=h||{})[e.ACTION_RESERVED=0]="ACTION_RESERVED",e[e.ACTION_DISPATCH=1]="ACTION_DISPATCH",e[e.ACTION_RETRY=2]="ACTION_RETRY",e[e.ACTION_NEXT_NODE=3]="ACTION_NEXT_NODE",e[e.ACTION_ABORT=4]="ACTION_ABORT",e[e.ACTION_NEXT_GROUP=5]="ACTION_NEXT_GROUP",(v=f=f||{})[v.METHOD_UNSET=0]="METHOD_UNSET",v[v.METHOD_GET=1]="METHOD_GET",v[v.METHOD_POST=2]="METHOD_POST",v[v.METHOD_PUT=3]="METHOD_PUT",v[v.METHOD_PATCH=4]="METHOD_PATCH",v[v.METHOD_DELETE=5]="METHOD_DELETE",v[v.METHOD_HEAD=6]="METHOD_HEAD",v[v.METHOD_OPTIONS=7]="METHOD_OPTIONS",(e=d=d||{})[e.CLOSE=0]="CLOSE",e[e.TEMP=1]="TEMP",e[e.TIMEOUT=2]="TIMEOUT",(v=p=p||{})[v.AUTO=0]="AUTO",v[v.MANUAL=1]="MANUAL",(e=g=g||{})[e.EMPTY=0]="EMPTY",e[e.CLOSE=1]="CLOSE",{2:"stream_closed",3:"close_connection",4:"http_request",5:"http_response",12:"hb_request",13:"hb_response",14:"get_config_request",15:"get_config_response",16:"http_request_ack",17:"pc_upward_message",18:"pc_upward_message_ack",19:"pc_established",20:"pc_broken",21:"pc_downward_message",22:"redirect",23:"get_appconfig_request",24:"get_appconfig_response",25:"push_appconfig",26:"accesshub_dispatch_request",27:"accesshub_dispatch_response",30:"push_exception",33:"http_request2",34:"redirect2",35:"accesshub_dispatch_request2",36:"accesshub_dispatch_response2",39:"get_svraddr_request",40:"get_svraddr_response"}),v=n(0),y=n.n(v),b=(e=n(1),n(1));const S=b.roots.default||(b.roots.default={}),E=n(0);b.util.Long=E,b.util.Long.fromBits=b.util.Long?b.util.Long.fromBits:function(){return 0};for(var T=b.types?b.types.basic:{double:1,float:5,int32:0,uint32:0,sint32:0,fixed32:5,sfixed32:5,int64:0,uint64:0,sint64:0,fixed64:1,sfixed64:1,bool:0,string:2,bytes:2},C=b.types?b.types.packed:{double:1,float:5,int32:0,uint32:0,sint32:0,fixed32:5,sfixed32:5,int64:0,uint64:0,sint64:0,fixed64:1,sfixed64:1,bool:0},w=Object.keys(T),R={$:function(t){return R[t]?R[t].call(this):S[t].decode?S[t].decode(this,this.uint32()):R.$.call(this,"int32")}},I={$:function(t,e,n){var r=T[t];return void 0===r?S[t].encode?(this.uint32((n<<3|2)>>0).fork(),S[t].encode(e,this).ldelim()):I.$.call(this,"int32",e,n):I[t].call(this.uint32(n<<3|r),e)}},k=0;k<w.length;k++)R[w[k]]=b.Reader.prototype[w[k]],I[w[k]]=b.Writer.prototype[w[k]];!function t(e,n,r,i){for(var o=0,s=Object.keys(e);o<s.length;o++){var a=s[o];if(e[a].$m&&Object.keys(e[a].$m).every((function(t){return Number(t)}))){if(r[a])throw Error(`nested type ${r}.${a} has already exist`);r[a]=function(e,r){function i(t){for(var n in e)"{"===(n=e[n])[1].charAt(0)?this[n[0]]={}:"["!==n[1].charAt(0)&&"<"!==n[1].charAt(0)||(this[n[0]]=[]);if(t)for(var r=Object.keys(t),i=0;i<r.length;++i)null!=t[r[i]]&&(this[r[i]]=t[r[i]])}var o,s={};for(o in e){var a=e[o],u=a[1];"{"===u.charAt(0)?(i.prototype[a[0]]=b.util.emptyObject,s[u]={$m:u.substring(1).split(",").map((function(t,e){return["$"+(e+1),t,null]})).reduce((function(t,e,n){return t[n+1]=e,t}),{})}):i.prototype[a[0]]="["===u.charAt(0)||"<"===u.charAt(0)?b.util.emptyArray:"bytes"===u?b.util.newBuffer([]):a[2]&&a[2].hasOwnProperty("low")&&a[2].hasOwnProperty("high")?b.util.Long.fromBits(a[2].low,a[2].high,a[2].unsigned):a[2]}return i.decode=function(t,n){t instanceof b.Reader||(t=b.Reader.create(t));for(var r=void 0===n?t.len:t.pos+n,o=new i;t.pos<r;){var s=t.uint32(),a=s>>>3;if(0<a&&e[a]){var u=e[a][0],c=e[a][1];if("{"===c.charAt(0))o[u]===b.util.emptyObject&&(o[u]={}),a=i.$namespace[c].decode(t,t.uint32()),o[u][a.$1]=a.$2;else if("["===c.charAt(0)||"<"===c.charAt(0))if(c=c.substring(1),o[u]&&o[u].length||(o[u]=[]),void 0!==C[c]&&2==(7&s))for(var l=t.uint32()+t.pos;t.pos<l;)o[u].push(R.$.call(t,c));else o[u].push(R.$.call(t,c));else o[u]=R.$.call(t,c)}else t.skipType(7&s)}return o},i.encode=function(t,n){for(var r in n=n||b.Writer.create(),e){var o=e[r][0];if("{"===(c=e[r][1]).charAt(0)){if(null!=t[o]&&t.hasOwnProperty(o))for(var s=0,a=Object.keys(t[o]);s<a.length;++s)n.uint32((r<<3|2)>>0).fork(),i.$namespace[c].encode({$1:a[s],$2:t[o][a[s]]},n).ldelim()}else if("["===c.charAt(0)||"<"===c.charAt(0)){var u="<"===c.charAt(0),c=c.substring(1),l=t[o];if(null!=l&&l.length)if(u&&void 0!==C[c]){for(n.uint32((r<<3|2)>>0).fork(),s=0;s<l.length;s++)I[c].call(n,l[s]);n.ldelim()}else for(s=0;s<l.length;s++)I.$.call(n,c,l[s],r)}else null!=t[o]&&t.hasOwnProperty(o)&&I.$.call(n,c,t[o],r)}return n},Object.keys(s).length&&(i.$namespace=t(s,n+"."+r,i.$namespace||{},!0)),i}(e[a].$m,a)}else e[a].$s?r[a]=function(t,e){function r(t,e,n){b.rpc.Service.call(this,t,e,n)}return(r.prototype=Object.create(b.rpc.Service.prototype)).constructor=r,Object.keys(t).forEach((function(i){var o=t[i];function s(t,e){return this.rpcCall(s,S[o[0]],S[o[1]],t,e)}Object.defineProperty(s,"name",{value:i}),Object.defineProperty(s,"path",{value:n+"."+e}),r.prototype[i]=s})),r}(e[a].$s,a):e[a].$e&&Object.values(e[a].$e).every((function(t){return Number(t)===t}))&&(r[a]=function(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++)n[n[e[r]]=t[e[r]]]=e[r];return n}(e[a].$e));r[a]&&!i&&(S[n+"."+a]=r[a]),delete e[a].$m,delete e[a].$s,delete e[a].$e,r[a]=t(e[a],n?n+"."+a:a,r[a]||{})}return r}({PB:{proto_accesshub:{AccesshubAddr:{$m:{1:["ipv4","fixed32",0],2:["ipv6","PB.proto_accesshub.IPV6Addr",null],3:["quic_port","uint32",0],4:["wss_port","uint32",0]}},AccesshubDispatchGroup:{$m:{1:["group","string",""],2:["quic_nodes","<string",null],3:["mtcp_nodes","<string",null],4:["wss_nodes","<string",null]}},AccesshubDispatchGroup2:{$m:{1:["group","string",""],2:["nodes","<PB.proto_accesshub.AccesshubAddr",null],3:["nodes_dual","<PB.proto_accesshub.AccesshubAddr",null]}},AccesshubDispatchRequest2:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["appid","uint32",0],3:["biz_type","uint32",0],4:["mode_no","PB.proto_accesshub.Mode",0],5:["id_name","string",""],6:["sdk_type","PB.proto_accesshub.SdkType",0],7:["zegoconn_version","uint32",0],8:["zegoconn_run_env","PB.proto_accesshub.ZegoconnRunEnv",0],9:["device_id","string",""],10:["client_ip","string",""],11:["geofencing_type","uint32",0],12:["geofencings","[uint32",null],13:["addr_type","uint32",0]}},AccesshubDispatchResponse2:{$m:{1:["code","int32",0],2:["message","string",""],3:["data","PB.proto_accesshub.AccesshubDispatchResponseData2",null]}},AccesshubDispatchResponseData2:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["rand","string",""],3:["secret","string",""],4:["groups","<PB.proto_accesshub.AccesshubDispatchGroup2",null],5:["wss_groups","<PB.proto_accesshub.WssAccesshubDispatchGroup",null],6:["ttl","uint32",0]}},BackendConnType:{$e:{BACKEND_CONN_TYPE_UNSET:0,BACKEND_CONN_TYPE_TCP:1,BACKEND_CONN_TYPE_WSS:2}},CloseConnection:{$m:{1:["reason","int32",0],2:["msg","string",""],3:["action","int32",0]},Action:{$e:{ACTION_RESERVED:0,ACTION_DISPATCH:1,ACTION_RETRY:2,ACTION_NEXT_NODE:3,ACTION_ABORT:4,ACTION_NEXT_GROUP:5}}},ConnectionClosed:{$m:{1:["code","int32",0],2:["msg","string",""]}},ErrorCode:{$e:{OK:0,DISPATCH_NO_AVAILABLE_NODE:1e4,DISPATCH_INTERNAL_ERROR:10001,DISPATCH_INVALID_FRAME:10002,DISPATCH_UNMARSHAL:10003,DISPATCH_MSGTYPE:10004,DISPATCH_MARSHAL:10005,DISPATCH_TOO_FREQUENTLY:10006,DISPATCH_EMPTY_GEOFENCING:10007,ACCESSHUB_INVALID_FRAME:2e4,ACCESSHUB_NEED_ENCRYPT:20001,ACCESSHUB_DECRYPT:20002,ACCESSHUB_MSGTYPE:20003,ACCESSHUB_UNMARSHAL:20004,ACCESSHUB_TIMEOUT:20005,ACCESSHUB_CONNECT:20006,ACCESSHUB_BROKEN:20007,ACCESSHUB_INTERNAL_ERROR:20008,ACCESSHUB_MARSHAL:20009,ACCESSHUB_UNSUPPORTED_SERVICE:20010,ACCESSHUB_TOO_FREQUENTLY:20011,ACCESSHUB_INVALID_APPID:20012,ACCESSHUB_HB_TIMEOUT:20013,ACCESSHUB_INVALID_SIGNATURE:20014,ACCESSHUB_AUTH_FAILED:20015,ACCESSHUB_UNSUPPORTED_INTERFACE:20016,ACCESSHUB_EMPTY_GEOFENCING:20017,ACCESSHUB_ACCESS_DENIED:20018,ACCESSHUB_SPECIAL_CUSTOMER:20019,ACCESSHUB_GET_STREAM_FAILED:3e4,ACCESSHUB_GET_CONN_FAILED:30001,ACCESSHUB_DO_HTTP_REQUEST_FAILED:30002,ACCESSHUB_UNMARSHAL_HB_FAILED:30003,ACCESSHUB_DO_BACKEND_DISPATCH_FAILED:30004}},GeoFencing:{$e:{CN:2,NA:3,EU:4,AS:5,IN:6,NCN:7}},GeoFencingType:{$e:{NONE:0,UNION:1,EXCLUDE:2}},GetAppConfigRequest:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["appid","uint32",0],3:["biz_type","uint32",0],4:["mode_no","PB.proto_accesshub.Mode",0],5:["id_name","string",""],6:["config_key","string",""],7:["ts","uint64",{low:0,high:0,unsigned:!0}],8:["signature","bytes",[]],9:["lite_sign","string",""],10:["token","string",""],11:["sdk_type","PB.proto_accesshub.SdkType",0],12:["zegoconn_version","uint32",0],13:["zegoconn_run_env","PB.proto_accesshub.ZegoconnRunEnv",0],14:["device_id","string",""],15:["etag","uint32",0],16:["is_special_customer","uint32",0]}},GetAppConfigResponse:{$m:{1:["code","int32",0],2:["message","string",""],3:["data","PB.proto_accesshub.GetAppConfigResponseData",null]}},GetAppConfigResponseData:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["data","bytes",[]],3:["ts","uint64",{low:0,high:0,unsigned:!0}],4:["etag","uint32",0]}},GetConfigRequest:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["appid","uint32",0],3:["biz_type","uint32",0],4:["mode","string",""],5:["id_name","string",""],6:["reqid","string",""],7:["zegoconn_version","uint32",0],8:["sdk_type","PB.proto_accesshub.SdkType",0],9:["zegoconn_run_env","PB.proto_accesshub.ZegoconnRunEnv",0],10:["device_id","string",""],11:["mode_no","PB.proto_accesshub.Mode",0],12:["geofencing_type","uint32",0],13:["geofencings","[uint32",null]}},GetConfigResponse:{$m:{1:["code","int32",0],2:["message","string",""],3:["data","PB.proto_accesshub.GetConfigResponseData",null]}},GetConfigResponseData:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["quic_hb_interval","uint32",0],3:["quic_hb_timeout","uint32",0],4:["logic_hb_interval","uint32",0],5:["logic_hb_timeout","uint32",0],6:["pc_establish_timeout","uint32",0],7:["sdk_link_detect_interval","uint32",0],8:["sdk_link_detect_duration","uint32",0],9:["client_outer_ip","string",""],10:["ntp_time","uint64",{low:0,high:0,unsigned:!0}],11:["root_rsa_certs_ver","uint32",0],12:["geofencing_id","uint32",0],13:["svraddr_ver","uint32",0],14:["root_ecc_certs_ver","uint32",0]}},HBRequest:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["ts","int64",{low:0,high:0,unsigned:!1}]}},HBResponse:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["ts","int64",{low:0,high:0,unsigned:!1}],3:["ntp_time","uint64",{low:0,high:0,unsigned:!0}]}},HTTPRequest:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["appid","uint32",0],3:["biz_type","uint32",0],4:["mode","string",""],5:["id_name","string",""],6:["reqid","string",""],7:["stick","string",""],8:["service","string",""],9:["location","string",""],10:["method","string",""],11:["headers","<PB.proto_accesshub.HTTPRequest.HTTPHeader",null],12:["body","bytes",[]],13:["ack","bool",!1],14:["mode_no","PB.proto_accesshub.Mode",0],15:["service_no","PB.proto_accesshub.Service",0],16:["method_no","PB.proto_accesshub.Method",0],17:["sdk_type","PB.proto_accesshub.SdkType",0],18:["zegoconn_run_env","PB.proto_accesshub.ZegoconnRunEnv",0],19:["zegoconn_version","uint32",0],20:["device_id","string",""],21:["reduce_resp_header","uint32",0]},HTTPHeader:{$m:{1:["name","string",""],2:["val","string",""]}}},HTTPRequest2:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["appid","uint32",0],3:["biz_type","uint32",0],4:["mode","PB.proto_accesshub.Mode",0],5:["id_name","string",""],6:["sdk_type","PB.proto_accesshub.SdkType",0],7:["zegoconn_run_env","PB.proto_accesshub.ZegoconnRunEnv",0],8:["zegoconn_version","uint32",0],9:["headers","<PB.proto_accesshub.HTTPRequest.HTTPHeader",null],10:["method","PB.proto_accesshub.Method",0],11:["interface_id","uint32",0],12:["res_id","string",""],13:["params","string",""],14:["body","bytes",[]],15:["ack","bool",!1],16:["device_id","string",""],17:["ts","uint64",{low:0,high:0,unsigned:!0}],18:["signature","bytes",[]],19:["token","string",""],20:["lite_sign","string",""],21:["reduce_resp_header","uint32",0]}},HTTPRequestAck:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}]}},HTTPRequestDroped:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["reason","int32",0],3:["msg","string",""]}},HTTPResponse:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["headers","<PB.proto_accesshub.HTTPRequest.HTTPHeader",null],3:["status_code","int32",0],4:["body","bytes",[]]}},IPAddr:{$m:{1:["ipv4","fixed32",0],2:["ipv6","PB.proto_accesshub.IPV6Addr",null]}},IPV6Addr:{$m:{1:["high","fixed64",{low:0,high:0,unsigned:!1}],2:["low","fixed64",{low:0,high:0,unsigned:!1}]}},MessageType:{$e:{MSG_TYPE_EMPTY:0,MSG_TYPE_CONNECTION_CLOSED:1,MSG_TYPE_STREAM_CLOSED:2,MSG_TYPE_CLOSE_CONNECTION:3,MSG_TYPE_HTTP_REQUEST:4,MSG_TYPE_HTTP_RESPONSE:5,MSG_TYPE_HTTP_REQUEST_DROPED:6,MSG_TYPE_PROXY_CONNECT:7,MSG_TYPE_PROXY_CONNECTED:8,MSG_TYPE_PROXY_CONNECTION_CLOSED:9,MSG_TYPE_PROXY_SEND_DATA:10,MSG_TYPE_PROXY_RECV_DATA:11,MSG_TYPE_HB_REQUEST:12,MSG_TYPE_HB_RESPONSE:13,MSG_TYPE_GET_CONFIG_REQUEST:14,MSG_TYPE_GET_CONFIG_RESPONSE:15,MSG_TYPE_HTTP_REQUEST_ACK:16,MSG_TYPE_PC_UPWARD_MESSAGE:17,MSG_TYPE_PC_UPWARD_MESSAGE_ACK:18,MSG_TYPE_PC_ESTABLISHED:19,MSG_TYPE_PC_BROKEN:20,MSG_TYPE_PC_DOWNWARD_MESSAGE:21,MSG_TYPE_REDIRECT:22,MSG_TYPE_GET_APPCONFIG_REQUEST:23,MSG_TYPE_GET_APPCONFIG_RESPONSE:24,MSG_TYPE_PUSH_APPCONFIG:25,MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST:26,MSG_TYPE_ACCESSHUB_DISPATCH_RESPONSE:27,MSG_TYPE_GET_IM_CONFIG_REQUEST:28,MSG_TYPE_GET_IM_CONFIG_RESPONSE:29,MSG_TYPE_PUSH_EXCEPTION:30,MSG_TYPE_RESOLVE_DOMAIN_REQUEST:31,MSG_TYPE_RESOLVE_DOMAIN_RESPONSE:32,MSG_TYPE_HTTP_REQUEST2:33,MSG_TYPE_REDIRECT2:34,MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST2:35,MSG_TYPE_ACCESSHUB_DISPATCH_RESPONSE2:36,MSG_TYPE_GET_ROOTCERTS_REQUEST:37,MSG_TYPE_GET_ROOTCERTS_RESPONSE:38,MSG_TYPE_GET_SVRADDR_REQUEST:39,MSG_TYPE_GET_SVRADDR_RESPONSE:40,MSG_TYPE_UA_DISPATCH_REQUEST:50,MSG_TYPE_UA_DISPATCH_RESPONSE:51,MSG_TYPE_UA_ECHO_REQUEST:52,MSG_TYPE_UA_ECHO_RESPONSE:53,MSG_TYPE_NODE_REGISTER_REQUEST:100,MSG_TYPE_NODE_REGISTER_RESPONSE:101,MSG_TYPE_NODE_HB_REQUEST:102,MSG_TYPE_NODE_HB_RESPONSE:103}},Method:{$e:{METHOD_UNSET:0,METHOD_GET:1,METHOD_POST:2,METHOD_PUT:3,METHOD_PATCH:4,METHOD_DELETE:5,METHOD_HEAD:6,METHOD_OPTIONS:7}},Mode:{$e:{Mode_UNSET:0,MODE_ONLINE:1,MODE_TEST:2,MODE_ALPHA:3}},PCBroken:{$m:{}},PCDownwardMessage:{$m:{1:["payload","bytes",[]],2:["wss_message_type","uint32",0],3:["ts","uint64",{low:0,high:0,unsigned:!0}]}},PCEstablished:{$m:{1:["elapse","uint32",0],2:["from","uint32",0]}},PCUpwardMessage:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["appid","uint32",0],3:["biz_type","uint32",0],4:["mode_no","PB.proto_accesshub.Mode",0],5:["id_name","string",""],6:["service_no","PB.proto_accesshub.Service",0],7:["ack","bool",!1],8:["payload","bytes",[]],9:["sdk_type","PB.proto_accesshub.SdkType",0],10:["wss_message_type","uint32",0],11:["wss_path","string",""],12:["wss_raw_query","string",""],13:["zegoconn_version","uint32",0],14:["zegoconn_run_env","PB.proto_accesshub.ZegoconnRunEnv",0],15:["backend_conn_type","PB.proto_accesshub.BackendConnType",0],16:["device_id","string",""],17:["geofencing_type","uint32",0],18:["geofencings","[uint32",null],19:["addr_type","uint32",0]}},PCUpwardMessageAck:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}]}},ProxyConnectionClosed:{$m:{1:["code","int32",0],2:["msg","string",""],3:["connected","int32",0]}},PushAppConfig:{$m:{1:["config_key","string",""],2:["data","bytes",[]]}},PushException:{$m:{1:["reason","int32",0],2:["msg","string",""],3:["txid","uint64",{low:0,high:0,unsigned:!0}]}},Redirect2:{$m:{1:["rand","string",""],2:["secret","string",""],3:["groups","<PB.proto_accesshub.AccesshubDispatchGroup2",null],4:["wss_groups","<PB.proto_accesshub.WssAccesshubDispatchGroup",null],5:["ttl","uint32",0]}},SdkType:{$e:{SDK_TYPE_UNSET:0,SDK_TYPE_NATIVE:1,SDK_TYPE_WSS_WEB:3}},Service:{$e:{SERVICE_UNSET:0,SERVICE_MEDIAGW:1,SERVICE_LIVEROOM:2,SERVICE_MIX:3,SERVICE_ZEUS:4,SERVICE_ZPUSH:5,SERVICE_L3:6,SERVICE_TALKLINE:7,SERVICE_EDUSUITE:8,SERVICE_ZIM:9,SERVICE_ClOUD_SETTING:10,SERVICE_ZEUSHB:11,SERVICE_USER_LOGIC:12,SERVICE_UNIFYDISPATCH:13,SERVICE_QUALITY:14,SERVICE_SECURITY:15,SERVICE_KTVCPR:16,SERVICE_SWITCH4LIVEROOM:17,SERVICE_WEBRTC_SIGNAL:18,SERVICE_L3_WEBRTC_SIGNAL:19,SERVICE_VIDEOCPR:20,SERVICE_CDN:21,SERVICE_CLOUDRECORD:22,SERVICE_INNER_ECHO:23,SERVICE_OUTER_ECHO:24,SERVICE_LOCALHOST_ECHO:25,SERVICE_ECHO:26,SERVICE_DOCSERVICE:27,SERVICE_AUTHSVR:28,SERVICE_WEBLIVEROOM:29,SERVICE_WHITEBOARD:30,SERVICE_METAWORLD:31,SERVICE_ZEGOLAND:32}},StreamClosed:{$m:{1:["code","int32",0],2:["msg","string",""]}},WssAccesshubDispatchGroup:{$m:{1:["group","string",""],2:["host","string",""],3:["main_domain","string",""]}},ZegoconnRunEnv:{$e:{ZEGOCONN_RUN_ENV_UNSET:0,ZEGOCONN_RUN_ENV_BROWSER:1,ZEGOCONN_RUN_ENV_APPLET:2}}},proto_initconfig:{AppConfig:{$m:{1:["test_id","int32",0],2:["domain","string",""],3:["flexible_domain","string",""],4:["replace_flexible_domain","string",""]}},InitConfig:{$m:{1:["app_config","PB.proto_initconfig.AppConfig",null],4:["speedlog_config","PB.proto_initconfig.SpeedlogConfig",null],5:["media_config","PB.proto_initconfig.MediaConfig",null]}},MediaConfig:{$m:{1:["play_config","PB.proto_initconfig.MediaPlayConfig",null],2:["publish_config","PB.proto_initconfig.MediaPublishConfig",null]}},MediaPlayConfig:{$m:{5:["resource_info","<PB.proto_initconfig.MediaResourceInfo",null]}},MediaPublishConfig:{$m:{2:["resource_info","<PB.proto_initconfig.MediaResourceInfo",null],5:["enable_subject_segmentation","int32",0],6:["object_segmentation_platform","int32",0]}},MediaResourceInfo:{$m:{1:["resource_type","PB.proto_initconfig.ResourceType",0],2:["service_info","<PB.proto_initconfig.MediaServiceProtocolInfo",null]}},MediaServiceProtocolInfo:{$m:{1:["config_id","string",""],2:["protocol","PB.proto_initconfig.ProtocolType",0],3:["url_template","string",""],4:["resolve_type","PB.proto_initconfig.ResolveType",0],5:["push_cdn_authentication","int32",0],6:["cdn_quic_version","<int32",null]}},ProtocolType:{$e:{UDP:0,RTMP:1,FLV:2,HLS:3,WEBRTC:4}},ResolveType:{$e:{LOCAL_DNS:0,DISPATCH:1}},ResourceType:{$e:{CDN:0,RTC:1,L3:2,CDN_PLUS:3,CDN_PLUS_BACKUP:4}},SpeedlogConfig:{$m:{1:["report_count","int32",0],2:["report_retry_interval","int32",0],3:["push_quality_sample_count","int32",0],4:["pull_quality_sample_count","int32",0],5:["hardware_report_cycle","int32",0],6:["room_user_max_count","int32",0],7:["room_stream_max_count","int32",0],8:["charge_info_report_cycle","int32",0],9:["charge_info_report_mode","int32",0],10:["disable_report_pull","<PB.proto_initconfig.ResourceType",null],11:["report_max_bytes","int32",0],12:["push_quality_report_freq","int32",0],13:["pull_quality_report_freq","int32",0],14:["charge_info_report_no_playing","int32",0]}}}}},"",S,!1),b.util.global.PB=S.PB;var O=S.PB,N=function(){return(N=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};e.util.Long=y.a,e.configure(),B.prototype.encodeRequest=function(t,e,n){var r=(i=this.protoMap[t])[0],i=i[1];return i=(r=this.encode(this.protoInstance[r][i],e)).length,(e=new Uint8Array(13+i))[0]=175,e[1]=0,e[2]=t>>8,e[3]=t-(e[2]<<8),e.set(new Uint8Array(Int32Array.from([i]).buffer).reverse(),4),e.set(new Uint8Array(Int32Array.from([n]).buffer).reverse(),8),e[12]=0,e.set(r,13),e},B.prototype.decodeResponse=function(t){var e=(t[2]<<8)+t[3],n=new DataView(t.buffer).getUint32(8),r=t.slice(13);try{var i=this.protoMap[e];return[n,e,this.decode(this.protoInstance[i[0]][i[1]],r)]}catch(t){return[n,e,{code:1}]}},B.prototype.decodeConfigMessage=function(t){return this.decode(this.protoInstance.proto_initconfig.InitConfig,t)},B.prototype.encode=function(t,e){return t.encode(new t(e)).finish()},B.prototype.decode=function(t,e){return N({},t.decode(e))};var A,L=B,P=(Object.defineProperty(U.prototype,"id",{get:function(){return this._id||null},set:function(t){this._id=t},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t},enumerable:!1,configurable:!0}),U.prototype.hasNext=function(){return this.next&&this.next.id},U.prototype.hasPrev=function(){return this.prev&&this.prev.id},U),M=(x.prototype.insertBefore=function(t,e){return(e=new P(this._idCounter,e)).next=t,e.prev=t.prev,t.prev&&(t.prev.next=e),t.prev=e,++this._idCounter,++this._numNodes,e},x.prototype.addLast=function(t){return this.insertBefore(this.end,t)},x.prototype.add=function(t){return this.addLast(t)},x.prototype.getFirst=function(){return 0===this._numNodes?null:this.start.next},x.prototype.getLast=function(){return 0===this._numNodes?null:this.end.prev},x.prototype.size=function(){return this._numNodes},x.prototype.getFromFirst=function(t){var e=0,n=this.start.next;if(0<=t)for(;e<t&&null!==n;)n=n.next,++e;else n=null;if(null===n)throw"Index out of bounds.";return n},x.prototype.get=function(t){return 0===t?this.getFirst():t===this._numNodes-1?this.getLast():this.getFromFirst(t)},x.prototype.remove=function(t){return t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),--this._numNodes,t},x.prototype.removeFirst=function(){var t=null;return 0<this._numNodes&&this.start.next?this.remove(this.start.next):t},x.prototype.removeLast=function(){var t=null;return 0<this._numNodes&&this.end.prev?this.remove(this.end.prev):t},x.prototype.removeAll=function(){this.start.next=this.end,this.end.prev=this.start,this._numNodes=0,this._idCounter=0},x.prototype.each=function(t){for(var e=this.start;e.hasNext();)t(e=e.next)},x.prototype.find=function(t){for(var e=this.start,n=!1,r=null;e.hasNext()&&!n;)t(e=e.next)&&(r=e,n=!0);return r},x.prototype.map=function(t){for(var e=this.start,n=[];e.hasNext();)t(e=e.next)&&n.push(e);return n},x.prototype.push=function(t){return this.addLast(t)},x.prototype.unshift=function(t){this.insertBefore(0<this._numNodes?this.start.next:this.end,t)},x.prototype.pop=function(){return this.removeLast()},x.prototype.shift=function(){return this.removeFirst()},x);function D(){this.txid=0,this.linkRetryTime=60,this.updatedMsgTime=0,this.connectServer=""}function x(){this.start=new P,this.end=new P,this._idCounter=0,this._numNodes=0,this.start.next=this.end,this.start.prev=null,this.end.prev=this.start,this.end.next=null}function U(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.next=null,this.prev=null,this._id=t,this._data=e}function B(){var t;this.protoInstance=O,this.protoMap=((t={})[i.MSG_TYPE_STREAM_CLOSED]=["proto_accesshub","ConnectionClosed"],t[i.MSG_TYPE_CLOSE_CONNECTION]=["proto_accesshub","CloseConnection"],t[i.MSG_TYPE_HTTP_REQUEST]=["proto_accesshub","HTTPRequest"],t[i.MSG_TYPE_HTTP_RESPONSE]=["proto_accesshub","HTTPResponse"],t[i.MSG_TYPE_HTTP_REQUEST2]=["proto_accesshub","HTTPRequest2"],t[i.MSG_TYPE_HB_REQUEST]=["proto_accesshub","HBRequest"],t[i.MSG_TYPE_HB_RESPONSE]=["proto_accesshub","HBResponse"],t[i.MSG_TYPE_GET_CONFIG_REQUEST]=["proto_accesshub","GetConfigRequest"],t[i.MSG_TYPE_GET_CONFIG_RESPONSE]=["proto_accesshub","GetConfigResponse"],t[i.MSG_TYPE_GET_SVRADDR_REQUEST]=["proto_accesshub","GetSvraddrRequest"],t[i.MSG_TYPE_GET_SVRADDR_RESPONSE]=["proto_accesshub","GetSvraddrResponse"],t[i.MSG_TYPE_HTTP_REQUEST_ACK]=["proto_accesshub","HTTPRequestAck"],t[i.MSG_TYPE_PC_UPWARD_MESSAGE]=["proto_accesshub","PCUpwardMessage"],t[i.MSG_TYPE_PC_UPWARD_MESSAGE_ACK]=["proto_accesshub","PCUpwardMessageAck"],t[i.MSG_TYPE_PC_ESTABLISHED]=["proto_accesshub","PCEstablished"],t[i.MSG_TYPE_PC_BROKEN]=["proto_accesshub","PCBroken"],t[i.MSG_TYPE_PC_DOWNWARD_MESSAGE]=["proto_accesshub","PCDownwardMessage"],t[i.MSG_TYPE_REDIRECT]=["proto_accesshub","Redirect"],t[i.MSG_TYPE_REDIRECT2]=["proto_accesshub","Redirect2"],t[i.MSG_TYPE_GET_APPCONFIG_REQUEST]=["proto_accesshub","GetAppConfigRequest"],t[i.MSG_TYPE_GET_APPCONFIG_RESPONSE]=["proto_accesshub","GetAppConfigResponse"],t[i.MSG_TYPE_PUSH_APPCONFIG]=["proto_accesshub","PushAppConfig"],t[i.MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST]=["proto_accesshub","AccesshubDispatchRequest"],t[i.MSG_TYPE_ACCESSHUB_DISPATCH_RESPONSE]=["proto_accesshub","AccesshubDispatchResponse"],t[i.MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST2]=["proto_accesshub","AccesshubDispatchRequest2"],t[i.MSG_TYPE_ACCESSHUB_DISPATCH_RESPONSE2]=["proto_accesshub","AccesshubDispatchResponse2"],t[i.MSG_TYPE_PUSH_EXCEPTION]=["proto_accesshub","PushException"],t)}D.prototype.createSocket=function(t){},D.prototype.setState=function(t){},D.prototype.initEvent=function(t,e,n,r){},D.prototype.sendMessage=function(t,e,n,r,i,o,s,a){void 0===r&&(r=!0),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null)},v=D,(n=A=A||{})[n.BROWSER=0]="BROWSER",n[n.WEIXINMINI=1]="WEIXINMINI",z.prototype.init=function(){var t=this;this._websocket&&(this.readyState=0,this._websocket.onOpen((function(e){t.readyState=t._websocket.readyState,"function"==typeof t.onopen&&(t.onopen(e),t._websocket.onClose((function(e){t.readyState=t._websocket.readyState,"function"==typeof t.onclose&&t.onclose(e)})),t._websocket.onMessage((function(e){"function"==typeof t.onmessage&&t.onmessage(e)})))})),this._websocket.onError((function(e){t.readyState=t._websocket.readyState,"function"==typeof t.onerror&&t.onerror(e)})))},z.prototype.onopen=function(t){},z.prototype.onerror=function(t){},z.prototype.onclose=function(t){},z.prototype.onmessage=function(t){},z.prototype.send=function(t){t instanceof Uint8Array&&(t=new Uint8Array(t).buffer),this._websocket&&this._websocket.send({data:t})},z.prototype.close=function(){this._websocket&&this._websocket.close()};var H=z;function z(t,e){this.url=t,this.readyState=3,this._websocket=wx.connectSocket({url:t}),this.init()}function G(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||((r=r||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}function F(t){var e=unescape||window.unescape;return Uint8Array.from(Array.from(e(encodeURIComponent(t))).map((function(t){return t.charCodeAt(0)})))}function q(t){var e=escape||window.escape;return decodeURIComponent(e(String.fromCharCode.apply(String,Array.from(t))))}function j(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||((r=r||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}Bt.prototype.createSocket=function(t){this.socket=new(this.ENV%2%2===A.BROWSER?WebSocket:H)(t)},Bt.prototype.openHandler=function(t){var e=this;this.socket&&(this.socket.onopen=function(n){e.socket.binaryType="arraybuffer",e.responseHandler(),t(n)})},Bt.prototype.responseHandler=function(){var t=this;this.socket&&(this.socket.onmessage=function(e){e="string"==typeof e.data?JSON.parse(e.data):e.data,t.onMessage(e)})},Bt.prototype.onMessage=function(t){},Bt.prototype.closeHandler=function(t){this.socket&&(this.socket.onclose=function(e){t(e)})},Bt.prototype.errorHandler=function(t){this.socket&&(this.socket.onerror=t)},Bt.prototype.closeSocket=function(){this.socket&&(this.socket.onclose=null,this.socket.onerror=null,this.socket.close(),this.socket=null)},Bt.prototype.isDisConnect=function(){return!this.socket||1!==this.socket.readyState},Bt.prototype.sendMessage=function(t){this.isDisConnect()||this.socket&&this.socket.send(t)};var V,W=Bt,Y={TIMEOUT:{code:1100002,msg:"network timeout."},SOCKET_CLOSE:{code:1100003,msg:"socket close"},NET_SOCKET_TIMEOUT:{code:1100004,msg:"net agent timeout"},NET_HB_TIMEOUT:{code:1100005,msg:"net hb timeout"},NET_CONNECT_TIMEOUT:{code:1100006,msg:"net connect timeout"}},Z="zn.zca.gc",K="zn.zca.gac",$="zn.zca.rd",Q="zn.nab.du",X="zn.nab.gac",J="zn.nhb.s",tt="zn.rlh.at",et="zn.rlh.sm",nt="zn.wl.cs.0",rt="zn.wl.bse",it="zn.napr.sr",ot="zn.napr.ope",st="zn.nahr.sr",at="zn.nahr.sr2",ut={domains:["accesshub-wss.zego.im"],mode:"online",modeNo:a.MODE_ONLINE,sdkType:3,connectVer:30,pcEstablishTimeout:15,scheme:"wss",location:"accesshub",wssMessageType:1},ct=(V=function(t,e){return(V=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(){return(ct=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)}),lt=function(t){function e(e,n,r,o,s){var a=t.call(this)||this;return a.appID=e,a.env=n,a.protobuf=r,a.logger=o,a.stateCenter=s,a.socketService=new W(a.env),a.urlIndex=0,a.updatedMsgTime=0,a.unUpdateMsgTimeTypes=[i.MSG_TYPE_HB_REQUEST,i.MSG_TYPE_HB_RESPONSE,i.MSG_TYPE_GET_CONFIG_REQUEST,i.MSG_TYPE_GET_CONFIG_RESPONSE,i.MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST2,i.MSG_TYPE_ACCESSHUB_DISPATCH_RESPONSE2],a.netLinkState=0,a.sendCommandList=new M,a.unSendCommandList=new M,a.sendCommandMap={},a.unSendCommandMap={},a.sendDataCheckOnceCount=100,a.sendDataDropTimeout=1e4,a.sendDataCheckInterval=2e3,a.timeout=5e3,a.connectInterval=1e4,a.connectTimer=null,a.connectRsp={},a.unlogTypes=[12,13],a.tryServers=[],a.tryConnectEvents=[],a.connectStartTime=0,a.updatedMsgTime=Date.now(),a}var n=e,r=t;if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=n}return V(n,r),n.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o),e.prototype.initEvent=function(t,e,n,r){this.onConnectedEvent=t,this.onDisConnectedEvent=e,this.onConnectingEvent=n,this.onPushEvent=r},e.prototype.createSocket=function(t){this.servers=t,this.urlIndex=0},e.prototype.destroySocket=function(t){this.logger.info("zn.wl.ds.0 call "+t),this.socketService.closeSocket(),this.netLinkState=0,t!==c.NONE&&this.onDisConnectedEvent&&this.onDisConnectedEvent(t===c.BROKEN),this.resetConnect()},e.prototype.refreshServers=function(t){this.servers=G(G([],t,!0),this.servers,!0)},e.prototype.connectSocket=function(t,e,n){var r=this,i=(void 0===t&&(t=!0),this.logger.info(nt+" call"),this.connectRsp.suc=e,!1),o=(this.connectRsp.fail=function(){n&&(i?r.logger.info(nt+" fail cb has exec"):(n(),i=!0))},t&&(this.urlIndex=(this.urlIndex+1)%this.servers.length),this.servers[this.urlIndex]);return this.connectServer=o,this.logger.info(nt+" server "+o),this.tryServers.push(o),this.connectStartTime=Date.now(),this.closeSocket(),this.netLinkState=1,this.socketService.createSocket(o),this.onConnectingEvent&&this.onConnectingEvent(!0),this.bindSocketEvent(),this.connectTimer=setTimeout((function(){r.logger.info(nt+" timeout"),r.connectEvent(o,Y.NET_CONNECT_TIMEOUT.code),r.connectRsp.fail&&r.connectRsp.fail()}),this.connectInterval),!0},e.prototype.bindSocketEvent=function(){var t=this;this.openHandler((function(){t.logger.info(rt+" open"),t.resetConnect(),t.connectRsp.suc&&t.connectRsp.suc(),t.netLinkState=2,t.connectEvent(t.connectServer,0),t.onConnectedEvent&&t.onConnectedEvent(t.tryServers,t.tryConnectEvents),t.tryConnectEvents=[],t.checkUnSendMsgs(t.unSendCommandList),t.startCheck()})),this.closeHandler((function(e){t.logger.warn(rt+" close "+JSON.stringify(e.code||e)),t.resetConnect(),t.connectRsp.fail&&t.connectRsp.fail(),t.connectEvent(t.connectServer,(null==e?void 0:e.code)||Y.NET_CONNECT_TIMEOUT.code),t.onDisConnectedEvent&&t.onDisConnectedEvent(!0),t.netLinkState=0})),this.errorHandler((function(e){t.logger.warn(rt+" error "+JSON.stringify(e.code||e)),t.resetConnect(),t.connectRsp.fail&&t.connectRsp.fail(),t.connectEvent(t.connectServer,(null==e?void 0:e.code)||Y.NET_CONNECT_TIMEOUT.code),t.onDisConnectedEvent&&t.onDisConnectedEvent(!0),t.netLinkState=0})),this.onMessage()},e.prototype.closeSocket=function(){this.logger.info("zn.wl.cs.1 call"),this.socketService.closeSocket(),this.netLinkState=0},e.prototype.connectEvent=function(t,e){var n;this.connectStartTime&&(n=Date.now()-this.connectStartTime,this.tryConnectEvents.push({url:t,time_consumed:n,connect_type:3,error:e}))},e.prototype.resetConnect=function(){this.connectTimer&&(clearTimeout(this.connectTimer),this.connectTimer=null),this.stopCheck()},e.prototype.isConnect=function(){return 2===this.netLinkState},e.prototype.isDisConnect=function(){return!this.socketService||this.socketService.isDisConnect()},e.prototype.isConnecting=function(){return 1===this.netLinkState},e.prototype.setState=function(t){this.netLinkState=t},e.prototype.closeHandler=function(t){this.socketService.closeHandler(t)},e.prototype.openHandler=function(t){this.socketService.openHandler(t)},e.prototype.errorHandler=function(t){this.socketService.errorHandler(t)},e.prototype.sendMessage=function(t,e,n,r,o,a,u,c){void 0===r&&(r=!0),void 0===o&&(o=null),void 0===a&&(a=null),void 0===u&&(u=null),void 0===(c=void 0===c?{}:c).timeout&&(c.timeout=5e3),void 0===c.isInSendMap&&(c.isInSendMap=!0),void 0===c.isMsgCache&&(c.isMsgCache=!0),this.txid++;var l={appid:this.appID,biz_type:0,mode_no:(null==(l=this.stateCenter.appInfo)?void 0:l.mode)||ut.modeNo,id_name:this.stateCenter.userId,sdk_type:ut.sdkType,zegoconn_run_env:0===this.env?s.ZEGOCONN_RUN_ENV_BROWSER:s.ZEGOCONN_RUN_ENV_APPLET,zegoconn_version:(null==(l=this.stateCenter.appInfo)?void 0:l.connVer)||ut.connectVer};null!=(h=this.stateCenter.appInfo)&&h.deviceID&&(l.device_id=null==(h=this.stateCenter.appInfo)?void 0:h.deviceID);var h=ct(ct({txid:this.txid},r?l:{}),n);r={data:h,txid:this.txid,sendTime:Date.now(),streamID:e,type:t,timeOut:c.timeout||this.timeout,ack:n.ack,success:o,error:a,ackFunc:u,isSend:!0,isCheck:t!==i.MSG_TYPE_PC_UPWARD_MESSAGE,extras:c.extras},c.isInSendMap&&(l=this.sendCommandList.push(r),this.sendCommandMap[this.txid]=l),10!==h.service&&14!==h.interface_id&&this.unUpdateMsgTimeTypes.includes(t)||(this.updatedMsgTime=Date.now()),-1===this.unlogTypes.indexOf(t)&&this.logger.info("zn.wl.sm type: "+t+"-"+m[t]+" streamID: "+e+" txid: "+this.txid),this.isConnect()?this.sendUint8Data(t,h,e,c.extras):c.isMsgCache&&(r.isSend=!1,n=this.unSendCommandList.push(r),this.unSendCommandMap[this.txid]=n)},e.prototype.checkUnSendMsgs=function(t){for(var e,n=t.getFirst();null!=n;)t.remove(n),n._data&&!1===(null==(e=n._data)?void 0:e.isSend)&&n._data.type&&n._data.streamID&&n._data.data&&(this.sendUint8Data(n._data.type,n._data.data,n._data.streamID),n._data.isSend=!0),n=t.getFirst()},e.prototype.Uint8ToArrayBuffer=function(t){return t.buffer.slice(t.byteOffset,t.byteLength+t.byteOffset)},e.prototype.sendUint8Data=function(t,e,n,r){t=this.protobuf.encodeRequest(t,e,n),this.socketService.sendMessage(this.Uint8ToArrayBuffer(t))},e.prototype.onMessage=function(){var t=this;this.socketService.onMessage=function(e){e=new Uint8Array(e);var n,r,i=(r=t.protobuf.decodeResponse(e))[0],o=r[1],s=((r=r[2]).txid&&y.a.isLong(r.txid)&&r.txid.toNumber&&(r.txid=r.txid.toNumber()),t.unUpdateMsgTimeTypes.includes(o)||(t.updatedMsgTime=Date.now()),(null==r?void 0:r.txid)||(null==(s=null==r?void 0:r.data)?void 0:s.txid));-1===t.unlogTypes.indexOf(o)&&(n=s?", txid: ".concat(s):"",t.logger.info("zn.wl.om"+" streamID: ".concat(i,", msgType: ").concat(o,"-").concat(m[o])+n)),s&&t.isRspMsg(s)?t.handleSendCommandMsgRsp(i,o,s,r,{size:e.length}):t.onPushEvent(i,o,r,{size:e.length})}},e.prototype.isRspMsg=function(t){return void 0!==this.sendCommandMap[t]},e.prototype.startCheck=function(){var t=this;this.checkMessageListTimeout(this.sendCommandList,this.sendCommandMap),this.sendDataCheckTimer=setTimeout((function(){t.startCheck()}),this.sendDataCheckInterval)},e.prototype.stopCheck=function(){this.checkSendMessageList(this.sendCommandList),clearTimeout(this.sendDataCheckTimer)},e.prototype.checkMessageListTimeout=function(t,e){for(var n,r=t.getFirst(),i=Date.now(),o=0,s=this;null!=r&&"break"!==function(){var a,u,c;return r._data&&r._data.sendTime+r._data.timeOut>i||(r._data&&delete e[r._data.data.txid],t.remove(r),r._data&&null==r._data.error||r._data&&r._data.sendTime+s.sendDataDropTimeout<i||(a=r&&r._data&&r._data.error,u=r&&r._data&&r._data.txid,c=r&&r._data&&(null==(n=r._data)?void 0:n.isCheck),setTimeout((function(){c&&a&&a({},u,Y.TIMEOUT)}),0)),++o>=s.sendDataCheckOnceCount)?"break":void(r=t.getFirst())}(););},e.prototype.checkSendMessageList=function(t){for(var e,n=t.getFirst();null!=n&&n._data;)!function(){var r,i,o;t.remove(n),n._data.isSend&&n._data.error&&(r=n&&n._data&&n._data.error,i=n&&n._data&&n._data.txid,o=n&&n._data&&(null==(e=n._data)?void 0:e.isCheck),setTimeout((function(){o&&r&&r({},i,Y.TIMEOUT)}),0)),n=t.getFirst()}()},e.prototype.handleSendCommandMsgRsp=function(t,e,n,r,o){var s,a=this.sendCommandMap[n];null!=a&&(null!=(s=a._data)&&s.ack||(delete this.sendCommandMap[n],this.sendCommandList.remove(a)),r.code&&0!==r.code?s&&null!=s.error&&s.error(r,n):e===i.MSG_TYPE_PUSH_EXCEPTION?(r.code=r.reason,r.message=r.msg,delete r.reason,delete r.msg,s&&null!=s.error&&s.error(r,n)):e===i.MSG_TYPE_HTTP_REQUEST_ACK?s&&null!=s.ackFunc&&s.ackFunc(r,n):s&&null!=s.success&&s.success(r,n,o))},e}(v),ht=(Ut.prototype.getConfig=function(t,e){var n;this.logger.info("zn.nab.gc call"),this.streamManager.createStream(u.OTHER).sendMessage(i.MSG_TYPE_GET_CONFIG_REQUEST,{geofencing_type:null==(n=this.stateCenter.appInfo.geoFencing)?void 0:n.type,geofencings:null==(n=this.stateCenter.appInfo.geoFencing)?void 0:n.list},t,e)},Ut.prototype.dispatchURL=function(t,e){var n,r=this;this.logger.info(Q+" call"),this.streamManager.createStream(u.OTHER).sendMessage(i.MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST2,{geofencing_type:null==(n=this.stateCenter.appInfo.geoFencing)?void 0:n.type,geofencings:null==(n=this.stateCenter.appInfo.geoFencing)?void 0:n.list},(function(e){r.logger.info(Q+" suc "),t&&t(e)}),(function(t,n,i){r.logger.info(Q+" fail"),e&&e(i||t)}))},Ut.prototype.getAppConfig=function(t,e,n,r,o){var s=this;return new Promise((function(a,c){function l(t,e,n){n?(s.logger.error(X+" fail "+JSON.stringify(n)),c(n)):0===t.code?(s.logger.info(X+" suc"),n=s.decodeConfigMessage(t.data.data),a({code:0,data:n,etag:t.data.etag})):(s.logger.error(X+" fail "+t.code),c({code:t.code}))}s.logger.info(X+" call");var h={id_name:e,config_key:t,token:n,mode_no:(null==(h=s.stateCenter.appInfo)?void 0:h.mode)||ut.modeNo,etag:o};s.streamManager.createStream(u.OTHER).sendMessage(i.MSG_TYPE_GET_APPCONFIG_REQUEST,h,l,l,null,{timeout:r})}))},Ut.prototype.decodeConfigMessage=function(t){return this.protobuf.decodeConfigMessage(t)},Ut),ft=(xt.prototype.init=function(t){var e=this;this.logger.info("zn.nhb.ii call"),this.hbStream||(this.hbStream=this.streamManager.createStream(u.OTHER)),1<=t.data.logic_hb_interval&&t.data.logic_hb_interval<=10&&(this.hbInterval=t.data.logic_hb_interval),3<=t.data.logic_hb_timeout&&t.data.logic_hb_timeout<=30&&(this.hbTimeout=t.data.logic_hb_timeout),this.tryHbCount=0,this.hbTimeoutMaxCount=this.hbTimeout/this.hbInterval,this.hbTimer&&clearTimeout(this.hbTimer),this.hbTimer=setTimeout((function(){e.start()}),1e3*this.hbInterval)},xt.prototype.start=function(){var t,e,n,r=this;this.logger.debug(J+" call "),this.tryHbCount++>this.hbTimeoutMaxCount?(this.logger.error(J+" come to try limit"),this.reset(),this.netHbLogout(Y.NET_HB_TIMEOUT)):(t=(new Date).getTime(),e=function(e,n,i){var o=(new Date).getTime()-t;r.logger.debug(J+" hb callback "+o),i&&0!==(null==i?void 0:i.code)?r.logger.info(J+" fail "+JSON.stringify(i)):(null!=e&&e.ntp_time&&(i="number"==typeof(o=e.ntp_time)?o:o.toNumber(),e=(new Date).getTime(),r.stateCenter.updateNTP(t,i,e)),r.tryHbCount=0)},n={ts:Date.now()},this.hbStream.sendMessage(i.MSG_TYPE_HB_REQUEST,n,e,e,null),this.hbStream.isFirst=!1,this.hbTimer&&clearTimeout(this.hbTimer),this.hbTimer=setTimeout((function(){r.start()}),1e3*this.hbInterval))},xt.prototype.netHbLogout=function(t){},xt.prototype.reset=function(){this.hbTimer&&(clearTimeout(this.hbTimer),this.hbTimer=null),this.tryHbCount=0},xt),dt=(Dt.prototype.addEventHandler=function(t,e){if(this.handlerListMap[t]||(this.handlerListMap[t]=[]),"function"!=typeof e)throw new Error("Params callBack is not a Function");return this.handlerListMap[t]&&-1==this.handlerListMap[t].indexOf(e)&&this.handlerListMap[t].push(e),!0},Dt.prototype.removeEventHandler=function(t,e){return!!this.handlerListMap[t]&&(this.handlerListMap[t]=e?this.handlerListMap[t].filter((function(t){return t!==e})):[],!0)},Dt.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.handlerListMap[t]&&this.handlerListMap[t].forEach((function(n){try{n.apply(void 0,e)}catch(n){console.error('Fail to execute callback of event "'.concat(t,'" : ').concat(n))}}))},Dt),pt=function(){return(pt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},gt=(Mt.prototype.sendRequest=function(t,e,n,r){var o=this,s=t.payload,a=(null!=(a=this.option)&&a.encode&&(s=F(t.payload)),{service_no:this.service,ack:t.ack,payload:s,wss_message_type:null!=(s=null==(a=this.option)?void 0:a.messageType)?s:ut.wssMessageType,wss_path:null==(a=this.option)?void 0:a.path,wss_raw_query:null==(s=this.option)?void 0:s.query,zegoconn_version:ut.connectVer});this.netPcStream.isConnect()||(this.logger.info(it+" pc is not connect"),this.eventManager.emit("connectStart")),this.netPcStream.sendMessage(i.MSG_TYPE_PC_UPWARD_MESSAGE,a,(function(){o.logger.info(it+" suc"),n&&n()}),(function(t){o.logger.error(it+" fail"),e&&e(t)}),null,{isInSendMap:"boolean"==typeof t.isInSendMap&&t.isInSendMap,extras:r,isMsgCache:null==(s=this.option)?void 0:s.isMsgCache})},Mt.prototype.onPushEvent=function(t,e,n){var r;switch(this.logger.info(ot+" msgType: ".concat(t)),t){case i.MSG_TYPE_PC_ESTABLISHED:this.netPcStream.isFirst=!1,this.pcEstablished(e,this.netPcStream.StreamID);break;case i.MSG_TYPE_PC_BROKEN:this.pcBroken();break;case i.MSG_TYPE_PC_DOWNWARD_MESSAGE:this.logger.info(ot+" ".concat(this.service," down ").concat((null==e?void 0:e.ts)&&e.ts.toNumber&&e.ts.toNumber()||e.ts));var o=e.payload;null!=(r=this.option)&&r.encode&&(o=q(e.payload)),this.eventManager.emit("downLoadMessage",o,n);break;case i.MSG_TYPE_PUSH_EXCEPTION:this.logger.info(ot+" ".concat(this.service," exception ").concat(JSON.stringify(e))),this.eventManager.emit("exception",e,n)}},Mt.prototype.on=function(t,e){return this.eventManager.addEventHandler(t,e)},Mt.prototype.off=function(t,e){this.eventManager.removeEventHandler(t,e)},Mt.prototype.pcEstablished=function(t,e){this.logger.info("zn.napr.pe call "+JSON.stringify(t)),this.setConnectState(l.CONNECTED);var n=p.MANUAL;this.lastConnectState===l.BROKEN&&this.connectState===l.CONNECTED&&(n=p.AUTO),this.eventManager.emit("connected",n),this.reportEvent("pcConnectedEvent",{proxy_link_sources:null==t?void 0:t.from,connect_stream:e}),this.brokenTimer&&clearTimeout(this.brokenTimer)},Mt.prototype.pcBroken=function(){var t=this;this.logger.info("zn.napr.pb call"),this.setConnectState(l.BROKEN),this.eventManager.emit("broken"),this.reportEvent("pcBrokenEvent"),this.brokenTimer=setTimeout((function(){t.eventManager.emit("disconnected",d.TEMP),t.reportEvent("pcDisconnectedEvent")}),1e3*this.pcEstablishTimeout)},Mt.prototype.resetBrokenTimer=function(){this.brokenTimer&&clearTimeout(this.brokenTimer)},Mt.prototype._close=function(t,e){var n;this.logger.info("zn.napr.cr call "+this.service+" "+this.connectState),this.connectState!==l.DISCONNECT&&(this.netPcStream.closeStream(0,""),this.resetBrokenTimer(),n=this.streamManager.getStreamID(),this.netPcStream.refresh(n),this.eventManager.emit(t,e),n="","broken"===t?n="pcBrokenEvent":"disconnected"===t&&(n="pcDisconnectedEvent"),n)&&this.reportEvent(n),this.setConnectState(l.DISCONNECT)},Mt.prototype.closePc=function(){this._close("broken")},Mt.prototype.closeRequest=function(){this._close("disconnected",d.CLOSE)},Mt.prototype.setConnectState=function(t){this.connectState!==t&&(this.lastConnectState=this.connectState,this.connectState=t)},Mt.prototype.reportEvent=function(t,e){this.eventManager.emit(t,pt({service_no:this.service},e))},Mt),_t=(Pt.prototype.getRequest=function(t,e){return t=new gt(this.logger,t,this.streamManager,this.pcEstablishTimeout,e),this.pcStreamRequests.push(t),t},Pt.prototype.updateConnectState=function(t,e,n){this.logger.info("zn.naprm.ucs call "+t+" "+e),this.pcStreamRequests.forEach((function(r){t===l.BROKEN?(r.eventManager.emit("broken"),r.reportEvent("pcBrokenEvent")):t===l.DISCONNECT&&(r.eventManager.emit("disconnected",e,n),r.reportEvent("pcDisconnectedEvent"))}))},Pt.prototype.closePCs=function(){this.pcStreamRequests.forEach((function(t){t.closePc()}))},Pt.prototype.setEstablishTimeout=function(t){this.pcEstablishTimeout=t},Pt),mt=(Lt.prototype.initLink=function(t){this.link=t},Lt.prototype.startMaxTime=function(){var t=this;this.logger.info(et+" call"),this.maxTimer||(this.logger.info(et+" start max timer"),this.maxTimer=setTimeout((function(){t.logger.warn(et+" over max time ".concat(t.RETRY_MAX_TIME,"s, stop retry")),t.isOverTime=!0,t.link.destroySocket(c.NONE),t.stopMaxTime(),t.invalid(),t.onactive(!1,Y.NET_SOCKET_TIMEOUT)}),1e3*this.RETRY_MAX_TIME))},Lt.prototype.stopMaxTime=function(){this.maxTimer&&clearTimeout(this.maxTimer),this.maxTimer=null},Lt.prototype.active=function(t,e,n){var i=this;if(void 0===n&&(n=!1),this.logger.info(tt+" call "+t+" "+(e=void 0!==e&&e)),this.retryTimer)return this.logger.info(tt+" has actived, ignore"),!1;var o=this.stateCenter.networkState==r.offline;if(o){if(this.logger.info(tt+"  check if really offline. "+this.retryNetCount),this.retryNetCount>=this.retryNetMaxTimes)return this.logger.warn(tt+" network is broken, stop retry"),!1}else this.retryNetCount=0;return this.link.isConnecting()&&!n?(this.logger.info(tt+" link is connecting, ignore"),!1):this.isOverTime?(this.logger.info(tt+" retry over time, stop retry"),!1):(1==this.retryActiveCount?this.retryActiveInterval=Math.floor(Math.random()*(1-this.RETRY_START_TIME_INTERVAL)+this.RETRY_START_TIME_INTERVAL):(n=Math.pow(2,Math.round(this.retryActiveCount/this.RETRY_CONTINUE_COUNT+1)),this.retryActiveInterval=n>this.RETRY_MAX_TIME_INTERVAL?this.RETRY_MAX_TIME_INTERVAL:n),this.logger.info(tt+" interval "+this.retryActiveInterval),this.retryTimer=setTimeout((function(){i.link.destroySocket(c.BROKEN),i.link.connectSocket(t,(function(){i.logger.info(tt+" suc"),i.stateCenter.networkState=r.online,i.stopMaxTime(),i.invalid(),i.onactive(!0)}),(function(){i.logger.info(tt+" fail"),i.maxTimer||i.startMaxTime(),i.active(!0,!1,!0)})),i.retryTimer&&clearTimeout(i.retryTimer),i.retryTimer=null,o?i.retryNetCount++:i.retryActiveCount++}),e?0:1e3*this.retryActiveInterval),!0)},Lt.prototype.onactive=function(){for(var t=0;t<arguments.length;t++);},Lt.prototype.init=function(t,e,n,r){this.invalid(),this.stopMaxTime(),this.isOverTime=!1,"number"==typeof t&&t<3600&&(this.RETRY_MAX_TIME=t),"number"==typeof e&&(this.RETRY_START_TIME_INTERVAL=e),"number"==typeof n&&(this.RETRY_CONTINUE_COUNT=n),"number"==typeof r&&(this.RETRY_MAX_TIME_INTERVAL=r)},Lt.prototype.invalid=function(){this.logger.info("zn.rlh.ivd end retry"),this.retryTimer&&clearTimeout(this.retryTimer),this.retryTimer=null,this.retryActiveCount=1,this.retryNetCount=0},Lt),vt=(At.prototype.updateNTP=function(t,e,n){var r;n<t||(r=n-t,this.timeOffset=Math.round((e-t+(e-n))/2),t=Math.round(e+r/2),(!this.networkRTT||r<this.networkRTT)&&(this.networkRTT=r,this.ntpTimeInfo={performanceTime:Math.round(performance.now()),ntp:t}))},At),yt=(Nt.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.join(" ");console.log(n)},Nt.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.join(" ");console.debug(n)},Nt.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.join(" ");console.info(n)},Nt.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.join(" ");console.warn(n)},Nt.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.join(" ");console.error(n)},Nt),bt=function(){return(bt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},St=(Ot.prototype.sendRequest=function(t,e,n,r,o){var s=this,a=t.disableLog;t={service_no:this.service,ack:t.ack,headers:t.headers,body:F(JSON.stringify(t.body)),id_name:t.idName,method_no:t.method_no,stick:t.stick,location:t.location,reduce_resp_header:t.reduceRspHeaders?1:0},this.netHttpStream.sendMessage(i.MSG_TYPE_HTTP_REQUEST,t,(function(t){s.closeStream();var n=("gzip"===(null==(n=(null==t?void 0:t.headers).find((function(t){return"Content-Encoding"===(null==t?void 0:t.name)})))?void 0:n.val)?a||s.logger.info(st+" gzip"):t.body&&(n=q(t.body),t.body=n),bt(bt({},t),{body:void 0}));a||s.logger.info(st+" suc "+JSON.stringify(n)),e&&e(t)}),(function(t,e,r){s.closeStream(),a||s.logger.error(st+" fail"),n&&n(r||t)}),(function(t){a||s.logger.error(st+" ack"),r&&r(t)}),o),this.netHttpStream.isFirst=!1},Ot.prototype.sendRequest2=function(t,e,n,r,o){var s=this,a=1===t.format?F(JSON.stringify(t.body)):t.body;a={ack:t.ack,body:a,id_name:t.idName,method:t.method,interface_id:t.interfaceID,token:t.token,reduce_resp_header:t.reduceRspHeaders?1:0},t.headers&&(a.headers=t.headers),t.resID&&(a.res_id=t.resID),t.urlParams&&(a.params=t.urlParams),t.mode&&(a.mode=t.mode),this.netHttpStream.sendMessage(i.MSG_TYPE_HTTP_REQUEST2,a,(function(r,i){s.closeStream();var o=(null==r?void 0:r.headers).find((function(t){return"Content-Encoding"===(null==t?void 0:t.name)}));if(200===r.status_code){if("gzip"===(null==o?void 0:o.val))s.logger.info(at+" gzip");else if(r.body&&1===t.format)try{a=q(r.body),r.body=a}catch(i){s.logger.info(at+" decode "+JSON.stringify(i))}o=bt(bt({},r),{body:void 0}),s.logger.info(at+" suc "+JSON.stringify(o)),e&&e(r,i)}else{try{var a=q(r.body);r.body=a}catch(i){s.logger.info(at+" status "+r.status_code+" "+JSON.stringify(i))}n&&n(r)}}),(function(t,e,r){s.closeStream(),s.logger.error(at+" fail"),n&&n(r||t)}),(function(t){s.logger.error(at+" ack"),r&&r(t)}),o),this.netHttpStream.isFirst=!1},Ot.prototype.closeStream=function(){this.logger.info("zn.nahr.cs call"),this.netHttpStream.closeStream(0,"")},Ot),Et=(Object.defineProperty(kt.prototype,"StreamID",{get:function(){return this.streamID},enumerable:!1,configurable:!0}),kt.prototype.refresh=function(t){this.streamID=t,this.isFirst=!0},kt.prototype.sendMessage=function(t,e,n,r,i,o){var s=this;void 0===n&&(n=null),void 0===r&&(r=null),this.zegoLink.sendMessage(t,this.streamID,e,this.isFirst,(function(t,e,r){s.type!==u.PC&&(s.isFree=!0),n&&n(t,r)}),(function(t,e,n){s.type!==u.PC&&(s.isFree=!0),r&&r(t,e,n)}),i=void 0===i?null:i,o=void 0===o?{timeout:5e3,isInSendMap:!0}:o)},kt.prototype.onPushEvent=function(t,e,n){},kt.prototype.closeStream=function(t,e){this.zegoLink.sendMessage(i.MSG_TYPE_STREAM_CLOSED,this.streamID,{code:t,msg:e})},kt.prototype.isConnect=function(){return this.zegoLink.isConnect()},kt),Tt=(It.prototype.createStream=function(t){var e=new Et(t,this.streamID++,this.zegoLink);return t===u.PC&&this.pcStreams.push(e),e},It.prototype.onPushEvent=function(t,e,n,r){var i=this.pcStreams.find((function(e){return e.StreamID===t}));i&&i.onPushEvent(e,n,r)},It.prototype.getStreamID=function(){return this.streamID++},It),Ct=function(){return(Ct=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},wt=(Object.defineProperty(Rt.prototype,"clientIP",{get:function(){return this.stateCenter.clientIP},enumerable:!1,configurable:!0}),Object.defineProperty(Rt.prototype,"timeOffset",{get:function(){return this.stateCenter.timeOffset},enumerable:!1,configurable:!0}),Object.defineProperty(Rt.prototype,"linkConnectState",{get:function(){return this._linkConnectState},set:function(t){this.lastLinkConnectState=this._linkConnectState,this._linkConnectState=t},enumerable:!1,configurable:!0}),Rt.prototype.init=function(){this.logger=new yt,this.protobuf=new L,this.stateCenter=new vt,this.eventManager=new dt,this.checkLinkMsg(),this.inited=!0},Rt.prototype.unInit=function(){this.inited=!1},Rt.prototype.setAppInfo=function(t){this.logger.info("zn.sai.0 "+JSON.stringify(t)),this.stateCenter.appInfo=t,this.stateCenter.networkState=!navigator||navigator.onLine?r.online:r.offline,0===t.env?this.bindWindowListener():1===t.env&&this.bindWxListener(),this.zegoLink=new lt(t.appID,t.env,this.protobuf,this.logger,this.stateCenter),this.zegoLink.initEvent(this.onConnectedEvent,this.onDisConnectedEvent,this.onConnectingEvent,this.onPushEvent),this.streamManager=new Tt(this.zegoLink),this.businessRequestMgr=new ht(this.streamManager,this.protobuf,this.logger,this.stateCenter),this.netHeartBeatHandler=new ft(this.streamManager,this.logger,this.stateCenter),this.netAgentPCRequestMgr=new _t(this.streamManager,this.logger),this.heartBeatHandler()},Rt.prototype.setUserInfo=function(t){this.stateCenter.userId=t},Rt.prototype.setNetAgentDefaultServers=function(t){this.connectServers=j([],t,!0)},Rt.prototype.setNetAgentSpecifiedServers=function(t){this.logger.info("zn.sss.0 "+JSON.stringify(t)),this.stateCenter.specified=!0,this.specifiedServers=j([],t,!0)},Rt.prototype.setBackupDomains=function(t){this.primaryDomains=t},Rt.prototype.setDispatchConnectServers=function(t){this.connect(t)},Rt.prototype.startHttpRequest=function(t,e,n,r,i){var o=this,s=this.reportSeq++;this.eventManager.emit("requestEvent",s,"start"),this.isConnect()||(this.logger.info("zn.shq.0 link is not connect"),this.connectUa()),new St(this.logger,this.streamManager,t.service).sendRequest(t,(function(n){o.eventManager.emit("requestEvent",s,"end",{na_req_location:t.location,status_code:n.status_code,err_code:0}),e&&e(n)}),(function(e){o.eventManager.emit("requestEvent",s,"end",{na_req_location:t.location,err_code:e.code||0}),n&&n(e)}),r,i)},Rt.prototype.startHttpRequest2=function(t,e,n,r,i){var o=this,s=this.reportSeq++;this.eventManager.emit("requestEvent",s,"start"),this.isConnect()||(this.logger.info("zn.shq.0 link is not connect"),this.connectUa()),new St(this.logger,this.streamManager).sendRequest2(t,(function(n,r){o.eventManager.emit("requestEvent",s,"end",{na_req_interface:t.interfaceID,status_code:n.status_code,err_code:0}),e&&e(n,r)}),(function(e){o.eventManager.emit("requestEvent",s,"end",{na_req_interface:t.interfaceID,err_code:e.code||0}),n&&n(e)}),r,i)},Rt.prototype.getAppConfigByAgent=function(t,e,n,r){return this.isConnect()||(this.logger.info("zn.gab.0 link is not connect"),this.connectUa()),this.getAppConfig(t,this.stateCenter.userId,e,n,r)},Rt.prototype.getPCRequest=function(t,e){var n=this;return(e=this.netAgentPCRequestMgr.getRequest(t,e)).on("disconnected",(function(e){n.logger.warn("zn.zca.gpr "+t+" disconnect "+e),e===d.TEMP&&(n.disConnect(),n.connectStart())})),e.on("connectStart",(function(){n.connectUa()})),e},Rt.prototype.connectUa=function(){this.isDestroy||(this.logger.info("zn.zca.cua call"),this.retryLinkHandler&&(this.retryLinkHandler.init(),this.connectStart(!1,!0)))},Rt.prototype.destroyConnect=function(){this.logger.info("zn.zca.dc.0 call"),this.resetNetAgent()},Rt.prototype.destroy=function(){this.logger.info("zn.zca.dy.0 call"),this.destroyConnect(),this.linkCheckTimer&&clearTimeout(this.linkCheckTimer),this.retryLinkHandler&&this.retryLinkHandler.invalid(),this.retryLinkHandler&&this.retryLinkHandler.stopMaxTime(),this.isDestroy=!0},Rt.prototype.isConnect=function(){return this.zegoLink&&this.zegoLink.isConnect()},Rt.prototype.on=function(t,e){return this.logger.info("zn.zca.o.0 "+t),this.eventManager.addEventHandler(t,e)},Rt.prototype.off=function(t,e){this.logger.info("zn.zca.o.1 "+t),this.eventManager.removeEventHandler(t,e)},Rt.prototype.setLogger=function(t){this.logger=t},Rt.prototype.setAccess=function(t){this.stateCenter.useNetAgent=t},Rt.prototype.getVersion=function(){return"1.1.5"},Rt.prototype.heartBeatHandler=function(){var t=this;this.netHeartBeatHandler.netHbLogout=function(e){t.retryLinkHandler&&([Y.NET_HB_TIMEOUT.code].includes(e.code)?(t.retryLinkHandler.startMaxTime(),t.disConnect(),t.connectStart()):(t.retryLinkHandler.stopMaxTime(),t.retryLinkHandler.invalid(),t.eventManager.emit("disconnected")))}},Rt.prototype.bindWindowListener=function(){var t=this;window.addEventListener("offline",(function(){t.netOffLineHandle()})),window.addEventListener("online",(function(){t.netOnLineHandle()}))},Rt.prototype.bindWxListener=function(){var t=this;wx.onNetworkStatusChange((function(e){e.isConnected?t.netOnLineHandle():t.netOffLineHandle()}))},Rt.prototype.netOnLineHandle=function(){this.logger.info("zn.zca.noh.0 network is online"),this.stateCenter.networkState=r.online,this.stateCenter.useNetAgent&&this.netOnLineHandler()},Rt.prototype.netOffLineHandle=function(){this.logger.info("zn.zca.noh.1 network is broken"),this.stateCenter.networkState=r.offline,this.stateCenter.useNetAgent&&this.netOffLineHandler()},Rt.prototype.checkLinkMsg=function(){var t=this;if(this.stateCenter.useNetAgent){if(this.isConnect()){var e=Date.now()-this.zegoLink.updatedMsgTime;if(e>1e3*this.linkMsgMaxInterval)return this.logger.info("zn.zca.clm interval: "+e),void this.resetNetAgent()}this.linkCheckTimer&&clearTimeout(this.linkCheckTimer),this.linkCheckTimer=setTimeout((function(){t.checkLinkMsg()}),1e3*this.linkMsgCheckInterval)}},Rt.prototype.connect=function(t){var e=this;0<t.length&&(this.connectServers=j([],t,!0)),this.stateCenter.specified&&0<this.specifiedServers.length&&(this.connectServers=this.specifiedServers),this.zegoLink.createSocket(this.connectServers),this.retryLinkHandler||(this.retryLinkHandler=new mt(this.logger,this.stateCenter)),this.retryLinkHandler.init(),this.retryLinkHandler.initLink(this.zegoLink),this.retryLinkHandler.onactive=function(t,n){n===Y.NET_SOCKET_TIMEOUT&&(e.eventManager.emit("disconnected",n),e.netAgentPCRequestMgr.updateConnectState(l.DISCONNECT,d.TIMEOUT,n))},this.connectStart(!1,!0)},Rt.prototype.resetNetAgent=function(){this.netHeartBeatHandler&&this.netHeartBeatHandler.reset(),this.zegoLink&&this.zegoLink.destroySocket(c.DISCONNECT)},Rt.prototype.getConfig=function(){function t(t,r,i){i?e.logger.info(Z+" fail "+JSON.stringify(i)):0===t.code?(e.logger.info(Z+" suc "+JSON.stringify(t)),e.getConfigSuccess(t,n)):e.logger.info(Z+" fail "+JSON.stringify(t))}var e=this,n=(new Date).getTime();this.businessRequestMgr.getConfig(t,t)},Rt.prototype.getConfigSuccess=function(t,e){var n,r;this.netHeartBeatHandler.init(t),this.netAgentPCRequestMgr.setEstablishTimeout(t.data.pc_establish_timeout),null!=(n=null==t?void 0:t.data)&&n.client_outer_ip&&(this.stateCenter.clientIP=t.data.client_outer_ip),null!=(n=null==t?void 0:t.data)&&n.ntp_time&&(n="number"==typeof(n=t.data.ntp_time)?n:n.toNumber(),r=(new Date).getTime(),this.stateCenter.updateNTP(e,n,r)),this.eventManager.emit("clientInfo",{clientIP:this.clientIP,timeOffset:this.timeOffset,geofencingID:e=t.data.geofencing_id})},Rt.prototype.dispatch=function(){var t=this;return new Promise((function(e,n){t.businessRequestMgr.dispatchURL((function(n){n=n.data.wss_groups;var r=(t.logger.info(Q+" wss_groups: "+JSON.stringify(n)),n.some((function(t){return t.host.includes("geo")}))),i=null!=(i=t.stateCenter.appInfo)&&i.geoFencing||r?n:t.getConnectionDomains(n,t.primaryDomains);r=t.handleWssGroups(i),e({servers:r,domains:i})}),(function(t){n(t)}))}))},Rt.prototype.handleWssGroups=function(t){return Array.isArray(t)&&0<t.length?t.map((function(t){return ut.scheme+"://"+t.host+"/"+ut.location})):[]},Rt.prototype.getConnectionDomains=function(t,e){var n=j([],t,!0);return e.forEach((function(e){t.forEach((function(t){var r,i="";t.main_domain?i=t.main_domain:t.host&&(i=(r=t.host.split("."))[r.length-2]+"."+r[r.length-1]),i&&i!==e&&(r=t.host.replace(i,e),n.push({group:t.group,host:r}))}))})),n=n.filter((function(t){return!!t.host}))},Rt.prototype.getAppConfig=function(t,e,n,r,i){var o=this;return new Promise((function(s,a){"string"==typeof e&&"string"==typeof n?o.businessRequestMgr.getAppConfig(t,e,n,r,i).then((function(t){s(Ct(Ct({},t),{retryCount:o.getAppConfigFailCount}))})).catch((function(r){var u;o.logger.error(K+" "+JSON.stringify(r)),!(-1<_.indexOf(r.code))&&(o.getAppConfigFailCount++,20008===r.code||1100002===r.code)&&o.getAppConfigFailCount<3?o.getAppConfig(t,e,n,i).then((function(t){return s(t)})).catch((function(t){return a(t)})):(u=o.getAppConfigFailCount,o.getAppConfigFailCount=0,a(Ct(Ct({},r),{retryCount:u})))})):o.logger.error(K+" userID or token must be string")}))},Rt.prototype.reportDisConnectEvent=function(){var t=(new Date).getTime()-this.connectedTime;this.connectid&&this.eventManager.emit("disConnectedEvent",{duration:t,server:this.zegoLink.connectServer,connectid:this.connectid})},Rt.prototype.redirect=function(t){this.logger.info($+" ".concat(JSON.stringify(t.wss_groups))),(t=this.handleWssGroups(t.wss_groups))&&Array.isArray(t)&&0<t.length?(this.disConnect(),this.stateCenter.specified&&(this.logger.info($+" specified"),t=this.specifiedServers),this.zegoLink.createSocket(t),this.connectStart(!1,!0)):this.logger.warn($+" wss_groups null")},Rt.prototype.connectClosed=function(t){var e=this;switch(this.logger.info("zn.zca.cc"+" ".concat(t.reason," ").concat(t.msg," ").concat(t.action)),t.action){case h.ACTION_DISPATCH:var n=this.reportSeq++;this.eventManager.emit("dispatchEvent",n,"start"),this.dispatch().then((function(t){var r=t.servers;e.eventManager.emit("dispatchEvent",n,"end",{domains:t=t.domains,reason:"ConnectClosed"}),Array.isArray(r)&&0<r.length&&(e.eventManager.emit("dispatchResultUpdate",{servers:r,domains:t}),t=e.stateCenter.specified?e.specifiedServers:r,e.disConnect(),e.zegoLink.createSocket(t),e.connectStart(!1,!0))})).catch((function(t){e.logger.info("zn.zca.cc dispatch fail")}));break;case h.ACTION_RETRY:this.disConnect(),this.connectStart(!1);break;case h.ACTION_NEXT_GROUP:this.netAgentPCRequestMgr.closePCs(),this.eventManager.emit("broken",g.CLOSE),this.connectStart()}},Rt.prototype.netOnLineHandler=function(){this.retryLinkHandler&&(this.zegoLink.isConnect()?this.retryLinkHandler.stopMaxTime():this.connectStart())},Rt.prototype.netOffLineHandler=function(){this.disConnect(),this.retryLinkHandler&&(this.retryLinkHandler.invalid(),this.retryLinkHandler.startMaxTime(),this.zegoLink.setState(0))},Rt.prototype.connectStart=function(t,e){this.retryLinkHandler.active(t,e)&&this.reportConnectEvent()},Rt.prototype.reportConnectEvent=function(){var t=this.reportSeq++;this.connectSeq=t,this.eventManager.emit("connectedEvent",t,"start")},Rt.prototype.disConnect=function(){this.logger.info("zn.zca.dc.1 call"),this.netAgentPCRequestMgr.closePCs(),this.eventManager.emit("broken"),2===this.lastLinkConnectState&&0===this.linkConnectState&&this.reportDisConnectEvent()},Rt.prototype.getNetworkTimeInfo=function(){var t,e=Date.now()+this.stateCenter.timeOffset,n=Math.round(this.stateCenter.networkRTT/2),r=this.stateCenter.ntpTimeInfo;return r&&(t=performance.now()-r.performanceTime,e=Math.round(r.ntp+t)),{timestamp:e,maxDeviation:n}},Rt);function Rt(){var t=this;this.linkCheckTimer=null,this.connectServers=[],this.specifiedServers=[],this.getAppConfigFailCount=0,this.getAppConfigTime=0,this.inited=!1,this.linkMsgMaxInterval=90,this.linkMsgCheckInterval=5,this.isDestroy=!1,this.connectedTime=0,this.connectid="",this.reportSeq=0,this.connectSeq=0,this.primaryDomains=[],this._linkConnectState=0,this.lastLinkConnectState=0,this.onConnectedEvent=function(e,n){var r;t.linkConnectState=2,t.getConfig(),t.stateCenter.specified||(r=t.reportSeq++,t.eventManager.emit("dispatchEvent",r,"start"),t.dispatch().then((function(e){var n=e.servers;e=e.domains.map((function(t){return t.host})),t.eventManager.emit("dispatchEvent",r,"end",{domains:e}),0<n.length&&t.eventManager.emit("dispatchResultUpdate",{servers:n,domains:e})})).catch((function(t){}))),t.eventManager.emit("connected"),t.connectedTime=(new Date).getTime(),t.connectid=function(t){var e,n="0123456789".split(""),r=[];for(t=n.length,e=0;e<16;e++)r[e]=n[0|Math.random()*t];return r.join("")}(),t.eventManager.emit("connectedEvent",t.connectSeq,"end",{servers:e,count:e.length,connectid:t.connectid,connectEvents:n})},this.onConnectingEvent=function(){t.logger.info("zn.zca.oce call"),t.linkConnectState=1},this.onDisConnectedEvent=function(e){t.logger.info("zn.zca.ode"+" ".concat(e)),t.linkConnectState=0,e?(t.disConnect(),t.netAgentPCRequestMgr.updateConnectState(l.BROKEN)):(t.eventManager.emit("disconnected"),t.netAgentPCRequestMgr.updateConnectState(l.DISCONNECT))},this.onPushEvent=function(e,n,r,o){switch(n){case i.MSG_TYPE_REDIRECT:case i.MSG_TYPE_REDIRECT2:t.redirect(r);break;case i.MSG_TYPE_CLOSE_CONNECTION:t.connectClosed(r);break;case i.MSG_TYPE_PC_BROKEN:case i.MSG_TYPE_PC_ESTABLISHED:case i.MSG_TYPE_PC_DOWNWARD_MESSAGE:case i.MSG_TYPE_PUSH_EXCEPTION:t.streamManager.onPushEvent(e,n,r,o);break;case i.MSG_TYPE_PUSH_APPCONFIG:t.businessRequestMgr.decodeConfigMessage(r.data)}}}function It(t){this.zegoLink=t,this.streamID=1,this.httpStreams=[],this.pcStreams=[]}function kt(t,e,n){this.type=t,this.streamID=e,this.zegoLink=n,this.isFree=!1,this.isFirst=!0}function Ot(t,e,n){this.logger=t,this.streamManager=e,this.service=n,this.netHttpStream=this.streamManager.createStream(u.HTTP)}function Nt(){}function At(){this.networkState=r.online,this.useNetAgent=!0,this.specified=!1,this.clientIP="",this.timeOffset=0,this.networkRTT=0}function Lt(t,e){this.logger=t,this.stateCenter=e,this.RETRY_START_TIME_INTERVAL=4,this.RETRY_CONTINUE_COUNT=2,this.RETRY_MAX_TIME_INTERVAL=32,this.retryTimer=null,this.maxTimer=null,this.retryActiveCount=1,this.retryNetCount=0,this.retryNetMaxTimes=3,this.isOverTime=!1,this.RETRY_MAX_TIME=90}function Pt(t,e){this.streamManager=t,this.logger=e,this.pcStreamRequests=[],this.pcEstablishTimeout=ut.pcEstablishTimeout}function Mt(t,e,n,r,i){this.logger=t,this.service=e,this.streamManager=n,this.pcEstablishTimeout=r,this.option=i,this.connectState=l.DISCONNECT,this.lastConnectState=l.DISCONNECT,this.brokenTimer=null,this.listenerList={connected:[],broken:[]},this.netPcStream=this.streamManager.createStream(u.PC),this.eventManager=new dt,this.netPcStream.onPushEvent=this.onPushEvent.bind(this)}function Dt(){this.handlerListMap={}}function xt(t,e,n){this.streamManager=t,this.logger=e,this.stateCenter=n,this.hbTimer=null,this.hbInterval=5,this.hbTimeout=10,this.hbTimeoutMaxCount=0,this.tryHbCount=0}function Ut(t,e,n,r){this.streamManager=t,this.protobuf=e,this.logger=n,this.stateCenter=r}function Bt(t){this.socket=null,this.ENV=t}}],a={},r.m=s,r.c=a,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=2))},function(t,e,n){function r(t){var e;return(u[t]||(e=u[t]={i:t,l:!1,exports:{}},a[t].call(e.exports,e,e.exports,r),e.l=!0,e)).exports}var i,o,s,a,u;t.exports=(i=n(8),o=n(0),s=n(2),u={},r.m=a=[function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ZEGO_SETTING_ACTION=void 0,(e=e.ZEGO_SETTING_ACTION||(e.ZEGO_SETTING_ACTION={})).CONSTRUCTOR="zs.0",e.SETTING_INIT="zs.ii.0",e.SETTING_FETCH_SETTING="zs.fs.0",e.SETTING__FETCH_SETTING="zs.fs.1",e.SETTING_GET_CLOUD_SETTING="zs.gcs.0",e.SETTING_POLLING_SETTING="zs.ps.0",e.SETTINGCACHEHANDLER_GET_CACHE_SETTING="zs.sch.gcs.0",e.SETTINGCACHEHANDLER_STORE_SETTING="zs.sch.ss.0",e.SETTINGFETCHHANDLER_FETCHSETTING="zs.sfh.fs.0"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.errorList=void 0,e.errorList={NOT_INIT:{code:1001,msg:"not init"},FILE_REQUEST_FAIL:{code:1002,msg:"fetch request fail"},INFLATE_DATA_FAIL:{code:1003,msg:"inflate fail"},MULTI_FILE_NOT_EXIST:{code:1004,msg:"get multi file fail"},AUTH_FAIL:{code:1005,msg:"auth failed"}}},function(t,e,n){"use strict";var r;Object.defineProperty(e,"__esModule",{value:!0}),e.ProductMap=e.Product=e.SOCKET_DISCONNECT=e.ENUM_REMOTE_TYPE=e.ZEGO_BROWSER_TYPE=e.ZEGO_ENV=e.PROTO_VERSION=void 0,e.PROTO_VERSION="1.1.1",(r=e.ZEGO_ENV||(e.ZEGO_ENV={}))[r.BROWSER=0]="BROWSER",r[r.WEIXINMINI=1]="WEIXINMINI",(r=e.ZEGO_BROWSER_TYPE||(e.ZEGO_BROWSER_TYPE={}))[r.IE=0]="IE",r[r.FIREFOX=1]="FIREFOX",r[r.CHROME=2]="CHROME",r[r.SAFARI=3]="SAFARI",r[r.OPERA=4]="OPERA",r[r.WEIXIN=5]="WEIXIN",r[r.WEIXINMINI=6]="WEIXINMINI",r[r.UNKOWN=7]="UNKOWN",(r=e.ENUM_REMOTE_TYPE||(e.ENUM_REMOTE_TYPE={}))[r.DISABLE=0]="DISABLE",r[r.WEBSOCKET=1]="WEBSOCKET",r[r.HTTPS=2]="HTTPS",e.SOCKET_DISCONNECT=-1,(r=e.Product||(e.Product={}))[r.RTC=0]="RTC",r[r.WEB_RTC=1]="WEB_RTC",r[r.ZIM=2]="ZIM",r[r.ROOM_KIT=3]="ROOM_KIT",r[r.DOC_SHARE=4]="DOC_SHARE",r[r.WHITE_BOARD=5]="WHITE_BOARD",r[r.SELF_CHECK=999]="SELF_CHECK",r[r.TEST_ANOOUS=1e3]="TEST_ANOOUS",e.ProductMap={0:"rtc_sdk_native",1:"Web_SDK",2:"ZIM",3:"roomkitWeb",4:"docsshare",5:"WhiteBoard"}},function(t,e){t.exports=i},function(t,e,n){"use strict";var r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(r(arguments[e]));return t},o=(Object.defineProperty(e,"__esModule",{value:!0}),e.decodeString=e.decodeCompressData=e.generateUUID=e.checkValidNumber=e.analyzeKey=e.getCurrentTime=e.getBrowser=void 0,n(16)),s=(e.getBrowser=function(){var t=window.navigator.userAgent,e=null!=window.ActiveXObject&&-1!=t.indexOf("MSIE"),n=-1!=t.indexOf("Firefox"),r=null!=window.opr,i=t.indexOf("Chrome")&&window.chrome,o=-1!=t.indexOf("Safari")&&-1!=t.indexOf("Version");return t=t.toLowerCase().match(/MicroMessenger/i)&&"micromessenger"===t.toLowerCase().match(/MicroMessenger/i)[0],e?"IE":n?"FIREFOX":r?"OPERA":i?"CHROME":o?"SAFARI":t?"WEIXIN":"UNKOWN"},["00","01","02","03","04","05","06","07","08","09"]);e.getCurrentTime=function(){var t=new Date;return[t.getFullYear()+"/",(s[t.getMonth()+1]||t.getMonth()+1)+"/",(s[t.getDate()]||t.getDate())+" ",(s[t.getHours()]||t.getHours())+":",(s[t.getMinutes()]||t.getMinutes())+":",s[t.getSeconds()]||t.getSeconds(),"."+t.getTime()%1e3].join("")},e.analyzeKey=function(t){return t=t.split("_"),{level:Number(t[0]),timestamp:t[1],seq:t[2]}},e.checkValidNumber=function(t,e,n){return e=e||1,n=n||1e4,"number"==typeof t&&t%1==0&&e<=t&&t<=n},e.generateUUID=function(t){if(0===(t=void 0===t?0:t))try{n=localStorage.getItem("z_deviceID")}catch(t){}else wx.getStorageSync("z_deviceID");if(!n){var e=(new Date).getTime(),n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(36)}));if(0===t)try{localStorage.setItem("z_deviceID",n)}catch(t){}else wx.setStorageSync("z_deviceID",n)}return n},e.decodeCompressData=function(t){try{return o.inflate(t,{to:"string"})}catch(t){console.error(t)}},e.decodeString=function(t){return decodeURIComponent(window.escape(String.fromCharCode.apply(String,i(Array.from(t)))))}},function(t,e){t.exports=o},function(t,e){t.exports=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.INIT_CONFIG=void 0,e.INIT_CONFIG={env:0,compress:!0,p_version:1}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ZegoSetting=void 0;var r=n(9);Object.defineProperty(e,"ZegoSetting",{enumerable:!0,get:function(){return r.ZegoSetting}})},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},i=this&&this.__awaiter||function(t,e,n,r){return new(n=n||Promise)((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):((e=t.value)instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s={next:a(0),throw:a(1),return:a(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){var u=[s,a];if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&u[0]?r.return:u[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,u[1])).done)return i;switch(r=0,(u=i?[2&u[0],i.value]:u)[0]){case 0:case 1:i=u;break;case 4:return o.label++,{value:u[1],done:!1};case 5:o.label++,r=u[1],u=[0];continue;case 7:u=o.ops.pop(),o.trys.pop();continue;default:if(!(i=0<(i=o.trys).length&&i[i.length-1])&&(6===u[0]||2===u[0])){o=0;continue}if(3===u[0]&&(!i||u[1]>i[0]&&u[1]<i[3]))o.label=u[1];else if(6===u[0]&&o.label<i[1])o.label=i[1],i=u;else{if(!(i&&o.label<i[2])){i[2]&&o.ops.pop(),o.trys.pop();continue}o.label=i[2],o.ops.push(u)}}u=e.call(t,o)}catch(a){u=[6,a],r=0}finally{n=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}},s=(Object.defineProperty(e,"__esModule",{value:!0}),e.ZegoSetting=void 0,n(2)),a=n(10),u=n(11),c=n(13),l=n(0),h=n(7),f=n(1),d=n(4);function p(){this.fileList=[],this.publicEnvVariable={},this.proEnvVariable={},this.pollingTimer=null,this.pollingInterval=300,this.inited=!1,this.checkFailCount=0,this.checkFailed=!1,this.log=new a.ZegoLog}Object.defineProperty(p.prototype,"envVariable",{get:function(){return Object.assign({},this.publicEnvVariable,this.proEnvVariable)},enumerable:!1,configurable:!0}),p.prototype.init=function(t){var e,n=this;return t.pollingFreq&&!d.checkValidNumber(t.pollingFreq)?(this.log.error(l.ZEGO_SETTING_ACTION.SETTING_INIT+" pollingFreq must be integer number"),!1):(this.options=Object.assign({},h.INIT_CONFIG,t),this.getPublicEnvVariable(),this.settingFetchHandler=new c.SettingFetchHandler(this.options,this.log),this.settingFetchHandler.setDataReport(this.options.reportNotify),t=Math.round(60*Math.random()),this.log.info(l.ZEGO_SETTING_ACTION.SETTING_INIT+" delay "+t),this.delayTimer&&(clearTimeout(this.delayTimer),this.delayTimer=null),this.options.pollingFreq&&60<=this.options.pollingFreq&&(this.pollingInterval=this.options.pollingFreq),this.delayTimer=setTimeout((function(){n.pollingSetting(1e3*n.pollingInterval,!1)}),1e3*t),this.settingCacheHandler=new u.SettingCacheHandler("setting_"+(this.options.online?"online_":"test_")+(t=this.options.product||this.options.productNum)+"_"+this.options.appID,this.log,this.options.env),[0,1,2,3,4,5].includes(t)&&(e=s.ProductMap[t])&&(1===t&&this.settingCacheHandler.dropOldStore("setting_"+(this.options.online?"online_":"test_")+"undefined_"+this.options.appID),this.settingCacheHandler.dropOldStore("setting_"+(this.options.online?"online_":"test_")+e+"_"+this.options.appID)),null!=(e=this.options)&&e.unify&&this.options.connection&&null!=(t=null==(t=this.options)?void 0:t.connection)&&t.on("connected",(function(){n.settingFetchHandler.checkUnSendMsgs(n.settingFetchHandler.unSendCommandList)})),this.refreshAuthCheck(),this.inited=!0)},p.prototype.uninit=function(){this.pollingTimer&&(clearTimeout(this.pollingTimer),this.pollingTimer=null)},p.prototype.setEnvVariable=function(t,e){this.proEnvVariable[t]=String(e)},p.prototype.getEnvVariable=function(t){return this.envVariable[t]},p.prototype.setEnvVariables=function(t){var e=this;Object.keys(t).forEach((function(n){"string"!=typeof t[n]&&"number"!=typeof t[n]&&e.log.error("zs.sev env "+n+" type error"),e.proEnvVariable[n]=String(t[n])}))},p.prototype.getEnvVariables=function(){return this.envVariable},p.prototype.enablePolling=function(t,e){var n=this;e?e.forEach((function(e){var r=n.fileList.find((function(t){return t.fileName===e}));r&&(r.needPolling=t)})):this.fileList.forEach((function(e){return e.needPolling=t}))},p.prototype.setToken=function(t){this.token!==t&&this.refreshAuthCheck(),this.token=t},p.prototype.setUserID=function(t){this.userID!==t&&this.refreshAuthCheck(),this.userID=t},p.prototype.getSettingCache=function(t){return i(this,void 0,void 0,(function(){var e,n;return o(this,(function(r){switch(r.label){case 0:return this.inited?(e=this.fileList.find((function(e){return e.fileName===t})))?[2,Promise.resolve({setting:e.setting,versions:e.versions})]:[3,1]:[2,Promise.reject(f.errorList.NOT_INIT)];case 1:return[4,this.settingCacheHandler.getCacheSetting(t)];case 2:return(e=r.sent())&&(this.fileList.find((function(e){return e.fileName===t}))||this.fileList.push({fileName:t,fetchedTime:0,needPolling:!1,setting:e.setting,versions:e.versions}),n={setting:e.setting,versions:e.versions}),[2,Promise.resolve(n)]}}))}))},p.prototype.fetchSetting=function(t,e,n){return void 0===e&&(e={}),void 0===n&&(n=!0),this.log.info(l.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" call "+t),this.inited?(this.activePolling(),0<Object.keys(e).length?(this.log.info(l.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" get file with params"),this._getCloudSetting(t,r(r({},this.envVariable),e))):(e=this.fileList.find((function(e){return e.fileName===t})))?(this.log.info(l.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" file exist"),(new Date).getTime()-e.fetchedTime<1e3*this.pollingInterval?(this.log.info(l.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" fetch time interval in freq"),e.needPolling=n,Promise.resolve({setting:e.setting,versions:e.versions})):this._fetchSetting(t,e,n)):(this.log.info(l.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" file not found"),this._fetchSetting(t,e,n))):Promise.reject(f.errorList.NOT_INIT)},p.prototype.fetchMultiSetting=function(t,e,n){var s=this;return void 0===e&&(e={}),void 0===n&&(n=!0),this.log.info(l.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" call "+JSON.stringify(t)),this.inited?(this.activePolling(),0<Object.keys(e).length?(this.log.info(l.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" get file with params"),this._getCloudSetting(t,r(r({},this.envVariable),e))):new Promise((function(e,r){var a={},u=[];if(t.forEach((function(t){return i(s,void 0,void 0,(function(){var e;return o(this,(function(n){return(e=this.fileList.find((function(e){return e.fileName===t})))&&(new Date).getTime()-e.fetchedTime<1e3*this.pollingInterval?(this.log.info(l.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" fetch time interval in freq"),a[t]={setting:e.setting,versions:e.versions}):u.push(t),[2]}))}))})),!(0<u.length))return e(a);s._getCloudSetting(u,s.envVariable).then((function(t){return s.handleFetchFiles(t,n),Object.assign(a,t),e(a)})).catch((function(t){u.forEach((function(t){return i(s,void 0,void 0,(function(){var e;return o(this,(function(r){switch(r.label){case 0:return(e=this.fileList.find((function(e){return e.fileName==t})))?e.fetchedTime=(new Date).getTime():this.fileList.find((function(e){return e.fileName===t}))||this.fileList.push({fileName:t,fetchedTime:(new Date).getTime(),needPolling:n,setting:{},versions:{}}),[4,this.settingCacheHandler.getCacheSetting(t)];case 1:return e=r.sent(),a[t]={setting:e.setting,versions:e.versions},[2]}}))}))})),0<Object.keys(a).length?e(a):r(t)}))}))):(this.log.info(l.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" not init"),Promise.reject(f.errorList.NOT_INIT))},p.prototype.setOptions=function(t){t&&"boolean"==typeof t.unify&&(this.options.unify=t.unify,this.settingFetchHandler.setOptions(this.options))},p.prototype.setLog=function(t){this.log=t},p.prototype._getCloudSetting=function(t,e){var n=this;return new Promise((function(r,s){return i(n,void 0,void 0,(function(){var n,i,a,u,c,h,d,p,g,_,m=this;return o(this,(function(o){switch(o.label){case 0:if(o.trys.push([0,6,,7]),this.checkFailed)return this.log.warn(l.ZEGO_SETTING_ACTION.SETTING_GET_CLOUD_SETTING+" check fail"),s(f.errorList.AUTH_FAIL),[2];h=(p=t instanceof Array)?t:[t],n=[],i={},a=function(t){return t=t.map((function(t){return m.settingCacheHandler.getCacheSetting(t)})),Promise.all(t)},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,a(h)];case 2:return u=o.sent(),h.forEach((function(t,e){var r;n.push({file_name:t,hash:null==(r=u[e].versions)?void 0:r.hash,g_version:null==(r=u[e].versions)?void 0:r.g_version}),i[t]=u[e]})),[3,4];case 3:return o.sent(),h.forEach((function(t){n.push({file_name:t})})),[3,4];case 4:return[4,this.settingFetchHandler.fetchSetting(n,e,this.token,this.userID,!1)];case 5:return h=o.sent(),c=h.data,h=h.polling_interval,this.checkFailCount=0,this.log.info(l.ZEGO_SETTING_ACTION.SETTING_GET_CLOUD_SETTING+" suc"),"number"==typeof h&&5<=h&&this.pollingInterval!==60*h&&(this.log.warn(l.ZEGO_SETTING_ACTION.SETTING_GET_CLOUD_SETTING+" polling interval change"),this.pollingInterval=60*h,this.uninit(),this.activePolling()),p?(d={},t.forEach((function(t){var e,n;0==(null==(e=c[t])?void 0:e.code)&&(c[t].hashChange?(m.log.info(l.ZEGO_SETTING_ACTION.SETTING_GET_CLOUD_SETTING+" file "+t+" changed"),d[t]={setting:null==(n=c[t])?void 0:n.data,versions:null==(n=c[t])?void 0:n.versions}):i[t]&&(d[t]={setting:null==(n=i[t])?void 0:n.setting,versions:null==(t=i[t])?void 0:t.versions}))})),0<Object.keys(d).length?r(d):s(f.errorList.MULTI_FILE_NOT_EXIST)):0===(null==(p=c[t])?void 0:p.code)&&null!=(g=c[t])&&g.data?r({setting:null==(g=c[t])?void 0:g.data,versions:null==(g=c[t])?void 0:g.versions}):s({code:null==(_=c[t])?void 0:_.code,msg:null==(_=c[t])?void 0:_.message}),[3,7];case 6:return _=o.sent(),this.log.error(l.ZEGO_SETTING_ACTION.SETTING_GET_CLOUD_SETTING+" fail "+JSON.stringify(_)),21002!==(null==_?void 0:_.code)&&401!==(null==_?void 0:_.status_code)||(this.checkFailCount+=1),2<=this.checkFailCount&&(this.checkFailed=!0),s(_),[3,7];case 7:return[2]}}))}))}))},p.prototype.handleFetchFiles=function(t,e){var n=this;Object.keys(t).forEach((function(r){var i=n.fileList.find((function(t){return t.fileName==r}));i?(i.fetchedTime=(new Date).getTime(),i.setting=t[r].setting,i.versions=t[r].versions,i.needPolling=e):n.fileList.find((function(t){return t.fileName===r}))||n.fileList.push({fileName:r,fetchedTime:(new Date).getTime(),needPolling:e,setting:t[r].setting,versions:t[r].versions}),n.settingCacheHandler.storeSetting(r,t[r])}))},p.prototype._fetchSetting=function(t,e,n){var r=this;return new Promise((function(s,a){r.log.info(l.ZEGO_SETTING_ACTION.SETTING__FETCH_SETTING+" call"),r._getCloudSetting(t,r.envVariable).then((function(i){e?(e.fetchedTime=(new Date).getTime(),e.setting=i.setting,e.versions=i.versions,e.needPolling=n):r.fileList.find((function(e){return e.fileName===t}))||r.fileList.push({fileName:t,fetchedTime:(new Date).getTime(),needPolling:n,setting:i.setting,versions:i.versions}),r.settingCacheHandler.storeSetting(t,i),s(i),r.log.info(l.ZEGO_SETTING_ACTION.SETTING__FETCH_SETTING+" call suc")})).catch((function(u){return i(r,void 0,void 0,(function(){var r;return o(this,(function(i){switch(i.label){case 0:e?e.fetchedTime=(new Date).getTime():this.fileList.find((function(e){return e.fileName===t}))||this.fileList.push({fileName:t,fetchedTime:(new Date).getTime(),needPolling:n,setting:{},versions:{}}),r=t,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.settingCacheHandler.getCacheSetting(r)];case 2:return r=i.sent(),s(r),[3,4];case 3:return i.sent(),a(u),[3,4];case 4:return this.log.info(l.ZEGO_SETTING_ACTION.SETTING__FETCH_SETTING+" setting not contain or fetch file fail"),[2]}}))}))}))}))},p.prototype.getPublicEnvVariable=function(){var t;0==this.options.env?(this.publicEnvVariable.userAgent=navigator.userAgent,this.publicEnvVariable.platform=navigator.platform,this.publicEnvVariable.browser=d.getBrowser(),this.publicEnvVariable.deviceid=d.generateUUID()):1==this.options.env&&(t=wx.getSystemInfoSync(),this.publicEnvVariable.brand=t.brand,this.publicEnvVariable.model=t.model,this.publicEnvVariable.system=t.system,this.publicEnvVariable.platform=t.platform,this.publicEnvVariable.wechatVersion=t.version,this.publicEnvVariable.wechatSDKVersion=t.SDKVersion,this.publicEnvVariable.deviceid=d.generateUUID(this.options.env))},p.prototype.pollingSetting=function(t,e){return void 0===e&&(e=!0),i(this,void 0,void 0,(function(){var n,r,s,a,u=this;return o(this,(function(c){switch(c.label){case 0:return this.log.info(l.ZEGO_SETTING_ACTION.SETTING_POLLING_SETTING+" call "+t+" "+e),n=t,e?(r=[],this.fileList.forEach((function(t){t.needPolling&&r.push({file_name:t.fileName,hash:t.versions.hash,g_version:t.versions.g_version})})),this.checkFailed?(this.log.warn(l.ZEGO_SETTING_ACTION.SETTING_GET_CLOUD_SETTING+" has checked fail"),[3,7]):[3,1]):[3,7];case 1:if(!(0<r.length))return[3,6];c.label=2;case 2:return c.trys.push([2,4,,5]),[4,this.settingFetchHandler.fetchSetting(r,this.envVariable,this.token,this.userID)];case 3:return a=c.sent(),s=a.data,a=a.polling_interval,this.log.info(l.ZEGO_SETTING_ACTION.SETTING_POLLING_SETTING+" fetch suc"),this.checkFailCount=0,"number"==typeof a&&5<=a&&this.pollingInterval!==60*a&&(this.log.warn(l.ZEGO_SETTING_ACTION.SETTING_POLLING_SETTING+" polling interval change"),this.pollingInterval=60*a,n=1e3*this.pollingInterval),this.fileList.forEach((function(t){return i(u,void 0,void 0,(function(){var e,n,r,i,a,u,c,h,f,d;return o(this,(function(o){switch(o.label){case 0:return t.fetchedTime=(new Date).getTime(),e=t.fileName,r=(n=s[t.fileName]).code,i=n.data,a=n.versions,u=n.message,c=n.hashChange,n&&0===r&&i?(f=JSON.stringify(i),d=JSON.stringify(t.setting),h={setting:i,versions:a,code:r,message:u},c&&d!==f&&(this.log.info(l.ZEGO_SETTING_ACTION.SETTING_POLLING_SETTING+" "+t.fileName+" setting changed"),t.setting=h.setting,t.versions=h.versions,this.options.pollingNotify(t.fileName,h)),[4,this.settingCacheHandler.getCacheSetting(e)]):[3,2];case 1:d=o.sent(),f=JSON.stringify(d),d=JSON.stringify(h),c&&f!==d&&this.settingCacheHandler.storeSetting(e,h),o.label=2;case 2:return[2]}}))}))})),[3,5];case 4:return a=c.sent(),this.log.error(l.ZEGO_SETTING_ACTION.SETTING_POLLING_SETTING+" fetch fail "+JSON.stringify(a)),21002!==(null==a?void 0:a.code)&&401!==(null==a?void 0:a.status_code)||(this.checkFailCount+=1),2<=this.checkFailCount&&(this.checkFailed=!0),[3,5];case 5:return[3,7];case 6:this.log.info(l.ZEGO_SETTING_ACTION.SETTING_POLLING_SETTING+" polling no file"),c.label=7;case 7:return this.pollingTimer&&clearTimeout(this.pollingTimer),this.pollingTimer=setTimeout((function(){u.pollingSetting(n)}),n),[2]}}))}))},p.prototype.activePolling=function(){this.pollingTimer||this.pollingSetting(1e3*this.pollingInterval)},p.prototype.refreshAuthCheck=function(){this.checkFailCount=0,this.checkFailed=!1},e.ZegoSetting=n=p},function(t,e,n){"use strict";function r(){}Object.defineProperty(e,"__esModule",{value:!0}),e.ZegoLog=void 0,r.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.join(" ");console.log(n)},r.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.join(" ");console.debug(n)},r.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.join(" ");console.info(n)},r.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.join(" ");console.warn(n)},r.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.join(" ");console.error(n)},e.ZegoLog=r},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n=n||Promise)((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):((e=t.value)instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s={next:a(0),throw:a(1),return:a(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){var u=[s,a];if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&u[0]?r.return:u[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,u[1])).done)return i;switch(r=0,(u=i?[2&u[0],i.value]:u)[0]){case 0:case 1:i=u;break;case 4:return o.label++,{value:u[1],done:!1};case 5:o.label++,r=u[1],u=[0];continue;case 7:u=o.ops.pop(),o.trys.pop();continue;default:if(!(i=0<(i=o.trys).length&&i[i.length-1])&&(6===u[0]||2===u[0])){o=0;continue}if(3===u[0]&&(!i||u[1]>i[0]&&u[1]<i[3]))o.label=u[1];else if(6===u[0]&&o.label<i[1])o.label=i[1],i=u;else{if(!(i&&o.label<i[2])){i[2]&&o.ops.pop(),o.trys.pop();continue}o.label=i[2],o.ops.push(u)}}u=e.call(t,o)}catch(a){u=[6,a],r=0}finally{n=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},s=(Object.defineProperty(e,"__esModule",{value:!0}),e.SettingCacheHandler=void 0,o(n(3))),a=n(0),u=n(12);function c(t,e,n){void 0===n&&(n=0),this.storeName=t,this.log=e,this.store=u.createZegoStore(t,n)}c.prototype.getCacheSetting=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return this.log.info(a.ZEGO_SETTING_ACTION.SETTINGCACHEHANDLER_GET_CACHE_SETTING+" call"),[4,this.store.getItem(t)];case 1:return[2,e.sent()||""]}}))}))},c.prototype.storeSetting=function(t,e){return r(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return this.log.info(a.ZEGO_SETTING_ACTION.SETTINGCACHEHANDLER_STORE_SETTING+" call"),[4,this.store.setItem(t,e)];case 1:return n.sent(),[2]}}))}))},c.prototype.dropOldStore=function(t){s.default.dropInstance({name:t}).then((function(){console.debug("Dropped ",t)})).catch((function(t){console.warn(t)}))},e.SettingCacheHandler=n=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createZegoStore=e.ZegoWechatMiniStore=void 0;var r=n(3),i=n(2),o=(s.prototype.getItem=function(t){var e=this;return new Promise((function(n,r){try{n(wx.getStorageSync(e.keyPrefix+t))}catch(n){r(n)}}))},s.prototype.setItem=function(t,e){var n=this;return new Promise((function(r,i){try{wx.setStorageSync(n.keyPrefix+t,e),r()}catch(r){i(r)}}))},s.prototype.removeItem=function(t){var e=this;return new Promise((function(n,r){try{n(wx.removeStorageSync(e.keyPrefix+t))}catch(n){r(n)}}))},s.prototype.clear=function(){return new Promise((function(t,e){try{wx.clearStorageSync(),t()}catch(t){e(t)}}))},s.prototype.keys=function(){var t=this;return new Promise((function(e,n){try{var r=wx.getStorageInfoSync().keys,i=(console.warn("keys",r),[]);r.forEach((function(e){0==e.indexOf(t.keyPrefix)&&i.push(e.replace(t.keyPrefix,""))})),console.warn("keyArr",i),i.sort(),e(i)}catch(e){n(e)}}))},s);function s(t){this.storeName=t,this.keyPrefix=t+"/"}e.ZegoWechatMiniStore=o,e.createZegoStore=function(t,e){return e===i.ZEGO_ENV.BROWSER?r.createInstance({name:t}):new o(t)}},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.SettingFetchHandler=void 0;var o,s,a=n(0),u=n(1),c=n(14),l=n(15),h=n(4),f=n(17),d=n(7),p=i(n(5));function g(t,e){this.options=t,this.log=e,this.seq=0,this.userID="",this.unSendCommandList=new l.LinkedList,this.testNetPackageSize=!1,this.protobuf=new f.CloudSettingProtoBuf}n=o={SERVICE_ClOUD_SETTING:10,10:"SERVICE_ClOUD_SETTING"},n=s={METHOD_UNSET:0,0:"METHOD_UNSET",METHOD_GET:1,1:"METHOD_GET",METHOD_POST:2,2:"METHOD_POST"},g.prototype.setOptions=function(t){this.options=t},g.prototype.setDataReport=function(t){this.reportFunc=t},g.prototype.setUserID=function(t){this.userID=t},g.prototype.fetchSetting=function(t,e,n,i,o){var s=this;return void 0===o&&(o=!0),new Promise((function(u,l){var f={product:s.options.product,files:t.map((function(t){return t.file_name})),param:r(r({},e),{deviceid:void 0}),appid:s.options.appID,token:n,id_name:i,timestamp:(new Date).getTime(),biztype:0,deviceid:e.deviceid||h.generateUUID(s.options.env),compress:!1,mode:s.options.online?"online":"test"},p=f.param,g={appid:f.appid,token:f.token,id_name:f.id_name,deviceid:f.deviceid},_=s.seq++;function m(t){var e,n=t.code,r=t.data,i=t.polling_interval;t=t.reportData,s.log.info(a.ZEGO_SETTING_ACTION.SETTINGFETCHHANDLER_FETCHSETTING+" unify "+n),r&&(e=[],Object.keys(r).forEach((function(t){var n;e.push({name:t,code:r[t].code,message:null==(n=r[t])?void 0:n.message,versions:JSON.stringify(null==(n=r[t])?void 0:n.versions),content:JSON.stringify(null==(t=r[t])?void 0:t.data)})}))),s.reportFunc&&s.reportFunc(_,"request_end",{code:n,reportData:t,params:g,requestKV:p,files:e,polling:o}),u({data:r,polling_interval:i})}function v(t){var e=t.code,n=t.msg,r=t.status_code;t=t.reportData,s.log.warn(a.ZEGO_SETTING_ACTION.SETTINGFETCHHANDLER_FETCHSETTING+" unify "+e),s.reportFunc&&s.reportFunc(_,"request_end",{code:e,params:g,requestKV:p,reportData:t,polling:o}),l({code:e,msg:n,status_code:r})}if(s.reportFunc&&s.reportFunc(_,"request_start",{polling:o}),null!=(E=s.options)&&E.unify&&s.options.connection)if(void 0!==s.options.productNum){var y,b=[];for(y in f.param)void 0!==f.param[y]&&b.push({key:y,value:f.param[y]});var S={product:s.options.productNum,response_compress:d.INIT_CONFIG.compress?0:1,files:t,param_list:b,p_version:d.INIT_CONFIG.p_version},E=(s.log.info(a.ZEGO_SETTING_ACTION.SETTINGFETCHHANDLER_FETCHSETTING+" files "+JSON.stringify(S.files)),s.options.online?1:2);s.sendCloudPBRequest(i,S,n,E,m,v)}else s.sendCloudRequest(i,f,"/cloud-setting/get",(function(t){m(t)}),(function(t){v(t)}));else s.options.urls&&c.fetch(s.options.urls,f,s.options.env||0).then((function(t){var e,n=t.code,r=t.data,i=t.polling_interval;t=t.reportData,s.log.info(a.ZEGO_SETTING_ACTION.SETTINGFETCHHANDLER_FETCHSETTING+" "+n),r&&(e=[],Object.keys(r).forEach((function(t){var n;e.push({name:t,code:r[t].code,message:null==(n=r[t])?void 0:n.message,versions:JSON.stringify(null==(n=r[t])?void 0:n.versions),content:JSON.stringify(null==(t=r[t])?void 0:t.data)})}))),s.reportFunc&&s.reportFunc(_,"request_end",{code:n,reportData:t,params:g,requestKV:p,files:e,polling:o}),u({data:r,polling_interval:i})})).catch((function(t){var e=t.code,n=t.msg;t=t.reportData,s.log.warn(a.ZEGO_SETTING_ACTION.SETTINGFETCHHANDLER_FETCHSETTING+" "+e),s.reportFunc&&s.reportFunc(_,"request_end",{code:e,params:g,requestKV:p,reportData:t,polling:o}),l({code:e,msg:n})}))}))},g.prototype.sendCloudRequest=function(t,e,n,i,a,c,l){var h=this,f=(void 0===c&&(c=3),void 0===l&&(l=[]),(new Date).getTime());this.sendNetAgentHttpRequest({service:o.SERVICE_ClOUD_SETTING,body:e,ack:!1,idName:t,method_no:s.METHOD_POST,location:n},(function(o){var s,d,p,g,_;200===(null==o?void 0:o.status_code)?(s=(g=JSON.parse(o.body)).code,_=g.message,d=g.data,p=g.polling_interval,g=(new Date).getTime()-f,l.push({timestamp:f,url:n,error:s,duration:g}),0===s?i({code:s,msg:_,data:d,polling_interval:p,reportData:l}):a({code:s,msg:_,reportData:l})):(_=(new Date).getTime()-f,l.push({timestamp:f,url:n,error:null==o?void 0:o.status_code,duration:_}),0<c?(c--,h.sendCloudRequest(t,e,n,i,a,c,l)):a(r(r({},u.errorList.FILE_REQUEST_FAIL),{reportData:l})))}),(function(o){var s=(new Date).getTime()-f;l.push({timestamp:f,url:n,error:o.code,duration:s}),0<c?(c--,h.sendCloudRequest(t,e,n,i,a,c,l)):a(r(r({},u.errorList.FILE_REQUEST_FAIL),{reportData:l}))}),null,{timeout:4e3})},g.prototype.sendNetAgentHttpRequest=function(t,e,n,r,i){r={param:t,suc:e,err:n,ack:r,option:i},null!=(i=this.options.connection)&&i.isConnect()?this.sendNetUintData(r):this.unSendCommandList.push(r)},g.prototype.sendNetUintData=function(t){var e=t.param,n=t.suc,r=t.err,i=t.ack,o=t.option;null!=(t=this.options.connection)&&t.startHttpRequest(e,n,r,i,o)},g.prototype.checkUnSendMsgs=function(t){for(var e=t.getFirst();null!=e;)t.remove(e),e._data&&e._data.param&&this.sendNetUintData(e._data),e=t.getFirst()},g.prototype.sendCloudPBRequest=function(t,e,n,i,o,c,l,f){var d,g=this,_=(void 0===l&&(l=3),void 0===f&&(f=[]),(new Date).getTime()),m=this.protobuf.encodeCloudSettingReq(e);null!=(d=this.options.connection)&&d.startHttpRequest2({interfaceID:14,body:m,ack:!1,idName:t,method:s.METHOD_POST,token:n,mode:i,reduceRspHeaders:!0},(function(s,d){if(200===(null==s?void 0:s.status_code)){var m=g.protobuf.decodeCloudSettingRsp(s.body),v=m.message,y=m.polling_interval,b=m.code||0,S=(p.default.isLong(b)&&(b=b.toNumber()),(new Date).getTime()-_);if(f.push({timestamp:_,error:b,duration:S}),0===b){for(var E={},T=0;T<m.file_response.length;T++){var C=(A=m.file_response[T]).message,w=A.file_name,R=A.hash,I=A.g_version,k=A.json_data,O=(g.log.info(a.ZEGO_SETTING_ACTION.SETTINGFETCHHANDLER_FETCHSETTING+" file rsp "+w+" "+I+" "+R.toString()),A.code||0);if(p.default.isLong(O)&&(O=O.toNumber()),A={},0<(null==R?void 0:R.byteLength)&&0<(null==k?void 0:k.byteLength))try{var N=0===e.response_compress?h.decodeCompressData(k):h.decodeString(k),A=JSON.parse(N)}catch(s){g.log.info(a.ZEGO_SETTING_ACTION.SETTINGFETCHHANDLER_FETCHSETTING+" decode fail "+(null==s?void 0:s.message)?s.message:JSON.stringify(s))}E[w]={code:O,message:C,versions:{hash:R,g_version:I},data:A,hashChange:0===R.byteLength?0:1}}o({code:b,msg:v,data:E,polling_interval:y,reportData:f})}else c({code:b,msg:v,reportData:f})}else v=(new Date).getTime()-_,f.push({timestamp:_,error:null==s?void 0:s.status_code,duration:v}),0<l?(l--,g.sendCloudPBRequest(t,e,n,i,o,c,l,f)):c(r(r({},u.errorList.FILE_REQUEST_FAIL),{reportData:f,status_code:null==s?void 0:s.status_code}))}),(function(s){var a=(new Date).getTime()-_;f.push({timestamp:_,error:s.code,duration:a}),0<l?(l--,g.sendCloudPBRequest(t,e,n,i,o,c,l,f)):c(r(r({},u.errorList.FILE_REQUEST_FAIL),{reportData:f,status_code:null==s?void 0:s.status_code}))}),null,{timeout:4e3,extras:{protoCmd:"GetCloudSettingConfigRequest"}})},e.SettingFetchHandler=n=g},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},i=(Object.defineProperty(e,"__esModule",{value:!0}),e.fetch=void 0,n(1));e.fetch=function t(e,n,o,s,a,u){return void 0===s&&(s=5),void 0===a&&(a=0),void 0===u&&(u=[]),new Promise((function(c,l){a=a||(new Date).getTime();var h,f,d,p=(new Date).getTime();0===o?((h=new XMLHttpRequest).open("post",f=e[(s+1)%2]||e[0]),1==n.compress&&(h.responseType="arraybuffer"),h.ontimeout=function(){console.warn("The request for "+f+" timed out.")},h.onreadystatechange=function(){var d,g,_,m,v;4==h.readyState&&(200<=h.status&&h.status<300||304==h.status?(g=void 0,1!=n.compress&&(g=h.responseText),v=(new Date).getTime()-p,d=(_=JSON.parse(g)).code,m=_.message,g=_.data,_=_.polling_interval,u.push({timestamp:p,url:f,error:d,duration:v}),0===d?c({code:d,msg:m,data:g,polling_interval:_,reportData:u}):l({code:d,msg:m,reportData:u})):(m=(new Date).getTime()-p,u.push({timestamp:p,url:f,error:h.status,duration:m}),v=(new Date).getTime()-a,0<s&&v<8e3?t(e,n,o,--s,a,u).then((function(t){c(t)})).catch((function(t){l(t)})):l(r(r({},i.errorList.FILE_REQUEST_FAIL),{reportData:u}))))},h.timeout=8e3,h.send(JSON.stringify(n))):(d=e[(s+1)%2]||e[0],wx.request({url:d,data:n,method:"POST",success:function(h){console.log(h.data);var f=(m=h.data).code,g=m.message,_=m.data,m=m.polling_interval;void 0!==f?0===f?(console.log("post suc"),c({code:f,msg:g,data:_,polling_interval:m,reportData:u})):(console.error("post fail ",f,g),l({code:f,msg:g,reportData:u})):(g=(new Date).getTime()-p,u.push({timestamp:p,url:d,error:i.errorList.FILE_REQUEST_FAIL.code,msg:h.data,duration:g}),0<s?t(e,n,o,--s,a,u).then((function(t){c(t)})).catch((function(t){l(t)})):l(r(r({},i.errorList.FILE_REQUEST_FAIL),{reportData:u})))},fail:function(h){console.log("send failed "+JSON.stringify(h)+h.statusCode);var f=(new Date).getTime()-p;u.push({timestamp:p,url:d,error:i.errorList.FILE_REQUEST_FAIL.code,msg:h.errMsg,duration:f}),0<s?t(e,n,o,--s,a,u).then((function(t){c(t)})).catch((function(t){l(t)})):l(r(r({},i.errorList.FILE_REQUEST_FAIL),{reportData:u}))}}))}))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LinkedList=e.ListNode=void 0,Object.defineProperty(i.prototype,"id",{get:function(){return this._id||null},set:function(t){this._id=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t},enumerable:!1,configurable:!0}),i.prototype.hasNext=function(){return this.next&&this.next.id},i.prototype.hasPrev=function(){return this.prev&&this.prev.id};var r=i;function i(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.next=null,this.prev=null,this._id=t,this._data=e}function o(){this.start=new r,this.end=new r,this._idCounter=0,this._numNodes=0,this.start.next=this.end,this.start.prev=null,this.end.prev=this.start,this.end.next=null}e.ListNode=r,o.prototype.insertBefore=function(t,e){return(e=new r(this._idCounter,e)).next=t,e.prev=t.prev,t.prev&&(t.prev.next=e),t.prev=e,++this._idCounter,++this._numNodes,e},o.prototype.addLast=function(t){return this.insertBefore(this.end,t)},o.prototype.add=function(t){return this.addLast(t)},o.prototype.getFirst=function(){return 0===this._numNodes?null:this.start.next},o.prototype.getLast=function(){return 0===this._numNodes?null:this.end.prev},o.prototype.size=function(){return this._numNodes},o.prototype.getFromFirst=function(t){var e=0,n=this.start.next;if(0<=t)for(;e<t&&null!==n;)n=n.next,++e;else n=null;if(null===n)throw"Index out of bounds.";return n},o.prototype.get=function(t){return 0===t?this.getFirst():t===this._numNodes-1?this.getLast():this.getFromFirst(t)},o.prototype.remove=function(t){return t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),--this._numNodes,t},o.prototype.removeFirst=function(){return 0<this._numNodes&&this.start.next?this.remove(this.start.next):null},o.prototype.removeLast=function(){return 0<this._numNodes&&this.end.prev?this.remove(this.end.prev):null},o.prototype.removeAll=function(){this.start.next=this.end,this.end.prev=this.start,this._numNodes=0,this._idCounter=0},o.prototype.each=function(t){for(var e=this.start;e.hasNext();)t(e=e.next)},o.prototype.find=function(t){for(var e=this.start,n=!1,r=null;e.hasNext()&&!n;)t(e=e.next)&&(r=e,n=!0);return r},o.prototype.map=function(t){for(var e=this.start,n=[];e.hasNext();)t(e=e.next)&&n.push(e);return n},o.prototype.push=function(t){return this.addLast(t)},o.prototype.unshift=function(t){this.insertBefore(0<this._numNodes?this.start.next:this.end,t)},o.prototype.pop=function(){return this.removeLast()},o.prototype.shift=function(){return this.removeFirst()},e.LinkedList=o},function(t,e,n){!function(t){"use strict";function e(t,e,n,r){var o=i,s=r+n;t^=-1;for(var a=r;a<s;a++)t=t>>>8^o[255&(t^e[a])];return-1^t}function n(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}var r=function(t,e,n,r){for(var i=65535&t|0,o=t>>>16&65535|0,s=0;0!==n;){for(n-=s=2e3<n?2e3:n;o=o+(i=i+e[r++]|0)|0,--s;);i%=65521,o%=65521}return i|o<<16|0},i=new Uint32Array(function(){for(var t=[],e=0;e<256;e++){for(var n=e,r=0;r<8;r++)n=1&n?3988292384^n>>>1:n>>>1;t[e]=n}return t}()),o=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),s=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),a=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),u=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),c=function(t,e,n,r,i,c,l,h){var f,d,p,g,_,m,v,y,b,S=h.bits,E=0,T=0,C=0,w=0,R=0,I=0,k=0,O=0,N=0,A=0,L=null,P=0,M=new Uint16Array(16),D=new Uint16Array(16),x=null,U=0;for(E=0;E<=15;E++)M[E]=0;for(T=0;T<r;T++)M[e[n+T]]++;for(R=S,w=15;1<=w&&0===M[w];w--);if(w<R&&(R=w),0===w)i[c++]=20971520,i[c++]=20971520,h.bits=1;else{for(C=1;C<w&&0===M[C];C++);for(R<C&&(R=C),E=O=1;E<=15;E++)if((O=(O<<1)-M[E])<0)return-1;if(0<O&&(0===t||1!==w))return-1;for(D[1]=0,E=1;E<15;E++)D[E+1]=D[E]+M[E];for(T=0;T<r;T++)0!==e[n+T]&&(l[D[e[n+T]]++]=T);if(m=0===t?(L=x=l,19):1===t?(L=o,P-=257,x=s,U-=257,256):(L=a,x=u,-1),E=C,_=c,k=T=A=0,p=-1,g=(N=1<<(I=R))-1,1===t&&852<N||2===t&&592<N)return 1;for(;;){for(b=l[T]<m?(y=0,l[T]):l[T]>m?(y=x[U+l[T]],L[P+l[T]]):(y=96,0),f=1<<(v=E-k),C=d=1<<I;i[_+(A>>k)+(d-=f)]=v<<24|y<<16|b|0,0!==d;);for(f=1<<E-1;A&f;)f>>=1;if(A=0!==f?(A&f-1)+f:0,T++,0==--M[E]){if(E===w)break;E=e[n+l[T]]}if(R<E&&(A&g)!==p){for(_+=C,O=1<<(I=E-(k=0===k?R:k));I+k<w&&!((O-=M[I+k])<=0);)I++,O<<=1;if(N+=1<<I,1===t&&852<N||2===t&&592<N)return 1;i[p=A&g]=R<<24|I<<16|_-c|0}}0!==A&&(i[_+A]=E-k<<24|64<<16|0),h.bits=R}return 0},l={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},h=l.Z_FINISH,f=l.Z_BLOCK,d=l.Z_TREES,p=l.Z_OK,g=l.Z_STREAM_END,_=l.Z_NEED_DICT,m=l.Z_STREAM_ERROR,v=l.Z_DATA_ERROR,y=l.Z_MEM_ERROR,b=l.Z_BUF_ERROR,S=l.Z_DEFLATED;function E(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function T(t,i){var o,s,a,u,l,E,T,C,I,N,A,L,P,M,D,x,U,B,H,z,G,F,q,j,V=0,W=new Uint8Array(4),Y=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return m;12===(o=t.state).mode&&(o.mode=13),l=t.next_out,a=t.output,u=t.next_in,s=t.input,C=o.hold,I=o.bits,N=E=t.avail_in,A=T=t.avail_out,F=p;t:for(;;)switch(o.mode){case 1:if(0===o.wrap)o.mode=13;else{for(;I<16;){if(0===E)break t;E--,C+=s[u++]<<I,I+=8}if(2&o.wrap&&35615===C)W[o.check=0]=255&C,W[1]=C>>>8&255,o.check=e(o.check,W,2,0),I=C=0,o.mode=2;else if(o.flags=0,o.head&&(o.head.done=!1),!(1&o.wrap)||(((255&C)<<8)+(C>>8))%31)t.msg="incorrect header check",o.mode=30;else if((15&C)!==S)t.msg="unknown compression method",o.mode=30;else{if(I-=4,G=8+(15&(C>>>=4)),0===o.wbits)o.wbits=G;else if(G>o.wbits){t.msg="invalid window size",o.mode=30;break}o.dmax=1<<o.wbits,t.adler=o.check=1,o.mode=512&C?10:12,I=C=0}}break;case 2:for(;I<16;){if(0===E)break t;E--,C+=s[u++]<<I,I+=8}if(o.flags=C,(255&o.flags)!==S){t.msg="unknown compression method",o.mode=30;break}if(57344&o.flags){t.msg="unknown header flags set",o.mode=30;break}o.head&&(o.head.text=C>>8&1),512&o.flags&&(W[0]=255&C,W[1]=C>>>8&255,o.check=e(o.check,W,2,0)),I=C=0,o.mode=3;case 3:for(;I<32;){if(0===E)break t;E--,C+=s[u++]<<I,I+=8}o.head&&(o.head.time=C),512&o.flags&&(W[0]=255&C,W[1]=C>>>8&255,W[2]=C>>>16&255,W[3]=C>>>24&255,o.check=e(o.check,W,4,0)),I=C=0,o.mode=4;case 4:for(;I<16;){if(0===E)break t;E--,C+=s[u++]<<I,I+=8}o.head&&(o.head.xflags=255&C,o.head.os=C>>8),512&o.flags&&(W[0]=255&C,W[1]=C>>>8&255,o.check=e(o.check,W,2,0)),I=C=0,o.mode=5;case 5:if(1024&o.flags){for(;I<16;){if(0===E)break t;E--,C+=s[u++]<<I,I+=8}o.length=C,o.head&&(o.head.extra_len=C),512&o.flags&&(W[0]=255&C,W[1]=C>>>8&255,o.check=e(o.check,W,2,0)),I=C=0}else o.head&&(o.head.extra=null);o.mode=6;case 6:if(1024&o.flags&&((L=(L=o.length)>E?E:L)&&(o.head&&(G=o.head.extra_len-o.length,o.head.extra||(o.head.extra=new Uint8Array(o.head.extra_len)),o.head.extra.set(s.subarray(u,u+L),G)),512&o.flags&&(o.check=e(o.check,s,L,u)),E-=L,u+=L,o.length-=L),o.length))break t;o.length=0,o.mode=7;case 7:if(2048&o.flags){if(0===E)break t;for(L=0;G=s[u+L++],o.head&&G&&o.length<65536&&(o.head.name+=String.fromCharCode(G)),G&&L<E;);if(512&o.flags&&(o.check=e(o.check,s,L,u)),E-=L,u+=L,G)break t}else o.head&&(o.head.name=null);o.length=0,o.mode=8;case 8:if(4096&o.flags){if(0===E)break t;for(L=0;G=s[u+L++],o.head&&G&&o.length<65536&&(o.head.comment+=String.fromCharCode(G)),G&&L<E;);if(512&o.flags&&(o.check=e(o.check,s,L,u)),E-=L,u+=L,G)break t}else o.head&&(o.head.comment=null);o.mode=9;case 9:if(512&o.flags){for(;I<16;){if(0===E)break t;E--,C+=s[u++]<<I,I+=8}if(C!==(65535&o.check)){t.msg="header crc mismatch",o.mode=30;break}I=C=0}o.head&&(o.head.hcrc=o.flags>>9&1,o.head.done=!0),t.adler=o.check=0,o.mode=12;break;case 10:for(;I<32;){if(0===E)break t;E--,C+=s[u++]<<I,I+=8}t.adler=o.check=n(C),I=C=0,o.mode=11;case 11:if(0===o.havedict)return t.next_out=l,t.avail_out=T,t.next_in=u,t.avail_in=E,o.hold=C,o.bits=I,_;t.adler=o.check=1,o.mode=12;case 12:if(i===f||i===d)break t;case 13:if(o.last)C>>>=7&I,I-=7&I,o.mode=27;else{for(;I<3;){if(0===E)break t;E--,C+=s[u++]<<I,I+=8}switch(o.last=1&C,--I,3&(C>>>=1)){case 0:o.mode=14;break;case 1:K=void 0;var Z=o;if(k){w=new Int32Array(512),R=new Int32Array(32);for(var K=0;K<144;)Z.lens[K++]=8;for(;K<256;)Z.lens[K++]=9;for(;K<280;)Z.lens[K++]=7;for(;K<288;)Z.lens[K++]=8;for(c(1,Z.lens,0,288,w,0,Z.work,{bits:9}),K=0;K<32;)Z.lens[K++]=5;c(2,Z.lens,0,32,R,0,Z.work,{bits:5}),k=!1}if(Z.lencode=w,Z.lenbits=9,Z.distcode=R,Z.distbits=5,o.mode=20,i!==d)break;C>>>=2,I-=2;break t;case 2:o.mode=17;break;case 3:t.msg="invalid block type",o.mode=30}C>>>=2,I-=2}break;case 14:for(C>>>=7&I,I-=7&I;I<32;){if(0===E)break t;E--,C+=s[u++]<<I,I+=8}if((65535&C)!=(C>>>16^65535)){t.msg="invalid stored block lengths",o.mode=30;break}if(o.length=65535&C,I=C=0,o.mode=15,i===d)break t;case 15:o.mode=16;case 16:if(L=o.length){if(0===(L=T<(L=E<L?E:L)?T:L))break t;a.set(s.subarray(u,u+L),l),E-=L,u+=L,T-=L,l+=L,o.length-=L}else o.mode=12;break;case 17:for(;I<14;){if(0===E)break t;E--,C+=s[u++]<<I,I+=8}if(o.nlen=257+(31&C),I-=5,o.ndist=1+(31&(C>>>=5)),I-=5,o.ncode=4+(15&(C>>>=5)),C>>>=4,I-=4,286<o.nlen||30<o.ndist){t.msg="too many length or distance symbols",o.mode=30;break}o.have=0,o.mode=18;case 18:for(;o.have<o.ncode;){for(;I<3;){if(0===E)break t;E--,C+=s[u++]<<I,I+=8}o.lens[Y[o.have++]]=7&C,C>>>=3,I-=3}for(;o.have<19;)o.lens[Y[o.have++]]=0;if(o.lencode=o.lendyn,o.lenbits=7,F=c(0,o.lens,0,19,o.lencode,0,o.work,q={bits:o.lenbits}),o.lenbits=q.bits,F){t.msg="invalid code lengths set",o.mode=30;break}o.have=0,o.mode=19;case 19:for(;o.have<o.nlen+o.ndist;){for(;x=(V=o.lencode[C&(1<<o.lenbits)-1])>>>16&255,U=65535&V,!((D=V>>>24)<=I);){if(0===E)break t;E--,C+=s[u++]<<I,I+=8}if(U<16)C>>>=D,I-=D,o.lens[o.have++]=U;else{if(16===U){for(j=D+2;I<j;){if(0===E)break t;E--,C+=s[u++]<<I,I+=8}if(C>>>=D,I-=D,0===o.have){t.msg="invalid bit length repeat",o.mode=30;break}G=o.lens[o.have-1],L=3+(3&C),C>>>=2,I-=2}else if(17===U){for(j=D+3;I<j;){if(0===E)break t;E--,C+=s[u++]<<I,I+=8}G=0,L=3+(7&(C>>>=D)),C>>>=3,I=I-D-3}else{for(j=D+7;I<j;){if(0===E)break t;E--,C+=s[u++]<<I,I+=8}G=0,L=11+(127&(C>>>=D)),C>>>=7,I=I-D-7}if(o.have+L>o.nlen+o.ndist){t.msg="invalid bit length repeat",o.mode=30;break}for(;L--;)o.lens[o.have++]=G}}if(30===o.mode)break;if(0===o.lens[256]){t.msg="invalid code -- missing end-of-block",o.mode=30;break}if(o.lenbits=9,F=c(1,o.lens,0,o.nlen,o.lencode,0,o.work,q={bits:o.lenbits}),o.lenbits=q.bits,F){t.msg="invalid literal/lengths set",o.mode=30;break}if(o.distbits=6,o.distcode=o.distdyn,F=c(2,o.lens,o.nlen,o.ndist,o.distcode,0,o.work,q={bits:o.distbits}),o.distbits=q.bits,F){t.msg="invalid distances set",o.mode=30;break}if(o.mode=20,i===d)break t;case 20:o.mode=21;case 21:if(6<=E&&258<=T){t.next_out=l,t.avail_out=T,t.next_in=u,t.avail_in=E,o.hold=C,o.bits=I,rt=ut=et=tt=J=X=Q=$=mt=_t=at=it=void 0;var $,Q,X,J,tt,et,nt=t,rt=nt.state,it=nt.next_in,ot=nt.input,st=it+(nt.avail_in-5),at=nt.next_out,ut=nt.output,ct=at-(A-nt.avail_out),lt=at+(nt.avail_out-257),ht=rt.dmax,ft=rt.wsize,dt=rt.whave,pt=rt.wnext,gt=rt.window,_t=rt.hold,mt=rt.bits,vt=rt.lencode,yt=rt.distcode,bt=(1<<rt.lenbits)-1,St=(1<<rt.distbits)-1;e:do{for(mt<15&&(_t+=ot[it++]<<mt,_t+=ot[it++]<<(mt+=8),mt+=8),$=vt[_t&bt];;){if(_t>>>=Q=$>>>24,mt-=Q,0==(Q=$>>>16&255))ut[at++]=65535&$;else{if(!(16&Q)){if(0==(64&Q)){$=vt[(65535&$)+(_t&(1<<Q)-1)];continue}if(32&Q){rt.mode=12;break e}nt.msg="invalid literal/length code",rt.mode=30;break e}for(X=65535&$,(Q&=15)&&(mt<Q&&(_t+=ot[it++]<<mt,mt+=8),X+=_t&(1<<Q)-1,_t>>>=Q,mt-=Q),mt<15&&(_t+=ot[it++]<<mt,_t+=ot[it++]<<(mt+=8),mt+=8),$=yt[_t&St];;){if(_t>>>=Q=$>>>24,mt-=Q,!(16&(Q=$>>>16&255))){if(0==(64&Q)){$=yt[(65535&$)+(_t&(1<<Q)-1)];continue}nt.msg="invalid distance code",rt.mode=30;break e}if(J=65535&$,mt<(Q&=15)&&(_t+=ot[it++]<<mt,(mt+=8)<Q)&&(_t+=ot[it++]<<mt,mt+=8),(J+=_t&(1<<Q)-1)>ht){nt.msg="invalid distance too far back",rt.mode=30;break e}if(_t>>>=Q,mt-=Q,J>(Q=at-ct)){if((Q=J-Q)>dt&&rt.sane){nt.msg="invalid distance too far back",rt.mode=30;break e}if(et=gt,(tt=0)===pt){if(tt+=ft-Q,Q<X){for(X-=Q;ut[at++]=gt[tt++],--Q;);tt=at-J,et=ut}}else if(pt<Q){if(tt+=ft+pt-Q,(Q-=pt)<X){for(X-=Q;ut[at++]=gt[tt++],--Q;);if(tt=0,pt<X){for(X-=Q=pt;ut[at++]=gt[tt++],--Q;);tt=at-J,et=ut}}}else if(tt+=pt-Q,Q<X){for(X-=Q;ut[at++]=gt[tt++],--Q;);tt=at-J,et=ut}for(;2<X;)ut[at++]=et[tt++],ut[at++]=et[tt++],ut[at++]=et[tt++],X-=3;X&&(ut[at++]=et[tt++],1<X)&&(ut[at++]=et[tt++])}else{for(tt=at-J;ut[at++]=ut[tt++],ut[at++]=ut[tt++],ut[at++]=ut[tt++],2<(X-=3););X&&(ut[at++]=ut[tt++],1<X)&&(ut[at++]=ut[tt++])}break}}break}}while(it<st&&at<lt);it-=X=mt>>3,_t&=(1<<(mt-=X<<3))-1,nt.next_in=it,nt.next_out=at,nt.avail_in=it<st?st-it+5:5-(it-st),nt.avail_out=at<lt?lt-at+257:257-(at-lt),rt.hold=_t,rt.bits=mt,l=t.next_out,a=t.output,T=t.avail_out,u=t.next_in,s=t.input,E=t.avail_in,C=o.hold,I=o.bits,12===o.mode&&(o.back=-1);break}for(o.back=0;x=(V=o.lencode[C&(1<<o.lenbits)-1])>>>16&255,U=65535&V,!((D=V>>>24)<=I);){if(0===E)break t;E--,C+=s[u++]<<I,I+=8}if(x&&0==(240&x)){for(B=D,H=x,z=U;x=(V=o.lencode[z+((C&(1<<B+H)-1)>>B)])>>>16&255,U=65535&V,!(B+(D=V>>>24)<=I);){if(0===E)break t;E--,C+=s[u++]<<I,I+=8}C>>>=B,I-=B,o.back+=B}if(C>>>=D,I-=D,o.back+=D,o.length=U,0===x){o.mode=26;break}if(32&x){o.back=-1,o.mode=12;break}if(64&x){t.msg="invalid literal/length code",o.mode=30;break}o.extra=15&x,o.mode=22;case 22:if(o.extra){for(j=o.extra;I<j;){if(0===E)break t;E--,C+=s[u++]<<I,I+=8}o.length+=C&(1<<o.extra)-1,C>>>=o.extra,I-=o.extra,o.back+=o.extra}o.was=o.length,o.mode=23;case 23:for(;x=(V=o.distcode[C&(1<<o.distbits)-1])>>>16&255,U=65535&V,!((D=V>>>24)<=I);){if(0===E)break t;E--,C+=s[u++]<<I,I+=8}if(0==(240&x)){for(B=D,H=x,z=U;x=(V=o.distcode[z+((C&(1<<B+H)-1)>>B)])>>>16&255,U=65535&V,!(B+(D=V>>>24)<=I);){if(0===E)break t;E--,C+=s[u++]<<I,I+=8}C>>>=B,I-=B,o.back+=B}if(C>>>=D,I-=D,o.back+=D,64&x){t.msg="invalid distance code",o.mode=30;break}o.offset=U,o.extra=15&x,o.mode=24;case 24:if(o.extra){for(j=o.extra;I<j;){if(0===E)break t;E--,C+=s[u++]<<I,I+=8}o.offset+=C&(1<<o.extra)-1,C>>>=o.extra,I-=o.extra,o.back+=o.extra}if(o.offset>o.dmax){t.msg="invalid distance too far back",o.mode=30;break}o.mode=25;case 25:if(0===T)break t;if(o.offset>(L=A-T)){if((L=o.offset-L)>o.whave&&o.sane){t.msg="invalid distance too far back",o.mode=30;break}P=L>o.wnext?o.wsize-(L-=o.wnext):o.wnext-L,L>o.length&&(L=o.length),M=o.window}else M=a,P=l-o.offset,L=o.length;for(T-=L=T<L?T:L,o.length-=L;a[l++]=M[P++],--L;);0===o.length&&(o.mode=21);break;case 26:if(0===T)break t;a[l++]=o.length,T--,o.mode=21;break;case 27:if(o.wrap){for(;I<32;){if(0===E)break t;E--,C|=s[u++]<<I,I+=8}if(t.total_out+=A-=T,o.total+=A,A&&(t.adler=o.check=(o.flags?e:r)(o.check,a,A,l-A)),A=T,(o.flags?C:n(C))!==o.check){t.msg="incorrect data check",o.mode=30;break}I=C=0}o.mode=28;case 28:if(o.wrap&&o.flags){for(;I<32;){if(0===E)break t;E--,C+=s[u++]<<I,I+=8}if(C!==(4294967295&o.total)){t.msg="incorrect length check",o.mode=30;break}I=C=0}o.mode=29;case 29:F=g;break t;case 30:F=v;break t;case 31:return y;default:return m}return t.next_out=l,t.avail_out=T,t.next_in=u,t.avail_in=E,o.hold=C,o.bits=I,(o.wsize||A!==t.avail_out&&o.mode<30&&(o.mode<27||i!==h))&&O(t,t.output,t.next_out,A-t.avail_out),A-=t.avail_out,t.total_in+=N-=t.avail_in,t.total_out+=A,o.total+=A,o.wrap&&A&&(t.adler=o.check=(o.flags?e:r)(o.check,a,A,t.next_out-A)),t.data_type=o.bits+(o.last?64:0)+(12===o.mode?128:0)+(20===o.mode||15===o.mode?256:0),(0==N&&0===A||i===h)&&F===p?b:F}function C(t,e){var n,i=e.length;return!t||!t.state||0!==(n=t.state).wrap&&11!==n.mode?m:11===n.mode&&r(1,e,i,0)!==n.check?v:O(t,e,i,i)?(n.mode=31,y):(n.havedict=1,p)}var w,R,I=function(t){var e;return t&&t.state&&((e=t.state).wsize=0,e.whave=0,e.wnext=0,e=t)&&e.state?(e.total_in=e.total_out=(t=e.state).total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,p):m},k=!0,O=function(t,e,n,r){var i;return null===(t=t.state).window&&(t.wsize=1<<t.wbits,t.wnext=0,t.whave=0,t.window=new Uint8Array(t.wsize)),r>=t.wsize?(t.window.set(e.subarray(n-t.wsize,n),0),t.wnext=0,t.whave=t.wsize):((i=t.wsize-t.wnext)>r&&(i=r),t.window.set(e.subarray(n-r,n-r+i),t.wnext),(r-=i)?(t.window.set(e.subarray(n-r,n),0),t.wnext=r,t.whave=t.wsize):(t.wnext+=i,t.wnext===t.wsize&&(t.wnext=0),t.whave<t.wsize&&(t.whave+=i))),0},N=I,A=function(t,e){var n,r,i;return t?(n=new E,(t.state=n).window=null,n=e,(i=!(e=t)||!e.state||(i=e.state,n<0?(r=0,n=-n):(r=1+(n>>4),n<48&&(n&=15)),n&&(n<8||15<n))?m:(null!==i.window&&i.wbits!==n&&(i.window=null),i.wrap=r,i.wbits=n,I(e)))!==p&&(t.state=null),i):m};function L(t){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var P=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){P=!1}for(var M=new Uint8Array(256),D=0;D<256;D++)M[D]=252<=D?6:248<=D?5:240<=D?4:224<=D?3:192<=D?2:1;function x(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}function U(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}M[254]=M[254]=1;var B={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},H=Object.prototype.toString,z=l.Z_NO_FLUSH,G=l.Z_FINISH,F=l.Z_OK,q=l.Z_STREAM_END,j=l.Z_NEED_DICT,V=l.Z_STREAM_ERROR,W=l.Z_DATA_ERROR,Y=l.Z_MEM_ERROR;function Z(t){this.options=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var n=e.shift();if(n){if("object"!==L(n))throw new TypeError(n+"must be non-object");for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}}return t}({chunkSize:65536,windowBits:15,to:""},t||{});var e,n=this.options;if(n.raw&&0<=n.windowBits&&n.windowBits<16&&(n.windowBits=-n.windowBits,0===n.windowBits)&&(n.windowBits=-15),!(0<=n.windowBits&&n.windowBits<16)||t&&t.windowBits||(n.windowBits+=32),15<n.windowBits&&n.windowBits<48&&0==(15&n.windowBits)&&(n.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new x,this.strm.avail_out=0,(t=A(this.strm,n.windowBits))!==F)throw new Error(B[t]);if(this.header=new U,!(e=this.strm)||!e.state||0==(2&(e=e.state).wrap)||((e.head=this.header).done=!1),n.dictionary&&("string"==typeof n.dictionary?n.dictionary=function(t){if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);for(var e,n,r,i,o=t.length,s=0,a=0;a<o;a++)55296==(64512&(n=t.charCodeAt(a)))&&a+1<o&&56320==(64512&(r=t.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),s+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(s),a=i=0;i<s;a++)55296==(64512&(n=t.charCodeAt(a)))&&a+1<o&&56320==(64512&(r=t.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),n<128?e[i++]=n:(n<2048?e[i++]=192|n>>>6:(n<65536?e[i++]=224|n>>>12:(e[i++]=240|n>>>18,e[i++]=128|n>>>12&63),e[i++]=128|n>>>6&63),e[i++]=128|63&n);return e}(n.dictionary):"[object ArrayBuffer]"===H.call(n.dictionary)&&(n.dictionary=new Uint8Array(n.dictionary)),n.raw)&&(t=C(this.strm,n.dictionary))!==F)throw new Error(B[t])}function K(t,e){if((e=new Z(e)).push(t),e.err)throw e.msg||B[e.err];return e.result}function $(t,e){return(e=e||{}).raw=!0,K(t,e)}Z.prototype.push=function(t,e){var n,r,i=this.strm,o=this.options.chunkSize,s=this.options.dictionary;if(this.ended)return!1;for(r=e===~~e?e:!0===e?G:z,i.input="[object ArrayBuffer]"===H.call(t)?new Uint8Array(t):t,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(o),i.next_out=0,i.avail_out=o),(n=T(i,r))===j&&s&&((n=C(i,s))===F?n=T(i,r):n===W&&(n=j));0<i.avail_in&&n===q&&0<i.state.wrap&&0!==t[i.next_in];)N(i),n=T(i,r);switch(n){case V:case W:case j:case Y:return this.onEnd(n),!(this.ended=!0)}var a,u,c,l=i.avail_out;if(!i.next_out||0!==i.avail_out&&n!==q||("string"===this.options.to?(a=function(t,e){for(var n=(e=(e=e||t.length)>t.length?t.length:e)-1;0<=n&&128==(192&t[n]);)n--;return!(n<0||0===n)&&n+M[t[n]]>e?n:e}(i.output,i.next_out),u=i.next_out-a,c=function(t,e){var n=e||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,e));for(var r=new Array(2*n),i=0,o=0;o<n;){var s=t[o++];if(s<128)r[i++]=s;else{var a=M[s];if(4<a)r[i++]=65533,o+=a-1;else{for(s&=2===a?31:3===a?15:7;1<a&&o<n;)s=s<<6|63&t[o++],a--;1<a?r[i++]=65533:s<65536?r[i++]=s:(r[i++]=55296|(s-=65536)>>10&1023,r[i++]=56320|1023&s)}}}var u=r,c=i;if(c<65534&&u.subarray&&P)return String.fromCharCode.apply(null,u.length===c?u:u.subarray(0,c));for(var l="",h=0;h<c;h++)l+=String.fromCharCode(u[h]);return l}(i.output,a),i.next_out=u,i.avail_out=o-u,u&&i.output.set(i.output.subarray(a,a+u),0),this.onData(c)):this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out))),n!==F||0!==l){if(n===q)return u=void 0,n=(a=this.strm)&&a.state?((u=a.state).window&&(u.window=null),a.state=null,p):m,this.onEnd(n),this.ended=!0;if(0===i.avail_in)break}}return!0},Z.prototype.onData=function(t){this.chunks.push(t)},Z.prototype.onEnd=function(t){t===F&&(this.result="string"===this.options.to?this.chunks.join(""):function(t){for(var e=0,n=0,r=t.length;n<r;n++)e+=t[n].length;for(var i=new Uint8Array(e),o=0,s=0,a=t.length;o<a;o++){var u=t[o];i.set(u,s),s+=u.length}return i}(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Q=K,X=K,J={Inflate:Z,inflate:Q,inflateRaw:$,ungzip:X,constants:l};t.Inflate=Z,t.constants=l,t.default=J,t.inflate=Q,t.inflateRaw=$,t.ungzip=X,Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){t[r=void 0===r?n:r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},a=(Object.defineProperty(e,"__esModule",{value:!0}),e.CloudSettingProtoBuf=void 0,s=s(n(5)),o=o(n(6)),n(18));function u(){}o.util.Long=s.default,o.configure(),u.prototype.encodeCloudSettingReq=function(t){return t=a.cloudsetting.GetCloudSettingConfigRequest.create(t),a.cloudsetting.GetCloudSettingConfigRequest.encode(t).finish()},u.prototype.decodeCloudSettingRsp=function(t){return a.cloudsetting.GetCloudSettingConfigResponse.decode(t)},e.CloudSettingProtoBuf=o=u},function(t,e,n){"use strict";var r,i=n(6),o=i.Reader,s=i.Writer,a=i.util,u=i.roots.default||(i.roots.default={});function c(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}function l(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}function h(t){if(this.file_list=[],this.param_list=[],this.files=[],t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}function f(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}function d(t){if(this.file_response=[],t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}u.cloudsetting=((r={}).Product=(n={},(i=Object.create(n))[n[0]="RTC"]=0,i[n[1]="WEB_RTC"]=1,i[n[2]="ZIM"]=2,i[n[3]="ROOM_KIT"]=3,i[n[4]="DOC_SHARE"]=4,i[n[5]="WHITE_BOARD"]=5,i[n[999]="SELF_CHECK"]=999,i[n[1e3]="TEST_ANOOUS"]=1e3,i),r.Param=(c.prototype.key="",c.prototype.value="",c.create=function(t){return new c(t)},c.encode=function(t,e){return e=e||s.create(),null!=t.key&&Object.hasOwnProperty.call(t,"key")&&e.uint32(10).string(t.key),null!=t.value&&Object.hasOwnProperty.call(t,"value")&&e.uint32(18).string(t.value),e},c.decode=function(t,e){t instanceof o||(t=o.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new u.cloudsetting.Param;t.pos<n;){var i=t.uint32();switch(i>>>3){case 1:r.key=t.string();break;case 2:r.value=t.string();break;default:t.skipType(7&i)}}return r},c),r.File=(l.prototype.file_name="",l.prototype.hash=a.newBuffer([]),l.prototype.g_version=0,l.create=function(t){return new l(t)},l.encode=function(t,e){return e=e||s.create(),null!=t.file_name&&Object.hasOwnProperty.call(t,"file_name")&&e.uint32(10).string(t.file_name),null!=t.hash&&Object.hasOwnProperty.call(t,"hash")&&e.uint32(18).bytes(t.hash),null!=t.g_version&&Object.hasOwnProperty.call(t,"g_version")&&e.uint32(24).uint32(t.g_version),e},l.decode=function(t,e){t instanceof o||(t=o.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new u.cloudsetting.File;t.pos<n;){var i=t.uint32();switch(i>>>3){case 1:r.file_name=t.string();break;case 2:r.hash=t.bytes();break;case 3:r.g_version=t.uint32();break;default:t.skipType(7&i)}}return r},l),r.GetCloudSettingConfigRequest=(h.prototype.product=0,h.prototype.response_compress=0,h.prototype.file_list=a.emptyArray,h.prototype.param_list=a.emptyArray,h.prototype.files=a.emptyArray,h.prototype.p_version=0,h.create=function(t){return new h(t)},h.encode=function(t,e){if(e=e||s.create(),null!=t.product&&Object.hasOwnProperty.call(t,"product")&&e.uint32(8).int32(t.product),null!=t.response_compress&&Object.hasOwnProperty.call(t,"response_compress")&&e.uint32(16).int32(t.response_compress),null!=t.file_list&&t.file_list.length)for(var n=0;n<t.file_list.length;++n)e.uint32(26).string(t.file_list[n]);if(null!=t.param_list&&t.param_list.length)for(n=0;n<t.param_list.length;++n)u.cloudsetting.Param.encode(t.param_list[n],e.uint32(34).fork()).ldelim();if(null!=t.files&&t.files.length)for(n=0;n<t.files.length;++n)u.cloudsetting.File.encode(t.files[n],e.uint32(42).fork()).ldelim();return null!=t.p_version&&Object.hasOwnProperty.call(t,"p_version")&&e.uint32(48).uint32(t.p_version),e},h.decode=function(t,e){t instanceof o||(t=o.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new u.cloudsetting.GetCloudSettingConfigRequest;t.pos<n;){var i=t.uint32();switch(i>>>3){case 1:r.product=t.int32();break;case 2:r.response_compress=t.int32();break;case 3:r.file_list&&r.file_list.length||(r.file_list=[]),r.file_list.push(t.string());break;case 4:r.param_list&&r.param_list.length||(r.param_list=[]),r.param_list.push(u.cloudsetting.Param.decode(t,t.uint32()));break;case 5:r.files&&r.files.length||(r.files=[]),r.files.push(u.cloudsetting.File.decode(t,t.uint32()));break;case 6:r.p_version=t.uint32();break;default:t.skipType(7&i)}}return r},h),r.CloudSettingFileResponse=(f.prototype.code=a.Long?a.Long.fromBits(0,0,!1):0,f.prototype.message="",f.prototype.file_name="",f.prototype.global_version="",f.prototype.version="",f.prototype.app_version="",f.prototype.json_data=a.newBuffer([]),f.prototype.hash=a.newBuffer([]),f.prototype.g_version=0,f.create=function(t){return new f(t)},f.encode=function(t,e){return e=e||s.create(),null!=t.code&&Object.hasOwnProperty.call(t,"code")&&e.uint32(8).int64(t.code),null!=t.message&&Object.hasOwnProperty.call(t,"message")&&e.uint32(18).string(t.message),null!=t.file_name&&Object.hasOwnProperty.call(t,"file_name")&&e.uint32(26).string(t.file_name),null!=t.global_version&&Object.hasOwnProperty.call(t,"global_version")&&e.uint32(34).string(t.global_version),null!=t.version&&Object.hasOwnProperty.call(t,"version")&&e.uint32(42).string(t.version),null!=t.app_version&&Object.hasOwnProperty.call(t,"app_version")&&e.uint32(50).string(t.app_version),null!=t.json_data&&Object.hasOwnProperty.call(t,"json_data")&&e.uint32(58).bytes(t.json_data),null!=t.hash&&Object.hasOwnProperty.call(t,"hash")&&e.uint32(66).bytes(t.hash),null!=t.g_version&&Object.hasOwnProperty.call(t,"g_version")&&e.uint32(72).uint32(t.g_version),e},f.decode=function(t,e){t instanceof o||(t=o.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new u.cloudsetting.CloudSettingFileResponse;t.pos<n;){var i=t.uint32();switch(i>>>3){case 1:r.code=t.int64();break;case 2:r.message=t.string();break;case 3:r.file_name=t.string();break;case 4:r.global_version=t.string();break;case 5:r.version=t.string();break;case 6:r.app_version=t.string();break;case 7:r.json_data=t.bytes();break;case 8:r.hash=t.bytes();break;case 9:r.g_version=t.uint32();break;default:t.skipType(7&i)}}return r},f),r.GetCloudSettingConfigResponse=(d.prototype.code=a.Long?a.Long.fromBits(0,0,!1):0,d.prototype.message="",d.prototype.polling_interval=0,d.prototype.file_response=a.emptyArray,d.create=function(t){return new d(t)},d.encode=function(t,e){if(e=e||s.create(),null!=t.code&&Object.hasOwnProperty.call(t,"code")&&e.uint32(8).int64(t.code),null!=t.message&&Object.hasOwnProperty.call(t,"message")&&e.uint32(18).string(t.message),null!=t.polling_interval&&Object.hasOwnProperty.call(t,"polling_interval")&&e.uint32(24).int32(t.polling_interval),null!=t.file_response&&t.file_response.length)for(var n=0;n<t.file_response.length;++n)u.cloudsetting.CloudSettingFileResponse.encode(t.file_response[n],e.uint32(34).fork()).ldelim();return e},d.decode=function(t,e){t instanceof o||(t=o.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new u.cloudsetting.GetCloudSettingConfigResponse;t.pos<n;){var i=t.uint32();switch(i>>>3){case 1:r.code=t.int64();break;case 2:r.message=t.string();break;case 3:r.polling_interval=t.int32();break;case 4:r.file_response&&r.file_response.length||(r.file_response=[]),r.file_response.push(u.cloudsetting.CloudSettingFileResponse.decode(t,t.uint32()));break;default:t.skipType(7&i)}}return r},d),r),t.exports=u}],r.c=u,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=8))},function(t,e,n){var r;t.exports=(r=n(1),function(){var t,e;"function"==typeof ArrayBuffer&&(e=(t=r.lib.WordArray).init,(t.init=function(t){if((t=(t=t instanceof ArrayBuffer?new Uint8Array(t):t)instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t)instanceof Uint8Array){for(var n=t.byteLength,r=[],i=0;i<n;i++)r[i>>>2]|=t[i]<<24-i%4*8;e.call(this,r,n)}else e.apply(this,arguments)}).prototype=t)}(),r.lib.WordArray)},function(t,e){var n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){},function(t,e,n){var r;t.exports=(t=n(1),r=t.lib.WordArray,t.enc.Base64={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=this._map,i=(t.clamp(),[]),o=0;o<n;o+=3)for(var s=(e[o>>>2]>>>24-o%4*8&255)<<16|(e[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|e[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;a<4&&o+.75*a<n;a++)i.push(r.charAt(s>>>6*(3-a)&63));var u=r.charAt(64);if(u)for(;i.length%4;)i.push(u);return i.join("")},parse:function(t){var e=t.length,n=this._map;if(!(i=this._reverseMap))for(var i=this._reverseMap=[],o=0;o<n.length;o++)i[n.charCodeAt(o)]=o;var s=n.charAt(64);return s&&-1!==(s=t.indexOf(s))&&(e=s),function(t,e,n){for(var i,o,s=[],a=0,u=0;u<e;u++)u%4&&(i=n[t.charCodeAt(u-1)]<<u%4*2,o=n[t.charCodeAt(u)]>>>6-u%4*2,s[a>>>2]|=(i|o)<<24-a%4*8,a++);return r.create(s,a)}(t,e,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},t.enc.Base64)},function(t,e,n){var r,i,o,s;t.exports=(t=n(1),s=(n=t).lib,r=s.WordArray,i=s.Hasher,o=[],s=(s=n.algo).SHA1=i.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var n=this._hash.words,r=n[0],i=n[1],s=n[2],a=n[3],u=n[4],c=0;c<80;c++){o[c]=c<16?0|t[e+c]:(l=o[c-3]^o[c-8]^o[c-14]^o[c-16])<<1|l>>>31;var l=(r<<5|r>>>27)+u+o[c];l+=c<20?1518500249+(i&s|~i&a):c<40?1859775393+(i^s^a):c<60?(i&s|i&a|s&a)-1894007588:(i^s^a)-899497514,u=a,a=s,s=i<<30|i>>>2,i=r,r=l}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+s|0,n[3]=n[3]+a|0,n[4]=n[4]+u|0},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,r=8*t.sigBytes;return e[r>>>5]|=128<<24-r%32,e[14+(64+r>>>9<<4)]=Math.floor(n/4294967296),e[15+(64+r>>>9<<4)]=n,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=i.clone.call(this);return t._hash=this._hash.clone(),t}}),n.SHA1=i._createHelper(s),n.HmacSHA1=i._createHmacHelper(s),t.SHA1)},function(t,e,n){var r;t.exports=(t=n(1),r=t.enc.Utf8,void(t.algo.HMAC=(n=t.lib.Base).extend({init:function(t,e){t=this._hasher=new t.init,"string"==typeof e&&(e=r.parse(e));for(var n=t.blockSize,i=4*n,o=((e=e.sigBytes>i?t.finalize(e):e).clamp(),t=this._oKey=e.clone(),e=this._iKey=e.clone(),t.words),s=e.words,a=0;a<n;a++)o[a]^=1549556828,s[a]^=909522486;t.sigBytes=e.sigBytes=i,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher;return t=e.finalize(t),e.reset(),e.finalize(this._oKey.clone().concat(t))}})))},function(t,e,n){var r,i,o,s,a,u,c,l,h,f,d,p;t.exports=(t=n(1),n(9),void(t.lib.Cipher||(n=t.lib,r=n.Base,i=n.WordArray,o=n.BufferedBlockAlgorithm,h=t.enc,s=h.Base64,a=t.algo.EvpKDF,u=n.Cipher=o.extend({cfg:r.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,n){this.cfg=this.cfg.extend(n),this._xformMode=t,this._key=e,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function t(t){return"string"==typeof t?p:f}return function(e){return{encrypt:function(n,r,i){return t(r).encrypt(e,n,r,i)},decrypt:function(n,r,i){return t(r).decrypt(e,n,r,i)}}}}()}),n.StreamCipher=u.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),h=t.mode={},c=n.BlockCipherMode=r.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}}),h=h.CBC=function(){var t=c.extend();function e(t,e,n){var r,i=this._iv;i?(r=i,this._iv=void 0):r=this._prevBlock;for(var o=0;o<n;o++)t[e+o]^=r[o]}return t.Encryptor=t.extend({processBlock:function(t,n){var r=this._cipher,i=r.blockSize;e.call(this,t,n,i),r.encryptBlock(t,n),this._prevBlock=t.slice(n,n+i)}}),t.Decryptor=t.extend({processBlock:function(t,n){var r=this._cipher,i=r.blockSize,o=t.slice(n,n+i);r.decryptBlock(t,n),e.call(this,t,n,i),this._prevBlock=o}}),t}(),d=(t.pad={}).Pkcs7={pad:function(t,e){for(var n=(e*=4)-t.sigBytes%e,r=n<<24|n<<16|n<<8|n,o=[],s=0;s<n;s+=4)o.push(r);e=i.create(o,n),t.concat(e)},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}},n.BlockCipher=u.extend({cfg:u.cfg.extend({mode:h,padding:d}),reset:function(){u.reset.call(this);var t,e=(n=this.cfg).iv,n=n.mode;this._xformMode==this._ENC_XFORM_MODE?t=n.createEncryptor:(t=n.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==t?this._mode.init(this,e&&e.words):(this._mode=t.call(n,this,e&&e.words),this._mode.__creator=t)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t,e=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(e.pad(this._data,this.blockSize),t=this._process(!0)):(t=this._process(!0),e.unpad(t)),t},blockSize:4}),l=n.CipherParams=r.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),h=(t.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext;return(t=(t=t.salt)?i.create([1398893684,1701076831]).concat(t).concat(e):e).toString(s)},parse:function(t){var e,n=(t=s.parse(t)).words;return 1398893684==n[0]&&1701076831==n[1]&&(e=i.create(n.slice(2,4)),n.splice(0,4),t.sigBytes-=16),l.create({ciphertext:t,salt:e})}},f=n.SerializableCipher=r.extend({cfg:r.extend({format:h}),encrypt:function(t,e,n,r){r=this.cfg.extend(r),e=(i=t.createEncryptor(n,r)).finalize(e);var i=i.cfg;return l.create({ciphertext:e,key:n,iv:i.iv,algorithm:t,mode:i.mode,padding:i.padding,blockSize:t.blockSize,formatter:r.format})},decrypt:function(t,e,n,r){return r=this.cfg.extend(r),e=this._parse(e,r.format),t.createDecryptor(n,r).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}}),d=(t.kdf={}).OpenSSL={execute:function(t,e,n,r){return r=r||i.random(8),t=a.create({keySize:e+n}).compute(t,r),n=i.create(t.words.slice(e),4*n),t.sigBytes=4*e,l.create({key:t,iv:n,salt:r})}},p=n.PasswordBasedCipher=f.extend({cfg:f.cfg.extend({kdf:d}),encrypt:function(t,e,n,r){return n=(r=this.cfg.extend(r)).kdf.execute(n,t.keySize,t.ivSize),r.iv=n.iv,(t=f.encrypt.call(this,t,e,n.key,r)).mixIn(n),t},decrypt:function(t,e,n,r){return r=this.cfg.extend(r),e=this._parse(e,r.format),n=r.kdf.execute(n,t.keySize,t.ivSize,e.salt),r.iv=n.iv,f.decrypt.call(this,t,e,n.key,r)}}))))},function(t,e,n){"use strict";n.r(e),n.d(e,"ZegoExpressWebRTMEngine",(function(){return Zn})),n.d(e,"getReportSeq",(function(){return p})),n.d(e,"getSeq",(function(){return d})),n.d(e,"ZegoLogger",(function(){return i.ZegoLogger})),n.d(e,"ZegoDataReport",(function(){return i.ZegoDataReport})),n.d(e,"ZegoExpressWebRTM",(function(){return Bn})),n.d(e,"BusinessService",(function(){return T})),n.d(e,"NetConnection",(function(){return I})),n.d(e,"ZReporter",(function(){return Wn}));var r,i=n(3);(e=r=r||{})[e.SWITCH_ONE=1]="SWITCH_ONE",e[e.SWITCH_TWO=2]="SWITCH_TWO";var o,s,a,u,c,l,h,f,d=((e=o=o||{})[e.TT_NONE=0]="TT_NONE",e[e.TT_PC=1]="TT_PC",e[e.TT_IOS=2]="TT_IOS",e[e.TT_ANDROID=3]="TT_ANDROID",e[e.TT_MAC=4]="TT_MAC",e[e.TT_LINUX=5]="TT_LINUX",e[e.TT_WEB=6]="TT_WEB",e[e.TT_MINIPROGRAM=7]="TT_MINIPROGRAM",e[e.TT_UNKNOWN=32]="TT_UNKNOWN",(e=s=s||{})[e.logout=0]="logout",e[e.trylogin=1]="trylogin",e[e.login=2]="login",(e=a=a||{})[e.I=0]="I",e[e.H=10]="H",e[e.M=100]="M",e[e.L=1e3]="L",(e=u=u||{})[e.offline=0]="offline",e[e.online=1]="online",(e=c=c||{})[e.NT_NONE=0]="NT_NONE",e[e.NT_LINE=1]="NT_LINE",e[e.NT_WIFI=2]="NT_WIFI",e[e.NT_2G=3]="NT_2G",e[e.NT_3G=4]="NT_3G",e[e.NT_4G=5]="NT_4G",e[e.NT_UNKNOWN=32]="NT_UNKNOWN",(e=l=l||{})[e.ClientType_None=0]="ClientType_None",e[e.ClientType_H5=1]="ClientType_H5",e[e.ClientType_SmallProgram=2]="ClientType_SmallProgram",e[e.ClientType_Webrtc=3]="ClientType_Webrtc",function(){return h++}),p=(f=h=1,function(){return f++}),g=(Object.defineProperty(_.prototype,"id",{get:function(){return this._id||null},set:function(t){this._id=t},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t},enumerable:!1,configurable:!0}),_.prototype.hasNext=function(){return this.next&&this.next.id},_.prototype.hasPrev=function(){return this.prev&&this.prev.id},_);function _(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.next=null,this.prev=null,this._id=t,this._data=e}v.prototype.insertBefore=function(t,e){return(e=new g(this._idCounter,e)).next=t,e.prev=t.prev,t.prev&&(t.prev.next=e),t.prev=e,++this._idCounter,++this._numNodes,e},v.prototype.addLast=function(t){return this.insertBefore(this.end,t)},v.prototype.add=function(t){return this.addLast(t)},v.prototype.getFirst=function(){return 0===this._numNodes?null:this.start.next},v.prototype.getLast=function(){return 0===this._numNodes?null:this.end.prev},v.prototype.size=function(){return this._numNodes},v.prototype.getFromFirst=function(t){var e=0,n=this.start.next;if(0<=t)for(;e<t&&null!==n;)n=n.next,++e;else n=null;if(null===n)throw"Index out of bounds.";return n},v.prototype.get=function(t){return 0===t?this.getFirst():t===this._numNodes-1?this.getLast():this.getFromFirst(t)},v.prototype.remove=function(t){return t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),--this._numNodes,t},v.prototype.removeFirst=function(){var t=null;return 0<this._numNodes&&this.start.next?this.remove(this.start.next):t},v.prototype.removeLast=function(){var t=null;return 0<this._numNodes&&this.end.prev?this.remove(this.end.prev):t},v.prototype.removeAll=function(){this.start.next=this.end,this.end.prev=this.start,this._numNodes=0,this._idCounter=0},v.prototype.each=function(t){for(var e=this.start;e.hasNext();)t(e=e.next)},v.prototype.find=function(t){for(var e=this.start,n=!1,r=null;e.hasNext()&&!n;)t(e=e.next)&&(r=e,n=!0);return r},v.prototype.map=function(t){for(var e=this.start,n=[];e.hasNext();)t(e=e.next)&&n.push(e);return n},v.prototype.push=function(t){return this.addLast(t)},v.prototype.unshift=function(t){this.insertBefore(0<this._numNodes?this.start.next:this.end,t)},v.prototype.pop=function(){return this.removeLast()},v.prototype.shift=function(){return this.removeFirst()};var m=v;function v(){this.start=new g,this.end=new g,this._idCounter=0,this._numNodes=0,this.start.next=this.end,this.start.prev=null,this.end.prev=this.start,this.end.next=null}var y,b,S,E,T,C,w="",R=n(10).ZegoConnectionAgent,I=(Object.defineProperty(k.prototype,"clientIP",{get:function(){var t;return(null==(t=this.connection)?void 0:t.clientIP)||""},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"timeOffset",{get:function(){var t;return null==(t=this.connection)?void 0:t.timeOffset},enumerable:!1,configurable:!0}),k.prototype.init=function(){var t;null!=(t=this.connection)&&t.init()},k.prototype.unInit=function(){var t;null!=(t=this.connection)&&t.unInit()},k.prototype.setAppInfo=function(t){var e;null!=(e=this.connection)&&e.setAppInfo(t)},k.prototype.setUserInfo=function(t){var e;null!=(e=this.connection)&&e.setUserInfo(t)},k.prototype.setNetAgentDefaultServers=function(t){var e;null!=(e=this.connection)&&e.setNetAgentDefaultServers(t)},k.prototype.setBackupDomains=function(t){var e;null!=(e=this.connection)&&e.setBackupDomains(t)},k.prototype.setDispatchConnectServers=function(t){var e;null!=(e=this.connection)&&e.setDispatchConnectServers(t)},k.prototype.setNetAgentSpecifiedServers=function(t){var e;null!=(e=this.connection)&&e.setNetAgentSpecifiedServers(t)},k.prototype.startHttpRequest=function(t,e,n,r,i){var o;null!=(o=this.connection)&&o.startHttpRequest(t,e,n,r,i)},k.prototype.startHttpRequest2=function(t,e,n,r,i){var o;null!=(o=this.connection)&&o.startHttpRequest2(t,e,n,r,i)},k.prototype.getAppConfigByAgent=function(t,e,n,r){var i;return null==(i=this.connection)?void 0:i.getAppConfigByAgent(t,e,n,r)},k.prototype.getPCRequest=function(t,e){var n;return(null==(n=this.connection)?void 0:n.getPCRequest(t,e))||null},k.prototype.connectUa=function(){var t;null!=(t=this.connection)&&t.connectUa()},k.prototype.destroyConnect=function(){var t;null!=(t=this.connection)&&t.destroyConnect()},k.prototype.destroy=function(){var t;null!=(t=this.connection)&&t.destroy()},k.prototype.isConnect=function(){return!!this.connection&&this.connection.isConnect()},k.prototype.on=function(t,e){var n;return(null==(n=this.connection)?void 0:n.on(t,e))||!0},k.prototype.off=function(t,e){var n;return null==(n=this.connection)?void 0:n.off(t,e)},k.prototype.setLogger=function(t){var e;return null==(e=this.connection)?void 0:e.setLogger(t)},k.prototype.setAccess=function(t){var e;return null==(e=this.connection)?void 0:e.setAccess(t)},k.prototype.getNTP=function(){var t;return(null==(t=this.connection)?void 0:t.getNetworkTimeInfo())||{timestamp:0,maxDeviation:0}},k);function k(){this.connection=null,this.isLoad=!1,this.callBackList=[],this.connection=new R}(e=y=y||{})[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL",(e=b=b||{})[e.EMPTY=0]="EMPTY",e[e.CLOSE=1]="CLOSE",(e=S=S||{})[e.Mode_UNSET=0]="Mode_UNSET",e[e.MODE_ONLINE=1]="MODE_ONLINE",e[e.MODE_TEST=2]="MODE_TEST",e[e.MODE_ALPHA=3]="MODE_ALPHA",(e=E=E||{})[e.CLOSE=0]="CLOSE",e[e.TEMP=1]="TEMP",e[e.TIMEOUT=2]="TIMEOUT",(e=T=T||{})[e.SERVICE_UNSET=0]="SERVICE_UNSET",e[e.SERVICE_MEDIAGW=1]="SERVICE_MEDIAGW",e[e.SERVICE_LIVEROOM=2]="SERVICE_LIVEROOM",e[e.SERVICE_MIX=3]="SERVICE_MIX",e[e.SERVICE_ZEUS=4]="SERVICE_ZEUS",e[e.SERVICE_ZPUSH=5]="SERVICE_ZPUSH",e[e.SERVICE_L3=6]="SERVICE_L3",e[e.SERVICE_TALKLINE=7]="SERVICE_TALKLINE",e[e.SERVICE_EDUSUITE=8]="SERVICE_EDUSUITE",e[e.SERVICE_ZIM=9]="SERVICE_ZIM",e[e.SERVICE_ClOUD_SETTING=10]="SERVICE_ClOUD_SETTING",e[e.SERVICE_ZEUSHB=11]="SERVICE_ZEUSHB",e[e.SERVICE_USER_LOGIC=12]="SERVICE_USER_LOGIC",e[e.SERVICE_UNIFYDISPATCH=13]="SERVICE_UNIFYDISPATCH",e[e.SERVICE_QUALITY=14]="SERVICE_QUALITY",e[e.SERVICE_SECURITY=15]="SERVICE_SECURITY",e[e.SERVICE_KTVCPR=16]="SERVICE_KTVCPR",e[e.SERVICE_SWITCH4LIVEROOM=17]="SERVICE_SWITCH4LIVEROOM",e[e.SERVICE_WEBRTC_SIGNAL=18]="SERVICE_WEBRTC_SIGNAL",e[e.SERVICE_L3_WEBRTC_SIGNAL=19]="SERVICE_L3_WEBRTC_SIGNAL",e[e.SERVICE_VIDEOCPR=20]="SERVICE_VIDEOCPR",e[e.SERVICE_CDN=21]="SERVICE_CDN",e[e.SERVICE_CLOUDRECORD=22]="SERVICE_CLOUDRECORD",e[e.SERVICE_INNER_ECHO=23]="SERVICE_INNER_ECHO",e[e.SERVICE_OUTER_ECHO=24]="SERVICE_OUTER_ECHO",e[e.SERVICE_LOCALHOST_ECHO=25]="SERVICE_LOCALHOST_ECHO",e[e.SERVICE_ECHO=26]="SERVICE_ECHO",e[e.SERVICE_DOCSERVICE=27]="SERVICE_DOCSERVICE",e[e.SERVICE_AUTHSVR=28]="SERVICE_AUTHSVR",(e=C=C||{}).Logining="LOGINING",e.Logined="LOGINED",e.LoginFailed="LOGIN_FAILED",e.Reconnecting="RECONNECTING",e.Reconnected="RECONNECTED",e.ReconnectFailed="RECONNECT_FAILED",e.Kickout="KICKOUT",e.Logout="LOGOUT",e.LogoutFailed="LOGOUT_FAILED";var O={SERVER:{code:0,msg:"liverooom cmd error"},SUCCESS:{code:0,msg:"success."},INIT:{code:2000000001,msg:"init sdk wrong"},NOT_LOGIN:{code:1000002,msg:"not login"},APPID_INVALID:{code:1001004,msg:"appid invalid"},NETWORK_BROKEN:{code:1000017,msg:"network is broken"},GEO_SET_ERROR:{code:1000018,msg:"geo set error"},INPUT_PARAM:{code:1100001,msg:"input parm error."},TIMEOUT:{code:1100002,msg:"network timeout."},SOCKET_CLOSE:{code:1100003,msg:"socket close"},NET_SOCKET_TIMEOUT:{code:1100004,msg:"net agent timeout"},NET_HB_TIMEOUT:{code:1100005,msg:"net hb timeout"},INIT_SDK_WRONG:{code:1101e3,msg:"init sdk wrong"},ROOM_COUNT_EXCEED:{code:1002001,msg:"login rooms exceeds the upper limit"},USER_ID_NULL:{code:1002005,msg:"user ID is empty"},USER_ID_INVALID_CHARACTER:{code:1002006,msg:"user ID contains illegal characters"},USER_ID_TOO_LONG:{code:1002007,msg:"user ID is too long"},USER_NAME_NULL:{code:1002008,msg:"username is empty"},USER_NAME_TOO_LONG:{code:1002010,msg:"username is too long"},ROOM_ID_NULL:{code:1002011,msg:"room ID is empty"},ROOM_ID_INVALID_CHARACTER:{code:1002012,msg:"room ID contains illegal characters"},ROOM_ID_TOO_LONG:{code:1002013,msg:"room ID is too long"},ROOM_NOT_EXIST:{code:1002014,msg:"room not exist"},ROOM_EXTRA_INFO_KEY_LIMIT:{code:1002017,msg:"room extra info key exceed the limit"},LOGIN_TIMEOUT:{code:1002031,msg:"login timeout"},ROOM_MAX_USER_COUNT:{code:1002034,msg:"users logging into the room exceeds the maximum number"},MULTI_ROOM_UNABLE:{code:1002036,msg:"multi room unable"},MULTIPLE_LOGIN_KICKOUT:{code:1002050,msg:"kickout may be the same user ID login other"},NETWORK_RECOVERY:{code:1002051,msg:"network recovery"},ROOM_RETRY_TIMEOUT:{code:1002053,msg:"network is broken and login fail."},MANUAL_KICKOUT:{code:1002055,msg:"server has sent a signal to kick out"},REPEATEDLY_LOGIN:{code:1002056,msg:"user repeatedly login"},REPEATEDLY_ENTER_ROOM:{code:1002057,msg:"user repeatedly enter room"},ALREADY_LOGIN:{code:1002058,msg:"user already logged in"},FORBID_BLACK_USER:{code:1002066,msg:"forbid black user"},WHITE_BOARD_VERSION_ERROR:{code:1002098,msg:"Mismatch with RTC SDK version, please upgrade ZegoSuperBoard or ZegoWhiteboardView SDK to the latest version"},ROOM_INNER_ERROR:{code:1002099,msg:"room inner error"},HEARTBEAT_TIMEOUT:{code:1102001,msg:"heartbeat timeout."},PARSE_JSON_ERROR:{code:1102011,msg:"parse json error."},LOGIN_PROCESSING:{code:1102012,msg:"login is processing."},LIVEROMM_REQUEST_ERROR:{code:1102013,msg:"liveroom request error."},ZPUSH_REQUEST_FAIL:{code:1102014,msg:"zpush request fail."},LOGIN_STATE_WRONG:{code:1102015,msg:"user login state is wrong."},TOKEN_ERROR:{code:1102016,msg:"token error"},DIAPATCH_ERROR:{code:1102017,msg:"dispatch error"},TOKEN_EXPIRED:{code:1102018,msg:"token expired"},SUBCMD_ERROR:{code:1102019,msg:"subcmd error."},ZEGO_AUTH_ERROR:{code:1102020,msg:"zego auth error."},BIZ_CHANNEL_ERROR:{code:1102021,msg:"biz channel error."},UPLOAD_LOG_ERROR:{code:1102025,msg:"upload zip logs failed"}},N=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1],A=(e=n(5),n.n(e)),L=(e=n(6),n.n(e));function P(){var t=window.navigator.userAgent,e=null!=window.ActiveXObject&&-1!=t.indexOf("MSIE"),n=-1!=t.indexOf("Firefox"),r=null!=window.opr,i=t.indexOf("Chrome")&&window.chrome;return t=-1!=t.indexOf("Safari")&&-1!=t.indexOf("Version"),e?"IE":n?"Firefox":r?"Opera":i?"Chrome":t?"Safari":"Unkown"}function M(){var t=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return((null==t?void 0:t.effectiveType)||(null==t?void 0:t.type)||"unknwon").toUpperCase()}function D(t,e){return A.a.encrypt(t,e).toString()}function x(t,e){try{return A.a.decrypt(t,e).toString(L.a)}catch(t){return""}}function U(t,e){return!(t=((null==t?void 0:t.replace("webliveroom","-"))||"").split("-")||[])[1]||!/\d*/i.test(t[1])||+t[1]==e}function B(t,e){try{localStorage.setItem(t,e)}catch(t){}}function H(t){try{return localStorage.getItem(t)}catch(t){}}var z=function(){return(z=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},G=(F.checkConfigParam=function(t,e,n){return t&&"number"==typeof t&&this.checkInteger(t)?!(!e||"string"!=typeof e&&!Array.isArray(e)||""==e)||(n.error("ccp.0 server must be string or string array and not empty"),!1):(n.error("ccp.0 appid must be positive integer number and not empty"),!1)},F.checkPriConfigParam=function(t,e,n,r,i){return t&&"number"==typeof t&&this.checkInteger(t)?e&&"string"==typeof e?"object"!=typeof n||"string"!=typeof n.deviceID?(i.error("ccp.0 deviceID must be string and not empty"),!1):1===r||0===r||(i.error("ccp.0 anType must be 0 or 1"),!1):(i.error("ccp.0 dispatchServer must be string and not empty"),!1):(i.error("ccp.0 appid must be positive integer number and not empty"),!1)},F.checkIllegalCharacters=function(t){return/^([0-9a-zA-Z#!$%&()`'+-;<=.>@^_~,\\*])+$/.test(t)&&/^[^:/]*$/g.test(t)},F.registerCallback=function(t,e,n){e.success&&(n[t+"SuccessCallback"]=e.success),e.error&&(n[t+"ErrorCallback"]=e.error)},F.actionErrorCallback=function(t,e){return e[t+"ErrorCallback"]},F.actionSuccessCallback=function(t,e){return e[t+"SuccessCallback"]},F.logReportCallback=function(t,e,n,r){F.registerCallback(t,{success:function(t,r){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];F.dataReportEvent(e,n,t,r,i)}},r)},F.proxyRes=function(t,e,n,r){return{interResolve:function(r){t.uploadReport(e),n(r)},interReject:function(n,i){var o;void 0===i&&(i=""),(o=n.code<2e9&&1e9<n.code?F.decodeServerError(n.code,n.msg):{code:n.code,message:n.msg})&&t.addMsgInfo(e,{error:o.code,message:o.message+i}),t.uploadReport(e),r({errorCode:n.code||n.errorCode})}}},F.getServerError=function(t){var e,n,r={1:"parse json error.",1001:"login is processing.",1002:"liveroom request error.",1003:"zpush connect fail.",1004:"zpush handshake fail.",1005:"zpush login fail.",1006:"user login state is wrong.",1007:"got no zpush addr",1008:"token error",1009:"dispatch error",1010:"token expired",1011:"token format error",2002:"biz channel error",1e9:"liveroom cmd error, code:",1000002001:"need relogin",1000002002:"third token auth error",1000002003:"token nonce type should be int64",1000002004:"token appid type  should be uint32",1000002005:"token timeout type should be int64",1000002006:"token user_id type should be string",1000002007:"token room_id type should be string",1000002008:"token format error",1000002009:"token privilege type should be map",1000002010:"token expire_time type should be int64",1000002011:"token user_id type should be string",1000002012:"token not exist",1000002013:"token update error",1000002014:"token not need to check"};return 0===t?O.SUCCESS:((e=z({},O.ROOM_INNER_ERROR)).code=t,e.msg=1e9<t?(n=r[t])?"liveroom cmd error, code: "+t+", message: "+n:r[1e9]+t:r[t]?r[t]+" code:"+t:"unknown error code:"+t,e)},F.unregisterCallback=function(t,e){delete e[t+"SuccessCallback"],delete e[t+"ErrorCallback"]},F.decodeServerError=function(t,e){var n={code:-1,message:"server error"};return n.code=1e9<t?t-1e9+52e6:t+2002e6,e&&(n.message=e),n},F.getLiveRoomError=function(t,e){var n={1016:"MULTI_ROOM_UNABLE",1105:"ROOM_MAX_USER_COUNT",1012:"PUBLISHER_ERROR_REPETITIVE_PUBLISH_STREAM",2002:"TOKEN_ERROR",2003:"ROOM_ERROR_LOGIN_TIMEOUT",2010:"TOKEN_ERROR",5022:"ROOM_COUNT_EXCEED",5030:"FORBID_BLACK_USER"};return e?2e5<t&&t<3e5?n[t-2e5]:t<2e5?{50116:"TOKEN_ERROR",50117:"TOKEN_EXPIRED",50118:"TOKEN_ERROR",50119:"TOKEN_ERROR",50120:"TOKEN_ERROR",50121:"TOKEN_ERROR",50122:"TOKEN_ERROR",50123:"TOKEN_EXPIRED",50124:"TOKEN_ERROR",50125:"TOKEN_ERROR",50126:"TOKEN_ERROR",50127:"TOKEN_ERROR",50128:"TOKEN_ERROR"}[t]||n[t]||"ROOM_INNER_ERROR":n[t]||"ROOM_INNER_ERROR":1e9<t?n[t-1e9]||"":{1:"PARSE_JSON_ERROR",1001:"LOGIN_PROCESSING",1002:"LIVEROMM_REQUEST_ERROR",1003:"ZPUSH_REQUEST_FAIL",1004:"ZPUSH_REQUEST_FAIL",1005:"ZPUSH_REQUEST_FAIL",1006:"LOGIN_STATE_WRONG",1007:"ZPUSH_REQUEST_FAIL",1008:"TOKEN_ERROR",1009:"DIAPATCH_ERROR",1010:"TOKEN_EXPIRED",1011:"TOKEN_ERROR",1012:"SUBCMD_ERROR",1101:"ZEGO_AUTH_ERROR",2001:"BIZ_CHANNEL_ERROR",2002:"BIZ_CHANNEL_ERROR"}[t]||"ROOM_INNER_ERROR"},F.getKickoutError=function(t,e){var n={code:t,message:"kickout reason = "+t};if(e)switch(t){case 1:n.code=63000001,n.message="zpush multiple login kickout",n.name="MULTIPLE_LOGIN_KICKOUT";break;case 2:n.code=63000002,n.message="zpush manual kickout",n.name="MANUAL_KICKOUT";break;case 4:n.code=63000005,n.message="zpush token expired",n.name="TOKEN_EXPIRED";break;default:n.code=t,n.message="kickout reason = "+t}else switch(t){case 1:n.code=63000001,n.message="zpush multiple login kickout",n.name="MULTIPLE_LOGIN_KICKOUT";break;case 2:n.code=63000002,n.message="zpush manual kickout",n.name="MANUAL_KICKOUT";break;case 3:n.code=63000003,n.message="kickout reason = "+t;break;case 4:n.code=63000004,n.message="zpush multiple login kickout",n.name="MULTIPLE_LOGIN_KICKOUT";break;case 5:n.code=63000005,n.message="zpush token expired",n.name="TOKEN_EXPIRED";break;default:n.code=t,n.message="kickout reason = "+t}return n},F.dataReportEvent=function(t,e,n,r,i){switch(n){case"eventStart":t.eventStart(e,r);break;case"eventEndWithMsgInfo":t.eventEndWithMsgInfo(e,r,i[0]);break;case"addEventMsg":t.addEventMsg(e,r,i[0],i[1]);break;case"addEvent":t.addEvent(e,r);break;case"eventEnd":t.eventEnd(e,r);break;case"addMsgInfo":t.addMsgInfo(e,i[0])}},F.mergeUserList=function(t,e,n,r){t.debug("msl.0 call");var i=[],o=[];n=n||[];for(var s=0;s<n.length;s++){for(var a=!1,u=0;u<e.length;u++)if(n[s].userID===e[u].userID){a=!0;break}a||i.push(n[s])}for(var c=0;c<e.length;c++){a=!1;for(var l=0;l<n.length;l++)if(e[c].userID===n[l].userID){a=!0;break}a||o.push(e[c])}for(e.splice(0),s=0;s<n.length;s++)e.push(e[s]);r(i,o),t.debug("msl.0 call success")},F.checkInteger=function(t,e){return 0==e?"number"==typeof t&&t%1==0&&0<=t:"number"==typeof t&&t%1==0&&0<t},F.checkValidNumber=function(t,e,n){return e=e||1,n=n||1e4,"number"==typeof t&&t%1==0&&e<=t&&t<=n},F.generateRandumNumber=function(t){return parseInt(Math.random()*(t+1)+"",10)},F.uuid=function(t,e){var n,r,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),o=[];if(e=e||i.length,t)for(n=0;n<t;n++)o[n]=i[0|Math.random()*e];else for(o[8]=o[13]=o[18]=o[23]="-",o[14]="4",n=0;n<36;n++)o[n]||(r=0|16*Math.random(),o[n]=i[19==n?3&r|8:r]);return o.join("")},F.isTestEnv=function(t){return!(!t.startsWith("wss")||-1===t.indexOf("test")||!t.endsWith("ws"))},F.getUint64=function(t,e,n){var r=n.getUint32(t,e);return n=n.getUint32(t+4,e),t=e?r+Math.pow(2,32)*n:Math.pow(2,32)*r+n,Number.isSafeInteger(t)||console.warn(t,"exceeds MAX_SAFE_INTEGER. Precision may be lost"),t},F.decodeTokenExpire=function(t){try{var e,n=Uint8Array.from(function(t){for(var e,n,r,i,o=t.length,s=0,a="";s<o;){for(;e=N[255&t.charCodeAt(s++)],s<o&&-1==e;);if(-1==e)break;for(;n=N[255&t.charCodeAt(s++)],s<o&&-1==n;);if(-1==n)break;a+=String.fromCharCode(e<<2|(48&n)>>4);do{if(61==(r=255&t.charCodeAt(s++)))return a}while(r=N[r],s<o&&-1==r);if(-1==r)break;a+=String.fromCharCode((15&n)<<4|(60&r)>>2);do{if(61==(i=255&t.charCodeAt(s++)))return a}while(i=N[i],s<o&&-1==i);if(-1==i)break;a+=String.fromCharCode((3&r)<<6|i)}return a}(t),(function(t){return t.charCodeAt(0)})),r=new DataView(n.buffer);return 0<(e="function"==typeof r.getBigInt64?r.getBigUint64(0):F.getUint64(0,!1,r))?Number(e):Number(r.getBigUint64(0,!0))}catch(t){console.error("token error")}return-1},F.bin2hex=function(t){for(var e,n="",r=0,i=(t+="").length;r<i;r++)n+=(e=t.charCodeAt(r).toString(16)).length<2?"0"+e:e;return n},F.getCanvasFingerprint=function(t){var e=document.createElement("canvas"),n=((n=e.getContext("2d")).textBaseline="top",n.font="14px 'Arial'",n.fillStyle="#f60",n.fillRect(125,1,62,20),n.fillStyle="#069",n.fillText(t,2,15),n.fillStyle="rgba(102, 204, 0, 0.7)",n.fillText(t,4,17),e.toDataURL().replace("data:image/png;base64,",""));return t=atob(n),this.bin2hex(t.slice(-16,-12))},F.generateUUID=function(t){void 0===t&&(t=0);var e,n=H("z_deviceID");return n||(e=(new Date).getTime(),n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(36)})),B("z_deviceID",n=0===t?this.getCanvasFingerprint("hello, zego")+n.slice(8):n),n)},F.getNetTypeNum=function(){var t=c.NT_UNKNOWN,e="",n=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return-1<(e=((null==n?void 0:n.effectiveType)||(null==n?void 0:n.type)||"unknwon").toUpperCase()).indexOf("4G")?t=c.NT_4G:-1<e.indexOf("2G")?t=c.NT_2G:-1<e.indexOf("3G")?t=c.NT_3G:-1<e.indexOf("WIFI")?t=c.NT_WIFI:-1<e.indexOf("LINE")?t=c.NT_LINE:-1<e.indexOf("NONE")&&(t=c.NT_NONE),t},F);function F(){}var q={product:"rtc_web",importLevel:a.H,levels:[0,10,100,1e3],bps:32e3},j="init",V="0c9e6e0f8c0a8f4e",W="z_net_access_servers",Y="z_appconfig",Z="z_appconfig_etag",K={domains:["accesshub-wss.zego.im","accesshub-wss.coolzcloud.com","accesshub-wss.zegocloud.com"],primaryDomains:["zego.im","coolzcloud.com","zegocloud.com"],mode:"online",modeNo:S.MODE_ONLINE,sdkType:3,connectVer:4,pcEstablishTimeout:15,scheme:"wss",location:"accesshub",wssMessageType:1},$=[{id:2,relative_geofencings:[],accesshub:"accesshub-wss-geo-2.zego.im",logreport:"weblogger-wss-geo-2.zego.im",detaillog:"detaillog-geo-2.zego.im"},{id:3,relative_geofencings:[7],accesshub:"accesshub-wss-geo-3.zego.im",logreport:"weblogger-wss-geo-3.zego.im",detaillog:"detaillog-geo-3.zego.im"},{id:4,relative_geofencings:[7],accesshub:"accesshub-wss-geo-4.zego.im",logreport:"weblogger-wss-geo-4.zego.im",detaillog:"detaillog-geo-4.zego.im"},{id:5,relative_geofencings:[7],accesshub:"accesshub-wss-geo-5.zego.im",logreport:"weblogger-wss-geo-5.zego.im",detaillog:"detaillog-geo-5.zego.im"},{id:6,relative_geofencings:[7],accesshub:"accesshub-wss-geo-6.zego.im",logreport:"weblogger-wss-geo-6.zego.im",detaillog:"detaillog-geo-6.zego.im"},{id:7,relative_geofencings:[3,4,5,6,1],accesshub:"accesshub-wss-geo-7.zego.im",logreport:"weblogger-wss-geo-7.zego.im",detaillog:"detaillog-geo-7.zego.im"}],Q=[2,3,4,5,6];function X(t,e){this.logger=t,this.stateCenter=e,this.RETRY_MAX_TIME=300,this.RETRY_START_TIME_INTERVAL=4,this.RETRY_CONTINUE_COUNT=2,this.RETRY_MAX_TIME_INTERVAL=32,this.retryTimer=null,this.maxTimer=null,this.retryStartTime=0,this.retryActiveCount=1,this.isOverTime=!1}function J(t){return t}function tt(t){return t}function et(t){return t}function nt(t){return t}X.prototype.init=function(t,e,n,r){this.invalid(),this.stopMaxTime(),this.isOverTime=!1,"number"==typeof t&&t<3600&&(this.RETRY_MAX_TIME=t),"number"==typeof e&&(this.RETRY_START_TIME_INTERVAL=e),"number"==typeof n&&(this.RETRY_CONTINUE_COUNT=n),"number"==typeof r&&(this.RETRY_MAX_TIME_INTERVAL=r)},X.prototype.invalid=function(){this.logger.info("zm.rh.ivd end retry"),this.retryTimer&&clearTimeout(this.retryTimer),this.retryTimer=null,this.retryStartTime=0,this.retryActiveCount=1};var rt="zm.0",it="zm.wl",ot="zm.slf",st="zm.lg",at="zm.lo",ut="zm.fac",ct="zm.fac.tk",lt="zm.hlu",ht="zm.cna",ft="zm.gsac",dt="zm.zpl.url",pt="zm.on",gt="zm.rntk",_t="zm.rm.lg",mt="zm.rm.tl",vt="zm.rm.lgr",yt="zm.rm.clh",bt="zm.rm.lo",St="zm.rm.dcn",Et="zm.rm.kco",Tt="zm.hhl",Ct="zm.hb.st",wt="zm.hb.rsp",Rt="zm.sv.ps",It="zm.us.urp",kt="zm.us.uph",Ot="ON_LISTENER",Nt="zm.st.ofls",At="zm.lrh.sm",Lt="zm.lrh.hsp",Pt="zm.lrh.lgi",Mt="zm.lrh.ful",Dt="zm.lrh.lgo",xt="zm.lrh.sru",Ut="zm.lrh.hd",Bt={event:"/sdk/init",error:{kInvalidParamError:O.INPUT_PARAM},system_info:tt,servers:function(t){return t},is_from_cache:nt,project:tt,liveroom_version:tt,biz_type:et,lua_md5:tt,sev_env:tt,use_na:et},Ht="listener",zt="/sdk/set_debug",Gt=tt,Ft={event:"/sdk/set_log_config",error:{kInvalidParamError:O.INPUT_PARAM},log_level:function(t){return t},remote_log_level:tt,log_url:tt},qt={event:"/sdk/on_listener",listener:tt,error:{INPUT_PARAM:O.INPUT_PARAM}},jt=tt,Vt={event:"/sdk/login",room_id:tt,room_sid_string:tt,user_state_update:et,max_member_cnt:et,message:tt,token:tt,svr_env:tt,server:tt,try_cnt:et,room_mode:et,role:et,audience_create_room:et,liveroom_sid_string:tt,error:{ROOM_ID_NULL:O.ROOM_ID_NULL,INPUT_PARAM:O.INPUT_PARAM,ROOM_ID_TOO_LONG:O.ROOM_ID_TOO_LONG,ROOM_ID_INVALID_CHARACTER:O.ROOM_ID_INVALID_CHARACTER,USER_ID_NULL:O.USER_ID_NULL,USER_ID_TOO_LONG:O.USER_ID_TOO_LONG,USER_ID_INVALID_CHARACTER:O.USER_ID_INVALID_CHARACTER,USER_NAME_NULL:O.USER_NAME_NULL,USER_NAME_TOO_LONG:O.USER_NAME_TOO_LONG,REPEATEDLY_LOGIN:O.REPEATEDLY_LOGIN,LOGIN_TIMEOUT:O.LOGIN_TIMEOUT,INNER_ERROR:O.ROOM_INNER_ERROR,NETWORK_BROKEN:O.NETWORK_BROKEN}},Wt="/sdk/sublogin",Yt=tt,Zt={event:"/zpush/login",sdk_zpush_sessionid_string:tt},Kt={event:"/liveroom/enter"},$t={event:"/sdk/renew_token",error:{INPUT_PARAM:O.INPUT_PARAM,NOT_LOGIN:O.NOT_LOGIN},token:tt},Qt={event:"/sdk/logout",error:{INPUT_PARAM:O.INPUT_PARAM,ROOM_NOT_EXIST:O.ROOM_NOT_EXIST},room_id:tt,room_sid_string:tt,is_multi:nt,is_send_cmd_net:nt,liveroom_sid_string:tt},Xt="/liveroom/quit",Jt=tt,te=tt,ee="/sdk/relogin",ne={event:"/liveroom/tempbroken"},re={event:"/sdk/reconnect",room_broken_time:et},ie={event:"/sdk/disconnect"},oe=et,se=et,ae={event:"/liveroom/hb",room_id:tt,room_sid_string:tt,interval:et,stream_seq:et,server_user_seq:et,error:{NOT_LOGIN:O.NOT_LOGIN,HB_TIMEOUT:O.TIMEOUT}},ue={event:"/liveroom/recv_user_update_info",user_list_seq:et,update_user:J,error:{ROOM_NOT_EXIST:O.ROOM_NOT_EXIST}},ce={event:"/sdk/enable_multi_room",is_multi:nt,error:{kInvalidParamError:O.INPUT_PARAM,kAlreadyLoginError:O.ALREADY_LOGIN}},le=J,he=J,fe=J,de="/cloud_setting/request",pe=J,ge=J,_e={event:"/liveroom/get_current_user_list",user_index:et,is_time_ascend:nt,use_na:et},me="/zegoconn/connect",ve=tt,ye=et,be=J,Se=tt,Ee=tt,Te=et,Ce="/zegoconn/request",we=J,Re=J,Ie=et,ke={event:"/zegoconn/proxy_connect",service_no:et,proxy_link_sources:et,recv_time:et,connect_stream:et},Oe={event:"/zegoconn/proxy_broken",service_no:et},Ne={event:"/zegoconn/proxy_disconnect",service_no:et};Ae=function(t,e){return(Ae=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Ae(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(De,Le=X),De.prototype.renewLocalToken=function(t,e){this.token=t,this.room.token=this.token;var n=(new Date).getTime(),r=void 0;e&&"number"==typeof e?r=1e3*e:"string"==typeof t&&["03","04"].includes(t.substring(0,2))&&(e=1e3*G.decodeTokenExpire(t.substring(2)),this.logger.info("zm.rm.rlt time "+e+" "+n+" "+this.stateCenter.local_time_deviation),r=e-(n-this.stateCenter.local_time_deviation)),r&&this.roomHandler.resetTokenTimer(r),this.logger.setTokenInfo(t),this.stateCenter.actionListener("_tokenRenewed",t,this.room.roomID)},De.prototype.initRoom=function(t,e,n,r,i,o,s){this.roomHandler=t,this.roomID=e,this.renewLocalToken(n),this.user=r,this.server=i,this.serverBak=o||i,this.config=s},De.prototype.active=function(t){var e=this,n=(this.logger.info(_t+" retry call "+(null==(n=this.room)?void 0:n.roomID)+" "+(t=void 0!==t&&t)),null!=(n=this.loginRoomCallback)&&n.success?Wt:ee);if(this.subLoginSpan||(this.subLoginSpan=this.stateCenter.reporter.createSpan(a.H,{key:Vt.event,par:this.roomID},{key:n,par:this.roomID},n,!0),this.spanKey=n),this.roomHandler.setRunState(s.trylogin),this.room.isMulti&&(null==(n=this.stateCenter.roomModulesList.find((function(t){return!t.isMulti})))?void 0:n.runState)!==s.login)this.logger.info(_t+" service is disconnected, multi room stop retry");else if(this.retryTimer)this.logger.info(_t+" has actived, ignore");else{var r=this.stateCenter.networkState==u.offline;if(r){if(this.logger.info(_t+" check if really offline. "+this.retryNetCount),this.retryNetCount>=this.retryNetMaxTimes)return void this.logger.warn(_t+" network is broken, stop retry")}else this.retryNetCount=0;this.isOverTime?this.logger.info(_t+" retry over time, stop retry"):(1==this.retryActiveCount?this.retryActiveInterval=Math.floor(Math.random()*(1-this.RETRY_START_TIME_INTERVAL)+this.RETRY_START_TIME_INTERVAL):(n=Math.pow(2,Math.round(this.retryActiveCount/this.RETRY_CONTINUE_COUNT+1)),this.retryActiveInterval=n>this.RETRY_MAX_TIME_INTERVAL?this.RETRY_MAX_TIME_INTERVAL:n),this.logger.info(_t+" interval "+this.retryActiveInterval),this.retryTimer=setTimeout((function(){e.roomHandler.login(e.retryActiveCount%2==1?e.server:e.serverBak,e.roomID,e.token,e.user,e.config,(function(t){e.stateCenter.networkState=u.online,e.handleLoginFinish(t)}),(function(t,n){e.handleLoginFinish(!1,t,n)})),e.retryTimer&&clearTimeout(e.retryTimer),e.retryTimer=null,r?e.retryNetCount++:e.retryActiveCount++}),t?0:1e3*this.retryActiveInterval))}},De.prototype.startMaxTime=function(){var t=this;this.maxTimer||(this.logger.info(_t+" start max timer"),this.maxTimer=setTimeout((function(){t.logger.info(_t+" over max time ".concat(t.RETRY_MAX_TIME,"s, stop retry")),t.isOverTime=!0,t.roomHandler.resetRoom(),t.stopMaxTime(),t.invalid(),t.onactive(!1,O.LOGIN_TIMEOUT),t.subLoginSpan&&(t.stateCenter.reporter.spanEnd({key:t.spanKey,par:t.roomID},{error:O.LOGIN_TIMEOUT.code,message:O.LOGIN_TIMEOUT.msg}),t.subLoginSpan=null),t.loginRoomCallback.fail&&(t.loginRoomCallback.fail(O.LOGIN_TIMEOUT),t.roomHandler.disconnectedHandle(O.LOGIN_TIMEOUT),t.resetCallBack())}),1e3*this.RETRY_MAX_TIME))},De.prototype.stopMaxTime=function(){this.logger.info(_t+" stop max timer"),this.maxTimer&&clearTimeout(this.maxTimer),this.maxTimer=null},De.prototype.onactive=function(t,e){},De.prototype.handleError=function(t,e){if(this.RETRY_MAX_TIME<3)return!1;if(e){e=void 0;var n=void 0,r=void 0,i=(this.stateCenter.useNetAgent?(e=["202002","205030","205035","50116","50117","50118","50119","50120","50121","50122","50123","50124","50125","50126","50127","50128"],n=["40001","40100"],r=["201002","30019"]):(e=["1000002002","1000005030","1000005035","1010","1011","1013","1014","1015","1016","1017","1018","1019","1020","1021","1023"],n=["1100040001","1100040100"]),t.code+"");if(this.stateCenter.useNetAgent){if(10015===t.code)return this.room.retryConnect(),!0;if(40001<=t.code&&t.code<=40100||50200<=t.code&&t.code<=50299||null!=r&&r.includes(i))return this.room.resetSessionInfo(),!0}return!(null!=e&&e.includes(i)||(null==n||!n.includes(i))&&(this.room.lastRunState!=s.login||(this.logger.warn("zm.rrh.he reset"),this.room.resetUserSession(),this.invalid(),0)))}return!0},De.prototype.setLoginRoomCallback=function(t,e){this.loginRoomCallback.success=t,this.loginRoomCallback.fail=e},De.prototype.loginFail=function(t){this.roomHandler.resetRoom(),this.stopMaxTime(),this.invalid(),this.onactive(!1,t),this.loginRoomCallback.fail&&(this.loginRoomCallback.fail(t),this.roomHandler.disconnectedHandle(t),this.resetCallBack())},De.prototype.handleLoginFinish=function(t,e,n){this.logger.info("zm.rrh.hlf "+t+" "+JSON.stringify(e)),e?(this.subLoginSpan&&(this.stateCenter.reporter.spanEnd({key:this.spanKey,par:this.roomID},{error:e.code,message:e.msg}),this.subLoginSpan=null),this.handleError(e,n)?(this.maxTimer||this.startMaxTime(),this.active()):(this.roomHandler.resetRoom(),this.stopMaxTime(),this.invalid(),this.onactive(t,e),this.loginRoomCallback.fail&&(this.loginRoomCallback.fail(e),this.roomHandler.disconnectedHandle(e),this.resetCallBack()))):(this.stopMaxTime(),this.invalid(),this.onactive(t,{code:0,msg:""}),this.subLoginSpan&&(this.stateCenter.reporter.spanEnd({key:this.spanKey,par:this.roomID},{room_id:this.roomID,room_sid_string:null==(n=this.room)?void 0:n.roomSidString}),this.subLoginSpan=null),this.loginRoomCallback.success&&(this.loginRoomCallback.success(t),this.resetCallBack()))},De.prototype.invalid=function(){this.logger.info("zm.rh.ivd end retry"),this.retryTimer&&clearTimeout(this.retryTimer),this.retryTimer=null,this.retryActiveCount=1,this.retryNetCount=0},De.prototype.resetCallBack=function(){this.loginRoomCallback.success=void 0,this.loginRoomCallback.fail=void 0};var Ae,Le,Pe,Me=De;function De(t,e,n){var r=Le.call(this,t,e)||this;return r.logger=t,r.stateCenter=e,r.room=n,r.retryNetCount=0,r.retryNetMaxTimes=3,r.spanKey="",r.loginRoomCallback={},r}(e=Pe=Pe||{}).NOT_EMPTY="NOT_EMPTY",e.ILLEGAL_CHARACTERS="ILLEGAL_CHARACTERS",e.TYPE_STRING="TYPE_STRING",e.TYPE_INTEGER="TYPE_INTEGER",e.TYPE_OBJECT="TYPE_OBJECT",e.MAX_LENGTH_10="MAX_LENGTH_10",e.MAX_LENGTH_64="MAX_LENGTH_64",e.MAX_LENGTH_100="MAX_LENGTH_100",e.MAX_LENGTH_128="MAX_LENGTH_128",e.MAX_LENGTH_256="MAX_LENGTH_256",e.MAX_LENGTH_1024="MAX_LENGTH_1024";var xe={error:{code:0,msg:"suc"}},Ue={NOT_EMPTY:function(t,e,n,r,i){return void 0===e||""===e||null===e?(r.error("".concat(n," ").concat(t," is empty")),i):xe},ILLEGAL_CHARACTERS:function(t,e,n,r,i){return G.checkIllegalCharacters(e)?xe:(r.error("".concat(n," ").concat(t," contains illegal characters")),i)},TYPE_STRING:function(t,e,n,r,i){return"string"!=typeof e?(r.error("".concat(n," ").concat(t," must be string")),i):xe},TYPE_INTEGER:function(t,e,n,r,i){return G.checkInteger(e,!1)?xe:(r.error("".concat(n," ").concat(t,"  must be integer number")),i)},TYPE_OBJECT:function(t,e,n,r,i){return e&&"object"==typeof e?xe:(r.error("".concat(n," ").concat(t,"  must be object")),i)},MAX_LENGTH_10:function(t,e,n,r,i){return 10<e.length?(r.error("".concat(n," ").concat(t," is too long")),i):xe},MAX_LENGTH_64:function(t,e,n,r,i){return 64<e.length?(r.error("".concat(n," ").concat(t," is too long")),i):xe},MAX_LENGTH_100:function(t,e,n,r,i){return 100<e.length?(r.error("".concat(n," ").concat(t," is too long")),i):xe},MAX_LENGTH_128:function(t,e,n,r,i){return 128<e.length?(r.error("".concat(n," ").concat(t," is too long")),i):xe},MAX_LENGTH_256:function(t,e,n,r,i){return 256<e.length?(r.error("".concat(n," ").concat(t," is too long")),i):xe},MAX_LENGTH_1024:function(t,e,n,r,i){return 1024<e.length?(r.error("".concat(n," ").concat(t," is too long")),i):xe}};Object.defineProperty(He.prototype,"debug",{get:function(){return this._debug},set:function(t){this._debug=t,i.LoggerStateCenter.getInstance().debug=t},enumerable:!1,configurable:!0}),Object.defineProperty(He.prototype,"testEnvironment",{get:function(){return this._testEnvironment},set:function(t){this._testEnvironment=t,i.LoggerStateCenter.getInstance().testEnvironment=t},enumerable:!1,configurable:!0}),Object.defineProperty(He.prototype,"ENV",{get:function(){return this._env},set:function(t){this._env=t,i.LoggerStateCenter.getInstance().ENV=t},enumerable:!1,configurable:!0}),Object.defineProperty(He.prototype,"roomid",{get:function(){return this.roomModulesList[0]?this.roomModulesList[0].roomID:""},enumerable:!1,configurable:!0}),Object.defineProperty(He.prototype,"serverTimeOffset",{get:function(){return this.roomModulesList[0]?this.roomModulesList[0].messageHandler.serverTimeOffset:0},enumerable:!1,configurable:!0}),He.prototype.getRequestId=function(){return this.idName+"-"+d()},He.prototype.actionListener=function(t){for(var e,n=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];["getAnchorInfo","HBResponse","roomOnlineUserCountUpdate","roomLoginResponse"].includes(t)||t.startsWith("_")||!this.listenerList[t]||((e=this.reporter.createSpan(a.H,{key:Ht},{key:""},"/sdk/listener")).setAttributes({listener:t,listener_params:JSON.stringify(r)}),e.end()),["roomStateChanged","tokenWillExpire"].includes(t)&&this.logger.info("zm.al ".concat(t," ").concat(JSON.stringify(r))),this.listenerList[t]&&this.listenerList[t].forEach((function(e){try{e.apply(void 0,r)}catch(e){n.logger.error("zm.st.at ",t," ",JSON.stringify(e))}}))},He.prototype.onListener=function(t,e){return this.listenerList[t]?"function"!=typeof e?(this.logger.error(Ot+" listener callBack must be funciton"),!1):(-1==this.listenerList[t].indexOf(e)&&this.listenerList[t].push(e),!0):(this.logger.error(Ot+" event "+t+" no found"),!1)},He.prototype.offListener=function(t,e){return this.listenerList[t]?"function"!=typeof e?(this.logger.error(Nt+" listener callBack must be funciton"),!1):(-1!==this.listenerList[t].indexOf(e)&&(this.listenerList[t]=this.listenerList[t].filter((function(t){return t!==e}))),!0):(this.logger.error(Nt+" event "+t+" no found"),!1)},Object.defineProperty(He.prototype,"sdKVersion",{get:function(){return this._sdkVersion},set:function(t){this._sdkVersion=t},enumerable:!1,configurable:!0}),He.prototype.proxyRes=function(t,e,n){return{interResolve:function(n){e(n),t.end()},interReject:function(e,r){var i;void 0===r&&(r=""),(i=e.code<2e9&&1e9<e.code?G.decodeServerError(e.code,e.msg):{code:e.code,message:e.msg})&&t.setAttributes({error:i.code,message:i.message+r}),t.end(),n({errorCode:e.code})}}};var Be=He;function He(t,e){this.logger=t,this.dataReport=e,this._debug=!1,this.appConfigEtag=-1,this.appConfigFetched=!1,this.requestList={},this.mode=S.MODE_ONLINE,this.connectState="connected",this.testNetPackageSize=!1,this.netGeoFencing={},this._testEnvironment=!1,this._env=0,this.type="PUBLIC",this.debugCustom=!1,this.configOK=!1,this.role=2,this.relateService=[],this.maxMemberCount=0,this.roomCreateFlag=1,this.local_time_deviation=0,this.callbackList={},this.listenerList={roomUserUpdate:[],roomOnlineUserCountUpdate:[],getAnchorInfo:[],_getAnchorInfo:[],IMRecvCustomCommand:[],IMRecvBroadcastMessage:[],recvReliableMessage:[],roomExtraInfoUpdate:[],IMRecvBarrageMessage:[],recvJoinLiveRequest:[],recvInviteJoinLiveRequest:[],recvEndJoinLiveCommand:[],roomLoginResponse:[],_roomLogin:[],_appConfigRsp:[],_netAppConfigRsp:[],_connectChanged:[],HBResponse:[],roomStateUpdate:[],_roomStateUpdate:[],_getTotalUserList:[],_userStateUpdate:[],_recvBigRoomMessage:[],_recvRoomMsg:[],_kickout:[],tokenWillExpire:[],_tokenExpired:[],roomStateChanged:[],hallStateUpdate:[],_hallStateUpdate:[],roomTokenWillExpire:[],_tokenRenewed:[],_protobufResponse:[],_cloudSettingNotify:[],_settingCanFetch:[]},this.reportList={},this.reportSeqList={login:0,relogin:0},this.networkState=u.online,this.roomRetryTime=300,this.roomModulesList=[],this.isMultiRoom=!1,this.setMultiRoom=!1,this.protoFormat="json",this.settingFetched=!1,this.useNetAgent=!0,this.netHasSet=!1,this.configRoomAuth=!1,this.configCheckToken=!1,this._sdkVersion="unknown",this.mode=K.modeNo}Ge.prototype.init=function(t){var e=this,n=t.body.hearbeat_interval<3e3?3e3:t.body.hearbeat_interval;this.tryHeartbeatCount=0,this.heartbeatTimer&&clearTimeout(this.heartbeatTimer),this.loginHeartbeatTimer=setTimeout((function(){e.start(n)}),n),this.initCount++},Ge.prototype.start=function(t){var e,n,r=this,i=(this.logger.info(Ct+" call"),this.stateCenter.reporter.createSpan(a.H,{key:Vt.event,par:this.room.roomID},{key:""},ae.event));this.room.isLogin()?3<++this.tryHeartbeatCount?(this.logger.error(Ct+" come to try limit"),this.stateCenter.reporter.setError(i,ae.error.HB_TIMEOUT),this.hbLogout(O.HEARTBEAT_TIMEOUT),this.stateCenter.reporter.createSpan(a.H,{key:Vt.event,par:this.room.roomID},{key:""},"/zpush/hb_timeout").end()):(e=function(t,e){var n=t.body&&t.body.err_code;t.header&&t.body?0!==n&&(n=G.decodeServerError(t.body.err_code||t.body.code,t.body.err_message||t.body.message),i.setAttributes({error:n.code,message:n.message+t.body.err_code})):i.setAttributes({error:(0<t.code?t:O.ROOM_INNER_ERROR).code,message:t.msg||O.ROOM_INNER_ERROR}),r.handleHeartbeatRsp(t,e),0===(null==(n=null==t?void 0:t.body)?void 0:n.err_code)&&i.setAttributes({interval:ae.interval(null==(e=null==t?void 0:t.body)?void 0:e.hearbeat_interval),stream_seq:ae.stream_seq(null==(n=null==t?void 0:t.body)?void 0:n.stream_seq),server_user_seq:ae.server_user_seq(null==(e=null==t?void 0:t.body)?void 0:e.server_user_seq)}),i.end()},null!=(n=this.stateCenter.useNetAgent?this.liveRoomHandler:this.service)&&n.heartBeat(e,e,this.room),this.heartbeatInterval=t,n=this.heartbeatInterval,2<=this.initCount?(n=Math.round(Math.random()*(this.heartbeatInterval+1)),this.initCount=1):n=this.heartbeatInterval,this.heartbeatTimer=setTimeout((function(){r.start(r.heartbeatInterval)}),n),this.logger.info(Ct+" call success")):(this.logger.error(Ct+" state error"),this.stateCenter.reporter.setError(i,ae.error.NOT_LOGIN))},Ge.prototype.handleHeartbeatRsp=function(t,e){if(t.body&&t.body.err_code&&0!==t.body.err_code)return this.logger.error(wt+" disconnect, server error=",t.body.err_code),1000000152==t.body.err_code?void this.hbLogout(O.HEARTBEAT_TIMEOUT):void this.hbLogout(G.getServerError(t.body.err_code));t.header&&t.body?((this.tryHeartbeatCount=0)!==t.body.hearbeat_interval&&(this.heartbeatInterval=t.body.hearbeat_interval,this.heartbeatInterval<3e3)&&(this.heartbeatInterval=3e3),this.heartbeatRspNotiFy(t,this.room.roomID),this.logger.info(wt+" call success")):(this.logger.error(wt+" disconnect, error=",JSON.stringify(t)+", seq = "+e),this.hbLogout(t))},Ge.prototype.heartbeatRspNotiFy=function(t,e){},Ge.prototype.hbLogout=function(t){},Ge.prototype.resetHeartbeat=function(){clearTimeout(this.heartbeatTimer),this.heartbeatTimer=null,clearTimeout(this.loginHeartbeatTimer),this.loginHeartbeatTimer=null,this.tryHeartbeatCount=0,this.initCount=0,this.logger.info("zm.hb.rst call success")};var ze=Ge;function Ge(t,e,n,r,i,o){this.logger=t,this.stateCenter=e,this.dataReport=n,this.liveRoomHandler=r,this.room=i,this.service=o,this.tryHeartbeatCount=0,this.heartbeatTimer=null,this.loginHeartbeatTimer=null,this.initCount=0}Object.defineProperty(qe.prototype,"isUseNetAgent",{get:function(){return this.stateCenter.useNetAgent},enumerable:!1,configurable:!0}),qe.prototype.resetTokenTimer=function(t){var e=this;this.logger.info("zm.rm.rst  call: "+(t=2147483647<(t=(t-=3e4)<0?0:t)?2147483647:t)),this.tokenTimer&&clearTimeout(this.tokenTimer),this.tokenTimer=setTimeout((function(){e.stateCenter.actionListener("tokenWillExpire",e.room.roomID),e.stateCenter.actionListener("roomTokenWillExpire",e.room.roomID)}),t)},qe.prototype.stopTokenTimer=function(){this.tokenTimer&&clearTimeout(this.tokenTimer),this.tokenTimer=null},qe.prototype.setRunState=function(t){this.room.runState!==t&&(this.room.lastRunState=this.room.runState,this.room.runState=t)},qe.prototype.resetTryLogin=function(){this.tryLoginTimer&&clearTimeout(this.tryLoginTimer),this.tryLoginTimer=null},qe.prototype.reportLogoutSpan=function(t){var e,n=this.stateCenter.isMultiRoom?Xt:"/switch/logout_user";n=this.stateCenter.reporter.createSpan(a.H,{key:Qt.event,par:this.room.roomID},{key:""},n),t&&this.isUseNetAgent&&"0"===this.liveRoomHandler.roomServicer.zPushSid&&(this.liveRoomHandler.roomServicer.zPushSid=null==(e=null==(e=null==(e=this.liveRoomHandler)?void 0:e.roomServicer)?void 0:e.switchSessionID)?void 0:e.toString()),t=this.isUseNetAgent?t?null==(t=null==(e=this.liveRoomHandler)?void 0:e.roomServicer)?void 0:t.zPushSid:null==(e=null==(t=null==(e=this.liveRoomHandler)?void 0:e.roomServicer)?void 0:t.switchSessionID)?void 0:e.toString():void 0,n.setAttributes({room_id:Qt.room_id(null==(e=this.room)?void 0:e.roomID),room_sid_string:Qt.room_sid_string(null==(e=this.room)?void 0:e.roomSidString),liveroom_sid_string:Jt(null==(e=this.room)?void 0:e.userSidString),sdk_zpush_sessionid_string:te(t)}),n.end()},qe.prototype.resetRoom=function(t){var e,n,r=this;this.logger.info("zm.rm.rr call"),1<this.stateCenter.roomModulesList.length&&!t&&(this.room.isMulti=!0),this.resetTryLogin(),this.room.sessionExist&&this.room.runState!==s.logout&&!this.room.isDisConnect()&&(e=function(t){r.handleLogoutRsp(t,!r.room.isMulti)},n=this.isUseNetAgent?this.liveRoomHandler:this.service)&&n.logout(this.room,e,e),this.reportLogoutSpan(t),this.setRunState(s.logout),this.room.resetRoomSession(),this.room.resetUserSession(),this.room.isMulti||(this.stateCenter.userid="",this.logger.setSessionInfo(this.stateCenter.appid,this.room.roomID,this.room.userSidString,this.stateCenter.idName,this.stateCenter.nickName,this.stateCenter.sdKVersion),this.isUseNetAgent?null!=(n=this.liveRoomHandler)&&n.reset():null!=(e=this.service)&&e.closeSocket()),this.resetRoomCallBack(),this.stateCenter.roomModulesList=this.stateCenter.roomModulesList.filter((function(t){return t!==r.room})),(t=this.stateCenter.roomModulesList[0])&&(t.isMulti=!1,t.runState!==s.login)&&t.roomTryHandler&&(t.roomTryHandler.startMaxTime(),t.roomTryHandler.active()),this.stateCenter.isMultiRoom&&0===this.stateCenter.roomModulesList.length&&(this.stateCenter.reporter.createSpan(a.H,{key:Qt.event,par:this.room.roomID},{key:""},"/zpush/multi_logout_user").end(),this.liveRoomHandler.roomServicer.zPushSid="0"),this.logger.info("zm.rm.rr call success")},qe.prototype.resetRoomCallBack=function(){},qe.prototype.loginSuccessCallBack=function(t,e){},qe.prototype.handlePushKickout=function(t,e,n){var r=this,i=(this.logger.info(Et+"  call "+JSON.stringify(t)),G.getKickoutError(t.body.reason||(null==(i=t.body)?void 0:i.kickout_reason),this.isUseNetAgent)),o=this.stateCenter.reporter.createSpan(a.H,{key:Vt.event,par:this.room.roomID},{key:""},"/sdk/kickout"),u=(o.setAttributes({error:null==(u=O[i.name||"ROOM_INNER_ERROR"])?void 0:u.code,message:i.message,kickout_reason:oe((null==(u=t.body)?void 0:u.reason)||(null==(u=t.body)?void 0:u.kickout_reason)),need_relogin:se(null==(u=null==t?void 0:t.body)?void 0:u.need_relogin)}),o.end(),this.room.roomTryHandler);u?(u.onactive=function(t,e){r.logger.info(Et+" onactive"),r.disconnectedHandle(e),r.stateCenter.actionListener("_kickout",e)},t.body.need_relogin&&1==t.body.need_relogin?(this.room.resetUserSession(),u.startMaxTime(),u.active()):(this.setRunState(s.logout),this.resetRoom(e),o={},t&&t.body.custom_reason?o.custom_kickout_message=t.body.custom_reason:i.name&&O[i.name]&&(o.custom_kickout_message=O[i.name].msg+"; kickout reason: "+(u=t.body.reason||t.body.kickout_reason)),this.disconnectedHandle(i.name&&O[i.name]?O[i.name]:O.ROOM_INNER_ERROR,{extendedData:JSON.stringify(o),isKickout:!0}),this.stateCenter.actionListener("_kickout",{code:O.MANUAL_KICKOUT.code,msg:O.MANUAL_KICKOUT.msg+t.body.reason||t.body.kickout_reason}))):this.logger.info(Et+" try handler no found")},qe.prototype.handleHbLogout=function(t){var e=this,n=this.room.roomTryHandler;n&&(n.onactive=function(t,n){e.logger.warn(Tt+" onactive"),e.transError(n),e.disconnectedHandle(n)},[O.HEARTBEAT_TIMEOUT,O.SOCKET_CLOSE].includes(t)||[105,152,2001].includes(null==t?void 0:t.code)||t.msg.endsWith("1000002001")||t.msg.endsWith("1000000152")||t.msg.endsWith("1000000105")?(n.startMaxTime(),n.active()):[O.TIMEOUT].includes(t)?this.logger.warn(Tt+" timeout"):(this.logger.warn(Tt+" unexpected error: ".concat(JSON.stringify(t))),n.stopMaxTime(),n.invalid(),this.resetRoom(),this.disconnectedHandle(t)))},qe.prototype.onDisconnect=function(t){var e=this;this.logger.error(St+" "+t.msg),"string"==typeof t.code&&"Error.Network"===t.code||"number"==typeof t.code&&(t.code<2e9&&1e9<t.code||t.code<1e6)&&G.decodeServerError(t.code,t.msg),G.unregisterCallback(ee,this.stateCenter.reportList),(t=this.room.roomTryHandler)?(t.onactive=function(t,n){e.logger.error(St+" onactive"),n&&0!==n.code?(e.transError(n),e.roomStateHandle("DISCONNECTED",C.ReconnectFailed,n)):e.roomStateHandle("CONNECTED",C.Reconnected,n)},t.startMaxTime(),t.active()):this.logger.error(St+" try handler no found")},qe.prototype.onConnecting=function(t){this.roomStateHandle("CONNECTING",C.Logining,t)},qe.prototype.disconnectedHandle=function(t,e){var n;t&&0!==t.code?(this.stopTokenTimer(),n=null!=e&&e.isKickout?C.Kickout:C.ReconnectFailed,this.transError(t),this.roomStateHandle("DISCONNECTED",n,t,(null==e?void 0:e.extendedData)||t.msg)):this.roomStateHandle("CONNECTED",C.Reconnected,t,null==e?void 0:e.extendedData)},qe.prototype.roomStateHandle=function(t,e,n,r,i){if(!e||e!=C.Reconnecting||(this.reconectTimes++,1!=this.reconectTimes)){this.logger.info("zm.rm.scb "+t+" "+JSON.stringify(n)),["CONNECTED","DISCONNECTED"].includes(t)&&(this.reconectTimes=0);var o,s,u=0;switch(e=(e=(e=e&&[C.LoginFailed,C.ReconnectFailed].includes(e)?null!=(s=this.room.roomTryHandler)&&s.loginRoomCallback.fail?C.LoginFailed:C.ReconnectFailed:e)&&[C.Logined,C.Reconnected].includes(e)?null!=(s=this.room.roomTryHandler)&&s.loginRoomCallback.success?C.Logined:C.Reconnected:e)&&[C.Logining,C.Reconnecting].includes(e)?null!=(s=this.room.roomTryHandler)&&s.loginRoomCallback.success?C.Logining:C.Reconnecting:e){case C.Reconnecting:o=ne,this.tempBrokenTime=(new Date).getTime();break;case C.ReconnectFailed:o=ie;break;case C.Reconnected:o=re,u=(new Date).getTime()-this.tempBrokenTime}this.room.lastRoomState=this.room.roomState,this.room.roomState=t,this.room.roomState!==this.room.lastRoomState&&(this.stateCenter.actionListener("_roomStateUpdate",this.room.roomID,t,n?n.code:0,r,i),i||(this.stateCenter.actionListener("roomStateUpdate",this.room.roomID,t,n?n.code:0,r),this.stateCenter.actionListener("roomStateChanged",this.room.roomID,e,n?n.code:0,r)),o)&&((s=this.stateCenter.reporter.createSpan(a.H,{key:Vt.event,par:this.room.roomID},{key:""},o.event)).setAttributes(e===C.Reconnected?{room_broken_time:re.room_broken_time(u)}:{error:(null==n?void 0:n.code)||0,message:r||""}),s.end())}},qe.prototype.transError=function(t){var e;this.logger.info("zm.rm.te "+JSON.stringify(t)),0!==t.code&&(t.code<2e9&&1e9<t.code||t.code<1e6)&&(e=G.getLiveRoomError(t.code,this.stateCenter.useNetAgent))&&O[e]&&(t.code=O[e].code,t.msg=O[e].msg)},qe.prototype.login=function(t,e,n,r,i,o,u){this.logger.info(_t+" call:"+e+" "+n),this.room.isMulti||this.logger.setSessionInfo(this.stateCenter.appid,e,"",r.userID,"",this.stateCenter.sdKVersion),i&&(i.userUpdate&&"boolean"==typeof i.userUpdate&&(this.room.userStateUpdate=i.userUpdate),i.maxMemberCount)&&"number"==typeof i.maxMemberCount&&(this.room.maxMemberCount=i.maxMemberCount),this.stateCenter.configOK?(this.room.runState!==s.trylogin&&this.setRunState(s.trylogin),this.room.roomID=e,this.room.token=n,this.room.thirdToken=n,this.stateCenter.idName=r.userID,this.stateCenter.nickName=r.userName||r.userID,this.loginCallback.success=o,this.loginCallback.fail=u,this.server=t,this.stateCenter.reporter.spanSetAttributes({key:Wt,bak_key:ee,par:e},{server:this.isUseNetAgent?void 0:Yt(this.server)}),this.liveRoomLoginKey=this.room.isMulti?Kt:Zt,this.stateCenter.reporter.createSpan(a.H,{key:Wt,bak_key:ee,par:this.room.roomID},{key:this.liveRoomLoginKey.event,par:this.room.roomID},this.liveRoomLoginKey.event,!0),this.resetTryLogin(),this.onConnecting({code:0,msg:""}),this.tryLogin(t),this.logger.info(_t+" call success")):(this.logger.error(_t+" init sdk wrong"),u(O.INIT))},qe.prototype.tryLogin=function(t){var e,n=this;if(this.room.runState!==s.trylogin)this.logger.error("zb.rh.tl state error");else{if(this.isUseNetAgent)return this.room.isMulti&&this.room.isDisConnect()?void this.logger.warn(mt+" liveroom is not connected"):(i=function(t,e){n.handleLoginRsp(t,e)},void(null!=(e=this.liveRoomHandler)&&e.isUaConnect()?(this.stateCenter.reporter.spanSetAttributes({key:this.liveRoomLoginKey.event,par:null==(e=this.room)?void 0:e.roomID},{sdk_zpush_sessionid_string:null==(e=null==(e=null==(e=this.liveRoomHandler)?void 0:e.roomServicer)?void 0:e.switchSessionID)?void 0:e.toString()}),this.liveRoomHandler.login(this.room,i,i)):(this.tryLoginTimer=setTimeout((function(){n.logger.info(mt+" over time no response, login timeout"),n.loginCallback.fail&&n.loginCallback.fail(Vt.error.LOGIN_TIMEOUT)}),this.tryLoginInterval),this.logger.warn(mt+" ua is not connected"))));if(null!=(e=this.service)&&e.isDisConnect())try{if(this.service.closeSocket(),this.logger.debug(mt+" new websocket"),!this.isUseNetAgent&&!U(t,this.stateCenter.appid))throw this.logger.error("".concat(mt," the server does not match the appID")),new Error("The server does not match the appID");this.service.createSocket(t);var r=Date.now();this.service.openHandler((function(){var t;n.stateCenter.reporter.spanSetAttributes({key:n.liveRoomLoginKey.event,par:null==(t=n.room)?void 0:t.roomID},{connect_consume:Date.now()-r}),n.openHandler()})),this.service.closeHandler((function(t){var e;n.logger.error(mt+" close "+JSON.stringify(t.code||t)),null!=(e=n.service)&&e.closeSocket(),n.closeHandler(t)})),this.service.errorHandler((function(t){var e;n.logger.error(mt+" error "+JSON.stringify(t.code||t)),null!=(e=n.service)&&e.closeSocket(),n.closeHandler(t)}))}catch(t){this.logger.error(mt+"  websocket err:"+JSON.stringify(t))}else{this.logger.info(mt+" use current websocket and sent login");var i=function(t,e){n.handleLoginRsp(t,e)};null!=(e=this.service)&&e.login(this.room,i,i)}this.tryLoginTimer=setTimeout((function(){n.logger.info(mt+" over time no response, login timeout"),n.loginCallback.fail&&n.loginCallback.fail(Vt.error.LOGIN_TIMEOUT)}),this.tryLoginInterval),this.logger.info(mt+" call success")}},qe.prototype.openHandler=function(){function t(t,e){n.handleLoginRsp(t,e)}var e,n=this;this.logger.info("zm.rm.op websocket.onpen call"),null!=(e=this.service)&&e.onPush(),null!=(e=this.service)&&e.login(this.room,t,t)},qe.prototype.handleLoginRsp=function(t,e){this.logger.info(vt+" seq: "+e+" "+JSON.stringify(t)),this.room.runState!==s.trylogin?this.logger.error(vt+" state error"):t.header&&t.body?t.header.seq!==e&&0==this.room.isMulti?this.logger.error(vt+" in wrong seq, local=",e+"",",recv=",t.header.seq):0!==t.body.err_code?(this.logger.error(vt+" server error=",t.body.err_code),this.handleLoginFail(t)):(this.logger.info(vt+" call success."),this.handleLoginSuccess(t)):(this.logger.error(vt+" "+JSON.stringify(t)),this.handleLoginFail(t))},qe.prototype.handleLoginFail=function(t){this.resetTryLogin();var e=Vt.error.INNER_ERROR;t.header&&t.body?e=G.getServerError(t.body.err_code):t.code&&t.msg&&(e=t),this.stateCenter.reporter.spanEnd({key:this.liveRoomLoginKey.event,par:this.room.roomID},{error:e.code,message:e.msg}),this.loginCallback.fail&&this.loginCallback.fail(e,!0)},qe.prototype.handleLoginSuccess=function(t){var e,n,r=this,i=(this.room.checkRoomSession(t.body.room_session_id)&&(this.room.loginTime=Date.now()),this.room.lastRunState),o=(this.setRunState(s.login),this.stateCenter.userid=t.body.user_id,this.isUseNetAgent?(this.room.longRoomSid=t.body.room_session_id,this.room.longSid=t.body.session_id):(this.room.sessionID=t.body.session_id,this.room.roomSessionID=t.body.room_session_id),(o={})[this.room.roomID]={room_sid_string:this.room.roomSidString},this.stateCenter.reporter.setPublicPros(o),null==(o=null==t?void 0:t.body)?void 0:o.token_remain_time);this.stateCenter.configRoomAuth=0<o,t.body.ret_timestamp&&["03","04"].includes(this.room.token.substring(0,2))&&(e=(n=(new Date).getTime())-t.body.ret_timestamp,this.stateCenter.local_time_deviation=e<5e3?0:e,e=0<o?1e3*o:1e3*G.decodeTokenExpire(this.room.token.substring(2))-(n-this.stateCenter.local_time_deviation),this.resetTokenTimer(e)),this.room.isMulti||this.logger.setSessionInfo(this.stateCenter.appid,this.room.roomID,this.room.userSidString,this.stateCenter.idName,this.stateCenter.nickName,this.stateCenter.sdKVersion),this.isUseNetAgent||(t.body.config_info&&(n=(null==(o=this.stateCenter.settingConfig)?void 0:o.getSetting("remote_log_level",!0))||t.body.config_info.log_level,this.logger.setRemoteLogLevel(n),""==t.body.config_info.log_url||this.logger.url||(this.logger.setLogServer(t.body.config_info.log_url),0===this.stateCenter.ENV&&(this.stateCenter.logDomain=null==(e=this.logger.url)?void 0:e.split("/")[2],this.stateCenter.reporter.setConfig({serverUrl:"wss://"+this.stateCenter.logDomain+"/zglog/tlog"})))),t.body.cluster_env&&1===t.body.cluster_env&&(this.stateCenter.testEnvironment=!0,this.stateCenter.debugCustom||(this.stateCenter.debug=!0))),this.stateCenter.reporter.spanEnd({key:this.liveRoomLoginKey.event,par:this.room.roomID},{server:this.isUseNetAgent?void 0:Yt(this.server),room_id:null==(o=this.room)?void 0:o.roomID,room_sid_string:null==(n=this.room)?void 0:n.roomSidString,zpush_sessionid_string:this.isUseNetAgent&&null!=(o=null==(e=null==t?void 0:t.header)?void 0:e.session_id)?o.toString():void 0,liveroom_sid_string:null==(n=this.room)?void 0:n.userSidString}),this.resetTryLogin(),this.loginSuccessCallBack(i,t),this.roomStateHandle("CONNECTED",C.Logined,{code:0,msg:""}),this.logger.makeZipLogSpaceUpload().catch((function(t){r.logger.error("zm.rm.lgsuc zip log upload error: "+t.message)})),this.loginCallback.success&&this.loginCallback.success(!0)},qe.prototype.closeHandler=function(t){this.logger.error(yt+" room websocket close "+JSON.stringify(t.code||t)),this.room.runState!==s.logout?this.room.runState===s.trylogin?(this.resetTryLogin(),this.loginCallback.fail&&this.loginCallback.fail(1006==t.code?Vt.error.LOGIN_TIMEOUT:t)):this.room.runState===s.login&&(this.logger.info(yt+" is called because of network broken"),this.resetTryLogin(),this.onDisconnect(Vt.error.NETWORK_BROKEN)):this.logger.info(yt+" onclose logout flow call websocket.close")},qe.prototype.logout=function(t,e){this.logger.info(bt+" call"),this.room.runState===s.logout?this.logger.warn("zb.rh.lo at logout"):(this.resetRoom(t),this.roomStateHandle("DISCONNECTED",C.Logout,{code:0,msg:""},void 0,e),this.stopTokenTimer(),this.logger.info(bt+" call success"))},qe.prototype.handleLogoutRsp=function(t,e){this.logger.info(bt+" result=",t.body&&t.body.err_code?t.body.err_code:"-1"),this.isUseNetAgent&&e&&null!=(t=this.liveRoomHandler)&&t.closeRequest()};var Fe=qe;function qe(t,e,n,r,i,o){this.logger=t,this.stateCenter=e,this.dataReport=n,this.room=r,this.liveRoomHandler=i,this.service=o,this.tryLoginTimer=null,this.tryLoginCount=0,this.tryLoginInterval=1e4,this.tokenTimer=null,this.beforeExpire=30,this.server="",this.tempBrokenTime=0,this.reconectTimes=0,this.loginCallback={}}var je=function(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||((r=r||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))},Ve=(We.prototype.loginRsp=function(t,e){this.anchor_info=t.body.anchor_info||this.anchor_info,this.userListInterval=t.body.userlist_interval||this.userListInterval,this.userListMergeInterval=t.body.userlist_merge_timeout||this.userListMergeInterval,t.body.anchor_info&&(this.stateCenter.actionListener("getAnchorInfo",t.body.anchor_info.anchor_id_name,t.body.anchor_info.anchor_nick_name),this.stateCenter.actionListener("_getAnchorInfo",t.body.anchor_info.anchor_id_name,t.body.anchor_info.anchor_nick_name)),t.body.online_count&&this.stateCenter.actionListener("roomOnlineUserCountUpdate",this.room.roomID,t.body.online_count),this.logger.info("zm.us.lgr  userStateUpdate "+this.room.userStateUpdate),this.room.userStateUpdate&&this.fetchUserList(e)},We.prototype.patchUserList=function(t){var e=this;t.body.server_user_seq!==this.userSeq&&this.room.userStateUpdate&&!this.userSeqMergeMap&&(this.logger.info("zm.us.pt call update user "+this.userSeq+" server "+t.body.server_user_seq),this.userSeqMergeMap||(this.userSeqMergeMap={}),this.userSeqMergeTimer&&clearTimeout(this.userSeqMergeTimer),this.userSeqMergeTimer=setTimeout((function(){e.handleMergeTimeout()}),this.userListMergeInterval)),this.minUserSeq=t.body.server_user_seq,null!=t.body.online_count&&0!=t.body.online_count&&this.stateCenter.actionListener("roomOnlineUserCountUpdate",this.room.roomID,t.body.online_count)},We.prototype.resetUserHandler=function(){this.userQuerying=!1,this.lastUserQueryTime=0,this.userTempList=[],this.userSeq=0,this.minUserSeq=0,this.userList=void 0,this.userSeqMergeMap={},this.userSeqMergeTimer=void 0,this.userQueryTimer=void 0,this.userListInterval=3e4,this.userListMergeInterval=5e3,this.anchor_info={anchor_id:"",anchor_id_name:"",anchor_nick_name:""}},We.prototype.fetchUserList=function(t){this.userQuerying?this.logger.warn("zm.us.ftu is already querying"):(this.userQuerying=!0,this.userTempList=[],this.fetchUserListWithPage(0,t||0),this.logger.info("zm.us.ftu the first time call"))},We.prototype.fetchUserListWithPage=function(t,e){function n(t){r.handleFetchUserListRsp(t,e)}var r=this,i={user_index:t,sort_type:0},o=_e;null!=(this.stateCenter.reporter.createSpan(a.H,{key:Vt.event,par:this.room.roomID},{key:o.event,par:this.room.roomID},o.event,!0).setAttribute("user_index",o.user_index(t)),o=this.stateCenter.useNetAgent?this.liveRoomHandler:this.service)&&o.fetchUserList(i,n,n,this.room)},We.prototype.handleFetchUserListRsp=function(t,e){var n=this;if(this.stateCenter.reporter.spanEnd({key:_e.event,par:this.room.roomID},{error:(null==(r=null==t?void 0:t.body)?void 0:r.err_code)||(null==t?void 0:t.code),message:(null==(r=null==t?void 0:t.body)?void 0:r.err_message)||(null==t?void 0:t.msg)}),t.body&&0!=t.body.err_code)this.userQuerying=!1,this.lastUserQueryTime=Date.now()+this.userListInterval,this.logger.info(It+" fetch error "+t.body.err_code);else if(t.header&&t.body)if(this.room.userStateUpdate){this.userTempList=je(je([],this.userTempList,!0),t.body.user_baseinfos,!0);var r=t.body.ret_user_index;if(r!=t.body.server_user_index)this.logger.info(It+" fetch another page"),this.fetchUserListWithPage(r+1,e);else{this.userSeq=t.body.server_user_seq;for(var i=[],o=[],a=0;a<this.userTempList.length;a++){var u={userID:this.userTempList[a].id_name,userName:this.userTempList[a].nick_name,role:this.userTempList[a].role};4!==u.role&&(i.push(u),o.push({idName:this.userTempList[a].id_name,nickName:this.userTempList[a].nick_name,role:this.userTempList[a].role}))}this.stateCenter.actionListener("_getTotalUserList",this.room.roomID,o),e==s.login?(this.userList&&G.mergeUserList(this.logger,this.userList,i,(function(t,e){0!==t.length&&n.onUserStateUpdate(n.room.roomID,"ADD",t),0!==e.length&&n.onUserStateUpdate(n.room.roomID,"DELETE",e)})),this.userList=i):0!==(this.userList=i).length&&this.onUserStateUpdate(this.room.roomID,"ADD",i),this.userQuerying=!1,this.lastUserQueryTime=Date.now()+this.userListInterval,this.userTempList=[],this.logger.info(It+" call success user_list "+i+", count: "+i.length+", seq: "+this.userSeq)}}else this.logger.info(It+" not update");else this.userQuerying=!1,this.lastUserQueryTime=Date.now()+this.userListInterval,this.logger.info(It+" fetch error "+t)},We.prototype.handlePushUserStateUpdateMsg=function(t){if(this.logger.info(kt+" call"),this.room.userStateUpdate)if(this.userSeq===t.body.user_list_seq)this.logger.warn(kt+" user_list_seq is the same with local seq");else if(this.userSeq+t.body.user_actions.length!==t.body.user_list_seq)this.mergeUserByUserSeq(t.body.user_list_seq,t.body.user_actions);else{this.userSeq=t.body.user_list_seq;for(var e=[],n=0;n<t.body.user_actions.length;n++){var r={action:t.body.user_actions[n].Action,idName:t.body.user_actions[n].IdName,nickName:t.body.user_actions[n].NickName,role:t.body.user_actions[n].Role,loginTime:t.body.user_actions[n].LoginTime};4!==r.role&&e.push(r)}this.stateCenter.actionListener("_userStateUpdate",t.body.room_id,e);var i=[],o=[];e.forEach((function(t){1==t.action?i.push({userID:t.idName,userName:t.nickName,role:t.role}):2==t.action&&o.push({userID:t.idName,userName:t.nickName,role:t.role})})),this.userList&&(this.userList=this.userList.concat(i).filter((function(t){return!o.some((function(e){return e.userID==t.userID}))}))),0!==i.length&&this.onUserStateUpdate(t.body.room_id,"ADD",i),0!==o.length&&this.onUserStateUpdate(t.body.room_id,"DELETE",o),this.logger.info(kt+" call success")}else this.logger.info(kt+" userStateUpdate is false")},We.prototype.onUserStateUpdate=function(t,e,n){var r=this;n=n.filter((function(t){return t.userID!==r.stateCenter.idName})),0!=n.length&&(n=n.map((function(t){return{userID:t.userID,userName:t.userName}})),this.stateCenter.actionListener("roomUserUpdate",t,e,n))},We.prototype.mergeUserByUserSeq=function(t,e){var n=this;this.userSeqMergeMap||(this.logger.warn("zm.us.mg new merge userlist "+this.userSeq+" server "+t),this.userSeqMergeMap={},this.userSeqMergeTimer&&clearTimeout(this.userSeqMergeTimer),this.userSeqMergeTimer=setTimeout((function(){n.handleMergeTimeout()}),this.userListMergeInterval)),this.userSeqMergeMap[t]=e,this.logger.warn("zm.us.mg  merge userlist "+this.userSeq+" server "+t+" userlist "+e.length)},We.prototype.mergeUser=function(t){var e=this,n=(this.logger.info("zm.us.mg merge userlist "+this.userSeq+" userSeqList "+t.join(",")),this.userSeq=t[t.length-1],this.lastUserQueryTime=Date.now()+this.userListInterval,{}),r=((t.forEach((function(t){e.userSeqMergeMap&&e.userSeqMergeMap[t].forEach((function(t){n[t.IdName]=t}))})),this.userSeqMergeMap=null,t=Object.values(n).map((function(t){return{action:t.Action,idName:t.IdName,nickName:t.NickName,role:t.Role,loginTime:t.LoginTime?String(t.LoginTime):""}})).filter((function(t){return 4!==t.role}))).sort((function(t,e){return t.loginTime.localeCompare(e.loginTime)})),[]),i=[];t.forEach((function(t){1==t.action?r.push({userID:t.idName,userName:t.nickName,role:t.role}):2==t.action&&i.push({userID:t.idName,userName:t.nickName,role:t.role})})),this.userList=this.userList&&this.userList.concat(r).filter((function(t){return!i.some((function(e){return e.userID==t.userID}))})),0!==r.length&&this.onUserStateUpdate(this.room.roomID,"ADD",r),0!==i.length&&this.onUserStateUpdate(this.room.roomID,"DELETE",i),this.stateCenter.actionListener("_userStateUpdate",this.room.roomID,t)},We.prototype.handleMergeTimeout=function(){var t,e=this,n=Object.keys(this.userSeqMergeMap).map((function(t){return+t})).sort((function(t,e){return t-e}));n[n.length-1]-n[0]+1===n.length||n[n.length-1]>=this.minUserSeq?this.mergeUser(n):(this.userSeqMergeMap=null,t=this.lastUserQueryTime-Date.now(),this.logger.info("zm.us.mto  fetch merge userlist "+this.userSeq+" userSeqList "+n.join(",")+" wait "+t),0<t?(this.userQueryTimer&&clearTimeout(this.userQueryTimer),this.userQueryTimer=setTimeout((function(){e.fetchUserList()}),t)):this.fetchUserList())},We);function We(t,e,n,r,i,o){this.logger=t,this.stateCenter=e,this.dataReport=n,this.liveRoomHandler=r,this.room=i,this.service=o,this.userQuerying=!1,this.userTempList=[],this.userSeq=0,this.minUserSeq=0,this.userList=[],this.userSeqMergeMap=null,this.userListInterval=3e4,this.userListMergeInterval=5e3,this.anchor_info={anchor_id:"",anchor_id_name:"",anchor_nick_name:""}}Object.defineProperty(Ze.prototype,"isUseNetAgent",{get:function(){return this.stateCenter.useNetAgent},enumerable:!1,configurable:!0}),Object.defineProperty(Ze.prototype,"sessionExist",{get:function(){return null!==this.longSid||"0"!==this.sessionID},enumerable:!1,configurable:!0}),Object.defineProperty(Ze.prototype,"roomSidString",{get:function(){return this.isUseNetAgent?this.longRoomSid?this.longRoomSid.toString():"0":this.roomSessionID},enumerable:!1,configurable:!0}),Object.defineProperty(Ze.prototype,"userSidString",{get:function(){return this.isUseNetAgent?this.longSid?this.longSid.toString():"0":this.sessionID},enumerable:!1,configurable:!0}),Ze.prototype.initMessageHandler=function(){},Ze.prototype.initLiveHandler=function(){},Ze.prototype.init=function(){this.bindHeatBeatHandler(),this.bindRoomHandler(),this.bindMessageHandler(),this.bindLiveHandler()},Ze.prototype.bindHeatBeatHandler=function(){var t=this;this.heartBeatHandler.hbLogout=function(e){t.roomHandler.handleHbLogout(e)},this.heartBeatHandler.heartbeatRspNotiFy=function(e,n){t.messageHandler&&t.messageHandler.loginRsp(e),t.userHandler.patchUserList(e),t.HBResponse(e,n)}},Ze.prototype.bindRoomHandler=function(){var t=this;this.roomHandler.loginSuccessCallBack=function(e,n){t.logger.info("zm.lrm.brh login suc "+e),t.heartBeatHandler.init(n),t.isUseNetAgent?t.liveRoomHandler.startCheck():t.service&&(t.service.stopCheck(),t.service.startCheck()),t.userHandler.loginRsp(n,e),t.messageHandler&&t.messageHandler.loginRsp(n),t.isMulti||t.handleMultiRoom(),t.roomLoginResponse(n)},this.roomHandler.resetRoomCallBack=function(){var e;t.heartBeatHandler.resetHeartbeat(),t.liveHandler&&t.liveHandler.resetLiveHandler(),t.messageHandler&&t.messageHandler.resetMessageInfo(),t.isUseNetAgent&&t.liveRoomHandler&&t.liveRoomHandler.stopCheck(),t.userHandler.resetUserHandler(),null!=(e=t.service)&&e.stopCheck(),t.roomTryHandler&&(t.roomTryHandler.invalid(),t.roomTryHandler.stopMaxTime())}},Ze.prototype.bindUserHandler=function(){},Ze.prototype.bindMessageHandler=function(){},Ze.prototype.bindLiveHandler=function(){},Ze.prototype.HBResponse=function(t,e){this.stateCenter.actionListener("HBResponse",t,e)},Ze.prototype.roomLoginResponse=function(t){this.stateCenter.actionListener("roomLoginResponse",t)},Ze.prototype.checkRoomSession=function(t){return this.isUseNetAgent?null!==this.longRoomSid&&this.longRoomSid.eq(t):this.roomSessionID===t},Ze.prototype.handleMultiRoom=function(){var t=this;this.stateCenter.roomModulesList.forEach((function(e){e.runState!==s.login&&e.roomTryHandler&&1==e.isMulti&&(e.roomTryHandler.onactive=function(n,r){var i;r&&0!==r.code?(0!==r.code&&(i=G.getLiveRoomError(r.code,t.isUseNetAgent))&&O[i]&&(r=O[i]),e.roomHandler.roomStateHandle("DISCONNECTED",C.ReconnectFailed,r,r.msg)):e.roomHandler.roomStateHandle("CONNECTED",C.Reconnected,r)},e.roomTryHandler.startMaxTime(),e.roomTryHandler.active())}))},Ze.prototype.isLogin=function(){return this.runState===s.login},Ze.prototype.isLogout=function(){return this.runState===s.logout},Ze.prototype.isTryLogin=function(){return this.runState===s.trylogin},Ze.prototype.isDisConnect=function(){return(this.isUseNetAgent?this.liveRoomHandler:this.service).isDisConnect()},Ze.prototype.retryConnect=function(){this.logger.info("zm.lrm.rc call"),this.isUseNetAgent&&(this.resetSessionInfo(),this.liveRoomHandler.closeRequest())},Ze.prototype.retryRoom=function(){this.logger.info("zm.lrm.rr.0 call"),this.roomTryHandler&&this.rtm.netAgent.isConnect()&&(this.resetRoomSession(),this.resetUserSession(),this.roomTryHandler.active(!0))},Ze.prototype.resetSessionInfo=function(){var t;this.logger.info("zm.lrm.rsi call"),this.resetRoomSession(),this.resetUserSession(),null!=(t=this.liveRoomHandler)&&t.reset()},Ze.prototype.resetRoomSession=function(){this.roomSessionID="0",this.longRoomSid=null},Ze.prototype.resetUserSession=function(){this.sessionID="0",this.longSid=null};var Ye=Ze;function Ze(t,e,n,r,i,o,a){this.roomID=t,this.stateCenter=e,this.logger=n,this.dataReport=r,this.rtm=i,this.liveRoomHandler=o,this.service=a,this.runState=s.logout,this.lastRunState=s.logout,this.lastRoomState="DISCONNECTED",this.roomState="DISCONNECTED",this.roomSessionID="0",this.sessionID="0",this.longSid=null,this.longRoomSid=null,this.isMulti=!1,this.token="",this.thirdToken="",this.loginTime=0,this.userStateUpdate=!1,this.maxMemberCount=0,this.roomName="",this.roomHandler=new Fe(this.logger,this.stateCenter,this.dataReport,this,o,this.service),this.heartBeatHandler=new ze(this.logger,this.stateCenter,this.dataReport,this.liveRoomHandler,this,this.service),this.userHandler=new Ve(this.logger,this.stateCenter,this.dataReport,this.liveRoomHandler,this,this.service),this.initMessageHandler(),this.initLiveHandler(),this.init()}$e.prototype.createSocket=function(t){this.socket=Object(i.createZegoWebSocket)(t,this.ENV%2)},$e.prototype.closeSocket=function(){this.socket&&(this.socket.onclose=null,this.socket.onerror=null,this.socket.close(),this.socket=null)},$e.prototype.isDisConnect=function(){return!this.socket||1!==this.socket.readyState},$e.prototype.sendMessage=function(t,e,n,r,i){return void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i={timeOut:6e3}),i={data:e={header:t,body:e},seq:t.seq,deleted:!1,sendTime:Date.parse(new Date+""),timeOut:i.timeOut,success:n,error:r},n=this.sendCommandList.push(i),this.sendCommandMap[i.seq]=n,this.socket&&this.socket.send(JSON.stringify(e)),t.seq},$e.prototype.sendPB=function(t){return this.socket&&this.socket.send(t),!0},$e.prototype.checkSendMessageList=function(t){for(var e=t.getFirst();null!=e;)!function(){var n,r,i;t.remove(e),e&&e._data&&(n=e._data.error,r=e._data.seq,i=e._data.data.body.custom_msg,setTimeout((function(){n&&n(O.TIMEOUT,r,i)}),0)),e=t.getFirst()}()},$e.prototype.checkMessageListTimeout=function(t,e){for(var n=t.getFirst(),r=Date.parse(new Date+""),i=0,o=this;null!=n&&"break"!==function(){var s,a,u;return n._data&&n._data.sendTime+n._data.timeOut>r||(n._data&&delete e[n._data.data.header.seq],t.remove(n),n._data&&null==n._data.error||n._data&&n._data.sendTime+o.sendDataDropTimeout<r||n&&n._data&&(s=n._data.error,a=n._data.seq,u=n._data.data.body.custom_msg,setTimeout((function(){s&&s(O.TIMEOUT,a,u)}),0)),++i>=o.sendDataCheckOnceCount)?"break":void(n=t.getFirst())}(););},$e.prototype.startCheck=function(){var t=this;this.checkMessageListTimeout(this.sendCommandList,this.sendCommandMap),this.sendDataCheckTimer=setTimeout((function(){t.startCheck()}),this.sendDataCheckInterval)},$e.prototype.stopCheck=function(){this.checkSendMessageList(this.sendCommandList),this.sendCommandMap={},clearTimeout(this.sendDataCheckTimer)},$e.prototype.openHandler=function(t){var e=this;this.socket&&(this.socket.onopen=function(n){e.socket.binaryType="arraybuffer",e.responseHandler(),t(n)})},$e.prototype.responseHandler=function(){var t=this;this.socket&&(this.socket.onmessage=function(e){e="string"==typeof e.data?JSON.parse(e.data):e.data,t.onMessage(e)})},$e.prototype.closeHandler=function(t){this.socket&&(this.socket.onclose=function(e){t(e)})},$e.prototype.errorHandler=function(t){this.socket&&(this.socket.onerror=t)},$e.prototype.onMessage=function(t){};var Ke=$e;function $e(t){this.socket=null,this.sendCommandList=new m,this.sendCommandMap={},this.sendDataCheckOnceCount=100,this.sendDataDropTimeout=1e4,this.sendDataCheckInterval=2e3,this.ENV=t}var Qe=function(){return(Qe=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},Xe=(Je.prototype.checkResponse=function(t){return 0!=this.stateCenter.roomModulesList.filter((function(t){return t.runState!==s.logout})).length&&(t.header.appid!==this.stateCenter.appid||t.header.user_id!==this.stateCenter.userid)},Je.prototype.handleSendCommandMsgRsp=function(t){var e,n=this,r=this.service.sendCommandMap[t.header.seq];null!=r&&(e=r._data,delete this.service.sendCommandMap[t.header.seq],this.service.sendCommandList.remove(r),0===t.body.err_code?setTimeout((function(){e&&null!=e.success&&e.success(t,n.cmdSeq)}),0):setTimeout((function(){e&&null!=e.error&&e.error(t,n.cmdSeq)}),0))},Je.prototype.onPush=function(){var t=this;this.service.onMessage=function(e){e instanceof ArrayBuffer?t.stateCenter.actionListener("_protobufResponse",e):e.header?(0!==e.body.err_code?e.body.err_message&&t.logger.error("".concat(Rt," cmd=").concat(e.header.cmd,", err_code=").concat(e.body.err_code,", err_message=").concat(e.body.err_message," ")):t.logger.info("".concat(Rt," cmd=").concat(e.header.cmd,", msg=").concat(JSON.stringify(e)," ")),-1<["login","logout"].indexOf(e.header.cmd)?t.handleSendCommandMsgRsp(e):t.checkResponse(e)?t.logger.error(Rt+"  check session fail."):(t.logger.info("".concat(Rt," cmd=").concat(e.header.cmd,",function=").concat(!!t.responseRouters[e.header.cmd])),t.handleSendCommandMsgRsp(e),t.responseRouters[e.header.cmd]&&t.responseRouters[e.header.cmd](e,t.cmdSeq))):t.logger.error("".concat(Rt," msg type error "))}},Je.prototype.handlePushKickout=function(t){var e,n;void 0===(null==(n=null==t?void 0:t.body)?void 0:n.protocol)||1===(null==(n=null==t?void 0:t.body)?void 0:n.protocol)?function(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||((r=r||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}([],this.stateCenter.roomModulesList,!0).forEach((function(e){return e.roomHandler.handlePushKickout(t,!0)})):(e=null==(n=null==t?void 0:t.header)?void 0:n.room_id,(n=this.stateCenter.roomModulesList.find((function(t){return t.roomID==e})))?n.roomHandler.handlePushKickout(t):this.logger.error(Rt+" room no found ignore "+JSON.stringify(null==(n=t.header)?void 0:n.room_id)))},Je.prototype.handlePushCustomMsg=function(t){},Je.prototype.handlePushRoomMsg=function(t){},Je.prototype.handlePushUserStateUpdateMsg=function(t){var e,n=null==(r=null==t?void 0:t.header)?void 0:r.room_id,r=this.stateCenter.roomModulesList.find((function(t){return t.roomID==n})),i=this.stateCenter.reporter.createSpan(a.H,{key:Vt.event,par:n},{key:""},ue.event);r?(i.setAttributes({user_list_seq:null==(e=null==t?void 0:t.body)?void 0:e.user_list_seq,update_user:null==(e=null==t?void 0:t.body)?void 0:e.user_actions}),i.end(),r.userHandler.handlePushUserStateUpdateMsg(t)):(this.logger.error(Rt+" room no found ignore "+JSON.stringify(t)),this.stateCenter.reporter.setError(i,ue.error.ROOM_NOT_EXIST))},Je.prototype.handlePushMergeMsg=function(t){},Je.prototype.handlePushTransMsg=function(t){},Je.prototype.handleBigImMsgRsp=function(t){},Je.prototype.handlePushSignalMsg=function(t){},Je.prototype.handlePushTokenExpire=function(t){this.stateCenter.actionListener("_tokenExpired",t)},Je.prototype.closeHandler=function(t){this.service.closeHandler(t)},Je.prototype.openHandler=function(t){this.service.openHandler(t)},Je.prototype.errorHandler=function(t){this.service.errorHandler(t)},Je.prototype.getHeader=function(t,e,n,r){return{Protocol:"req",cmd:t,appid:this.stateCenter.appid,seq:++this.cmdSeq,user_id:this.stateCenter.userid,session_id:e||"",room_id:n||"",room_session_id:r||"",biz_version:this.stateCenter.bizVersion||""}},Je.prototype.startCheck=function(){this.logger.info("zm.sc.0 start"),this.service.startCheck()},Je.prototype.stopCheck=function(){this.logger.info("zm.sc.1 stop"),this.service.stopCheck()},Je.prototype.isDisConnect=function(){return!this.service||this.service.isDisConnect()},Je.prototype.createSocket=function(t){var e=this;this.stateCenter.roomServer=t,this.service.createSocket(t),this.responseRouters=Qe(Qe({},this.responseRouters),{push_kickout:function(t){e.handlePushKickout(t)},push_custommsg:function(t){e.handlePushCustomMsg(t)},push_im_chat:function(t){e.handlePushRoomMsg(t)},push_userlist_update:function(t){e.handlePushUserStateUpdateMsg(t)},push_merge_message:function(t){e.handlePushMergeMsg(t)},push_trans:function(t){e.handlePushTransMsg(t)},push_signal:function(t){e.handlePushSignalMsg(t)},push_token_expire:function(t){e.handlePushTokenExpire(t)}})},Je.prototype.closeSocket=function(){this.service.closeSocket()},Je.prototype.sendMessage=function(t,e,n,r,i,o){var s,a;return this.service.isDisConnect()?(this.logger.error("zm.sv.sd socket is disconnect"),r(O.SOCKET_CLOSE),0):(s=null!=o&&o.roomID?o.roomID:null==(s=this.stateCenter.roomModulesList[0])?void 0:s.roomID,a=null!=o&&o.roomSessionID?o.roomSessionID:null==(a=this.stateCenter.roomModulesList[0])?void 0:a.roomSessionID,o=null!=o&&o.sessionID?o.sessionID:null==(o=this.stateCenter.roomModulesList[0])?void 0:o.sessionID,i=i||this.getHeader(t,o,s,a),this.logger.info("zm.sv.sd sendMsg:"+JSON.stringify({header:i,body:e})),this.service.sendMessage(i,e,n,r))},Je.prototype.on=function(t,e){this.responseRouters[t]=e},Je.prototype.login=function(t,e,n){var r=this.getHeader(t.isMulti?"enter":"login",t.sessionID,t.roomID,t.roomSessionID);return t={id_name:this.stateCenter.idName,nick_name:this.stateCenter.nickName,role:this.stateCenter.role,token:t.token,version:this.stateCenter.sdKVersion,room_name:t.roomID,user_state_flag:t.userStateUpdate?1:0,room_create_flag:this.stateCenter.roomCreateFlag,client_type:0===this.stateCenter.ENV?l.ClientType_Webrtc:l.ClientType_SmallProgram,third_token:t.thirdToken,user_count_limit:t.maxMemberCount,relate_service:this.stateCenter.relateService.join()||"",login_logic:this.stateCenter.isMultiRoom?3:1,proto_format:this.stateCenter.protoFormat},this.sendMessage("",t,e,n,r)},Je.prototype.logout=function(t,e,n){var r=t.isMulti?"quit":"logout",i={reserve:0};return"logout"==r&&(i.login_logic=this.stateCenter.isMultiRoom?3:1),this.sendMessage(r,i,e,n,void 0,{sessionID:t.sessionID,roomID:t.roomID,roomSessionID:t.roomSessionID})},Je.prototype.heartBeat=function(t,e,n){return this.sendMessage("hb",{reserve:0},t,e,void 0,n)},Je.prototype.fetchUserList=function(t,e,n,r){return this.sendMessage("user_list",t,e,n,void 0,r)},Je.prototype.fetchUserListV2=function(t,e,n,r){return this.sendMessage("user_list_v2",t,e,n,void 0,r)},Je.prototype.fetchReliableMessage=function(t,e,n,r){return this.sendMessage("trans_fetch",t,e,n,void 0,r)},Je.prototype.sendReliableMessage=function(t,e,n,r){return this.sendMessage("trans",t,e,n,void 0,r)},Je.prototype.sendRoomMsg=function(t,e,n,r){return this.sendMessage("im_chat",t,e,n,void 0,r)},Je.prototype.sendCustomCommand=function(t,e,n,r){return this.sendMessage("custommsg",t,e,n,void 0,r)},Je.prototype.sendBigRoomMessage=function(t,e,n,r){return this.sendMessage("bigim_chat",t,e,n,void 0,r)},Je.prototype.sendRelayMessage=function(t,e,n,r){return this.sendMessage("relay",t,e,n,void 0,r)},Je.prototype.sendSignalCmd=function(t,e,n,r){return this.sendMessage("signal",t,e,n,void 0,r)},Je.prototype.sendPB=function(t){return this.service.isDisConnect()||this.stateCenter.networkState==u.offline?(this.logger.error("zm.spb socket is disconnected"),!1):this.service.sendPB(t)},Je);function Je(t,e,n){this.stateCenter=t,this.logger=e,this.rtm=n,this.service=new Ke(this.stateCenter.ENV),this.cmdSeq=0,this.responseRouters={}}en.prototype.setSetting=function(t,e){var n,r,i=Array.isArray(e)&&0<e.length;for(n in t)if("number"==typeof t[n].ctrlmode&&[1,2].includes(t[n].ctrlmode))this.setting[n]=t[n],this.setting[n+"_ctrlmode"]=t[n].ctrlmode;else for(var o in t[n])o.endsWith("_ctrlmode")||i&&-1==e.indexOf(o)||(1===(r=t[n][o+"_ctrlmode"])||2===r?this.setting[o]=t[n][o]:this.defaultSetting[o]&&(this.setting[o]=this.defaultSetting[o]),"number"==typeof r&&(this.setting[o+"_ctrlmode"]=t[n][o+"_ctrlmode"]))},en.prototype.getSetting=function(t,e){return(e=void 0!==e&&e)&&2!=this.setting[t+"_ctrlmode"]?void 0:this.setting[t]};var tn=en;function en(){this.defaultSetting={remote_log_level:"info",zip_log:0,detaillog_domain:""},this.requestList={},this.setting=JSON.parse(JSON.stringify(this.defaultSetting))}for(var nn=n(2),rn=nn.roots,on=nn.types?nn.types.basic:{double:1,float:5,int32:0,uint32:0,sint32:0,fixed32:5,sfixed32:5,int64:0,uint64:0,sint64:0,fixed64:1,sfixed64:1,bool:0,string:2,bytes:2},sn=nn.types?nn.types.packed:{double:1,float:5,int32:0,uint32:0,sint32:0,fixed32:5,sfixed32:5,int64:0,uint64:0,sint64:0,fixed64:1,sfixed64:1,bool:0},an=Object.keys(on),un=nn.util.Long?nn.util.Long.fromBits:function(){return 0},cn={$:function(t){return cn[t]?cn[t].call(this):rn[t].decode?rn[t].decode(this,this.uint32()):cn.$.call(this,"int32")}},ln={$:function(t,e,n){var r=on[t];return void 0===r?rn[t].encode?(this.uint32((n<<3|2)>>0).fork(),rn[t].encode(e,this).ldelim()):ln.$.call(this,"int32",e,n):ln[t].call(this.uint32(n<<3|r),e)}},hn=0;hn<an.length;hn++)cn[an[hn]]=nn.Reader.prototype[an[hn]],ln[an[hn]]=nn.Writer.prototype[an[hn]];!function t(e,n,r,i){for(var o=0,s=Object.keys(e);o<s.length;o++){var a=s[o];if(e[a].$m&&Object.keys(e[a].$m).every((function(t){return Number(t)}))){if(r[a])throw Error(`nested type ${r}.${a} has already exist`);r[a]=function(e,r){function i(t){for(var n in e)"{"===(n=e[n])[1].charAt(0)?this[n[0]]={}:"["!==n[1].charAt(0)&&"<"!==n[1].charAt(0)||(this[n[0]]=[]);if(t)for(var r=Object.keys(t),i=0;i<r.length;++i)null!=t[r[i]]&&(this[r[i]]=t[r[i]])}var o,s={};for(o in e){var a=e[o],u=a[1];"{"===u.charAt(0)?(i.prototype[a[0]]=nn.util.emptyObject,s[u]={$m:u.substring(1).split(",").map((function(t,e){return["$"+(e+1),t,null]})).reduce((function(t,e,n){return t[n+1]=e,t}),{})}):i.prototype[a[0]]="["===u.charAt(0)||"<"===u.charAt(0)?nn.util.emptyArray:"bytes"===u?nn.util.newBuffer([]):a[2]&&a[2].hasOwnProperty("low")&&a[2].hasOwnProperty("high")?un(a[2].low,a[2].high,a[2].unsigned):a[2]}return i.create=function(t){return new i(t)},i.decode=function(t,n){t instanceof nn.Reader||(t=nn.Reader.create(t));for(var r=void 0===n?t.len:t.pos+n,o=new i;t.pos<r;){var s=t.uint32(),a=s>>>3;if(0<a&&e[a]){var u=e[a][0],c=e[a][1];if("{"===c.charAt(0))o[u]===nn.util.emptyObject&&(o[u]={}),a=i.$namespace[c].decode(t,t.uint32()),o[u][a.$1]=a.$2;else if("["===c.charAt(0)||"<"===c.charAt(0))if(c=c.substring(1),o[u]&&o[u].length||(o[u]=[]),void 0!==sn[c]&&2==(7&s))for(var l=t.uint32()+t.pos;t.pos<l;)o[u].push(cn.$.call(t,c));else o[u].push(cn.$.call(t,c));else o[u]=cn.$.call(t,c)}else t.skipType(7&s)}return o},i.encode=function(t,n){for(var r in n=n||nn.Writer.create(),e){var o=e[r][0];if("{"===(c=e[r][1]).charAt(0)){if(null!=t[o]&&t.hasOwnProperty(o))for(var s=0,a=Object.keys(t[o]);s<a.length;++s)n.uint32((r<<3|2)>>0).fork(),i.$namespace[c].encode({$1:a[s],$2:t[o][a[s]]},n).ldelim()}else if("["===c.charAt(0)||"<"===c.charAt(0)){var u="<"===c.charAt(0),c=c.substring(1),l=t[o];if(null!=l&&l.length)if(u&&void 0!==sn[c]){for(n.uint32((r<<3|2)>>0).fork(),s=0;s<l.length;s++)ln[c].call(n,l[s]);n.ldelim()}else for(s=0;s<l.length;s++)ln.$.call(n,c,l[s],r)}else null!=t[o]&&t.hasOwnProperty(o)&&ln.$.call(n,c,t[o],r)}return n},Object.keys(s).length&&(i.$namespace=t(s,n+"."+r,i.$namespace||{},!0)),i}(e[a].$m,a)}else e[a].$s?r[a]=function(t,e){function r(t,e,n){nn.rpc.Service.call(this,t,e,n)}return((r.prototype=Object.create(nn.rpc.Service.prototype)).constructor=r).create=function(t,e,n){return new r(t,e,n)},Object.keys(t).forEach((function(i){var o=t[i];function s(t,e){return this.rpcCall(s,rn[o[0]],rn[o[1]],t,e)}Object.defineProperty(s,"name",{value:i}),Object.defineProperty(s,"path",{value:n+"."+e}),r.prototype[i]=s})),r}(e[a].$s,a):e[a].$e&&Object.values(e[a].$e).every((function(t){return Number(t)===t}))&&(r[a]=function(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++)n[n[e[r]]=t[e[r]]]=e[r];return n}(e[a].$e));r[a]&&!i&&(rn[n+"."+a]=r[a]),delete e[a].$m,delete e[a].$s,delete e[a].$e,r[a]=t(e[a],n?n+"."+a:a,r[a]||{})}return r}({PB:{liveroom_cs_v3:{AddStreamReq:{$m:{1:["stream_id","bytes",[]],2:["stream_title","bytes",[]],3:["stream_type","uint32",0],4:["stream_attr","bytes",[]],5:["extra_info","bytes",[]],6:["client_req_seq","uint32",0],7:["third_token","bytes",[]],8:["censor_mode","uint32",0],9:["need_gather","uint32",0]}},AddStreamRsp:{$m:{1:["rsp_head","PB.liveroom_cs_v3.RspHead",null],2:["stream_seq","uint32",0],3:["stream_sid","string",""],4:["stream_ver","uint32",0],5:["stream_nid","uint32",0],6:["token_remain_time","uint32",0]}},AnchorInfo:{$m:{1:["id_name","bytes",[]],2:["user_id","uint64",{low:0,high:0,unsigned:!0}],3:["nick_name","bytes",[]]}},BigImData:{$m:{1:["id_name","bytes",[]],2:["nick_name","bytes",[]],3:["role","uint32",0],4:["msg_id","bytes",[]],5:["msg_category","uint32",0],6:["msg_type","uint32",0],7:["msg_content","bytes",[]],8:["msg_timestamp","int64",{low:0,high:0,unsigned:!1}]}},CommonRsp:{$m:{1:["rsp_head","PB.liveroom_cs_v3.RspHead",null]}},DeleteStreamReq:{$m:{1:["stream_sid","string",""],2:["stream_id","bytes",[]],3:["client_req_seq","uint32",0]}},DeleteStreamRsp:{$m:{1:["rsp_head","PB.liveroom_cs_v3.RspHead",null],2:["stream_seq","uint32",0],3:["stream_ver","uint32",0]}},EnterRoomReq:{$m:{1:["net_type","uint32",0],2:["conn_type","uint32",0],3:["room_id","bytes",[]],4:["room_name","bytes",[]],5:["role","uint32",0],6:["third_token","bytes",[]],7:["room_create_flag","uint32",0],8:["user_state_flag","uint32",0],9:["user_count_limit","uint32",0],10:["relate_service","string",""],11:["need_gather_stream","uint32",0],12:["callback_data","bytes",[]],13:["service_flags","uint32",0],14:["license_token","bytes",[]]}},EnterRoomRsp:{$m:{1:["rsp_head","PB.liveroom_cs_v3.RspHead",null],2:["user_session_id","uint64",{low:0,high:0,unsigned:!0}],3:["room_session_id","uint64",{low:0,high:0,unsigned:!0}],4:["user_id","uint64",{low:0,high:0,unsigned:!0}],5:["ret_timestamp","int64",{low:0,high:0,unsigned:!1}],6:["big_im_time_window","uint32",0],7:["liveroom_hb_interval","uint32",0],8:["liveroom_hb_timeout","uint32",0],9:["online_count","uint32",0],10:["anchor_info","PB.liveroom_cs_v3.AnchorInfo",null],11:["userlist_merge_timeout","uint32",0],12:["userlist_interval","uint32",0],13:["token_remain_time","uint32",0],14:["trans_list_seq","uint32",0],15:["trans_channel_list","<PB.liveroom_cs_v3.TransChannel",null],16:["stream_count","uint32",0],17:["stream_list_seq","uint32",0],18:["stream_info_list","<PB.liveroom_cs_v3.StreamInfo",null],19:["stream_fetch_flag","uint32",0],20:["stream_list_push_merge_timeout","uint32",0],21:["stream_list_hb_merge_timeout","uint32",0],22:["relate_result_list","<PB.liveroom_cs_v3.RelateResult",null],23:["gather_list_seq","uint32",0],24:["gather_info_list","<PB.liveroom_cs_v3.GatherInfo",null]}},EnumSignalTransmitResult:{$e:{ok:0,version_err:1}},GatherInfo:{$m:{1:["gather_id","string",""]}},GetGatherListReq:{$m:{}},GetGatherListRsp:{$m:{1:["rsp_head","PB.liveroom_cs_v3.RspHead",null],2:["gather_list_seq","uint32",0],3:["gather_info_list","<PB.liveroom_cs_v3.GatherInfo",null]}},GetImReq:{$m:{1:["msg_id","uint64",{low:0,high:0,unsigned:!0}],2:["sort_type","uint32",0],3:["msg_count","uint32",0]}},GetImRsp:{$m:{1:["rsp_head","PB.liveroom_cs_v3.RspHead",null],2:["server_msg_id","uint64",{low:0,high:0,unsigned:!0}],3:["ret_msg_id","uint64",{low:0,high:0,unsigned:!0}],4:["msg_list","<PB.liveroom_cs_v3.GetImRspImData",null]}},GetImRspImData:{$m:{1:["id_name","bytes",[]],2:["nick_name","bytes",[]],3:["role","uint32",0],4:["msg_id","uint64",{low:0,high:0,unsigned:!0}],5:["msg_category","uint32",0],6:["msg_type","uint32",0],7:["msg_content","bytes",[]],8:["send_time","int64",{low:0,high:0,unsigned:!1}]}},GetStreamListReq:{$m:{}},GetStreamListRsp:{$m:{1:["rsp_head","PB.liveroom_cs_v3.RspHead",null],2:["stream_list_seq","uint32",0],3:["stream_info_list","<PB.liveroom_cs_v3.StreamInfo",null],4:["stream_refresh","uint32",0]}},GetTransReq:{$m:{1:["trans_channel","bytes",[]],2:["trans_list","<PB.liveroom_cs_v3.GetTransReqTransData",null]}},GetTransReqTransData:{$m:{1:["trans_type","bytes",[]],2:["trans_local_seq","uint32",0]}},GetTransRsp:{$m:{1:["rsp_head","PB.liveroom_cs_v3.RspHead",null],2:["trans_channel","bytes",[]],3:["trans_list_seq","uint32",0],4:["trans_list","<PB.liveroom_cs_v3.GetTransRspTransData",null]}},GetTransRspTransData:{$m:{1:["err_code","uint32",0],2:["trans_type","bytes",[]],3:["trans_data","bytes",[]],4:["trans_send_time","int64",{low:0,high:0,unsigned:!1}],5:["trans_seq","uint32",0],6:["id_name","bytes",[]],7:["nick_name","bytes",[]],8:["role","uint32",0]}},GetUserlistReq:{$m:{1:["sort_type","uint32",0],2:["user_index","uint32",0]}},GetUserlistRsp:{$m:{1:["rsp_head","PB.liveroom_cs_v3.RspHead",null],2:["server_user_seq","uint64",{low:0,high:0,unsigned:!0}],3:["server_user_index","int64",{low:0,high:0,unsigned:!1}],4:["ret_user_index","int64",{low:0,high:0,unsigned:!1}],5:["user_base_info_list","<PB.liveroom_cs_v3.UserBaseInfo",null]}},GetUserTransReq:{$m:{1:["trans_channel","bytes",[]],2:["user_trans_list","<PB.liveroom_cs_v3.GetUserTransReqTransData",null]}},GetUserTransReqTransData:{$m:{1:["trans_type","bytes",[]],2:["trans_local_seq","uint32",0]}},GetUserTransRsp:{$m:{1:["rsp_head","PB.liveroom_cs_v3.RspHead",null],2:["trans_channel","bytes",[]],3:["user_trans_list","<PB.liveroom_cs_v3.GetUserTransRspTransData",null]}},GetUserTransRspTransData:{$m:{1:["err_code","uint32",0],2:["trans_type","bytes",[]],3:["trans_data","bytes",[]],4:["trans_send_time","int64",{low:0,high:0,unsigned:!1}],5:["trans_seq","uint32",0],6:["id_name","bytes",[]],7:["nick_name","bytes",[]],8:["role","uint32",0]}},HbReq:{$m:{}},HbRsp:{$m:{1:["rsp_head","PB.liveroom_cs_v3.RspHead",null],2:["ret_timestamp","int64",{low:0,high:0,unsigned:!1}],3:["hb_interval","uint32",0],4:["hb_timeout","uint32",0],5:["stream_seq","uint32",0],6:["user_seq","int64",{low:0,high:0,unsigned:!1}],7:["online_count","uint32",0],8:["big_im_time_window","uint32",0],9:["trans_channel_list","<PB.liveroom_cs_v3.TransChannel",null],10:["user_trans_channel_list","<PB.liveroom_cs_v3.TransChannel",null],11:["stream_refresh","uint32",0],12:["trans_list_seq","uint32",0],13:["gather_list_seq","uint32",0]}},ImData:{$m:{1:["id_name","bytes",[]],2:["nick_name","bytes",[]],3:["role","uint32",0],4:["msg_id","uint64",{low:0,high:0,unsigned:!0}],5:["msg_category","uint32",0],6:["msg_type","uint32",0],7:["msg_content","bytes",[]],8:["send_time","int64",{low:0,high:0,unsigned:!1}]}},LiveroomSessionInfo:{$m:{1:["RoomId","bytes",[]],2:["UserSessionId","uint64",{low:0,high:0,unsigned:!0}],3:["RoomSessionId","uint64",{low:0,high:0,unsigned:!0}],4:["Role","uint32",0]}},PushBigIm:{$m:{1:["msg_list","<PB.liveroom_cs_v3.BigImData",null]}},PushIm:{$m:{1:["server_msg_id","uint64",{low:0,high:0,unsigned:!0}],2:["ret_msg_id","uint64",{low:0,high:0,unsigned:!0}],4:["msg_list","<PB.liveroom_cs_v3.ImData",null]}},PushStartGather:{$m:{1:["gather_id","string",""],2:["gather_seq","uint32",0]}},PushStopGather:{$m:{1:["gather_id","string",""],2:["gather_seq","uint32",0]}},PushStream:{$m:{1:["stream_seq","uint32",0],2:["stream_info_list","<PB.liveroom_cs_v3.PushStreamInfo",null]}},PushStreamInfo:{$m:{1:["stream_id","bytes",[]],2:["stream_sid","string",""],3:["id_name","bytes",[]],4:["nick_name","bytes",[]],5:["stream_title","bytes",[]],6:["stream_ver","uint32",0],7:["stream_attr","bytes",[]],8:["stream_src","uint32",0],9:["stream_state","uint32",0],10:["stream_type","uint32",0],11:["stream_nid","uint32",0],12:["extra_info","bytes",[]],13:["create_time","int64",{low:0,high:0,unsigned:!1}],14:["close_type","uint32",0],15:["need_gather","uint32",0]}},PushTrans:{$m:{1:["id_name","bytes",[]],2:["nick_name","bytes",[]],3:["role","uint32",0],4:["trans_type","bytes",[]],5:["trans_data","bytes",[]],6:["trans_seq","uint32",0],7:["trans_send_time","int64",{low:0,high:0,unsigned:!1}],8:["trans_channel","bytes",[]],9:["trans_list_seq","uint32",0]}},PushUserInfoUpdated:{$m:{1:["server_user_seq","int64",{low:0,high:0,unsigned:!1}],2:["user_action_list","<PB.liveroom_cs_v3.UserAction",null]}},PushUserKickout:{$m:{1:["id_name","bytes",[]],2:["user_session_id","uint64",{low:0,high:0,unsigned:!0}],3:["kickout_reason","int32",0],4:["custom_reason","bytes",[]]}},PushUserLogReport:{$m:{}},PushUserTokenExpire:{$m:{1:["token","string",""],2:["stop_stream_info","PB.liveroom_cs_v3.StopStream",null]}},PushUserTrans:{$m:{1:["id_name","bytes",[]],2:["nick_name","bytes",[]],3:["role","uint32",0],4:["trans_send_time","int64",{low:0,high:0,unsigned:!1}],5:["trans_channel","bytes",[]],6:["trans_seq_list","<PB.liveroom_cs_v3.PushUserTransInfo",null]}},PushUserTransInfo:{$m:{1:["trans_type","bytes",[]],2:["trans_data","bytes",[]],3:["trans_seq","uint32",0]}},QuitRoomReq:{$m:{}},QuitRoomRsp:{$m:{1:["rsp_head","PB.liveroom_cs_v3.RspHead",null]}},RelateResult:{$m:{1:["service","string",""],2:["relate_result","uint32",0]}},RenewTokenReq:{$m:{1:["token","string",""]}},RenewTokenRsp:{$m:{1:["rsp_head","PB.liveroom_cs_v3.RspHead",null],2:["token_remain_time","uint32",0],3:["stop_stream_id_list","<bytes",null]}},RspHead:{$m:{1:["code","uint32",0],2:["message","string",""]}},SendBigImReq:{$m:{1:["msg_list","<PB.liveroom_cs_v3.SendBigImReqMsgData",null]}},SendBigImReqMsgData:{$m:{1:["msg_category","uint32",0],2:["msg_type","uint32",0],3:["msg_content","bytes",[]],4:["msg_timestamp","int64",{low:0,high:0,unsigned:!1}],5:["msg_client_id","bytes",[]]}},SendBigImRsp:{$m:{1:["rsp_head","PB.liveroom_cs_v3.RspHead",null],2:["big_im_time_window","uint32",0],3:["msg_list","<PB.liveroom_cs_v3.SendBigImRspMsgData",null]}},SendBigImRspMsgData:{$m:{1:["msg_id","bytes",[]],2:["msg_client_id","bytes",[]]}},SendImReq:{$m:{1:["msg_category","uint32",0],2:["msg_type","uint32",0],3:["msg_content","bytes",[]],4:["to_user_list","<PB.liveroom_cs_v3.ToUser",null]}},SendImRsp:{$m:{1:["rsp_head","PB.liveroom_cs_v3.RspHead",null],2:["msg_id","uint64",{low:0,high:0,unsigned:!0}]}},SetTransReq:{$m:{1:["trans_type","bytes",[]],2:["trans_data","bytes",[]],3:["trans_local_seq","uint32",0],4:["trans_channel","bytes",[]]}},SetTransRsp:{$m:{1:["rsp_head","PB.liveroom_cs_v3.RspHead",null],2:["trans_type","bytes",[]],3:["trans_seq","uint32",0],4:["trans_list_seq","uint32",0],5:["trans_channel","bytes",[]]}},SetUserAttrReq:{$m:{1:["use_data_channel","uint32",0],2:["is_modify_use_data_channel","bool",!1],3:["user_type","uint32",0],4:["is_modify_user_type","bool",!1]}},SetUserAttrRsp:{$m:{1:["rsp_head","PB.liveroom_cs_v3.RspHead",null]}},SignalLiveCustomReq:{$m:{1:["push_message","bytes",[]],2:["to_user_list","<PB.liveroom_cs_v3.ToUser",null]}},SignalLiveCustomRsp:{$m:{1:["rsp_head","PB.liveroom_cs_v3.RspHead",null]}},SignalLiveInviteReq:{$m:{1:["push_message","bytes",[]],2:["to_user_list","<PB.liveroom_cs_v3.ToUser",null]}},SignalLiveInviteRsp:{$m:{1:["rsp_head","PB.liveroom_cs_v3.RspHead",null]}},SignalLiveRequestReq:{$m:{1:["push_message","bytes",[]],2:["to_user_list","<PB.liveroom_cs_v3.ToUser",null]}},SignalLiveRequestRsp:{$m:{1:["rsp_head","PB.liveroom_cs_v3.RspHead",null]}},SignalLiveResultReq:{$m:{1:["push_message","bytes",[]],2:["to_user_list","<PB.liveroom_cs_v3.ToUser",null]}},SignalLiveResultRsp:{$m:{1:["rsp_head","PB.liveroom_cs_v3.RspHead",null]}},SignalLiveStopReq:{$m:{1:["push_message","bytes",[]],2:["to_user_list","<PB.liveroom_cs_v3.ToUser",null]}},SignalLiveStopRsp:{$m:{1:["rsp_head","PB.liveroom_cs_v3.RspHead",null]}},SignalTransmitReq:{$m:{1:["to_user_list","<bytes",null],2:["transmit_data","bytes",[]]}},SignalTransmitResult:{$m:{1:["to_user","bytes",[]],2:["result","PB.liveroom_cs_v3.EnumSignalTransmitResult",0]}},SignalTransmitRsp:{$m:{1:["rsp_head","PB.liveroom_cs_v3.RspHead",null],2:["result","<PB.liveroom_cs_v3.SignalTransmitResult",null]}},StopStream:{$m:{1:["stream_id_list","<bytes",null]}},StreamInfo:{$m:{1:["stream_id","bytes",[]],2:["stream_sid","string",""],3:["id_name","bytes",[]],4:["nick_name","bytes",[]],5:["stream_title","bytes",[]],6:["stream_ver","uint32",0],7:["stream_attr","bytes",[]],8:["create_time","int64",{low:0,high:0,unsigned:!1}],9:["stream_src","uint32",0],10:["stream_state","uint32",0],11:["stream_type","uint32",0],12:["stream_nid","uint32",0],13:["extra_info","bytes",[]],14:["need_gather","uint32",0]}},ToUser:{$m:{1:["id_name","bytes",[]],2:["user_id","uint64",{low:0,high:0,unsigned:!0}]}},TransChannel:{$m:{1:["trans_channel","bytes",[]],2:["trans_seq_list","<PB.liveroom_cs_v3.TransSeq",null]}},TransSeq:{$m:{1:["trans_type","bytes",[]],2:["trans_seq","uint32",0]}},UpdateStreamReq:{$m:{1:["stream_sid","string",""],2:["stream_id","bytes",[]],3:["stream_title","bytes",[]],4:["stream_attr","bytes",[]],5:["extra_info","bytes",[]],6:["client_req_seq","uint32",0],7:["nick_name","bytes",[]]}},UpdateStreamRsp:{$m:{1:["rsp_head","PB.liveroom_cs_v3.RspHead",null],2:["stream_seq","uint32",0],3:["stream_ver","uint32",0]}},UserAction:{$m:{1:["action","uint32",0],2:["id_name","bytes",[]],3:["nick_name","bytes",[]],4:["role","uint32",0],5:["login_time","int64",{low:0,high:0,unsigned:!1}]}},UserBaseInfo:{$m:{1:["id_name","bytes",[]],2:["nick_name","bytes",[]],3:["role","uint32",0]}}},proto_switch_v3:{AnchorInfo:{$m:{1:["id_name","bytes",[]],2:["user_id","uint64",{low:0,high:0,unsigned:!0}],3:["nick_name","bytes",[]]}},CommonRsp:{$m:{1:["rsp_head","PB.proto_switch_v3.RspHead",null]}},GatherInfo:{$m:{1:["gather_id","string",""]}},Header:{$m:{1:["cmd","uint32",0],2:["seq","uint32",0],3:["timestamp","int64",{low:0,high:0,unsigned:!1}],4:["controls","bytes",[]],5:["flags","bytes",[]],6:["context_key","uint32",0],101:["dev_traffic_label","bytes",[]]}},LiveroomProtoVersion:{$e:{PROTO_VERSION_NONE:0,RPOTO_V020000:131072}},LoginRoomReq:{$m:{1:["app_id","uint32",0],2:["biz_type","uint32",0],3:["room_id","bytes",[]],4:["room_name","bytes",[]],5:["role","uint32",0],6:["id_name","bytes",[]],7:["nick_name","bytes",[]],8:["device_id","string",""],9:["term_type","PB.proto_switch_v3.TermType",0],10:["net_type","PB.proto_switch_v3.NetType",0],11:["sdk_conn_type","PB.proto_switch_v3.SdkConnType",0],12:["sdk_version","uint32",0],13:["biz_version","string",""],14:["client_stamp","bytes",[]],15:["login_logic","uint32",0],16:["third_token","bytes",[]],17:["login_token","bytes",[]],18:["relogin_token","bytes",[]],19:["switch_session_id","uint64",{low:0,high:0,unsigned:!0}],20:["user_session_id","uint64",{low:0,high:0,unsigned:!0}],21:["room_create_flag","uint32",0],22:["user_state_flag","uint32",0],23:["user_count_limit","uint32",0],24:["relate_service","string",""],25:["need_gather_stream","uint32",0],26:["callback_data","bytes",[]],27:["service_flags","uint32",0],28:["license_token","bytes",[]]}},LoginRoomRsp:{$m:{1:["rsp_head","PB.proto_switch_v3.RspHead",null],2:["switch_session_id","uint64",{low:0,high:0,unsigned:!0}],3:["user_session_id","uint64",{low:0,high:0,unsigned:!0}],4:["room_session_id","uint64",{low:0,high:0,unsigned:!0}],5:["user_id","uint64",{low:0,high:0,unsigned:!0}],6:["ret_timestamp","int64",{low:0,high:0,unsigned:!1}],7:["big_im_time_window","uint32",0],8:["liveroom_hb_interval","uint32",0],9:["liveroom_hb_timeout","uint32",0],10:["online_count","uint32",0],11:["anchor_info","PB.proto_switch_v3.AnchorInfo",null],12:["relogin_token","bytes",[]],13:["userlist_merge_timeout","uint32",0],14:["userlist_interval","uint32",0],15:["token_remain_time","uint32",0],16:["trans_list_seq","uint32",0],17:["trans_channel_list","<PB.proto_switch_v3.TransChannel",null],18:["stream_count","uint32",0],19:["stream_list_seq","uint32",0],20:["stream_info_list","<PB.proto_switch_v3.StreamInfo",null],21:["stream_fetch_flag","uint32",0],22:["stream_list_push_merge_timeout","uint32",0],23:["stream_list_hb_merge_timeout","uint32",0],24:["relate_result_list","<PB.proto_switch_v3.RelateResult",null],25:["gather_list_seq","uint32",0],26:["gather_info_list","<PB.proto_switch_v3.GatherInfo",null]}},LogoutRoomReq:{$m:{1:["logout_code","uint32",0],2:["logout_check","bytes",[]],3:["user_session_id","uint64",{low:0,high:0,unsigned:!0}],4:["logout_logic","uint32",0]}},LogoutRoomRsp:{$m:{1:["rsp_head","PB.proto_switch_v3.RspHead",null]}},MergePushHead:{$m:{1:["qos_flag","uint32",0],2:["send_time","int64",{low:0,high:0,unsigned:!1}]}},MergePushInfo:{$m:{1:["sub_cmd","uint32",0],2:["sub_seq","uint32",0],3:["msg_body","bytes",[]]}},MergePushReq:{$m:{1:["head","PB.proto_switch_v3.MergePushHead",null],2:["message_list","<PB.proto_switch_v3.MergePushInfo",null]}},MergePushRsp:{$m:{1:["message_list","<PB.proto_switch_v3.MergePushRspInfo",null],2:["server_send_time","int64",{low:0,high:0,unsigned:!1}]}},MergePushRspInfo:{$m:{1:["sub_cmd","uint32",0],2:["sub_seq","uint32",0]}},NetType:{$e:{NT_NONE:0,NT_LINE:1,NT_WIFI:2,NT_2G:3,NT_3G:4,NT_4G:5,NT_UNKNOWN:32}},PushKickout:{$m:{1:["reason","uint32",0],2:["message","string",""],3:["is_need_relogin","uint32",0]}},PushReq:{$m:{1:["head","PB.proto_switch_v3.PushReqHead",null],2:["msg_body","bytes",[]]}},PushReqHead:{$m:{1:["sub_cmd","uint32",0],2:["qos_flag","uint32",0],3:["send_time","int64",{low:0,high:0,unsigned:!1}]}},PushRsp:{$m:{1:["code","uint32",0],2:["message","string",""],3:["sub_cmd","uint32",0],4:["server_send_time","int64",{low:0,high:0,unsigned:!1}]}},RelateResult:{$m:{1:["service","string",""],2:["relate_result","uint32",0]}},RspHead:{$m:{1:["code","uint32",0],2:["message","string",""]}},SdkConnType:{$e:{SdkConnType_None:0,SdkConnType_Tcp:1,SdkConnType_Websocket:2}},StreamInfo:{$m:{1:["stream_id","bytes",[]],2:["stream_sid","string",""],3:["id_name","bytes",[]],4:["nick_name","bytes",[]],5:["create_time","int64",{low:0,high:0,unsigned:!1}],6:["extra_info","bytes",[]],7:["title","bytes",[]],8:["stream_ver","uint32",0],9:["stream_attr","bytes",[]],10:["stream_src","uint32",0],11:["stream_state","uint32",0],12:["stream_type","uint32",0],13:["stream_nid","uint32",0],14:["need_gather","uint32",0]}},TermType:{$e:{TT_NONE:0,TT_PC:1,TT_IOS:2,TT_ANDROID:3,TT_MAC:4,TT_LINUX:5,TT_WEB:6,TT_MINI_PROGRAM:7,TT_UNKNOWN:32}},TransChannel:{$m:{1:["trans_channel","bytes",[]],2:["trans_seq_list","<PB.proto_switch_v3.TransSeq",null]}},TransSeq:{$m:{1:["trans_type","bytes",[]],2:["trans_seq","uint32",0]}}}}},"",rn,!1),nn.util.global.PB=rn.PB,e=rn.PB;var fn,dn={1002:"LoginRoomRsp",1004:"LogoutRoomRsp",1101:"PushReq",1103:"MergePushReq",1105:"PushKickout",10001:"PushUserInfoUpdated",10002:"PushUserKickout",10003:"PushUserLogReport",10004:"PushUserTokenExpire",12001:"PushStream",12002:"PushStream",12003:"PushStream",13001:"PushIm",14001:"PushBigIm",15001:"PushTrans",15002:"PushUserTrans",301002:"EnterRoomRsp",301004:"QuitRoomRsp",301006:"HbRsp",301008:"RenewTokenRsp",301012:"SetTransRsp",301014:"GetTransRsp",302002:"AddStreamRsp",302004:"DeleteStreamRsp",302006:"UpdateStreamRsp",302008:"GetStreamListRsp",303002:"SendImRsp",303006:"SendBigImRsp",303010:"SignalLiveRequestRsp",303012:"SignalLiveResultRsp",303014:"SignalLiveInviteRsp",303016:"SignalLiveStopRsp",303018:"SignalLiveCustomRsp",304002:"GetUserlistRsp"},pn=((pn=fn=fn||{})[pn.LoginRoomReq=1001]="LoginRoomReq",pn[pn.LoginRoomRsp=1002]="LoginRoomRsp",pn[pn.LogoutRoomReq=1003]="LogoutRoomReq",pn[pn.LogoutRoomRsp=1004]="LogoutRoomRsp",pn[pn.PushReq=1101]="PushReq",pn[pn.PushRsp=1102]="PushRsp",pn[pn.MergePushReq=1103]="MergePushReq",pn[pn.MergePushRsp=1104]="MergePushRsp",pn[pn.PushKickout=1105]="PushKickout",pn[pn.PushUserInfoUpdated=10001]="PushUserInfoUpdated",pn[pn.PushUserKickout=10002]="PushUserKickout",pn[pn.PushUserLogReport=10003]="PushUserLogReport",pn[pn.PushUserTokenExpire=10004]="PushUserTokenExpire",pn[pn.PushIm=13001]="PushIm",pn[pn.PushBigIm=14001]="PushBigIm",pn[pn.PushTrans=15001]="PushTrans",pn[pn.PushUserTrans=15002]="PushUserTrans",pn[pn.EnterRoomReq=301001]="EnterRoomReq",pn[pn.EnterRoomRsp=301002]="EnterRoomRsp",pn[pn.QuitRoomReq=301003]="QuitRoomReq",pn[pn.QuitRoomRsp=301004]="QuitRoomRsp",pn[pn.HbReq=301005]="HbReq",pn[pn.HbRsp=301006]="HbRsp",pn[pn.RenewTokenReq=301007]="RenewTokenReq",pn[pn.RenewTokenRsp=301008]="RenewTokenRsp",pn[pn.SetUserAttrReq=301009]="SetUserAttrReq",pn[pn.SetUserAttrRsp=301010]="SetUserAttrRsp",pn[pn.SetTransReq=301011]="SetTransReq",pn[pn.SetTransRsp=301012]="SetTransRsp",pn[pn.GetTransReq=301013]="GetTransReq",pn[pn.GetTransRsp=301014]="GetTransRsp",pn[pn.GetUserTransReq=301015]="GetUserTransReq",pn[pn.GetUserTransRsp=301016]="GetUserTransRsp",pn[pn.AddStreamReq=302001]="AddStreamReq",pn[pn.AddStreamRsp=302002]="AddStreamRsp",pn[pn.DeleteStreamReq=302003]="DeleteStreamReq",pn[pn.DeleteStreamRsp=302004]="DeleteStreamRsp",pn[pn.UpdateStreamReq=302005]="UpdateStreamReq",pn[pn.UpdateStreamRsp=302006]="UpdateStreamRsp",pn[pn.GetStreamListReq=302007]="GetStreamListReq",pn[pn.GetStreamListRsp=302008]="GetStreamListRsp",pn[pn.SendImReq=303001]="SendImReq",pn[pn.SendImRsp=303002]="SendImRsp",pn[pn.GetImReq=303003]="GetImReq",pn[pn.GetImRsp=303004]="GetImRsp",pn[pn.SendBigImReq=303005]="SendBigImReq",pn[pn.SendBigImRsp=303006]="SendBigImRsp",pn[pn.SignalLiveRequestReq=303009]="SignalLiveRequestReq",pn[pn.SignalLiveRequestRsp=303010]="SignalLiveRequestRsp",pn[pn.SignalLiveResultReq=303011]="SignalLiveResultReq",pn[pn.SignalLiveResultRsp=303012]="SignalLiveResultRsp",pn[pn.SignalLiveInviteReq=303013]="SignalLiveInviteReq",pn[pn.SignalLiveInviteRsp=303014]="SignalLiveInviteRsp",pn[pn.SignalLiveStopReq=303015]="SignalLiveStopReq",pn[pn.SignalLiveStopRsp=303016]="SignalLiveStopRsp",pn[pn.SignalLiveCustomReq=303017]="SignalLiveCustomReq",pn[pn.SignalLiveCustomRsp=303018]="SignalLiveCustomRsp",pn[pn.SignalTransmitReq=303019]="SignalTransmitReq",pn[pn.SignalTransmitRsp=303020]="SignalTransmitRsp",pn[pn.GetUserlistReq=304001]="GetUserlistReq",pn[pn.GetUserlistRsp=304002]="GetUserlistRsp",n(2)),gn=n(12),_n=n.n(gn),mn=(gn=n(4),n.n(gn)),vn=(yn.prototype.md5Bytes=function(t){return this.wordArray2Uint8Array(mn()(this.uint8Array2WordArray(t)))},yn.prototype.wordArray2Uint8Array=function(t){for(var e=t.words,n=t.sigBytes,r=new Uint8Array(n),i=0;i<n;i++)r[i]=e[i>>>2]>>>24-i%4*8&255;return r},yn.prototype.uint8Array2WordArray=function(t){for(var e=t.length,n=[],r=0;r<e;r++)n[r>>>2]|=(255&t[r])<<24-r%4*8;return _n.a.create(n,e)},yn);function yn(){}function bn(t){var e=unescape||window.unescape;return Uint8Array.from(Array.from(e(encodeURIComponent(t))).map((function(t){return t.charCodeAt(0)})))}function Sn(t){var e=escape||window.escape;return decodeURIComponent(e(String.fromCharCode.apply(String,Array.from(t))))}gn=n(0);var En,Tn=n.n(gn),Cn=function(){return(Cn=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},wn=(pn.util.Long=Tn.a,pn.configure(),e),Rn=e.liveroom_cs_v3,In=e.proto_switch_v3,kn=((gn=En=En||{})[gn.disconnected=0]="disconnected",gn[gn.broken=1]="broken",gn[gn.connected=2]="connected",Object.defineProperty(On.prototype,"nickName",{get:function(){return bn(this.stateCenter.nickName)},enumerable:!1,configurable:!0}),Object.defineProperty(On.prototype,"TermType",{get:function(){return this.stateCenter.ENV%2==0?o.TT_WEB:o.TT_MINIPROGRAM},enumerable:!1,configurable:!0}),On.prototype.isDisConnect=function(){return this.state!==En.connected},On.prototype.getHeader=function(t,e){return t={cmd:t,seq:++this.seq,timestamp:(new Date).getTime()},this.controls&&(t.controls=this.controls),null!=e&&e.contextKey&&(t.context_key=null==e?void 0:e.contextKey),e=In.Header.create(t),e=In.Header.encode(e).finish(),[t.seq,e]},On.prototype.isUaConnect=function(){return this.ua.isConnect()},On.prototype.sendMessage=function(t,e,n,r,i,o,s){var a=this;if(void 0===o&&(o={timeout:6e3}),void 0===s&&(s=!0),this.logger.info(At+" call"),"LoginRoomReq"!==t&&this.state!==En.connected)return this.logger.warn(At+" state "+this.state),-1;if("number"==typeof t)l=t;else if(void 0===(l=fn[t]))return this.logger.warn(At+" cmd not found "+t),-1;var u=0,c=void 0!==(null==i?void 0:i.roomID)?null==i?void 0:i.roomID:null==(c=this.stateCenter.roomModulesList[0])?void 0:c.roomID,l=("LoginRoomReq"!==t&&c&&(u=this.roomIDKeys[c]),c=this.getHeader(l,{contextKey:u}))[1];return e=this.getHead(l.length,(u=e).length),e=new Uint8Array(Array.from(e).concat(Array.from(l)).concat(Array.from(u))),s&&(l={seq:this.seq,deleted:!1,sendTime:Date.parse(new Date+""),timeout:o.timeout,success:n,error:function(t,e,n){var i;if(a.logger.info(At+" seq: "+e+" "+JSON.stringify(t)+" "+JSON.stringify(n)),(null==(i=null==t?void 0:t.header)?void 0:i.cmd)!==fn.LoginRoomRsp&&-1<[1002,105].indexOf(null==(i=null==t?void 0:t.body)?void 0:i.err_code))return(null==(i=null==t?void 0:t.header)?void 0:i.cmd)===fn.EnterRoomRsp&&null!=n&&n.roomID?(i=a.stateCenter.roomModulesList.find((function(t){return t.roomID==n.roomID})))?void i.retryRoom():void a.logger.error(At+" room no found ignore "):void a.rtm.retryRoom();[207,208].indexOf(null==(i=null==t?void 0:t.body)?void 0:i.err_code),r&&r(t,e)},params:i},u=this.sendCommandList.push(l),this.sendCommandMap[l.seq]=u),this.logger.info(At+" seq: "+c[0]+" cmd: "+t),null!=(s=this.liveroomRequest)&&s.sendRequest({payload:e,ack:"LoginRoomReq"===t},(function(t){a.logger.info(At+" fail")}),(function(){a.logger.info(At+" ack")}),{}),c[0]},On.prototype.getHead=function(t,e){var n=new Uint8Array(7);return n[0]=49,n[1]=t>>8,n[2]=t-(n[1]<<8),n.set(new Uint8Array(Int32Array.from([e]).buffer).reverse(),3),n},On.prototype.handlePush=function(t,e){var n,r,i;49===t[0]&&(n=In.Header.decode(t.slice(7,7+(i=(t[1]<<8)+t[2]))),t=t.slice(7+i),dn[n.cmd]?(i=this.decodeResponseBody(n,t),this.swPushCmdList.includes(n.cmd)?this.handleSwitchPush(n,i):(this.logger.info("zm.lrh.hp down "+(r=dn[n.cmd]||n.cmd)+" "+JSON.stringify(this.transBuf(i))),r={header:this.transHeader(n),body:this.transRsp(i)},void 0!==(i=this.roomKeyIDs[n.context_key])&&(r.header.room_id=i),this.handleSendCommandMsgRsp(r))):(this.logger.info("zm.lrh.hp cmd is not rtc"),this.onSwitchMessage(n,t)))},On.prototype.handleSwitchPush=function(t,e){var n,r,i=this.roomKeyIDs[t.context_key];if(i||this.noContextKeyCmdList.includes(t.cmd))if(t.cmd===fn.PushReq)if((r=this.transRsp(e.head)).room_id=i,this.stateCenter.roomModulesList.find((function(t){return t.roomID==i}))){var o,s,a={header:r,body:this.unStructCmdList.includes(e.head.sub_cmd)?{signal_msg:Sn(e.msg_body),sub_cmd:e.head.sub_cmd}:11005===e.head.sub_cmd?{custommsg:Sn(e.msg_body)}:dn[e.head.sub_cmd]?this.transRsp(this.decode(Rn[dn[e.head.sub_cmd]],e.msg_body)):{}};if(this.logger.info(Lt+" push "+JSON.stringify(this.transBuf(a))),this.rtcPushCmdList.includes(e.head.sub_cmd))switch(e.head.sub_cmd){case fn.PushUserInfoUpdated:this.handlePushUserStateUpdateMsg(a);break;case fn.PushUserKickout:this.transKeysName(a.body,this.loginKeyTransMap),this.handlePushKickout(a,!1);break;case fn.PushTrans:this.handlePushTransMsg(a);break;case fn.PushIm:this.handlePushRoomMsg(a);break;case 11005:this.handlePushCustomMsg(a);break;case 12001:case 12002:case 12003:this.handlePushStreamMsg(a);break;case 11001:case 11002:case 11003:case 11004:this.handlePushSignalMsg(a);break;case fn.PushUserTokenExpire:this.handlePushTokenExpire(a)}else this.logger.info(Lt+" white "),this.onSwitchMessage(t,e);1==e.head.qos_flag&&(o=In.PushRsp.create({code:0,message:"",sub_cmd:e.head.sub_cmd,server_send_time:e.head.send_time}),s=In.PushRsp.encode(o).finish(),this.sendMessage("PushRsp",s,void 0,void 0))}else this.logger.warn(Lt+" room no found ignore ");else t.cmd===fn.MergePushReq?((r=this.transRsp(e.head)).room_id=i,this.stateCenter.roomModulesList.find((function(t){return t.roomID==i}))?(n=[],e.message_list.forEach((function(t){var e;n.push({sub_cmd:t.sub_cmd,sub_seq:t.sub_seq}),t.sub_cmd===fn.PushBigIm&&(e=Rn.PushBigIm.decode(t.msg_body),t.msg_body=e)})),delete(r={header:r,body:this.transRsp(e)}).body.head,this.handlePushMergeMsg(r),1==e.head.qos_flag&&(o=In.MergePushRsp.create({messages:n,server_send_time:e.head.send_time}),s=In.MergePushRsp.encode(o).finish(),this.sendMessage("MergePushRsp",s,void 0,void 0))):this.logger.warn(Lt+" room no found ignore ")):t.cmd===fn.PushKickout&&this.handlePushKickout({header:t,body:{reason:900<e.reason?e.reason-900:e.reason,msg:e.message,need_relogin:void 0!==e.is_need_relogin?e.is_need_relogin:0}},!0);else this.logger.warn(Lt+" ctx key not found")},On.prototype.handlePushTokenExpire=function(t){},On.prototype.handlePushKickout=function(t,e){},On.prototype.handlePushStreamMsg=function(t){},On.prototype.handlePushSignalMsg=function(t){},On.prototype.handlePushMergeMsg=function(t){},On.prototype.handlePushCustomMsg=function(t){},On.prototype.handlePushRoomMsg=function(t){},On.prototype.handlePushTransMsg=function(t){},On.prototype.onSwitchMessage=function(t,e){},On.prototype.decodeResponseBody=function(t,e){var n=this.onSwitchCmdList.includes(t.cmd)?"proto_switch_v3":"liveroom_cs_v3";return this.decode(this.protoInstance[n][dn[t.cmd]],e)},On.prototype.handlePushUserStateUpdateMsg=function(t){},On.prototype.login=function(t,e,n){var r,i,o,s=this,a=(this.state==En.disconnected&&(this.logger.info(Pt+" state disconnect"),this.closeRequest()),(new Date).getTime()+""),u={net_type:G.getNetTypeNum(),room_id:bn(t.roomID),room_name:bn(t.roomName),nick_name:this.nickName,role:this.stateCenter.role,third_token:bn(t.token),room_create_flag:this.stateCenter.roomCreateFlag,user_state_flag:t.userStateUpdate?1:0,user_count_limit:t.maxMemberCount,relate_service:this.stateCenter.relateService.join()||""};t.isMulti?(i=Cn(Cn({},u),{conn_type:2}),r=Cn(Cn({},i),{room_id:t.roomID,room_name:t.roomName,third_token:t.token}),this.logger.info(Pt+" enter "+JSON.stringify(r)),i=Rn.EnterRoomReq.create(i),o=Rn.EnterRoomReq.encode(i).finish(),this.sendMessage("EnterRoomReq",o,(function(n,r){s.transLoginRspKeys(n,t),e&&e(n,r)}),(function(t,e){n&&n(t,e)}),{roomID:t.roomID})):(u=Cn(Cn({},u),{app_id:this.stateCenter.appid,id_name:bn(this.stateCenter.idName),device_id:this.stateCenter.deviceID,term_type:this.TermType,sdk_version:this.getNumSDKVersion(),client_stamp:bn(a),relogin_token:this.switchSessionID.notEquals(Tn.a.fromInt(0))?bn(this.reloginToken):"",switch_session_id:this.switchSessionID,user_session_id:null!=(u=t.longSid)?u:Tn.a.fromInt(0),biz_type:0,biz_version:this.stateCenter.bizVersion||"",login_logic:this.stateCenter.isMultiRoom?3:1,sdk_conn_type:2}),r=Cn(Cn({},u),{id_name:this.stateCenter.idName,nick_name:this.stateCenter.nickName,client_stamp:a,k1_sign:void 0,relogin_token:this.reloginToken,room_id:t.roomID,room_name:t.roomName,third_token:t.token,user_session_id:t.longSid}),this.logoutCheckToken=t.token,this.logger.info(Pt+" login "+JSON.stringify(r)),i=In.LoginRoomReq.create(u),o=In.LoginRoomReq.encode(i).finish(),this.sendMessage("LoginRoomReq",o,(function(n,r){var i;s.logger.info(Pt+" login rsp"),s.switchSessionID=n.body.switch_session_id,s.reloginToken=n.body.relogin_token,null!=(i=null==n?void 0:n.header)&&i.controls&&(s.controls=null==(i=null==n?void 0:n.header)?void 0:i.controls),s.transLoginRspKeys(n,t),e&&e(n,r)}),(function(t,e){n&&n(t,e)})))},On.prototype.transLoginRspKeys=function(t,e){null!=(n=t.header)&&n.context_key&&(this.roomIDKeys[e.roomID]=null==(n=t.header)?void 0:n.context_key,this.roomKeyIDs[null==(n=t.header)?void 0:n.context_key]=e.roomID,t.header.room_id=e.roomID),this.longToStringNumber(t.body,["ret_timestamp"],"toString"),this.transKeysName(t.body,this.loginKeyTransMap),this.keysExist(t.body,["token_remain_time","stream_seq"]);var n={anchor_id_name:t.body.anchor_info.id_name,anchor_id:t.body.anchor_info.user_id,anchor_nick_name:t.body.anchor_info.nick_name};t.body.anchor_info=n},On.prototype.transKeysName=function(t,e){e.forEach((function(e){void 0!==t[e[0]]&&(t[e[1]]=t[e[0]],delete t[e[0]])}))},On.prototype.keysExist=function(t,e){e.forEach((function(e){void 0===t[e]&&(t[e]=0)}))},On.prototype.longToStringNumber=function(t,e,n){e.forEach((function(e){Tn.a.isLong(t[e])&&(t[e]=t[e][n]())}))},On.prototype.logout=function(t,e,n){var r,i,o,s;return t.isMulti?(r={},this.logger.info(Dt+" quit "+t.roomID),o=Rn.QuitRoomReq.create(r),s=Rn.QuitRoomReq.encode(o).finish(),this.sendMessage("QuitRoomReq",s,e,n,{roomID:null==t?void 0:t.roomID})):(r={logout_code:0,logout_check:this.crypto.md5Bytes(bn(this.logoutCheckToken)),user_session_id:t.longSid,logout_logic:this.stateCenter.isMultiRoom?3:1},i=this.transBuf(r),this.logger.info(Dt+" logout "+JSON.stringify(i)),o=In.LogoutRoomReq.create(r),s=In.LogoutRoomReq.encode(o).finish(),this.sendMessage("LogoutRoomReq",s,e,n,{roomID:null==t?void 0:t.roomID}))},On.prototype.checkSendMessageList=function(t){for(var e=t.getFirst();null!=e;)t.remove(e),e._data&&e._data.error&&setTimeout((function(){e&&e._data&&e._data.error&&e._data.error(O.TIMEOUT,e._data.seq)}),0),e=t.getFirst()},On.prototype.checkMessageListTimeout=function(t,e){for(var n=t.getFirst(),r=Date.parse(new Date+""),i=0,o=this;null!=n&&"break"!==function(){var s,a;return n._data&&n._data.sendTime+n._data.timeout>r||(n._data&&delete e[n._data.seq],t.remove(n),n._data&&null==n._data.error||n._data&&n._data.sendTime+o.sendDataDropTimeout<r||(s=n&&n._data&&n._data.error,a=n&&n._data&&n._data.seq,setTimeout((function(){s&&s(O.TIMEOUT,a)}),0)),++i>=o.sendDataCheckOnceCount)?"break":void(n=t.getFirst())}(););},On.prototype.startCheck=function(){var t=this;this.checkMessageListTimeout(this.sendCommandList,this.sendCommandMap),this.sendDataCheckTimer=setTimeout((function(){t.startCheck()}),this.sendDataCheckInterval)},On.prototype.stopCheck=function(){this.checkSendMessageList(this.sendCommandList),clearTimeout(this.sendDataCheckTimer)},On.prototype.handleSendCommandMsgRsp=function(t){var e,n,r=this.sendCommandMap[t.header.seq];null!=r&&(n=null==(e=r._data)?void 0:e.params,delete this.sendCommandMap[t.header.seq],this.sendCommandList.remove(r),0===t.body.err_code?setTimeout((function(){e&&null!=e.success&&e.success(t,t.header.seq)}),0):setTimeout((function(){e&&null!=e.error&&e.error(t,t.header.seq,n)}),0))},On.prototype.getReqHead=function(t){return{}},On.prototype.heartBeat=function(t,e,n){var r=this,i=Rn.HbReq.create({});i=Rn.HbReq.encode(i).finish(),this.sendMessage("HbReq",i,(function(e,n){r.transKeysName(e.body,[["hb_interval","hearbeat_interval"],["hb_timeout","hearbeat_timeout"],["big_im_time_window","bigim_time_window"],["trans_channel_list","trans_seqs"]]),e.body.server_user_seq=e.body.user_seq.toNumber(),r.longToStringNumber(e.body,["ret_timestamp"],"toNumber"),t&&t(e,n)}),e,{roomID:null==n?void 0:n.roomID})},On.prototype.fetchUserList=function(t,e,n,r){var i=this,o=(t=Cn({},t),this.transBuf(t));return this.logger.info(Mt+" "+JSON.stringify(o)),o=Rn.GetUserlistReq.create(t),t=Rn.GetUserlistReq.encode(o).finish(),this.sendMessage("GetUserlistReq",t,(function(t,n){i.logger.info(Mt+" suc "+n),i.transKeysName(t.body,[["user_base_info_list","user_baseinfos"]]),i.longToStringNumber(t.body,["server_user_seq","server_user_index","ret_user_index"],"toNumber"),e&&e(t,n)}),n,{roomID:null==r?void 0:r.roomID})},On.prototype.sendRoomMsg=function(t,e,n,r){var i=this,o=(t={msg_category:t.msg_category,msg_type:t.msg_type,msg_content:bn(t.msg_content)},this.transBuf(t));return this.logger.info("zm.lrh.srm.1 "+JSON.stringify(o)),o=Rn.SendImReq.create(t),t=Rn.SendImReq.encode(o).finish(),this.sendMessage("SendImReq",t,(function(t,n){i.longToStringNumber(t.body,["msg_id"],"toNumber"),e&&e(t,n)}),n,{roomID:null==r?void 0:r.roomID})},On.prototype.sendReliableMessage=function(t,e,n,r){t={trans_type:bn(t.trans_type),trans_data:bn(t.trans_data),trans_local_seq:t.trans_local_seq,trans_channel:bn(t.trans_channel)};var i=this.transBuf(t);return this.logger.info("zm.lrh.srm.0 "+JSON.stringify(i)),i=Rn.SetTransReq.create(t),t=Rn.SetTransReq.encode(i).finish(),this.sendMessage("SetTransReq",t,e,n,{roomID:null==r?void 0:r.roomID})},On.prototype.fetchReliableMessage=function(t,e,n,r){var i=t.fetch_array.map((function(t){return{trans_type:bn(t.trans_type),trans_local_seq:t.trans_seq}}));return t={trans_channel:bn(t.trans_channel),trans_list:i},i=this.transBuf(t),this.logger.info("zm.lrh.frm "+JSON.stringify(i)),i=Rn.GetTransReq.create(t),t=Rn.GetTransReq.encode(i).finish(),this.sendMessage("GetTransReq",t,e,n,{roomID:null==r?void 0:r.roomID})},On.prototype.sendCustomCommand=function(t,e,n,r){var i=this,o=t.dest_id_name.map((function(t){return{id_name:bn(t)}}));return o=Cn({to_user_list:o,push_message:bn(t.custom_msg)},t),t=this.transBuf(o),this.logger.info("zm.lrh.scc "+JSON.stringify(t)),t=Rn.SignalLiveCustomReq.create(o),o=Rn.SignalLiveCustomReq.encode(t).finish(),this.sendMessage("SignalLiveCustomReq",o,(function(t,n){e&&e(i.transRsp(t),n)}),(function(t,e){n&&n(t,e)}),{roomID:null==r?void 0:r.roomID})},On.prototype.sendBigRoomMessage=function(t,e,n,r){t={msg_list:t.msgs.map((function(t){return{msg_category:t.msg_category,msg_type:t.msg_type,msg_timestamp:Tn.a.fromNumber(Date.now()),msg_content:bn(t.msg_content),msg_client_id:bn(t.bigmsg_client_id)}}))};var i=this.transBuf(t);return this.logger.info("zm.lrh.sbrm "+JSON.stringify(i)),i=Rn.SendBigImReq.create(t),t=Rn.SendBigImReq.encode(i).finish(),this.sendMessage("SendBigImReq",t,e,n,{roomID:null==r?void 0:r.roomID})},On.prototype.sendSignalCmd=function(t,e,n,r){var i="";switch(t.sub_cmd){case 1003:i="SignalLiveInviteReq";break;case 1001:i="SignalLiveRequestReq";break;case 1002:i="SignalLiveResultReq";break;case 1004:i="SignalLiveStopReq"}var o=t.dest_id_name.map((function(t){return{id_name:bn(t)}}));return t={push_message:bn(t.signal_msg),to_user_list:o},o=this.transBuf(t),this.logger.info("zm.lrh.ssc "+JSON.stringify(o)),o=Rn[i].create(t),t=Rn[i].encode(o).finish(),this.sendMessage(i,t,e,n,{roomID:null==r?void 0:r.roomID})},On.prototype.sendStreamUpdate=function(t,e,n,r){var i,o=this;try{i=JSON.parse(t.stream_msg)}catch(t){}var s,a="",u=(this.logger.info(xt+" "+JSON.stringify(t)),this.stateCenter.roomModulesList.find((function(t){return t.roomID==r.roomID})));if(!u)return this.logger.error(xt+" room no found ignore "),-1;switch(t.sub_cmd){case 2001:a="AddStreamReq",s={stream_id:bn(i.stream_id),extra_info:bn(i.extra_info),client_req_seq:this.seq+1,third_token:bn(t.third_token||"")};break;case 2002:a="DeleteStreamReq",s={stream_id:bn(i.stream_id),stream_sid:i.stream_sid,client_req_seq:this.seq+1};break;case 2003:a="UpdateStreamReq",s={stream_id:bn(i.stream_id),stream_sid:i.stream_sid,client_req_seq:this.seq+1,extra_info:bn(i.extra_info)}}var c=this.transBuf(s);return this.logger.info(xt+" "+JSON.stringify(c)),c=Rn[a].create(s),c=Rn[a].encode(c).finish(),this.sendMessage(a,c,(function(t,n){o.logger.info(xt+" suc "+a+" "+JSON.stringify(t)),t.header.room_id=u.roomID,e&&e(t,n)}),(function(t,e){o.logger.info(xt+" fail "+a+" "+JSON.stringify(t)),n&&n(t,e)}),{roomID:null==r?void 0:r.roomID})},On.prototype.getStreamList=function(t,e,n,r){var i,o,s=this;this.stateCenter.roomModulesList.find((function(t){return t.roomID==r.roomID}))?(i=this.transBuf(o={}),this.logger.info("zm.lrh.gs "+JSON.stringify(i)),i=Rn.GetStreamListReq.create(o),o=Rn.GetStreamListReq.encode(i).finish(),this.sendMessage("GetStreamListReq",o,(function(t,n){var r;null!=(r=t.body)&&r.stream_info_list.forEach((function(t){t.create_time=t.create_time.toNumber()})),s.transKeysName(t.body,[["stream_list_seq","stream_seq"],["stream_info_list","stream_info"]]),e&&e(t,n)}),(function(t,e){n&&n(t,e)}),{roomID:null==r?void 0:r.roomID})):this.logger.error("zm.lrh.gs room no found ignore "+r.roomID)},On.prototype.transBuf=function(t){var e=this,n={};return Object.keys(t).forEach((function(r){["logout_check","k2_sign","k1_sign"].includes(r)?n[r]=t[r]:e.transReqBytes(n,t,r)})),n},On.prototype.transReqBytes=function(t,e,n){var r=this;if(Tn.a.isLong(e[n]))t[n]=e[n].toString();else if("[object Object]"===Object.prototype.toString.call(e[n]))t[n]={},Object.keys(e[n]).forEach((function(i){return r.transReqBytes(t[n],e[n],i)}));else if("[object Array]"===Object.prototype.toString.call(e[n])&&"[object Object]"===Object.prototype.toString.call(e[n][0])){t[n]=[];for(var i=0;i<e[n].length;i++)!function(i){var o={};Object.keys(e[n][i]).forEach((function(t){r.transReqBytes(o,e[n][i],t)})),t[n].push(o)}(i)}else t[n]="[object Uint8Array]"===Object.prototype.toString.call(e[n])?Sn(e[n]):e[n]},On.prototype.transHeader=function(t){return t.timestamp=Tn.a.isLong(t.timestamp)?t.timestamp.toString():t.timestamp,t},On.prototype.transRsp=function(t){var e=this,n=t&&t.rsp_head?this.transRspHead(t.rsp_head):{},r=Cn(Cn({},t),n),i=(delete r.rsp_head,{});return Object.keys(r).forEach((function(t){"k2_sign"===t?i[t]=r[t]:e.transBytes(i,r,t)})),i},On.prototype.transBytes=function(t,e,n){var r=this;if(Tn.a.isLong(e[n]))t[n]=e[n];else if("[object Object]"===Object.prototype.toString.call(e[n]))t[n]={},Object.keys(e[n]).forEach((function(i){return r.transBytes(t[n],e[n],i)}));else if("[object Array]"===Object.prototype.toString.call(e[n])&&"[object Object]"===Object.prototype.toString.call(e[n][0])){t[n]=[];for(var i=0;i<e[n].length;i++)!function(i){var o={};Object.keys(e[n][i]).forEach((function(t){r.transBytes(o,e[n][i],t)})),t[n].push(o)}(i)}else t[n]="[object Uint8Array]"===Object.prototype.toString.call(e[n])?Sn(e[n]):e[n]},On.prototype.transRspHead=function(t){return t?{err_code:t.code||0,err_message:t.message}:{}},On.prototype.decode=function(t,e){return Cn({},t.decode(e))},On.prototype.handleDisconnected=function(t,e){var n=this;this.logger.info(Ut+" call"),this.state=En.disconnected,this.stateCenter.useNetAgent&&t===E.TIMEOUT&&this.stateCenter.roomModulesList.forEach((function(t){t.roomTryHandler&&(n.ua.isConnect()?(n.logger.info(Ut+" ua is connect"),t.roomTryHandler.active()):(n.logger.info(Ut+" ua is disconnect"),n.ua.connectUa()))}))},On.prototype.handleBroken=function(){var t=this;this.logger.info("zm.lrh.hb call"),this.state=En.broken,this.stateCenter.useNetAgent&&this.stateCenter.roomModulesList.forEach((function(e){e.roomTryHandler&&(e.roomTryHandler.invalid(),e.roomTryHandler.onactive=function(n,r){t.logger.info("zm.lrh.hb onactive"),e.roomHandler.transError(r),e.roomHandler.disconnectedHandle(r)},e.roomTryHandler.startMaxTime(),e.roomHandler.roomStateHandle("CONNECTING",C.Reconnecting,O.NETWORK_BROKEN))}))},On.prototype.handleConnected=function(t){var e=this;this.logger.info("zm.lrh.hc call "+t),this.state=En.connected,this.stateCenter.useNetAgent&&t===y.AUTO&&this.stateCenter.roomModulesList.forEach((function(t){t.roomTryHandler&&e.ua.isConnect()&&t.roomTryHandler.active()}))},On.prototype.renewToken=function(t,e,n,r){var i=this,o=Rn.RenewTokenReq.create(t={token:t.token});o=Rn.RenewTokenReq.encode(o).finish(),t=this.transBuf(t),this.logger.info("zm.lrh.rt "+JSON.stringify(t)),this.sendMessage("RenewTokenReq",o,(function(t,n){i.keysExist(t.body,["token_remain_time"]),e&&e(t,n)}),n,{roomID:null==r?void 0:r.roomID})},On.prototype.reset=function(){this.logger.info("zm.lrh.r.0 call "),this.state=En.disconnected,this.switchSessionID=Tn.a.fromInt(0),this.sendDataCheckTimer&&clearTimeout(this.sendDataCheckTimer)},On.prototype.closeRequest=function(){var t;null!=(t=this.liveroomRequest)&&t.closeRequest()},On.prototype.resetSessionInfo=function(){this.switchSessionID=Tn.a.fromInt(0)},On.prototype.getNumSDKVersion=function(){var t=0===this.stateCenter.ENV?6:7,e=this.rtm.version.split(".").map((function(t){return parseInt(t)}));return t<<28|e[0]<<20|e[1]<<8|e[2]},On);function On(t,e,n,r,i){var o=this;this.logger=t,this.stateCenter=e,this.ua=n,this.dataReport=r,this.rtm=i,this.seq=0,this.sendCommandList=new m,this.sendCommandMap={},this.logoutCheckToken="",this.zPushSid="0",this.loginKeyTransMap=[["user_session_id","session_id"],["liveroom_hb_interval","hearbeat_interval"],["liveroom_hb_timeout","hearbeat_timeout"],["big_im_time_window","bigim_time_window"],["trans_channel_list","trans_seqs"],["stream_list_seq","stream_seq"],["stream_info_list","stream_info"]],this.sendDataCheckOnceCount=100,this.sendDataDropTimeout=1e4,this.sendDataCheckInterval=2e3,this.protoInstance=wn,this.roomKeyIDs={},this.roomIDKeys={},this.swPushCmdList=[fn.PushReq,fn.MergePushReq,fn.PushKickout],this.onSwitchCmdList=[fn.LoginRoomRsp,fn.LogoutRoomRsp,fn.PushKickout,fn.PushReq,fn.MergePushReq],this.noContextKeyCmdList=[1105],this.rtcPushCmdList=[10001,10002,10004,11001,11002,11003,11004,11005,12001,12002,12003,13001,15001],this.state=En.disconnected,this.unStructCmdList=[11001,11002,11003,11004],this.reloginToken="",this.crypto=new vn,this.liveroomRequest=this.ua.getPCRequest(T.SERVICE_SWITCH4LIVEROOM),this.switchSessionID=Tn.a.fromInt(0),null!=(t=this.liveroomRequest)&&t.on("connected",(function(t){o.handleConnected(t)})),null!=(e=this.liveroomRequest)&&e.on("broken",(function(t){o.handleBroken()})),null!=(n=this.liveroomRequest)&&n.on("disconnected",(function(t,e){o.handleDisconnected(t,e)})),null!=(r=this.liveroomRequest)&&r.on("downLoadMessage",(function(t,e){o.handlePush(t,e)})),null!=(i=this.liveroomRequest)&&i.on("exception",(function(t,e){o.logger.info("zm.lrh.o.0 except "+JSON.stringify(t))})),null!=(t=this.liveroomRequest)&&t.on("pcBrokenEvent",(function(t){var e=Oe,n=o.stateCenter.reporter.createSpan(a.H,{key:me},{key:""},e.event);n.setAttributes({service_no:e.service_no(null==t?void 0:t.service_no)}),n.end()})),null!=(e=this.liveroomRequest)&&e.on("pcDisconnectedEvent",(function(t){var e=Ne,n=o.stateCenter.reporter.createSpan(a.H,{key:me},{key:""},e.event);n.setAttributes({service_no:e.service_no(null==t?void 0:t.service_no)}),n.end()})),null!=(n=this.liveroomRequest)&&n.on("pcConnectedEvent",(function(t){var e=ke,n=o.stateCenter.reporter.createSpan(a.H,{key:me},{key:""},e.event);n.setAttributes({service_no:e.service_no(t.service_no),recv_time:e.recv_time((new Date).getTime()),proxy_link_sources:e.proxy_link_sources(t.proxy_link_sources),connect_stream:e.connect_stream(t.connect_stream)}),n.end()}))}var Nn=(An.prototype.listenCallBack=function(){var t=this;this.roomServicer.handlePushCustomMsg=function(e){t.handlePushCustomMsg(e)},this.roomServicer.handlePushTokenExpire=function(e){var n,r=null==(r=null==(r=null==e?void 0:e.body)?void 0:r.stop_stream)?void 0:r.stream_id_list.map(Sn);null!=(n=null==(n=null==e?void 0:e.body)?void 0:n.stop_stream)&&(n.stream_id_list=r),t.stateCenter.actionListener("_tokenExpired",e)},this.roomServicer.handlePushKickout=function(e,n){var r;n?function(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||((r=r||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}([],t.stateCenter.roomModulesList,!0).forEach((function(t){t.roomHandler.handlePushKickout(e,!0,!0)})):(r=null==(n=null==e?void 0:e.header)?void 0:n.room_id,n=t.stateCenter.roomModulesList.find((function(t){return t.roomID==r})),t.roomServicer.longToStringNumber(e.body,["session_id"],"toString"),n?n.roomHandler.handlePushKickout(e):t.logger.error("zm.lrh.pk room no found ignore "+JSON.stringify(null==(n=e.header)?void 0:n.room_id)))},this.roomServicer.handlePushStreamMsg=function(e){t.handlePushStreamMsg(e)},this.roomServicer.handlePushSignalMsg=function(e){t.handlePushSignalMsg(e)},this.roomServicer.handlePushMergeMsg=function(e){t.handlePushMergeMsg(e)},this.roomServicer.handlePushRoomMsg=function(e){t.handlePushRoomMsg(e)},this.roomServicer.handlePushTransMsg=function(e){t.handlePushTransMsg(e)},this.roomServicer.onSwitchMessage=function(e,n){t.onSwitchMessage(e,n)},this.roomServicer.handlePushUserStateUpdateMsg=function(e){var n,r,i,o=null==(s=null==e?void 0:e.header)?void 0:s.room_id,s=t.stateCenter.roomModulesList.find((function(t){return t.roomID==o}));s?(i=e.body.user_action_list.map((function(t){return{Action:t.action,IdName:t.id_name,NickName:t.nick_name,Role:t.role,LoginTime:t.login_time.toString()}})),r=t.stateCenter.reporter.createSpan(a.H,{key:Vt.event,par:o},{key:""},ue.event),i={body:{user_actions:i,user_list_seq:e.body.server_user_seq.toNumber(),room_id:o}},r.setAttributes({user_list_seq:null==(n=null===i?void 0:i.body)?void 0:n.user_list_seq,update_user:null==(n=null===i?void 0:i.body)?void 0:n.user_actions}),r.end(),s.userHandler.handlePushUserStateUpdateMsg(i)):t.logger.error("zm.lrh.puu room no found ignore "+JSON.stringify(e))}},An.prototype.isDisConnect=function(){return!!this.roomServicer&&this.roomServicer.isDisConnect()},An.prototype.isUaConnect=function(){var t;return null==(t=this.roomServicer)?void 0:t.isUaConnect()},An.prototype.sendMessage=function(t,e,n,r,i,o,s){var a;return null==(a=this.roomServicer)?void 0:a.sendMessage(t,e,n,r,i,o)},An.prototype.handlePushTokenExpire=function(t){},An.prototype.handlePushKickout=function(t,e){},An.prototype.handlePushStreamMsg=function(t){},An.prototype.handlePushSignalMsg=function(t){},An.prototype.handlePushMergeMsg=function(t){},An.prototype.handlePushCustomMsg=function(t){},An.prototype.handlePushRoomMsg=function(t){},An.prototype.handlePushTransMsg=function(t){},An.prototype.onSwitchMessage=function(t,e){},An.prototype.handlePushUserStateUpdateMsg=function(t){},An.prototype.login=function(t,e,n){var r;null!=(r=this.roomServicer)&&r.login(t,e,n)},An.prototype.logout=function(t,e,n){var r;return null==(r=this.roomServicer)?void 0:r.logout(t,e,n)},An.prototype.startCheck=function(){var t;null!=(t=this.roomServicer)&&t.startCheck()},An.prototype.stopCheck=function(){var t;null!=(t=this.roomServicer)&&t.stopCheck()},An.prototype.getReqHead=function(t){var e;return null==(e=this.roomServicer)?void 0:e.getReqHead(t)},An.prototype.heartBeat=function(t,e,n){var r;null!=(r=this.roomServicer)&&r.heartBeat(t,e,n)},An.prototype.fetchUserList=function(t,e,n,r){var i;return null==(i=this.roomServicer)?void 0:i.fetchUserList(t,e,n,r)},An.prototype.sendRoomMsg=function(t,e,n,r){var i;return null==(i=this.roomServicer)?void 0:i.sendRoomMsg(t,e,n,r)},An.prototype.sendReliableMessage=function(t,e,n,r){var i;return null==(i=this.roomServicer)?void 0:i.sendReliableMessage(t,e,n,r)},An.prototype.fetchReliableMessage=function(t,e,n,r){var i;return null==(i=this.roomServicer)?void 0:i.fetchReliableMessage(t,e,n,r)},An.prototype.sendCustomCommand=function(t,e,n,r){var i;return null==(i=this.roomServicer)?void 0:i.sendCustomCommand(t,e,n,r)},An.prototype.sendBigRoomMessage=function(t,e,n,r){var i;return null==(i=this.roomServicer)?void 0:i.sendBigRoomMessage(t,e,n,r)},An.prototype.sendSignalCmd=function(t,e,n,r){var i;return null==(i=this.roomServicer)?void 0:i.sendSignalCmd(t,e,n,r)},An.prototype.sendStreamUpdate=function(t,e,n,r){var i;return null==(i=this.roomServicer)?void 0:i.sendStreamUpdate(t,e,n,r)},An.prototype.getStreamList=function(t,e,n,r){var i;return null==(i=this.roomServicer)?void 0:i.getStreamList(t,e,n,r)},An.prototype.renewToken=function(t,e,n,r){var i;null!=(i=this.roomServicer)&&i.renewToken(t,e,n,r)},An.prototype.reset=function(){var t;null!=(t=this.roomServicer)&&t.reset()},An.prototype.closeRequest=function(){var t;null!=(t=this.roomServicer)&&t.closeRequest()},An);function An(t,e,n,r,i){this.logger=t,this.stateCenter=e,this.ua=n,this.dataReport=r,this.rtm=i,this.roomServicer=new kn(t,e,n,r,i),this.listenCallBack()}var Ln=n(11),Pn=(Mn.prototype.setLog=function(t){this.zegoSetting.setLog(t)},Mn.prototype.init=function(t){this.zegoSetting.init(t)},Mn.prototype.setEnvVariable=function(t,e){this.zegoSetting.setEnvVariable(t,e)},Mn.prototype.getEnvVariables=function(){return this.zegoSetting.getEnvVariables()},Mn.prototype.fetchSetting=function(t,e,n){return this.zegoSetting.fetchSetting(t,e,n)},Mn.prototype.fetchMultiSetting=function(t,e,n){return this.zegoSetting.fetchMultiSetting(t,e,n)},Mn.prototype.setOptions=function(t){return this.zegoSetting.setOptions(t)},Mn.prototype.getSettingCache=function(t){return this.zegoSetting.getSettingCache(t)},Mn.prototype.setToken=function(t){this.zegoSetting.setToken(t)},Mn.prototype.setUserID=function(t){this.zegoSetting.setUserID(t)},Mn.prototype.activePolling=function(){this.zegoSetting.activePolling()},Mn.prototype.uninit=function(){var t;null!=(t=this.zegoSetting)&&t.uninit()},Mn.prototype.getEnvVariable=function(t){this.zegoSetting.getEnvVariable(t)},Mn);function Mn(){this.isLoad=!1,this.callBackList=[],this.zegoSetting=new Ln.ZegoSetting}var Dn=function(t,e,n,r){return new(n=n||Promise)((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):((e=t.value)instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},xn=function(t,e){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s={next:a(0),throw:a(1),return:a(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(u){var c=[a,u];if(n)throw new TypeError("Generator is already executing.");for(;o=s&&c[s=0]?0:o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,(c=i?[2&c[0],i.value]:c)[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=0<(i=o.trys).length&&i[i.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3]))o.label=c[1];else if(6===c[0]&&o.label<i[1])o.label=i[1],i=c;else{if(!(i&&o.label<i[2])){i[2]&&o.ops.pop(),o.trys.pop();continue}o.label=i[2],o.ops.push(c)}}c=e.call(t,o)}catch(u){c=[6,u],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}},Un=function(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||((r=r||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))},Bn=(Object.defineProperty(Hn.prototype,"modules",{get:function(){return{service:this.service}},enumerable:!1,configurable:!0}),Object.defineProperty(Hn.prototype,"isUseNetAgent",{get:function(){return this.stateCenter.useNetAgent},enumerable:!1,configurable:!0}),Hn.prototype.destroyRTM=function(){this.stateCenter.roomModulesList.some((function(t){return!(null!=t&&t.isLogout()||"DISCONNECTED"===t.roomState)}))&&this.logoutRoom(),this.stateCenter.reporter.setUnloadState(a.I),this.reporter.destroy()},Hn.prototype.getSettingUnify=function(t){var e=this.stateCenter.settingConfig.getSetting("unify",t=void 0!==t&&t);return this.logger.info("zm.gsu "+t+" "+JSON.stringify(e)),e?(t=e.enable,e=e.sdk_conn_ver,!!(t&&e<=K.connectVer)):this.isUseNetAgent},Hn.prototype.initCallback=function(){this.proxyRes=G.proxyRes,this.actionSuccessCallback=G.actionSuccessCallback,this.actionErrorCallback=G.actionErrorCallback,this.getServerError=G.getServerError,this.generateRandumNumber=G.generateRandumNumber,this.unregisterCallback=G.unregisterCallback,this.logReportCallback=G.logReportCallback,this.registerCallback=G.registerCallback},Hn.prototype.initSpans=function(){this.stateCenter.reporter.createSpan(a.H,{key:Bt.event},{key:Ht},Ht,!0).end()},Hn.prototype.handleZipLogUrl=function(){var t,e="";null!=(t=this.stateCenter.geoFencing)&&t.detaillog&&""!==(null==(t=this.stateCenter.geoFencing)?void 0:t.detaillog)?(e="https://".concat(null==(t=this.stateCenter.geoFencing)?void 0:t.detaillog,"/log/userupload"),this.logger.info(dt+" set detaillog url by geoFencing "+e),this.logger.setZipLogUploadUrl(e)):(t=this.stateCenter.settingConfig.getSetting("detaillog_domain"))&&""!==t&&(e="https://".concat(t,"/log/userupload"),this.logger.info(dt+" set detaillog url by cloudsetting "+e),this.logger.setZipLogUploadUrl(e))},Hn.prototype.getStoreAppConfig=function(){if(this.logger.info(ft+" call"),null!=(t=this.stateCenter.geoFencing)&&t.logreport&&this.handleLogUpload(),null!=(t=this.stateCenter.geoFencing)&&t.detaillog&&this.handleZipLogUrl(),localStorage){var t=H(Y+"_"+this.getAppID()+"_"+(this.stateCenter.mode||K.modeNo));if(t){var e=H(Z+"_"+this.getAppID()+"_"+(this.stateCenter.mode||K.modeNo));e||this.logger.info(ft+" no store config etag");try{var n,r=x(t,V);r?(this.stateCenter.appConfig=JSON.parse(r),this.stateCenter.reporter.spanSetAttributes({key:Bt.event},{is_from_cache:Bt.is_from_cache(!0)}),this.stateCenter.actionListener("_appConfigRsp"),this.handleLogUpload()):localStorage.removeItem(Y+"_"+this.getAppID()+"_"+(this.stateCenter.mode||K.modeNo)),e&&(n=x(e,V),this.stateCenter.appConfigEtag=parseInt(n))}catch(t){this.logger.warn(ft+" "+JSON.stringify(t))}}else this.logger.info(ft+" no store config")}else this.logger.warn(ft+" no localstorage")},Hn.prototype.createNetAgent=function(){var t=this,e=(this.logger.info(ht+" call"),this.netAgent.on("disconnected",(function(e){t.logger.info("".concat(ht," netAgent disconnect"))})),this.netAgent.on("connected",(function(){t.logger.info("".concat(ht," netAgent connect")),t.stateCenter.reporter.setNetStateCheck(),t.isUseNetAgent?(t.fetchAppConfig(),t.stateCenter.roomModulesList.forEach((function(e){e.roomTryHandler&&t.netAgent.isConnect()&&e.roomTryHandler.active(!0)}))):t.logger.info("".concat(ht," unify false"))})),this.netAgent.on("broken",(function(e){t.logger.info("".concat(ht," netAgent broken")),e===b.CLOSE&&t.stateCenter.roomModulesList.forEach((function(t){t.resetSessionInfo()}))})),this.netAgent.on("dispatchEvent",(function(e,n,r){var i;t.logger.info("".concat(ht," dispatch")),"start"===n?(i=t.stateCenter.reporter.createSpan(a.H,{key:me},{key:""},"/zegoconn/auto_dispatch"),t.stateCenter.requestList[e]=i):"end"===n&&(i=t.stateCenter.requestList[e])&&(i.setAttributes({domain_list:r.domains}),i.end())})),this.netAgent.on("dispatchResultUpdate",(function(e){var n,r=e.servers;e=e.domains,t.logger.info("".concat(ht," dispatchResult ").concat(JSON.stringify(r),", ").concat(JSON.stringify(e))),null!=(n=t.stateCenter.geoFencing)&&n.id?(e&&e[0]&&(t.stateCenter.netGeoFencing.accesshub=e[0]),t.setLocalGeoFencing()):(n=D(JSON.stringify(r),V),B(W+"_"+t.stateCenter.appid+"_"+(t.stateCenter.mode||K.modeNo),n))})),this.netAgent.on("connectedEvent",(function(e,n,r){var i;t.logger.info("".concat(ht," connect")),"start"===n?(i=t.stateCenter.reporter.createSpan(a.H,{key:Bt.event},{key:me},me,!0),t.stateCenter.requestList[e]=i):"end"===n&&(i=t.stateCenter.requestList[e])&&(i.setAttributes({request_count:ye(r.count),connect_id:ve(r.connectid),events:be(r.connectEvents)}),i.end())})),this.netAgent.on("requestEvent",(function(e,n,r){var i;t.logger.info("".concat(ht," request")),"start"===n?(i=t.stateCenter.reporter.createSpan(a.H,{key:Bt.event},{key:Ce},Ce,!0),t.stateCenter.requestList[e]=i):"end"===n&&(i=t.stateCenter.requestList[e])&&(i.setAttributes({req_location:we(r.na_req_location),http_code:r.status_code,error:r.err_code}),i.end())})),this.netAgent.on("disConnectedEvent",(function(e){var n=e.duration,r=e.server,i=(e=e.connectid,t.logger.info("".concat(ht," disconnect")),t.stateCenter.reporter.createSpan(a.H,{key:Bt.event},{key:""},"/zegoconn/disconnect"));i.setAttributes({url:Ee(r),connect_duration:Te(n),connect_id:Se(e)}),i.end()})),null!=(e=this.netAgent)&&e.on("clientInfo",(function(e){var n=e.timeOffset;e=e.geofencingID,"number"==typeof n&&t.stateCenter.reporter.setTimeOffset(n),t.updateTimeOffsetInterval(),"number"==typeof e&&(t.stateCenter.netGeoFencing.id=e,t.setLocalGeoFencing())})),K.domains);if(Hn.geoFenceType&&Hn.geoFenceAreaList){this.logger.info("".concat(ht," geo type ").concat(Hn.geoFenceType," area ").concat(Hn.geoFenceAreaList.join(",")));var n=void 0,r=[],i=this.getGeoFencingIDAndDomain(Hn.geoFenceType,Hn.geoFenceAreaList);if(!i)throw this.logger.warn("".concat(ht," geofencing not exist")),O.GEO_SET_ERROR;var o,s=this.getLocalGeoFencing(),u=!1;null!=s&&s.id&&(o=i.find((function(t){return t.id===(null==s?void 0:s.id)})))&&(u=!0,n={id:null==s?void 0:s.id,accesshub:(null==s?void 0:s.accesshub)||(null==o?void 0:o.accesshub),logreport:null==o?void 0:o.logreport,detaillog:null==o?void 0:o.detaillog},null!=s&&s.accesshub&&r.push(null==s?void 0:s.accesshub),r.push(null==o?void 0:o.accesshub)),u||(n={id:(o=i[0]).id,accesshub:u=o.accesshub,logreport:o.logreport,detaillog:o.detaillog},r.push(u)),this.stateCenter.geoFencing=n,this.logger.info("".concat(ht," use geo ").concat(JSON.stringify(this.stateCenter.geoFencing))),e=r}this.logger.info("".concat(ht," domains ").concat(JSON.stringify(e))),i=e.map((function(t){return"wss://".concat(t,"/accesshub")})),this.netAgent.setBackupDomains(K.primaryDomains),this.netAgent.setNetAgentDefaultServers(i),!this.stateCenter.geoFencing&&null!=(o=this.options)&&o.accessURL&&this.netAgent.setNetAgentSpecifiedServers([null==(u=this.options)?void 0:u.accessURL]),null!=(n=this.options)&&n.customDomain&&(r="wss://accesshub-wss."+this.options.customDomain+"/accesshub",this.stateCenter.geoFencing&&(this.replaceMainDomain(this.options.customDomain),r="wss://".concat(null==(e=this.stateCenter.geoFencing)?void 0:e.accesshub,"/accesshub")),this.netAgent.setNetAgentSpecifiedServers([r])),this.dispatchServers=[],this.dispatchServers=this.stateCenter.geoFencing?i:this.getDispatchUrl(),this.netAgent.setDispatchConnectServers(this.dispatchServers)},Hn.prototype.getMainDomain=function(t){return(t=t.split("."))[t.length-2]+"."+t[t.length-1]},Hn.prototype.replaceMainDomain=function(t){var e,n;this.stateCenter.geoFencing&&(n=this.getMainDomain(null==(n=this.stateCenter.geoFencing)?void 0:n.accesshub),this.stateCenter.geoFencing.accesshub=null==(e=this.stateCenter.geoFencing)?void 0:e.accesshub.replace(n,t),this.stateCenter.geoFencing.logreport=null==(e=this.stateCenter.geoFencing)?void 0:e.logreport.replace(n,t),this.stateCenter.geoFencing.detaillog=null==(e=this.stateCenter.geoFencing)?void 0:e.detaillog.replace(n,t))},Hn.prototype.getDispatchUrl=function(){var t=H(W+"_"+this.stateCenter.appid+"_"+(this.stateCenter.mode||K.modeNo));if(t&&(t=x(t,V)))try{return JSON.parse(t)}catch(t){}return[]},Hn.prototype.bindWindowListener=function(){var t=this,e=navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone/i),n=P(),r="micromessenger"==(i=navigator.userAgent).toLowerCase().match(/MicroMessenger/i),i=-1<i.indexOf("Android")||-1<i.indexOf("Adr"),o=e||r&&i?"pagehide":"Firefox"===n?"beforeunload":"unload";window.addEventListener(o,(function(){return Dn(t,void 0,void 0,(function(){return xn(this,(function(t){switch(t.label){case 0:return this.logger.info(it+" "+o),this.stateCenter.reporter.setUnloadState(a.I),this._onBeforePageUnload?[4,this._onBeforePageUnload()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.logoutRoom(),[2]}}))}))})),window.addEventListener("offline",(function(){t.netOffLineHandle()})),window.addEventListener("online",(function(){t.netOnLineHandle()}))},Hn.prototype.retryRoom=function(){var t=this;this.stateCenter.roomModulesList.forEach((function(e){e.roomTryHandler&&t.netAgent.isConnect()&&(e.resetSessionInfo(),e.roomTryHandler.active(!0))}))},Hn.prototype.netOnLineHandle=function(){var t=this;this.logger.info(it+" network is online"),this.stateCenter.networkState=u.online,this.isUseNetAgent||this.stateCenter.roomModulesList.forEach((function(e){e.roomTryHandler&&t.service.isDisConnect()?e.roomTryHandler.active():e.roomTryHandler&&(e.roomTryHandler.stopMaxTime(),e.roomHandler.roomStateHandle("CONNECTED",C.Reconnected,{code:0,msg:""}))}))},Hn.prototype.netOffLineHandle=function(){var t=this;this.logger.info(it+" network is broken"),this.stateCenter.networkState=u.offline,this.isUseNetAgent||this.stateCenter.roomModulesList.forEach((function(e){e.roomTryHandler&&(e.roomTryHandler.invalid(),e.roomTryHandler.onactive=function(n,r){t.logger.info(it+" onactive"),e.roomHandler.transError(r),e.roomHandler.disconnectedHandle(r)},e.roomTryHandler.startMaxTime(),e.roomHandler.roomStateHandle("CONNECTING",C.Reconnecting,O.NETWORK_BROKEN))}))},Hn.prototype.setLogConfig=function(t){this.logger.info(ot+" call");var e,n=this.stateCenter.reporter.createSpan(a.H,{key:Bt.event},{key:Ft.event},Ft.event);if(t.logLevel&&["debug","info","warn","error","report","disable"].includes(t.logLevel)&&(this.logger.setLogLevel(t.logLevel),n.setAttributes({log_level:Ft.log_level(t.logLevel)})),t.remoteLogLevel&&["debug","info","warn","error","report","disable"].includes(t.remoteLogLevel)&&n.setAttributes({remote_log_level:Ft.remote_log_level(t.remoteLogLevel)}),"string"==typeof t.logURL&&(t.logURL.startsWith("wss://")||t.logURL.startsWith("https://")))null!=(e=this.stateCenter.geoFencing)&&e.logreport?this.logger.info(ot+" geo exist"):(this.logger.setLogServer(t.logURL),0===this.stateCenter.ENV&&(this.stateCenter.logDomain=null==(e=this.logger.url)?void 0:e.split("/")[2],this.stateCenter.reporter.setConfig({serverUrl:"wss://"+this.stateCenter.logDomain+"/zglog/tlog"}))),n.setAttributes({log_url:Ft.log_url(t.logURL)}),n.end();else if(t.logURL)return this.logger.error(ot+"log url must be a wss or https url"),this.stateCenter.reporter.setError(n,Ft.error.kInvalidParamError),!1;return this.logger.info(ot+" call success"),n.end(),!0},Hn.prototype.setDebugVerbose=function(t){var e=this.stateCenter.reporter.createSpan(a.H,{key:Bt.event},{key:zt},zt);"boolean"==typeof t&&(this.stateCenter.debug=t,this.stateCenter.debugCustom=!0,e.setAttributes({debug:Gt(t?"true":"false")})),e.end(),this.logger.info("zm.sdv call success")},Hn.prototype.setDebug=function(t){"string"==typeof t&&-1<t.indexOf("wss")?this.stateCenter.debug=G.isTestEnv(t):Array.isArray(t)&&0<t.length&&t.every((function(t){return"string"==typeof t&&-1<t.indexOf("wss")}))?this.stateCenter.debug=G.isTestEnv(t[0]):this.logger.info("zm.0 server wrong"),this.stateCenter.testEnvironment=this.stateCenter.debug},Hn.prototype.renewToken=function(t,e){var n,r,i,o,s=this,u=this.stateCenter.reporter.createSpan(a.H,{key:Vt.event,par:e},{key:""},$t.event);return void 0===e||"string"==typeof e&&""!=e?(r=this.getRoomModules(e)||this.stateCenter.roomModulesList[0])?"string"==typeof t&&r.roomTryHandler?(t===r.roomTryHandler.token?(this.logger.info(gt+" token has not changed"),u.setAttributes({error:$t.error.INPUT_PARAM.code,message:"token has not changed"}),u.end()):(u.setAttributes({token:$t.token(t)}),this.stateCenter.configRoomAuth?(i=function(e){var n;null!=(n=r.roomTryHandler)&&n.renewLocalToken(t,null==(n=null==e?void 0:e.body)?void 0:n.token_remain_time),s.cloudSetting.setToken(t),s.reporter.setReporterInfo(s.stateCenter.idName||"",t),s.stateCenter.configCheckToken=!0,u.end(),s.logger.info(gt+" "+JSON.stringify(e))},o=function(e){var n=null==(n=null==e?void 0:e.body)?void 0:n.err_code;s.stateCenter.reporter.setError(u,e),!n||1000002014!==n&&2014!==n?s.logger.error(gt+" "+JSON.stringify(e)):(s.stateCenter.configCheckToken=!1,null!=(n=r.roomTryHandler)&&n.renewLocalToken(t),s.cloudSetting.setToken(t),s.logger.warn(gt+" "+JSON.stringify(e)))},this.isUseNetAgent?null!=(n=this.liveRoomHandler)&&n.renewToken({token:t},i,o,r):this.service.sendMessage("renew_token",{token:t},i,o,void 0,{sessionID:r.sessionID,roomID:e,roomSessionID:r.roomSessionID})):(null!=(n=r.roomTryHandler)&&n.renewLocalToken(t),this.cloudSetting.setToken(t),this.reporter.setReporterInfo(this.stateCenter.idName||"",t),u.end())),!0):("string"!=typeof t||r.roomTryHandler?(this.logger.error(gt+" token must be string and not empty"),this.stateCenter.reporter.setError(u,$t.error.INPUT_PARAM)):(this.logger.error(gt+" calling must after loginRoom"),this.stateCenter.reporter.setError(u,$t.error.NOT_LOGIN)),!1):(this.logger.error(gt+" calling must after loginRoom"),this.stateCenter.reporter.setError(u,$t.error.NOT_LOGIN),!1):(this.logger.error(gt+" roomID must be string and no empty"),!1)},Hn.prototype.setCloudSettingURLs=function(t){var e=this;this.logger.info("zm.scsu call "),Array.isArray(t)&&0<t.length&&t.every((function(t){return"string"==typeof t&&-1<t.indexOf("http")}))&&this.cloudSetting.init({productNum:1,appID:this.stateCenter.appid,env:this.stateCenter.ENV,pollingNotify:function(t,n){e.logger.info("zm.scsu"," setting file changed "+t+" "+JSON.stringify(n)),e.stateCenter.actionListener("_cloudSettingNotify",t,n)},reportNotify:this.cloudReportNotify.bind(this),online:!this.stateCenter.testEnvironment,unify:this.isUseNetAgent,connection:this.netAgent})},Hn.prototype.loginRoom=function(t,e,n,r){var i=this;return this.logger.info(st+" call by user "+(null==n?void 0:n.userID)+" "+t+" "+this.version),new Promise((function(o,a){return Dn(i,void 0,void 0,(function(){var i,c,l,h,f;return xn(this,(function(d){switch(d.label){case 0:return 1!==this.stateCenter.ENV?[3,2]:[4,new Promise((function(t){}))];case 1:d.sent(),d.label=2;case 2:return c=this.loginReport(o,a,t,e,r),h=c.interResolve,i=c.interReject,c=c.loginSpan,(r=r||{}).maxMemberCount||(r.maxMemberCount=0),l=this.getRoomModules(t),f=Vt.error,l?(this.logger.setSessionInfo(this.stateCenter.appid,t,"",n.userID,"",this.stateCenter.sdKVersion),i(f.REPEATEDLY_LOGIN)):((l=new Ye(t,this.stateCenter,this.logger,this.dataReport,this,this.liveRoomHandler,this.service)).roomTryHandler||(l.roomTryHandler=new Me(this.logger,this.stateCenter,l)),l.roomTryHandler.init(this.stateCenter.roomRetryTime),l.roomTryHandler.initRoom(l.roomHandler,t,e,n,this.stateCenter.server,this.stateCenter.serverBak,r),l.roomTryHandler.setLoginRoomCallback(h,i),l.roomHandler.roomStateHandle("CONNECTING",C.Logining,{code:0,msg:""}),(h=function(t,e){var n,r,i=[],o={};for(n in t)o[t[n].order]=t[n],t[n].key=n;for(r in o)i.push(o[r]);for(var s=0;s<i.length;s++)for(var a=i[s].rules,u=0;u<a.length;u++){var c={key:i[s].key,value:i[s].value,action:e.action,logger:e.logger},l=c.value,h=a[u].name?""+a[u].name:"";if((void 0===l&&h===Pe.NOT_EMPTY||void 0!==l)&&Ue[h]&&(h=Ue[h](c.key,l,c.action,c.logger,a[u]))!=xe)return h}return xe}({roomID:{order:0,value:t,rules:[{name:Pe.NOT_EMPTY,error:f.ROOM_ID_NULL},{name:Pe.TYPE_STRING,error:f.INPUT_PARAM,extMsg:"roomID must be string"},{name:Pe.MAX_LENGTH_128,error:f.ROOM_ID_TOO_LONG},{name:Pe.ILLEGAL_CHARACTERS,error:f.ROOM_ID_INVALID_CHARACTER}]},token:{order:1,value:e,rules:[{name:Pe.NOT_EMPTY,error:f.INPUT_PARAM},{name:Pe.TYPE_STRING,error:f.INPUT_PARAM}]},user:{order:2,value:n,rules:[{name:Pe.NOT_EMPTY,error:f.INPUT_PARAM,extMsg:" param user error."},{name:Pe.TYPE_OBJECT,error:f.INPUT_PARAM,extMsg:" param user error."}]},"user.userID":{order:3,value:n.userID,rules:[{name:Pe.NOT_EMPTY,error:f.USER_ID_NULL,extMsg:" param user error."},{name:Pe.TYPE_STRING,error:f.INPUT_PARAM,extMsg:" param userID error."},{name:Pe.MAX_LENGTH_64,error:f.USER_ID_TOO_LONG},{name:Pe.ILLEGAL_CHARACTERS,error:f.USER_ID_INVALID_CHARACTER}]},"user.userName":{order:4,value:n.userName,rules:[{name:Pe.TYPE_STRING,error:f.INPUT_PARAM,extMsg:" userName must be string."},{name:Pe.MAX_LENGTH_256,error:f.USER_NAME_TOO_LONG}]},config:{order:5,value:r,rules:[]},"config.maxMemberCount":{order:6,value:r.maxMemberCount,rules:[{name:Pe.TYPE_INTEGER,error:f.INPUT_PARAM,extMsg:" maxMemberCount must be integer number."}]}},{action:st,logger:this.logger}))!==xe?(l.roomHandler.roomStateHandle("DISCONNECTED",C.LoginFailed,h.error,h.extMsg),i(h.error,h.extMsg)):(this.logger.setSessionInfo(this.stateCenter.appid,"","",n.userID,"",this.version),0<this.stateCenter.roomModulesList.length&&1==this.stateCenter.isMultiRoom?l.isMulti=!0:Un([],this.stateCenter.roomModulesList,!0).forEach((function(t){return t.roomHandler.logout()})),r&&(l.config=r),this.stateCenter.roomModulesList.push(l),this.netAgent&&(this.stateCenter.idName=n.userID,this.netAgent.setUserInfo(n.userID),this.stateCenter.actionListener("_roomLogin",t,e),this.netAgent.isConnect())&&this.fetchAppConfig(e),this.cloudSetting.setUserID(n.userID),this.cloudSetting.setToken(e),this.cloudSetting.activePolling(),this.stateCenter.reporter.setCommonAttributes({id_name:n.userID}),this.stateCenter.reporter.setReporterInfo(n.userID,e),this.logger.setTokenInfo(e,n.userID),this.stateCenter.reporter.setSpanInMap(c,{key:Vt.event,par:t}),f=this.stateCenter.settingConfig.getSetting("room_server",!0),Array.isArray(f)&&0<f.length&&(this.logger.info(st," setting room_server "+f),this.stateCenter.server=f[0],this.stateCenter.serverBak=f[1]||f[0]),this.stateCenter.setMultiRoom=!0,l.roomTryHandler.startMaxTime(),this.isUseNetAgent&&!this.netAgent.isConnect()?(this.logger.info(st," us is not connected"),l.roomHandler.setRunState(s.trylogin),this.netAgent.connectUa()):(this.isUseNetAgent&&(this.stateCenter.networkState=u.online),l.roomTryHandler.active(!0)))),[2]}}))}))}))},Hn.prototype.handleLogUpload=function(t){var e="";t&&t.app_config?e=t.app_config.domain:this.stateCenter.appConfig&&this.stateCenter.appConfig.app_config&&(e=this.stateCenter.appConfig.app_config.domain),this.logger.info(lt+" call"),this.logger.url?this.logger.info(lt+" log is connected"):(null!=(t=this.stateCenter.geoFencing)&&t.logreport?(this.stateCenter.logDomain=null==(t=this.stateCenter.geoFencing)?void 0:t.logreport,e=this.getMainDomain(null==(t=this.stateCenter.geoFencing)?void 0:t.logreport)):this.stateCenter.testEnvironment?(this.stateCenter.logDomain="weblogger-hk-test.zegocloud.com",e="zegocloud.com"):this.stateCenter.logDomain="weblogger".concat(this.stateCenter.appid,"-api.").concat(e),e?(t="",0===this.stateCenter.ENV?(t="wss://".concat(this.stateCenter.logDomain,"/log"),this.reporter.setConfig({serverUrl:"wss://".concat(this.stateCenter.logDomain,"/zglog/tlog")})):t="https://".concat(this.stateCenter.logDomain,"/httplog"),this.logger.setLogServer(t)):this.logger.warn(lt+" appconfig no domain"))},Hn.prototype.fetchAppConfigByTargetToken=function(t,e){return Dn(this,void 0,void 0,(function(){var n,r,i,o,s;return xn(this,(function(a){switch(a.label){case 0:if(this.logger.info(ct+" call"),!e)return this.logger.warn(ct+" user not exist"),[2];if(n=this.getUserID(),r="",i=null,t)r=t;else{if(!(0<this.stateCenter.roomModulesList.length))return this.logger.warn(ct+" token not exist"),[2];r=this.getToken()}this.logger.roomid||this.logger.setSessionInfo(this.stateCenter.appid,"player-no-room","",e,"",this.stateCenter.sdKVersion),a.label=1;case 1:return a.trys.push([1,3,4,5]),this.netAgent.setUserInfo(e),[4,this.netAgent.getAppConfigByAgent("init",r,5e3)];case 2:return o=a.sent(),s=o.data,0===o.code&&(this.handleLogUpload(s),i=s),[3,5];case 3:return a.sent(),this.logger.error(ct+" token not validated"),[3,5];case 4:return n&&this.netAgent.setUserInfo(n),this.logger.info(ct+" call success"),[2,i];case 5:return[2]}}))}))},Hn.prototype.fetchAppConfig=function(t){return Dn(this,void 0,void 0,(function(){var e,n,r,i,o,s,u,c;return xn(this,(function(l){switch(l.label){case 0:if(this.stateCenter.appConfigFetched)return this.logger.warn(ut+" config fetched"),[2];if(!this.getUserID())return this.logger.warn(ut+" user not exist"),[2];if(e="",t)e=t;else{if(!(0<this.stateCenter.roomModulesList.length))return this.logger.warn(ut+" token not exist"),[2];e=this.getToken()}n=this.stateCenter.reporter.createSpan(a.H,{key:Bt.event},{key:""},"/sdk_config/init"),this.logger.info(st+" initConfig etag: "+this.stateCenter.appConfigEtag),r=!!this.stateCenter.appConfig,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.netAgent.getAppConfigByAgent("init",e,5e3,this.stateCenter.appConfigEtag)];case 2:if(o=l.sent(),u=o.code,c=o.data,i=o.etag,o=o.retryCount,n.setAttributes({trigger_reason:Re(this.stateCenter.appConfig?"refresh":"normal"),try_count:Ie(o||0)}),n.end(),this.stateCenter.appConfigFetched=!0,this.logger.info(st+" initConfig code:"+u+" data: "+JSON.stringify(c)+" etag: "+i),this.stateCenter.appConfigEtag!==i){if(0==Object.keys(c).length)return this.logger.info(st+" initConfig data null"),[2];this.stateCenter.appConfig={app_config:o=c.app_config,media_config:{publish_config:s=(u=c.media_config).publish_config,play_config:u=u.play_config},speedlog_config:{charge_info_report_no_playing:(c=c.speedlog_config.charge_info_report_no_playing)||0}},this.stateCenter.appConfigEtag=i,o=JSON.stringify(this.stateCenter.appConfig),s=D(o,V),B(Y+"_"+this.getAppID()+"_"+(this.stateCenter.mode||K.modeNo),s),u=D(this.stateCenter.appConfigEtag+"",V),B(Z+"_"+this.getAppID()+"_"+(this.stateCenter.mode||K.modeNo),u)}return this.handleLogUpload(),!r&&this.stateCenter.appConfig&&this.stateCenter.actionListener("_appConfigRsp"),!this.stateCenter.netAppConfig&&this.stateCenter.appConfig&&(this.stateCenter.netAppConfig=Object.assign(this.stateCenter.appConfig),this.stateCenter.actionListener("_netAppConfigRsp",this.stateCenter.netAppConfig),this._onAppConfigUpdate)&&this._onAppConfigUpdate(this.stateCenter.netAppConfig),[3,4];case 3:return c=l.sent(),this.logger.error(st+" fail "+JSON.stringify(c)),n.setAttributes({error:null==c?void 0:c.code}),n.end(),[20012,20008].includes(null==c?void 0:c.code)&&this.stateCenter.roomModulesList.forEach((function(t){t.roomTryHandler&&t.roomTryHandler.loginFail(O.APPID_INVALID)})),[3,4];case 4:return[2]}}))}))},Hn.prototype.getCloudSetting=function(){var t,e=this;null!=(t=this.cloudSetting)&&t.fetchMultiSetting([j,"room","rtc"]).then((function(t){var n,r;e.logger.info(st," settingConfig "+JSON.stringify(t)),t&&(e.stateCenter.settingConfig.setSetting(null==(r=null==t?void 0:t.init)?void 0:r.setting,["remote_log_level","zip_log","detaillog_domain"]),e.stateCenter.actionListener("_settingCanFetch",null==t?void 0:t.rtc),(r=e.stateCenter.settingConfig.getSetting("remote_log_level",!0))&&(e.logger.info("".concat(st,"  setting remote_log_level ").concat(r)),e.logger.setRemoteLogLevel(r)),void 0!==(t=e.stateCenter.settingConfig.getSetting("zip_log"))&&(e.logger.info("".concat(rt," force setting zip_log ").concat(t)),e.logger.setZipLogConfig(t,!0)),e.handleZipLogUrl(),(r=e.stateCenter.settingConfig.getSetting("unify",e.stateCenter.netHasSet))&&(e.logger.info("".concat(st," unify ").concat(JSON.stringify(r))),t=r.enable,r=r.sdk_conn_ver,n=!0,n=!!(t&&r<=K.connectVer),!0===e.isUseNetAgent)&&!1===n&&(e.cloudSetting.setOptions({unify:!1}),"connecting"!==e.stateCenter.connectState&&(e.stateCenter.connectState="connecting",e.stateCenter.actionListener("_connectChanged","connecting")),t=Un([],e.stateCenter.roomModulesList,!0),Un([],e.stateCenter.roomModulesList,!0).forEach((function(t){t.roomHandler.logout(!0,!0)})),e.stateCenter.useNetAgent=n,t.forEach((function(t){var n;e.stateCenter.roomModulesList.push(t),t.roomTryHandler||(t.roomTryHandler=new Me(e.logger,e.stateCenter,t)),t.roomTryHandler.init(e.stateCenter.roomRetryTime),t.roomTryHandler.initRoom(t.roomHandler,t.roomID,t.token,{userID:e.stateCenter.idName,userName:e.stateCenter.nickName},e.stateCenter.server,e.stateCenter.serverBak,t.config),null!=(n=t.roomTryHandler)&&n.startMaxTime(),t.roomTryHandler.onactive=function(n,r){n?"connected"!==e.stateCenter.connectState&&(e.stateCenter.connectState="connected",e.stateCenter.actionListener("_connectChanged","connected",{roomID:t.roomID})):(e.logger.info(st," onactive"),t.roomHandler.transError(r),t.roomHandler.disconnectedHandle(r))},null!=(n=t.roomTryHandler)&&n.active()}))),r=e.stateCenter.settingConfig.getSetting("report_script"))&&(n=r.url,t=r.key,r=r.hash,e.logger.info("".concat(st," report script ").concat(n," ").concat(t," ").concat(r)),e.stateCenter.reporter.loadScript(!0,n,t,r))})).catch((function(t){e.logger.warn(st," settingConfig "+JSON.stringify(t))})),this.stateCenter.onListener("_cloudSettingNotify",(function(t,n){var r=e.cloudSetting.getEnvVariables()||{},i=e.stateCenter.reporter.createSpan(a.H,{key:Bt.event},{key:""},"/cloud_setting/refresh");i.setAttributes({request_kv:he(r),files:fe([{name:t,content:n.setting,versions:n.versions,code:null==n?void 0:n.code,message:null==n?void 0:n.message}])}),i.end(),t===j&&(e.stateCenter.settingConfig.setSetting(null==n?void 0:n.setting,["remote_log_level"]),r=e.stateCenter.settingConfig.getSetting("remote_log_level"))&&(e.logger.info(st," setting remote_log_level "+r),e.logger.setRemoteLogLevel(r))}))},Hn.prototype.cloudReportNotify=function(t,e,n){0!==(null==n?void 0:n.code)||!1===(null==n?void 0:n.polling)?"request_start"===e?this.stateCenter.reporter.createSpan(a.H,{key:Bt.event},{key:de,par:t+""},de,!0):"request_end"===e&&this.stateCenter.reporter.spanEnd({key:de,par:t+""},{request_detail:pe(null==n?void 0:n.reportData),files:ge(null==n?void 0:n.files),code:null==n?void 0:n.code,request_params:null==n?void 0:n.params,request_kv:null==n?void 0:n.requestKV}):this.logger.info("zm.crn not report")},Hn.prototype.loginReport=function(t,e,n,r,i){var o=this,s=Vt,u=this.stateCenter.reporter.createSpan(a.I,{key:Bt.event},{key:""},s.event);return u.setAttributes({svr_env:s.svr_env(this.stateCenter.testEnvironment?"test":"online"),token:s.token(r)}),i&&("boolean"==typeof i.userUpdate&&u.setAttribute("user_state_update",s.user_state_update(i.userUpdate?1:0)),"number"==typeof i.maxMemberCount)&&u.setAttributes({max_member_cnt:s.max_member_cnt(i.maxMemberCount)}),{interResolve:function(e){var r=o.getRoomSessionID(n),i=o.getRoomModules(n),a=o.getSessionId(n);u.setAttributes({room_id:s.room_id(n),room_sid_string:s.room_sid_string(r),liveroom_sid_string:s.liveroom_sid_string(a),try_cnt:s.try_cnt(null==(r=null==i?void 0:i.roomTryHandler)?void 0:r.retryActiveCount),server:s.server(null==(a=null==i?void 0:i.roomHandler)?void 0:a.server),room_mode:s.room_mode(o.stateCenter.isMultiRoom?1:0),role:s.role(o.stateCenter.role),audience_create_room:s.audience_create_room(o.stateCenter.roomCreateFlag?1:0),max_member_cnt:s.max_member_cnt((null==i?void 0:i.maxMemberCount)||0)}),u.end(),t(e)},interReject:function(t,r){var i,a;void 0===r&&(r=""),u.setAttributes({room_id:s.room_id(n)}),t.code<2e9&&1e9<t.code||t.code<1e6?(i=G.decodeServerError(t.code,t.msg),a=G.getLiveRoomError(t.code,o.isUseNetAgent)):i={code:t.code,message:t.msg},i&&o.stateCenter.reporter.setError(u,{code:i.code,msg:i.message+r}),a&&O[a]&&(t.code=O[a].code,t.msg.includes("unknown"))&&(t.msg=O[a].msg),e(t.code&&t.msg&&""!==r?{code:t.code,msg:t.msg+r}:t)},loginSpan:u}},Hn.prototype.logoutRoom=function(t){var e,n=this;this.logger.info(at+" call by user "+t),this.stateCenter.roomModulesList.length?void 0===t?(Un([],this.stateCenter.roomModulesList,!0).forEach((function(t){n.logoutSpan(t),t.roomHandler.logout(!0)})),this.cloudSetting.uninit()):"string"!=typeof t||""==t?(this.logger.error(at+" roomID must be string and not empty"),this.logoutSpan(void 0,Qt.error.INPUT_PARAM)):(e=this.getRoomModules(t))?(this.logoutSpan(e),e.roomHandler.logout(),0===this.stateCenter.roomModulesList.length&&this.cloudSetting.uninit()):(this.logger.error(at+" room not exist"),this.logoutSpan(void 0,Qt.error.ROOM_NOT_EXIST,t)):this.logger.warn(at+" no room")},Hn.prototype.uploadLog=function(){var t=this;return new Promise((function(e,n){t.logger.info("zm.zip.udlg call"),t.logger.uploadStorageLog().then((function(){t.logger.info("zm.zip.udlg call success"),e({errorCode:0,extendedData:"upload logs success!"})})).catch((function(e){t.logger.error("zm.zip.udlg upload zip log failed, result: "+((null==e?void 0:e.message)||"unknown")),n({errorCode:O.UPLOAD_LOG_ERROR.code,extendedData:O.UPLOAD_LOG_ERROR.msg+", result: "+((null==e?void 0:e.message)||"unknown")})}))}))},Hn.prototype.sendCustomCommand=function(t,e,n){return new Promise((function(t,e){console.error(w),e()}))},Hn.prototype._sendCustomCommand=function(t,e,n){return new Promise((function(t,e){console.error(w),e()}))},Hn.prototype.sendBroadcastMessage=function(t,e){return new Promise((function(t,e){console.error(w),e()}))},Hn.prototype._sendBroadcastMessage=function(t,e,n,r){return void 0===n&&(n=1),void 0===r&&(r=1),new Promise((function(t,e){console.error(w),e()}))},Hn.prototype.setRoomExtraInfo=function(t,e,n){return new Promise((function(t,e){console.error(w),e()}))},Hn.prototype._setRoomExtraInfo=function(t,e,n){return new Promise((function(t,e){console.error(w),e()}))},Hn.prototype.sendBarrageMessage=function(t,e){return new Promise((function(t,e){console.error(w),e()}))},Hn.prototype._sendBarrageMessage=function(t,e,n,r){return void 0===n&&(n=1),void 0===r&&(r=1),new Promise((function(t,e){console.error(w),e()}))},Hn.prototype.sendRelayMessage=function(t,e,n,r,i){console.error(w)},Hn.prototype.requestJoinLive=function(t,e,n,r,i){return console.error(w),!1},Hn.prototype.inviteJoinLive=function(t,e,n,r,i){return console.error(w),!1},Hn.prototype.endJoinLive=function(t,e,n,r){return console.error(w),!1},Hn.prototype.respondJoinLive=function(t,e,n,r,i){return console.error(w),!1},Hn.prototype.getVersion=function(){return this.version},Hn.prototype.setSdkBizVersion=function(t){"string"==typeof t&&""!==t&&(this.stateCenter.bizVersion=t)},Hn.prototype.on=function(t,e){var n=this.stateCenter.reporter.createSpan(a.H,{key:Ht},{key:""},qt.event);return n.setAttributes({listener:qt.listener(t)}),this.stateCenter.listenerList[t]?"function"!=typeof e?(this.logger.error(pt+" listener callBack must be funciton"),this.stateCenter.reporter.setError(n,qt.error.INPUT_PARAM," listener callBack must be function"),!1):(-1==this.stateCenter.listenerList[t].indexOf(e)&&this.stateCenter.listenerList[t].push(e),n.end(),!0):(this.logger.error(pt+" event "+t+" no found"),this.stateCenter.reporter.setError(n,qt.error.INPUT_PARAM," event "+t+" no found"),!1)},Hn.prototype.off=function(t,e){var n,r=this.stateCenter.reporter.createSpan(a.H,{key:Ht},{key:""},"/sdk/off_listener");return r.setAttributes({listener:jt(t)}),this.stateCenter.listenerList[t]?(n=this.stateCenter.listenerList[t],e?n.splice(n.indexOf(e),1):this.stateCenter.listenerList[t]=[],r.end(),!0):(this.logger.error("zm.off listener no found"),this.stateCenter.reporter.setError(r,qt.error.INPUT_PARAM," event "+t+" no found"),!1)},Hn.prototype._on=function(t,e){return this.stateCenter.listenerList[t]?"function"!=typeof e?(this.logger.error(pt+" listener callBack must be funciton"),!1):(-1==this.stateCenter.listenerList[t].indexOf(e)&&this.stateCenter.listenerList[t].push(e),!0):(this.logger.error(pt+" event "+t+" no found"),!1)},Hn.prototype._off=function(t,e){var n;return this.stateCenter.listenerList[t]?(n=this.stateCenter.listenerList[t],e?n.splice(n.indexOf(e),1):this.stateCenter.listenerList[t]=[],!0):(this.logger.error("zm.off listener no found"),!1)},Hn.prototype.isTestEnvironment=function(){return this.stateCenter.testEnvironment},Hn.prototype.isLogin=function(t){return!!(t=this.getRoomModules(t)||this.stateCenter.roomModulesList[0])&&t.isLogin()},Hn.prototype.getMultiRoom=function(){return this.stateCenter.isMultiRoom},Hn.prototype.getAppID=function(){return this.stateCenter.appid},Hn.prototype.getUserID=function(){return this.stateCenter.idName},Hn.prototype.getUserName=function(){return this.stateCenter.nickName},Hn.prototype.getToken=function(t){return(this.getRoomModules(t)||this.stateCenter.roomModulesList[0]).token},Hn.prototype.setRoomCreateFlag=function(t){this.stateCenter.roomCreateFlag=t},Hn.prototype.setRole=function(t){this.stateCenter.role=t},Hn.prototype.getSessionId=function(t){return(t=this.getRoomModules(t)||this.stateCenter.roomModulesList[0])?t.userSidString:"0"},Hn.prototype.getRoomSessionID=function(t){return(t=this.getRoomModules(t)||this.stateCenter.roomModulesList[0])?t.roomSidString:"0"},Hn.prototype.getAppConfig=function(){return this.stateCenter.appConfig},Hn.prototype.setTestPackageSize=function(t){this.cloudSetting.zegoSetting.settingFetchHandler.testNetPackageSize=t,this.stateCenter.testNetPackageSize=t},Hn.prototype.setAccess=function(t){this.stateCenter.configOK&&(this.stateCenter.netHasSet=!0,this.stateCenter.useNetAgent=t,this.stateCenter.useNetAgent=this.getSettingUnify(!0),this.netAgent.setAccess(this.isUseNetAgent),this.cloudSetting.setOptions({unify:this.isUseNetAgent}))},Hn.prototype.enableMultiRoom=function(t){var e=this.stateCenter.reporter.createSpan(a.H,{key:Bt.event},{key:""},ce.event);return"boolean"!=typeof t?(this.logger.error("zm.emr param must be boolean"),this.stateCenter.reporter.setError(e,ce.error.kAlreadyLoginError),!1):(e.setAttribute("is_multi",ce.is_multi(t)),0<this.stateCenter.roomModulesList.length||this.stateCenter.setMultiRoom?(this.logger.error("zm.emr multi room can only be set once before first login"),this.stateCenter.reporter.setError(e,ce.error.kInvalidParamError),!1):(e.end(),this.stateCenter.isMultiRoom=t,this.stateCenter.setMultiRoom=!0))},Hn.prototype.getRoomModules=function(t){return this.stateCenter.roomModulesList.find((function(e){return e.roomID==t}))},Hn.prototype._onAppConfigUpdate=function(t){},Hn.prototype._onBeforePageUnload=function(){},Hn.use=function(t){switch(t.type){case"message":case"live":t.install(Hn,Ye,Xe,Nn)}},Hn.setGeoFence=function(t,e){if(![0,1,2].includes(t))throw new Error("GeoFencing set Error");if(!e.every((function(t){return Q.find((function(e){return e===t}))})))throw new Error("GeoFencing set Error");Hn.geoFenceType=t,Hn.geoFenceAreaList=e},Hn.setEngineOptions=function(t){if(t.geoFenceType){if(![0,1,2].includes(t.geoFenceType))throw new Error("GeoFencing set Error");Hn.geoFenceType=t.geoFenceType}if(t.geoFenceAreaList){if(!t.geoFenceAreaList.every((function(t){return $.find((function(e){return e.id===t}))})))throw new Error("GeoFencing set Error");Hn.geoFenceAreaList=t.geoFenceAreaList}Hn.engineOptions=t},Hn.prototype.resetRoomTokenTimer=function(t,e){(t=this.getRoomModules(t)||this.stateCenter.roomModulesList[0])&&e&&0<e&&t.roomHandler.resetTokenTimer(1e3*e)},Hn.prototype.isDisConnect=function(){return(this.isUseNetAgent?this.liveRoomHandler:this.service).isDisConnect()},Hn.prototype.sendMessage=function(t,e,n,r){(this.isUseNetAgent?this.liveRoomHandler:this.service).sendMessage(t,e,n,r)},Hn.prototype.getNetworkInfo=function(){return this.netAgent.getNTP()},Hn.prototype.setProtoFormat=function(t){if(!["json","pb"].includes(t=void 0===t?"json":t))throw new Error("Failed to execute 'setProtoFormat': Arguments 'format' must be 'json' or 'pb'.");this.stateCenter.protoFormat=t},Hn.prototype.setSdkLoginRelateService=function(t){Array.isArray(t)&&t.every((function(t){return"string"==typeof t}))&&(this.stateCenter.relateService=t)},Hn.prototype.sendMessageByService=function(t,e,n,r,i,o){return this.service.sendMessage(t,e,n,r,i,o)},Hn.prototype.getHeader=function(t){var e=this.stateCenter.roomModulesList[0];if(e&&e.isLogin())return this.service.getHeader(t,e.sessionID,e.roomID,e=e.roomSessionID);this.logger.error("zm.gh room no found or no login")},Hn.prototype.sendPB=function(t){return t instanceof Uint8Array?this.service.sendPB(t):(this.logger.error("zm.spb type error"),!1)},Hn.prototype.onPushBizChannel=function(t){t&&this.service.on("push_biz_channel",t)},Hn.prototype.getRoomID=function(){return this.stateCenter.roomid},Hn.prototype.getServerTimeOffset=function(){return this.stateCenter.serverTimeOffset},Hn.prototype.getReqHead=function(t){return t="string"==typeof t&&""!==t&&this.getRoomModules(t)||this.stateCenter.roomModulesList[0],this.liveRoomHandler.getReqHead(t)},Hn.prototype.sendSwitchMessage=function(t,e){throw this.logger.error("".concat("zm.ssm"," ").concat(O.WHITE_BOARD_VERSION_ERROR.msg)),O.WHITE_BOARD_VERSION_ERROR},Hn.prototype.onSwitchMessage=function(t){t&&this.liveRoomHandler&&(this.liveRoomHandler.onSwitchMessage=t)},Hn.prototype.onAppConfigUpdate=function(t){t&&(this._onAppConfigUpdate=t)},Hn.prototype.onBeforePageUnload=function(t){t&&(this._onBeforePageUnload=t)},Hn.prototype.getProtoVer=function(){return r.SWITCH_TWO},Hn.prototype.sendBusinessMessage=function(t,e,n){return"number"==typeof t&&e?this.liveRoomHandler.sendMessage(t,e,void 0,void 0,n,void 0,!1):-1},Hn.prototype.logoutSpan=function(t,e,n){var r=this,i=this.stateCenter.reporter.createSpan(a.I,{key:Bt.event},{key:Qt.event,par:null==t?void 0:t.roomID},Qt.event,!0);i.setAttributes({is_multi:Qt.is_multi(this.stateCenter.isMultiRoom),is_send_cmd_net:Qt.is_send_cmd_net(!0)}),t?i.setAttributes({room_id:Qt.room_id(null==t?void 0:t.roomID),room_sid_string:Qt.room_sid_string(null==t?void 0:t.roomSidString),liveroom_sid_string:Qt.liveroom_sid_string(null==t?void 0:t.userSidString)}):"string"==typeof n&&i.setAttributes({room_id:Qt.room_id(n)}),e?this.stateCenter.reporter.setError(i,e):i.end(),setTimeout((function(){r.reporter.flush()}),200)},Hn.prototype.getMsgSpan=function(t,e,n){return this.stateCenter.reporter.createSpan(a.H,{key:Vt.event,par:e},{key:t,par:e},t,n=void 0!==n&&n)},Hn.prototype.updateTimeOffsetInterval=function(){var t=this;"number"==typeof this.netAgent.timeOffset&&this.stateCenter.reporter.setTimeOffset(this.netAgent.timeOffset),this.timeOffsetUpdateTimer=setTimeout((function(){t.updateTimeOffsetInterval()}),9e5)},Hn.prototype.setLocalGeoFencing=function(){var t;null!=(t=this.stateCenter.netGeoFencing)&&t.id&&null!=(t=this.stateCenter.netGeoFencing)&&t.accesshub&&(t=D(JSON.stringify(this.stateCenter.netGeoFencing),V),B("z_geos_"+this.stateCenter.appid+"_"+(this.stateCenter.mode||K.modeNo),t),this.stateCenter.netGeoFencing={})},Hn.prototype.getLocalGeoFencing=function(){var t=H("z_geos_"+this.stateCenter.appid+"_"+(this.stateCenter.mode||K.modeNo));if(t){if(t=x(t,V))try{return JSON.parse(t)}catch(t){this.logger.warn("zm.glgf local geo descrypt fail")}}else this.logger.info("zm.glgf no local geo");return null},Hn.prototype.getGeoFencingIDAndDomain=function(t,e){var n=[];return 1===t?e.forEach((function(t){var e=$.find((function(e){return e.id===t}));e&&n.push(e)})):2===t&&(n=JSON.parse(JSON.stringify($)),e.forEach((function(t){var e=$.find((function(e){return e.id===t}));e&&(n=n.filter((function(t){return t.id!==(null==e?void 0:e.id)})),e.relative_geofencings.forEach((function(t){n=n.filter((function(e){return e.id!==t}))})))}))),0<n.length?n:null},Hn.rtmVersion="2.0.0",Hn);function Hn(t,e,n,r,o,s,c,l){var h,f,g,_=this,m=(this.logger=n,this.dataReport=r,this.reporter=o,this.version=s,this.options=l,this.roomLoginResponseListener=function(){clearTimeout(_.cloudSettingTimer),_.cloudSettingTimer=setTimeout((function(){_.logger.info(st+" fetch cloud setting"),_.getCloudSetting()}),100)},this.stateCenter=new Be(this.logger,this.dataReport),this.stateCenter.ENV=c,this.stateCenter.product=q.product,this.cloudSetting=new Pn,this.getReportSeq=p,this.getSeq=d,this.initCallback(),this.stateCenter.deviceID=G.generateUUID(c),this.logger.info("".concat(rt," device ID is ").concat(this.stateCenter.deviceID)),this.reporter.init(t,c,this.stateCenter.deviceID),this.reporter.setLogger(this.logger),this.stateCenter.reporter=this.reporter,Bt),v=this.stateCenter.reporter.createSpan(a.H,{key:""},{key:m.event},m.event,!0);0!=c&&1!=c||this.setDebug(e),n="Express",null!=(r=this.options)&&r.reportData&&(h=null==(s=null==(o=this.options)?void 0:o.reportData)?void 0:s.version,n=(null==(r=null==(l=this.options)?void 0:l.reportData)?void 0:r.project)||n),v.setAttributes({biz_type:m.biz_type(0),project:m.project(n),servers:m.servers("string"==typeof e?[e]:e),liveroom_version:m.liveroom_version(h),is_from_cache:m.is_from_cache(!1),sev_env:m.sev_env(this.stateCenter.testEnvironment?"test":"online")}),G.checkConfigParam(t,e,this.logger)?(this.stateCenter.appid=t,this.stateCenter.configOK=!0,this.stateCenter.sdKVersion=this.version,this.stateCenter.testEnvironment&&(this.stateCenter.mode=S.MODE_TEST),this.netAgent=new I,this.logger.setSessionInfo(this.stateCenter.appid,"","","","",this.version),this.netAgent.init(),this.netAgent.setLogger(this.logger),o={appID:this.stateCenter.appid,env:this.stateCenter.ENV,mode:this.stateCenter.mode},Hn.geoFenceType&&Hn.geoFenceAreaList&&(o.geoFencing={type:Hn.geoFenceType,list:Hn.geoFenceAreaList}),this.netAgent.setAppInfo(o),this.liveRoomHandler=new Nn(this.logger,this.stateCenter,this.netAgent,this.dataReport,this),this.service=new Xe(this.stateCenter,this.logger,this),s="",0===c?s="rtc":1===c&&(s="ali"),this.stateCenter.settingConfig=new tn,this.cloudSetting.setLog(this.logger),this.cloudSetting.init({productNum:1,appID:t,env:c,pollingNotify:function(t,e){_.logger.info(rt," setting file changed "+t+" "+JSON.stringify(e)),_.stateCenter.actionListener("_cloudSettingNotify",t,e)},reportNotify:this.cloudReportNotify.bind(this),online:!this.stateCenter.testEnvironment,unify:this.isUseNetAgent,connection:this.netAgent}),(l=this.stateCenter.settingConfig.getSetting("remote_log_level"))&&(this.logger.info("".concat(rt," setting remote_log_level default ").concat(l)),this.logger.setRemoteLogLevel(l)),void 0!==(r=this.stateCenter.settingConfig.getSetting("zip_log"))&&(this.logger.info("".concat(rt," setting zip_log default ").concat(r)),this.logger.setZipLogConfig(r)),this.cloudSetting.setEnvVariable("environment",s),n=this.cloudSetting.getSettingCache(j),h=this.cloudSetting.getSettingCache("room"),f=!1,g=setTimeout((function(){_.logger.warn("".concat(rt," time out, get cache settings failed!")),_.isUseNetAgent&&(f=!0,_.createNetAgent(),_.getStoreAppConfig()),v.setAttributes({use_na:m.use_na(_.isUseNetAgent?1:0)}),v.end()}),3e3),Promise.all([n,h]).then((function(n){g&&clearTimeout(g);var r=null==n?void 0:n[0],i=(void 0!==(_.stateCenter.settingConfig.setSetting(null==r?void 0:r.setting),_.stateCenter.useNetAgent=_.getSettingUnify(_.stateCenter.netHasSet),_.cloudSetting.setOptions({unify:_.isUseNetAgent}),_.isUseNetAgent&&!f&&(_.createNetAgent(),_.getStoreAppConfig()),(s=_.stateCenter.settingConfig.getSetting("remote_log_level",!0))&&(_.logger.info("".concat(rt,"  setting remote_log_level ").concat(s)),_.logger.setRemoteLogLevel(s)),_.handleZipLogUrl(),s=_.stateCenter.settingConfig.getSetting("zip_log"))&&(_.logger.info("".concat(rt," setting zip_log ").concat(s)),_.logger.setZipLogConfig(s)),(s=_.stateCenter.settingConfig.getSetting("report_script"))?(i=s.url,o=s.key,s=s.hash,_.logger.info("".concat(rt," report script ").concat(i," ").concat(o," ").concat(s)),_.stateCenter.reporter.loadScript(!1,i,o,s),v.setAttributes({lua_md5:m.lua_md5(s)})):_.stateCenter.reporter.loadScript(!1,"","",""),null==n?void 0:n[1]),o=(_.stateCenter.settingConfig.setSetting(null==i?void 0:i.setting),_.stateCenter.reporter.createSpan(a.H,{key:m.event},{key:""},"/cloud_setting/cache")),s=(o.setAttributes({files:le([{name:j,content:JSON.stringify(null==r?void 0:r.setting),versions:JSON.stringify(null==r?void 0:r.versions),code:0,message:""},{name:"room",content:JSON.stringify(null==i?void 0:i.setting),versions:JSON.stringify(null==i?void 0:i.versions),code:0,message:""}])}),o.end(),v.setAttributes({use_na:m.use_na(_.isUseNetAgent?1:0)}),v.end(),Array.isArray(e)?e[0]:e);if(!_.isUseNetAgent&&!U(s,t))throw _.logger.error("".concat(rt," the server does not match the appID")),new Error("The server does not match the appID")})).catch((function(t){if(g&&clearTimeout(g),v.setAttributes({use_na:m.use_na(_.isUseNetAgent?1:0)}),v.end(),_.logger.warn("".concat(rt,"  initConfig ").concat(JSON.stringify(t))),(null==t?void 0:t.code)===O.GEO_SET_ERROR.code)throw Error("GeoFencing set Error")})),"string"==typeof e?(this.stateCenter.server=e,this.stateCenter.serverBak=e):Array.isArray(e)&&0<e.length&&(this.stateCenter.server=e[0],this.stateCenter.serverBak=e[1]||e[0]),this.logger.info("".concat(rt,"  ").concat(null===navigator||void 0===navigator?void 0:navigator.appVersion," ").concat(this.version," rtmVersion: ").concat(Hn.rtmVersion," logVersion:").concat(i.ZegoLogger.logVersion)),this.bindWindowListener(),this.stateCenter.networkState=!navigator||navigator.onLine?u.online:u.offline,o="Firefox"===P()?null===navigator||void 0===navigator?void 0:navigator.userAgent:null===navigator||void 0===navigator?void 0:navigator.appVersion,v.setAttribute("sys_info",o||""),this.initSpans(),this.logger.setSessionInfo(this.stateCenter.appid,"","","","",this.version)):(this.logger.error("".concat(rt," init sdk error")),this.stateCenter.reporter.setError(v,m.error.kInvalidParamError)),this.stateCenter.onListener("roomLoginResponse",this.roomLoginResponseListener)}var zn=n(7),Gn=function(){return(Gn=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},Fn=(qn.prototype.init=function(t,e,n){var r=this;this.tracer.init({product:this.product,version:"1.0.0",env:e,appID:t,deviceID:n,importantLevel:q.importLevel,levels:q.levels,bps:q.bps,spanStart:function(t){try{"function"==typeof scriptSpanStart&&scriptSpanStart(r.commonStates,r.tracer,t)}catch(t){r.logger.warn("zm.tc.ii dy span start ",JSON.stringify(t))}},spanBeforeEnd:function(t){t.setAttribute("ntype_end",M())},spanEnd:function(t,e){try{"function"==typeof scriptSpanEnd&&scriptSpanEnd(r.commonStates,r.tracer,t)}catch(t){r.logger.warn("zm.tc.ii dy span end ",JSON.stringify(t))}},resources:{product:this.product,appid:t,device_id:n,console:0==e?"rtc":"ali"}})},qn.prototype.setConfig=function(t){this.tracer.setConfig(t)},qn.prototype.loadScript=function(t,e,n,r){return function(t,e,n,r){return new(n=n||Promise)((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):((e=t.value)instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}(this,void 0,void 0,(function(){var i;return function(t,e){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s={next:a(0),throw:a(1),return:a(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(u){var c=[a,u];if(n)throw new TypeError("Generator is already executing.");for(;o=s&&c[s=0]?0:o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,(c=i?[2&c[0],i.value]:c)[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=0<(i=o.trys).length&&i[i.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3]))o.label=c[1];else if(6===c[0]&&o.label<i[1])o.label=i[1],i=c;else{if(!(i&&o.label<i[2])){i[2]&&o.ops.pop(),o.trys.pop();continue}o.label=i[2],o.ops.push(c)}}c=e.call(t,o)}catch(u){c=[6,u],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.tracer.loadJs(t,e,n,r,"\nfunction scriptSpanStart(states, tracer, span) {\n    \n}\nfunction scriptSpanEnd(states, tracer, span) {\n    if (span['tags']['msg_content']) {\n        span['tags']['msg_content_size'] = span['tags']['msg_content'].length;\n        delete span['tags']['msg_content'];\n    }\n    delete span['tags']['resp'];\n    const filterSpans = ['/rtc/login', '/rtc/hb', '/rtc/recv_remote_stream'];\n    if (filterSpans.includes(span.name)) {\n        console.log(span.name + ' do not report');\n        span.droped = true;\n    }\n}\nfunction scriptInit(states, tracer) {\n\n}\n\n",{})];case 1:return o.sent(),"function"==typeof scriptInit&&scriptInit(this.commonStates,this.tracer),[3,3];case 2:return i=o.sent(),this.logger.warn("zm.tc.ls"," load script fail "+JSON.stringify(i)),[3,3];case 3:return[2]}}))}))},qn.prototype.setReporterInfo=function(t,e){var n=new Map;n.set("userID",t),n.set("token",e),this.tracer.startReport(n)},qn.prototype.flush=function(t){this.tracer.flush(t)},qn.prototype.destroy=function(){this.tracer.destroy()},qn.prototype.setCommonStates=function(t){this.commonStates=t},qn.prototype.setResource=function(t){this.tracer.setResource(t)},qn.prototype.setCommonAttributes=function(t){this.commonAttrs=Object.assign({},this.commonAttrs,t)},qn.prototype.createSpan=function(t,e,n){return(t=this.tracer.createSpan(t,e,{parent:n})).setAttributes(Gn({ntype:M(),error:0,message:""},this.commonAttrs)),t},qn.prototype.spanEnd=function(t,e){t&&e&&t.setAttributes(Gn({},e)),t&&t.end()},qn.prototype.spanSetAttributes=function(t,e){t&&t.setAttributes(e)},qn.prototype.spanAppendAttribute=function(t,e,n){t&&t.appendAttribute(e,n)},qn.prototype.setError=function(t,e,n){t.setAttributes({error:e.code||e.errorCode,message:(e.msg||e.message||e.extendedData)+" "+(n=void 0===n?"":n)}),t.end()},qn.prototype.setLogger=function(t){this.tracer.setLogger(t)},qn.prototype.setTimeOffset=function(t){this.tracer.setTimeOffset(t)},qn.prototype.setUnloadState=function(t){this.isUnload=!0,this.tracer.setUnloadState(t)},qn.prototype.setNetStateCheck=function(){this.tracer.setNetStateCheck()},qn);function qn(t){this.logger=t,this.product=q.product,this.commonAttrs={},this.commonStates={},this.isUnload=!1,new zn.DynamicCode,this.tracer=new zn.ZegoTracer,this.tracer.setSampleConfig({level:a.L})}var jn=["/sdk/start_publish","/publish/start","/publish/restart"],Vn=["/sdk/start_play","/play/start","/play/restart"],Wn=(Yn.prototype.init=function(t,e,n){this.tracerHandler.init(t,e,n)},Yn.prototype.setConfig=function(t){this.tracerHandler.setConfig(t)},Yn.prototype.loadScript=function(t,e,n,r){return this.tracerHandler.loadScript(t,e,n,r)},Yn.prototype.setReporterInfo=function(t,e){this.tracerHandler.setReporterInfo(t,e)},Yn.prototype.flush=function(t){this.tracerHandler.flush(t)},Yn.prototype.destroy=function(){this.tracerHandler.destroy()},Yn.prototype.setCommonStates=function(t){this.tracerHandler.setCommonStates(t)},Yn.prototype.setResource=function(t){this.tracerHandler.setResource(t)},Yn.prototype.setCommonAttributes=function(t){this.tracerHandler.setCommonAttributes(t)},Yn.prototype.setPublicPros=function(t){this.publicPros=Object.assign({},this.publicPros,t)},Yn.prototype.createSpan=function(t,e,n,r,i){var o;e&&e.key&&e.par?(s=e.par1?"_"+e.par1:"",!(o=null==(o=this.reportList[e.key])?void 0:o[e.par+s])&&e.bak_key&&(o=null==(a=this.reportList[e.bak_key])?void 0:a[e.par+s])):e&&!(o=this.reportList[e.key])&&e.bak_key&&(o=this.reportList[e.bak_key]);var s,a=this.tracerHandler.createSpan(t,r,o=o||this.reportList[Bt.event]);return"/sdk/login"===e.key&&(a.setAttribute("room_id",e.par),this.publicPros[e.par])&&a.setAttributes(this.publicPros[e.par]),(jn.includes(e.key)||Vn.includes(e.key))&&a.setAttribute("stream_id",e.par),jn.includes(e.key)&&this.publicPros["_publish_"+e.par]&&a.setAttributes(this.publicPros["_publish_"+e.par]),Vn.includes(e.key)&&this.publicPros["_play_"+e.par]&&a.setAttributes(this.publicPros["_play_"+e.par]),i&&(n.par?(this.reportList[n.key]||(this.reportList[n.key]={}),this.reportList[n.key][n.par+(s=n.par1?"_"+n.par1:"")]=a):this.reportList[n.key]=a),a},Yn.prototype.setSpanInMap=function(t,e){e.par?(this.reportList[e.key]||(this.reportList[e.key]={}),this.reportList[e.key][e.par+(e.par2?"_"+e.par2:"")]=t):this.reportList[e.key]=t},Yn.prototype.spanEnd=function(t,e,n){var r;t.par?(r=t.par1?"_"+t.par1:"",r=this.reportList[t.key]&&this.reportList[t.key][t.par+r],this.reportList[t.key]&&!n&&delete this.reportList[t.key][t.par]):(r=this.reportList[t.key],n||delete this.reportList[t.key]),this.tracerHandler.spanEnd(r,e)},Yn.prototype.spanSetAttributes=function(t,e){var n,r;t.par?(n=t.par1?"_"+t.par1:"",!(r=this.reportList[t.key]&&this.reportList[t.key][t.par+n])&&t.bak_key&&(r=this.reportList[t.bak_key]&&this.reportList[t.bak_key][t.par+n])):!(r=this.reportList[t.key])&&t.bak_key&&(r=this.reportList[t.key]),this.tracerHandler.spanSetAttributes(r,e)},Yn.prototype.spanAppendAttribute=function(t,e,n){var r,i;t.par?(r=t.par1?"_"+t.par1:"",!(i=this.reportList[t.key]&&this.reportList[t.key][t.par+r])&&t.bak_key&&(i=this.reportList[t.bak_key]&&this.reportList[t.bak_key][t.par+r])):!(i=this.reportList[t.key])&&t.bak_key&&(i=this.reportList[t.key]),this.tracerHandler.spanAppendAttribute(i,e,n)},Yn.prototype.setError=function(t,e,n){this.tracerHandler.setError(t,e,n)},Yn.prototype.setLogger=function(t){this.tracerHandler.setLogger(t)},Yn.prototype.setTimeOffset=function(t){this.tracerHandler.setTimeOffset(t)},Yn.prototype.setUnloadState=function(t){this.tracerHandler.setUnloadState(t)},Yn.prototype.setNetStateCheck=function(){this.tracerHandler.setNetStateCheck()},Yn);function Yn(t){this.logger=t,this.reportList={},this.publicPros={},this.tracerHandler=new Fn(t)}Kn.prototype.enableMultiRoom=function(t){return this.zegoWebRTM.enableMultiRoom(t)},Kn.prototype.loginRoom=function(t,e,n,r){return this.zegoWebRTM.loginRoom(t,e,n,r)},Kn.prototype.logoutRoom=function(t){return this.zegoWebRTM.logoutRoom(t)},Kn.prototype.renewToken=function(t,e){return this.zegoWebRTM.renewToken(t,e)},Kn.prototype.sendBarrageMessage=function(t,e){return this.zegoWebRTM.sendBarrageMessage(t,e)},Kn.prototype.sendBroadcastMessage=function(t,e){return this.zegoWebRTM.sendBroadcastMessage(t,e)},Kn.prototype.sendCustomCommand=function(t,e,n){return this.zegoWebRTM.sendCustomCommand(t,e,n)},Kn.prototype.setRoomExtraInfo=function(t,e,n){return this.zegoWebRTM.setRoomExtraInfo(t,e,n)},Kn.prototype.setLogConfig=function(t){return this.zegoWebRTM.setLogConfig(t)},Kn.prototype.setDebugVerbose=function(t){return this.zegoWebRTM.setDebugVerbose(t)},Kn.prototype.on=function(t,e){return this.zegoWebRTM.on(t,e)},Kn.prototype.getVersion=function(){return this.zegoWebRTM.getVersion()},Kn.prototype.off=function(t,e){return this.zegoWebRTM.off(t,e)},Kn.use=function(t){Bn.use(t)},Kn.setGeoFence=function(t,e){Bn.setGeoFence(t,e)},Kn.setEngineOptions=function(t){Bn.setEngineOptions(t)},Kn.version="2.0.0";var Zn=Kn;function Kn(t,e,n,r){this.logger=new i.ZegoLogger(n=void 0===n?0:n),this.dataReport=new i.ZegoDataReport(this.logger),this.reporter=new Wn(this.logger),this.zegoWebRTM=new Bn(t,e,this.logger,this.dataReport,this.reporter,Kn.version,n,r)}}],i={},n.m=r,n.c=i,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=19);function n(t){var e;return(i[t]||(e=i[t]={i:t,l:!1,exports:{}},r[t].call(e.exports,e,e.exports,n),e.l=!0,e)).exports}var r,i}(n(782),n(13))},1679:function(t){"use strict";t.exports=function(t,e){var n=new Array(arguments.length-1),r=0,i=2,o=!0;for(;i<arguments.length;)n[r++]=arguments[i++];return new Promise((function(i,s){n[r]=function(t){if(o)if(o=!1,t)s(t);else{for(var e=new Array(arguments.length-1),n=0;n<e.length;)e[n++]=arguments[n];i.apply(null,e)}};try{t.apply(e||null,n)}catch(t){o&&(o=!1,s(t))}}))}},1420:function(t,e){"use strict";var n=e;n.length=function(t){var e=t.length;if(!e)return 0;for(var n=0;--e%4>1&&"="===t.charAt(e);)++n;return Math.ceil(3*t.length)/4-n};for(var r=new Array(64),i=new Array(123),o=0;o<64;)i[r[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;n.encode=function(t,e,n){for(var i,o=null,s=[],a=0,u=0;e<n;){var c=t[e++];switch(u){case 0:s[a++]=r[c>>2],i=(3&c)<<4,u=1;break;case 1:s[a++]=r[i|c>>4],i=(15&c)<<2,u=2;break;case 2:s[a++]=r[i|c>>6],s[a++]=r[63&c],u=0}a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0)}return u&&(s[a++]=r[i],s[a++]=61,1===u&&(s[a++]=61)),o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var s="invalid encoding";n.decode=function(t,e,n){for(var r,o=n,a=0,u=0;u<t.length;){var c=t.charCodeAt(u++);if(61===c&&a>1)break;if(void 0===(c=i[c]))throw Error(s);switch(a){case 0:r=c,a=1;break;case 1:e[n++]=r<<2|(48&c)>>4,r=c,a=2;break;case 2:e[n++]=(15&r)<<4|(60&c)>>2,r=c,a=3;break;case 3:e[n++]=(3&r)<<6|c,a=0}}if(1===a)throw Error(s);return n-o},n.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}},138:function(t){"use strict";function e(){this._listeners={}}t.exports=e,e.prototype.on=function(t,e,n){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:e,ctx:n||this}),this},e.prototype.off=function(t,e){if(void 0===t)this._listeners={};else if(void 0===e)this._listeners[t]=[];else for(var n=this._listeners[t],r=0;r<n.length;)n[r].fn===e?n.splice(r,1):++r;return this},e.prototype.emit=function(t){var e=this._listeners[t];if(e){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<e.length;)e[r].fn.apply(e[r++].ctx,n)}return this}},3209:function(t){"use strict";function e(t){return"undefined"!=typeof Float32Array?function(){var e=new Float32Array([-0]),n=new Uint8Array(e.buffer),r=128===n[3];function i(t,r,i){e[0]=t,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3]}function o(t,r,i){e[0]=t,r[i]=n[3],r[i+1]=n[2],r[i+2]=n[1],r[i+3]=n[0]}function s(t,r){return n[0]=t[r],n[1]=t[r+1],n[2]=t[r+2],n[3]=t[r+3],e[0]}function a(t,r){return n[3]=t[r],n[2]=t[r+1],n[1]=t[r+2],n[0]=t[r+3],e[0]}t.writeFloatLE=r?i:o,t.writeFloatBE=r?o:i,t.readFloatLE=r?s:a,t.readFloatBE=r?a:s}():function(){function e(t,e,n,r){var i=e<0?1:0;if(i&&(e=-e),0===e)t(1/e>0?0:2147483648,n,r);else if(isNaN(e))t(2143289344,n,r);else if(e>34028234663852886e22)t((i<<31|2139095040)>>>0,n,r);else if(e<11754943508222875e-54)t((i<<31|Math.round(e/1401298464324817e-60))>>>0,n,r);else{var o=Math.floor(Math.log(e)/Math.LN2);t((i<<31|o+127<<23|8388607&Math.round(e*Math.pow(2,-o)*8388608))>>>0,n,r)}}function s(t,e,n){var r=t(e,n),i=2*(r>>31)+1,o=r>>>23&255,s=8388607&r;return 255===o?s?NaN:i*(1/0):0===o?1401298464324817e-60*i*s:i*Math.pow(2,o-150)*(s+8388608)}t.writeFloatLE=e.bind(null,n),t.writeFloatBE=e.bind(null,r),t.readFloatLE=s.bind(null,i),t.readFloatBE=s.bind(null,o)}(),"undefined"!=typeof Float64Array?function(){var e=new Float64Array([-0]),n=new Uint8Array(e.buffer),r=128===n[7];function i(t,r,i){e[0]=t,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3],r[i+4]=n[4],r[i+5]=n[5],r[i+6]=n[6],r[i+7]=n[7]}function o(t,r,i){e[0]=t,r[i]=n[7],r[i+1]=n[6],r[i+2]=n[5],r[i+3]=n[4],r[i+4]=n[3],r[i+5]=n[2],r[i+6]=n[1],r[i+7]=n[0]}function s(t,r){return n[0]=t[r],n[1]=t[r+1],n[2]=t[r+2],n[3]=t[r+3],n[4]=t[r+4],n[5]=t[r+5],n[6]=t[r+6],n[7]=t[r+7],e[0]}function a(t,r){return n[7]=t[r],n[6]=t[r+1],n[5]=t[r+2],n[4]=t[r+3],n[3]=t[r+4],n[2]=t[r+5],n[1]=t[r+6],n[0]=t[r+7],e[0]}t.writeDoubleLE=r?i:o,t.writeDoubleBE=r?o:i,t.readDoubleLE=r?s:a,t.readDoubleBE=r?a:s}():function(){function e(t,e,n,r,i,o){var s=r<0?1:0;if(s&&(r=-r),0===r)t(0,i,o+e),t(1/r>0?0:2147483648,i,o+n);else if(isNaN(r))t(0,i,o+e),t(2146959360,i,o+n);else if(r>17976931348623157e292)t(0,i,o+e),t((s<<31|2146435072)>>>0,i,o+n);else{var a;if(r<22250738585072014e-324)t((a=r/5e-324)>>>0,i,o+e),t((s<<31|a/4294967296)>>>0,i,o+n);else{var u=Math.floor(Math.log(r)/Math.LN2);1024===u&&(u=1023),t(4503599627370496*(a=r*Math.pow(2,-u))>>>0,i,o+e),t((s<<31|u+1023<<20|1048576*a&1048575)>>>0,i,o+n)}}}function s(t,e,n,r,i){var o=t(r,i+e),s=t(r,i+n),a=2*(s>>31)+1,u=s>>>20&2047,c=4294967296*(1048575&s)+o;return 2047===u?c?NaN:a*(1/0):0===u?5e-324*a*c:a*Math.pow(2,u-1075)*(c+4503599627370496)}t.writeDoubleLE=e.bind(null,n,0,4),t.writeDoubleBE=e.bind(null,r,4,0),t.readDoubleLE=s.bind(null,i,0,4),t.readDoubleBE=s.bind(null,o,4,0)}(),t}function n(t,e,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24}function r(t,e,n){e[n]=t>>>24,e[n+1]=t>>>16&255,e[n+2]=t>>>8&255,e[n+3]=255&t}function i(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function o(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}t.exports=e(e)},4556:function(module){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}module.exports=inquire},3794:function(t){"use strict";t.exports=function(t,e,n){var r=n||8192,i=r>>>1,o=null,s=r;return function(n){if(n<1||n>i)return t(n);s+n>r&&(o=t(r),s=0);var a=e.call(o,s,s+=n);return 7&s&&(s=1+(7|s)),a}}},2482:function(t,e){"use strict";var n=e;n.length=function(t){for(var e=0,n=0,r=0;r<t.length;++r)(n=t.charCodeAt(r))<128?e+=1:n<2048?e+=2:55296==(64512&n)&&56320==(64512&t.charCodeAt(r+1))?(++r,e+=4):e+=3;return e},n.read=function(t,e,n){if(n-e<1)return"";for(var r,i=null,o=[],s=0;e<n;)(r=t[e++])<128?o[s++]=r:r>191&&r<224?o[s++]=(31&r)<<6|63&t[e++]:r>239&&r<365?(r=((7&r)<<18|(63&t[e++])<<12|(63&t[e++])<<6|63&t[e++])-65536,o[s++]=55296+(r>>10),o[s++]=56320+(1023&r)):o[s++]=(15&r)<<12|(63&t[e++])<<6|63&t[e++],s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0);return i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))},n.write=function(t,e,n){for(var r,i,o=n,s=0;s<t.length;++s)(r=t.charCodeAt(s))<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):55296==(64512&r)&&56320==(64512&(i=t.charCodeAt(s+1)))?(++s,e[n++]=(r=65536+((1023&r)<<10)+(1023&i))>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128);return n-o}},13:function(t,e,n){
/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/
t.exports=function t(e,n,r){function i(s,a){if(!n[s]){if(!e[s]){if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[s]={exports:{}};e[s][0].call(c.exports,(function(t){var n=e[s][1][t];return i(n||t)}),c,c.exports,t,e,n,r)}return n[s].exports}for(var o=void 0,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e,r){(function(t){"use strict";var n,r,i=t.MutationObserver||t.WebKitMutationObserver;if(i){var o=0,s=new i(l),a=t.document.createTextNode("");s.observe(a,{characterData:!0}),n=function(){a.data=o=++o%2}}else if(t.setImmediate||void 0===t.MessageChannel)n="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){l(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(l,0)};else{var u=new t.MessageChannel;u.port1.onmessage=l,n=function(){u.port2.postMessage(0)}}var c=[];function l(){var t,e;r=!0;for(var n=c.length;n;){for(e=c,c=[],t=-1;++t<n;)e[t]();n=c.length}r=!1}function h(t){1!==c.push(t)||r||n()}e.exports=h}).call(this,void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,n){"use strict";var r=t(1);function i(){}var o={},s=["REJECTED"],a=["FULFILLED"],u=["PENDING"];function c(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,t!==i&&d(this,t)}function l(t,e,n){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function h(t,e,n){r((function(){var r;try{r=e(n)}catch(e){return o.reject(t,e)}r===t?o.reject(t,new TypeError("Cannot resolve promise with itself")):o.resolve(t,r)}))}function f(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function d(t,e){var n=!1;function r(e){n||(n=!0,o.reject(t,e))}function i(e){n||(n=!0,o.resolve(t,e))}function s(){e(i,r)}var a=p(s);"error"===a.status&&r(a.value)}function p(t,e){var n={};try{n.value=t(e),n.status="success"}catch(t){n.status="error",n.value=t}return n}function g(t){return t instanceof this?t:o.resolve(new this(i),t)}function _(t){var e=new this(i);return o.reject(e,t)}function m(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return this.resolve([]);for(var s=new Array(n),a=0,u=-1,c=new this(i);++u<n;)l(t[u],u);return c;function l(t,i){function u(t){s[i]=t,++a!==n||r||(r=!0,o.resolve(c,s))}e.resolve(t).then(u,(function(t){r||(r=!0,o.reject(c,t))}))}}function v(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return this.resolve([]);for(var s=-1,a=new this(i);++s<n;)u(t[s]);return a;function u(t){e.resolve(t).then((function(t){r||(r=!0,o.resolve(a,t))}),(function(t){r||(r=!0,o.reject(a,t))}))}}e.exports=c,c.prototype.catch=function(t){return this.then(null,t)},c.prototype.then=function(t,e){if("function"!=typeof t&&this.state===a||"function"!=typeof e&&this.state===s)return this;var n=new this.constructor(i);return this.state!==u?h(n,this.state===a?t:e,this.outcome):this.queue.push(new l(n,t,e)),n},l.prototype.callFulfilled=function(t){o.resolve(this.promise,t)},l.prototype.otherCallFulfilled=function(t){h(this.promise,this.onFulfilled,t)},l.prototype.callRejected=function(t){o.reject(this.promise,t)},l.prototype.otherCallRejected=function(t){h(this.promise,this.onRejected,t)},o.resolve=function(t,e){var n=p(f,e);if("error"===n.status)return o.reject(t,n.value);var r=n.value;if(r)d(t,r);else{t.state=a,t.outcome=e;for(var i=-1,s=t.queue.length;++i<s;)t.queue[i].callFulfilled(e)}return t},o.reject=function(t,e){t.state=s,t.outcome=e;for(var n=-1,r=t.queue.length;++n<r;)t.queue[n].callRejected(e);return t},c.resolve=g,c.reject=_,c.all=m,c.race=v},{1:1}],3:[function(t,e,r){(function(e){"use strict";"function"!=typeof e.Promise&&(e.Promise=t(2))}).call(this,void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(t){return}}var s=o();function a(){try{if(!s||!s.open)return!1;var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),e="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!t||e)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(t){return!1}}function u(t,e){t=t||[],e=e||{};try{return new Blob(t,e)}catch(i){if("TypeError"!==i.name)throw i;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<t.length;r+=1)n.append(t[r]);return n.getBlob(e.type)}}"undefined"==typeof Promise&&t(3);var c=Promise;function l(t,e){e&&t.then((function(t){e(null,t)}),(function(t){e(t)}))}function h(t,e,n){"function"==typeof e&&t.then(e),"function"==typeof n&&t.catch(n)}function f(t){return"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t)),t}function d(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var p="local-forage-detect-blob-support",g=void 0,_={},m=Object.prototype.toString,v="readonly",y="readwrite";function b(t){for(var e=t.length,n=new ArrayBuffer(e),r=new Uint8Array(n),i=0;i<e;i++)r[i]=t.charCodeAt(i);return n}function S(t){return new c((function(e){var n=t.transaction(p,y),r=u([""]);n.objectStore(p).put(r,"key"),n.onabort=function(t){t.preventDefault(),t.stopPropagation(),e(!1)},n.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);e(n||!t||parseInt(t[1],10)>=43)}})).catch((function(){return!1}))}function E(t){return"boolean"==typeof g?c.resolve(g):S(t).then((function(t){return g=t}))}function T(t){var e=_[t.name],n={};n.promise=new c((function(t,e){n.resolve=t,n.reject=e})),e.deferredOperations.push(n),e.dbReady=e.dbReady?e.dbReady.then((function(){return n.promise})):n.promise}function C(t){var e=_[t.name].deferredOperations.pop();if(e)return e.resolve(),e.promise}function w(t,e){var n=_[t.name].deferredOperations.pop();if(n)return n.reject(e),n.promise}function R(t,e){return new c((function(n,r){if(_[t.name]=_[t.name]||x(),t.db){if(!e)return n(t.db);T(t),t.db.close()}var i=[t.name];e&&i.push(t.version);var o=s.open.apply(s,i);e&&(o.onupgradeneeded=function(e){var n=o.result;try{n.createObjectStore(t.storeName),e.oldVersion<=1&&n.createObjectStore(p)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+t.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+t.storeName+'" already exists.')}}),o.onerror=function(t){t.preventDefault(),r(o.error)},o.onsuccess=function(){var e=o.result;e.onversionchange=function(t){t.target.close()},n(e),C(t)}}))}function I(t){return R(t,!1)}function k(t){return R(t,!0)}function O(t,e){if(!t.db)return!0;var n=!t.db.objectStoreNames.contains(t.storeName),r=t.version>t.db.version;if(t.version<t.db.version&&(t.version!==e&&console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+"."),t.version=t.db.version),r||n){if(n){var i=t.db.version+1;i>t.version&&(t.version=i)}return!0}return!1}function N(t){return new c((function(e,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");e({__local_forage_encoded_blob:!0,data:r,type:t.type})},r.readAsBinaryString(t)}))}function A(t){return u([b(atob(t.data))],{type:t.type})}function L(t){return t&&t.__local_forage_encoded_blob}function P(t){var e=this,n=e._initReady().then((function(){var t=_[e._dbInfo.name];if(t&&t.dbReady)return t.dbReady}));return h(n,t,t),n}function M(t){T(t);for(var e=_[t.name],n=e.forages,r=0;r<n.length;r++){var i=n[r];i._dbInfo.db&&(i._dbInfo.db.close(),i._dbInfo.db=null)}return t.db=null,I(t).then((function(e){return t.db=e,O(t)?k(t):e})).then((function(r){t.db=e.db=r;for(var i=0;i<n.length;i++)n[i]._dbInfo.db=r})).catch((function(e){throw w(t,e),e}))}function D(t,e,n,r){void 0===r&&(r=1);try{var i=t.db.transaction(t.storeName,e);n(null,i)}catch(i){if(r>0&&(!t.db||"InvalidStateError"===i.name||"NotFoundError"===i.name))return c.resolve().then((function(){if(!t.db||"NotFoundError"===i.name&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version)return t.db&&(t.version=t.db.version+1),k(t)})).then((function(){return M(t).then((function(){D(t,e,n,r-1)}))})).catch(n);n(i)}}function x(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function U(t){var e=this,n={db:null};if(t)for(var r in t)n[r]=t[r];var i=_[n.name];i||(i=x(),_[n.name]=i),i.forages.push(e),e._initReady||(e._initReady=e.ready,e.ready=P);var o=[];function s(){return c.resolve()}for(var a=0;a<i.forages.length;a++){var u=i.forages[a];u!==e&&o.push(u._initReady().catch(s))}var l=i.forages.slice(0);return c.all(o).then((function(){return n.db=i.db,I(n)})).then((function(t){return n.db=t,O(n,e._defaultConfig.version)?k(n):t})).then((function(t){n.db=i.db=t,e._dbInfo=n;for(var r=0;r<l.length;r++){var o=l[r];o!==e&&(o._dbInfo.db=n.db,o._dbInfo.version=n.version)}}))}function B(t,e){var n=this;t=f(t);var r=new c((function(e,r){n.ready().then((function(){D(n._dbInfo,v,(function(i,o){if(i)return r(i);try{var s=o.objectStore(n._dbInfo.storeName).get(t);s.onsuccess=function(){var t=s.result;void 0===t&&(t=null),L(t)&&(t=A(t)),e(t)},s.onerror=function(){r(s.error)}}catch(t){r(t)}}))})).catch(r)}));return l(r,e),r}function H(t,e){var n=this,r=new c((function(e,r){n.ready().then((function(){D(n._dbInfo,v,(function(i,o){if(i)return r(i);try{var s=o.objectStore(n._dbInfo.storeName).openCursor(),a=1;s.onsuccess=function(){var n=s.result;if(n){var r=n.value;L(r)&&(r=A(r));var i=t(r,n.key,a++);void 0!==i?e(i):n.continue()}else e()},s.onerror=function(){r(s.error)}}catch(t){r(t)}}))})).catch(r)}));return l(r,e),r}function z(t,e,n){var r=this;t=f(t);var i=new c((function(n,i){var o;r.ready().then((function(){return o=r._dbInfo,"[object Blob]"===m.call(e)?E(o.db).then((function(t){return t?e:N(e)})):e})).then((function(e){D(r._dbInfo,y,(function(o,s){if(o)return i(o);try{var a=s.objectStore(r._dbInfo.storeName);null===e&&(e=void 0);var u=a.put(e,t);s.oncomplete=function(){void 0===e&&(e=null),n(e)},s.onabort=s.onerror=function(){i(u.error?u.error:u.transaction.error)}}catch(t){i(t)}}))})).catch(i)}));return l(i,n),i}function G(t,e){var n=this;t=f(t);var r=new c((function(e,r){n.ready().then((function(){D(n._dbInfo,y,(function(i,o){if(i)return r(i);try{var s=o.objectStore(n._dbInfo.storeName).delete(t);o.oncomplete=function(){e()},o.onerror=function(){r(s.error)},o.onabort=function(){r(s.error?s.error:s.transaction.error)}}catch(t){r(t)}}))})).catch(r)}));return l(r,e),r}function F(t){var e=this,n=new c((function(t,n){e.ready().then((function(){D(e._dbInfo,y,(function(r,i){if(r)return n(r);try{var o=i.objectStore(e._dbInfo.storeName).clear();i.oncomplete=function(){t()},i.onabort=i.onerror=function(){n(o.error?o.error:o.transaction.error)}}catch(t){n(t)}}))})).catch(n)}));return l(n,t),n}function q(t){var e=this,n=new c((function(t,n){e.ready().then((function(){D(e._dbInfo,v,(function(r,i){if(r)return n(r);try{var o=i.objectStore(e._dbInfo.storeName).count();o.onsuccess=function(){t(o.result)},o.onerror=function(){n(o.error)}}catch(t){n(t)}}))})).catch(n)}));return l(n,t),n}function j(t,e){var n=this,r=new c((function(e,r){t<0?e(null):n.ready().then((function(){D(n._dbInfo,v,(function(i,o){if(i)return r(i);try{var s=o.objectStore(n._dbInfo.storeName),a=!1,u=s.openKeyCursor();u.onsuccess=function(){var n=u.result;n?0===t||a?e(n.key):(a=!0,n.advance(t)):e(null)},u.onerror=function(){r(u.error)}}catch(t){r(t)}}))})).catch(r)}));return l(r,e),r}function V(t){var e=this,n=new c((function(t,n){e.ready().then((function(){D(e._dbInfo,v,(function(r,i){if(r)return n(r);try{var o=i.objectStore(e._dbInfo.storeName).openKeyCursor(),s=[];o.onsuccess=function(){var e=o.result;e?(s.push(e.key),e.continue()):t(s)},o.onerror=function(){n(o.error)}}catch(t){n(t)}}))})).catch(n)}));return l(n,t),n}function W(t,e){e=d.apply(this,arguments);var n=this.config();(t="function"!=typeof t&&t||{}).name||(t.name=t.name||n.name,t.storeName=t.storeName||n.storeName);var r,i=this;if(t.name){var o=t.name===n.name&&i._dbInfo.db?c.resolve(i._dbInfo.db):I(t).then((function(e){var n=_[t.name],r=n.forages;n.db=e;for(var i=0;i<r.length;i++)r[i]._dbInfo.db=e;return e}));r=o.then(t.storeName?function(e){if(e.objectStoreNames.contains(t.storeName)){var n=e.version+1;T(t);var r=_[t.name],i=r.forages;e.close();for(var o=0;o<i.length;o++){var a=i[o];a._dbInfo.db=null,a._dbInfo.version=n}var u=new c((function(e,r){var i=s.open(t.name,n);i.onerror=function(t){i.result.close(),r(t)},i.onupgradeneeded=function(){i.result.deleteObjectStore(t.storeName)},i.onsuccess=function(){var t=i.result;t.close(),e(t)}}));return u.then((function(t){r.db=t;for(var e=0;e<i.length;e++){var n=i[e];n._dbInfo.db=t,C(n._dbInfo)}})).catch((function(e){throw(w(t,e)||c.resolve()).catch((function(){})),e}))}}:function(e){T(t);var n=_[t.name],r=n.forages;e.close();for(var i=0;i<r.length;i++)r[i]._dbInfo.db=null;var o=new c((function(e,n){var r=s.deleteDatabase(t.name);r.onerror=function(){var t=r.result;t&&t.close(),n(r.error)},r.onblocked=function(){console.warn('dropInstance blocked for database "'+t.name+'" until all open connections are closed')},r.onsuccess=function(){var t=r.result;t&&t.close(),e(t)}}));return o.then((function(t){n.db=t;for(var e=0;e<r.length;e++)C(r[e]._dbInfo)})).catch((function(e){throw(w(t,e)||c.resolve()).catch((function(){})),e}))})}else r=c.reject("Invalid arguments");return l(r,e),r}var Y={_driver:"asyncStorage",_initStorage:U,_support:a(),iterate:H,getItem:B,setItem:z,removeItem:G,clear:F,length:q,key:j,keys:V,dropInstance:W};function Z(){return"function"==typeof openDatabase}var K="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$="~~local_forage_type~",Q=/^~~local_forage_type~([^~]+)~/,X="__lfsc__:",J=X.length,tt="arbf",et="blob",nt="si08",rt="ui08",it="uic8",ot="si16",st="si32",at="ur16",ut="ui32",ct="fl32",lt="fl64",ht=J+tt.length,ft=Object.prototype.toString;function dt(t){var e,n,r,i,o,s=.75*t.length,a=t.length,u=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);var c=new ArrayBuffer(s),l=new Uint8Array(c);for(e=0;e<a;e+=4)n=K.indexOf(t[e]),r=K.indexOf(t[e+1]),i=K.indexOf(t[e+2]),o=K.indexOf(t[e+3]),l[u++]=n<<2|r>>4,l[u++]=(15&r)<<4|i>>2,l[u++]=(3&i)<<6|63&o;return c}function pt(t){var e,n=new Uint8Array(t),r="";for(e=0;e<n.length;e+=3)r+=K[n[e]>>2],r+=K[(3&n[e])<<4|n[e+1]>>4],r+=K[(15&n[e+1])<<2|n[e+2]>>6],r+=K[63&n[e+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}function gt(t,e){var n="";if(t&&(n=ft.call(t)),t&&("[object ArrayBuffer]"===n||t.buffer&&"[object ArrayBuffer]"===ft.call(t.buffer))){var r,i=X;t instanceof ArrayBuffer?(r=t,i+=tt):(r=t.buffer,"[object Int8Array]"===n?i+=nt:"[object Uint8Array]"===n?i+=rt:"[object Uint8ClampedArray]"===n?i+=it:"[object Int16Array]"===n?i+=ot:"[object Uint16Array]"===n?i+=at:"[object Int32Array]"===n?i+=st:"[object Uint32Array]"===n?i+=ut:"[object Float32Array]"===n?i+=ct:"[object Float64Array]"===n?i+=lt:e(new Error("Failed to get type for BinaryArray"))),e(i+pt(r))}else if("[object Blob]"===n){var o=new FileReader;o.onload=function(){var n=$+t.type+"~"+pt(this.result);e(X+et+n)},o.readAsArrayBuffer(t)}else try{e(JSON.stringify(t))}catch(n){console.error("Couldn't convert value into a JSON string: ",t),e(null,n)}}function _t(t){if(t.substring(0,J)!==X)return JSON.parse(t);var e,n=t.substring(ht),r=t.substring(J,ht);if(r===et&&Q.test(n)){var i=n.match(Q);e=i[1],n=n.substring(i[0].length)}var o=dt(n);switch(r){case tt:return o;case et:return u([o],{type:e});case nt:return new Int8Array(o);case rt:return new Uint8Array(o);case it:return new Uint8ClampedArray(o);case ot:return new Int16Array(o);case at:return new Uint16Array(o);case st:return new Int32Array(o);case ut:return new Uint32Array(o);case ct:return new Float32Array(o);case lt:return new Float64Array(o);default:throw new Error("Unkown type: "+r)}}var mt={serialize:gt,deserialize:_t,stringToBuffer:dt,bufferToString:pt};function vt(t,e,n,r){t.executeSql("CREATE TABLE IF NOT EXISTS "+e.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function yt(t){var e=this,n={db:null};if(t)for(var r in t)n[r]="string"!=typeof t[r]?t[r].toString():t[r];var i=new c((function(t,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(t){return r(t)}n.db.transaction((function(i){vt(i,n,(function(){e._dbInfo=n,t()}),(function(t,e){r(e)}))}),r)}));return n.serializer=mt,i}function bt(t,e,n,r,i,o){t.executeSql(n,r,i,(function(t,s){s.code===s.SYNTAX_ERR?t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[e.storeName],(function(t,a){a.rows.length?o(t,s):vt(t,e,(function(){t.executeSql(n,r,i,o)}),o)}),o):o(t,s)}),o)}function St(t,e){var n=this;t=f(t);var r=new c((function(e,r){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){bt(n,i,"SELECT * FROM "+i.storeName+" WHERE key = ? LIMIT 1",[t],(function(t,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=i.serializer.deserialize(r)),e(r)}),(function(t,e){r(e)}))}))})).catch(r)}));return l(r,e),r}function Et(t,e){var n=this,r=new c((function(e,r){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){bt(n,i,"SELECT * FROM "+i.storeName,[],(function(n,r){for(var o=r.rows,s=o.length,a=0;a<s;a++){var u=o.item(a),c=u.value;if(c&&(c=i.serializer.deserialize(c)),void 0!==(c=t(c,u.key,a+1)))return void e(c)}e()}),(function(t,e){r(e)}))}))})).catch(r)}));return l(r,e),r}function Tt(t,e,n,r){var i=this;t=f(t);var o=new c((function(o,s){i.ready().then((function(){void 0===e&&(e=null);var a=e,u=i._dbInfo;u.serializer.serialize(e,(function(e,c){c?s(c):u.db.transaction((function(n){bt(n,u,"INSERT OR REPLACE INTO "+u.storeName+" (key, value) VALUES (?, ?)",[t,e],(function(){o(a)}),(function(t,e){s(e)}))}),(function(e){if(e.code===e.QUOTA_ERR){if(r>0)return void o(Tt.apply(i,[t,a,n,r-1]));s(e)}}))}))})).catch(s)}));return l(o,n),o}function Ct(t,e,n){return Tt.apply(this,[t,e,n,1])}function wt(t,e){var n=this;t=f(t);var r=new c((function(e,r){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){bt(n,i,"DELETE FROM "+i.storeName+" WHERE key = ?",[t],(function(){e()}),(function(t,e){r(e)}))}))})).catch(r)}));return l(r,e),r}function Rt(t){var e=this,n=new c((function(t,n){e.ready().then((function(){var r=e._dbInfo;r.db.transaction((function(e){bt(e,r,"DELETE FROM "+r.storeName,[],(function(){t()}),(function(t,e){n(e)}))}))})).catch(n)}));return l(n,t),n}function It(t){var e=this,n=new c((function(t,n){e.ready().then((function(){var r=e._dbInfo;r.db.transaction((function(e){bt(e,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],(function(e,n){var r=n.rows.item(0).c;t(r)}),(function(t,e){n(e)}))}))})).catch(n)}));return l(n,t),n}function kt(t,e){var n=this,r=new c((function(e,r){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){bt(n,i,"SELECT key FROM "+i.storeName+" WHERE id = ? LIMIT 1",[t+1],(function(t,n){var r=n.rows.length?n.rows.item(0).key:null;e(r)}),(function(t,e){r(e)}))}))})).catch(r)}));return l(r,e),r}function Ot(t){var e=this,n=new c((function(t,n){e.ready().then((function(){var r=e._dbInfo;r.db.transaction((function(e){bt(e,r,"SELECT key FROM "+r.storeName,[],(function(e,n){for(var r=[],i=0;i<n.rows.length;i++)r.push(n.rows.item(i).key);t(r)}),(function(t,e){n(e)}))}))})).catch(n)}));return l(n,t),n}function Nt(t){return new c((function(e,n){t.transaction((function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(n,r){for(var i=[],o=0;o<r.rows.length;o++)i.push(r.rows.item(o).name);e({db:t,storeNames:i})}),(function(t,e){n(e)}))}),(function(t){n(t)}))}))}function At(t,e){e=d.apply(this,arguments);var n=this.config();(t="function"!=typeof t&&t||{}).name||(t.name=t.name||n.name,t.storeName=t.storeName||n.storeName);var r,i=this;return l(r=t.name?new c((function(e){var r;r=t.name===n.name?i._dbInfo.db:openDatabase(t.name,"","",0),e(t.storeName?{db:r,storeNames:[t.storeName]}:Nt(r))})).then((function(t){return new c((function(e,n){t.db.transaction((function(r){function i(t){return new c((function(e,n){r.executeSql("DROP TABLE IF EXISTS "+t,[],(function(){e()}),(function(t,e){n(e)}))}))}for(var o=[],s=0,a=t.storeNames.length;s<a;s++)o.push(i(t.storeNames[s]));c.all(o).then((function(){e()})).catch((function(t){n(t)}))}),(function(t){n(t)}))}))})):c.reject("Invalid arguments"),e),r}var Lt={_driver:"webSQLStorage",_initStorage:yt,_support:Z(),iterate:Et,getItem:St,setItem:Ct,removeItem:wt,clear:Rt,length:It,key:kt,keys:Ot,dropInstance:At};function Pt(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(t){return!1}}function Mt(t,e){var n=t.name+"/";return t.storeName!==e.storeName&&(n+=t.storeName+"/"),n}function Dt(){var t="_localforage_support_test";try{return localStorage.setItem(t,!0),localStorage.removeItem(t),!1}catch(t){return!0}}function xt(){return!Dt()||localStorage.length>0}function Ut(t){var e=this,n={};if(t)for(var r in t)n[r]=t[r];return n.keyPrefix=Mt(t,e._defaultConfig),xt()?(e._dbInfo=n,n.serializer=mt,c.resolve()):c.reject()}function Bt(t){var e=this,n=e.ready().then((function(){for(var t=e._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(t)&&localStorage.removeItem(r)}}));return l(n,t),n}function Ht(t,e){var n=this;t=f(t);var r=n.ready().then((function(){var e=n._dbInfo,r=localStorage.getItem(e.keyPrefix+t);return r&&(r=e.serializer.deserialize(r)),r}));return l(r,e),r}function zt(t,e){var n=this,r=n.ready().then((function(){for(var e=n._dbInfo,r=e.keyPrefix,i=r.length,o=localStorage.length,s=1,a=0;a<o;a++){var u=localStorage.key(a);if(0===u.indexOf(r)){var c=localStorage.getItem(u);if(c&&(c=e.serializer.deserialize(c)),void 0!==(c=t(c,u.substring(i),s++)))return c}}}));return l(r,e),r}function Gt(t,e){var n=this,r=n.ready().then((function(){var e,r=n._dbInfo;try{e=localStorage.key(t)}catch(t){e=null}return e&&(e=e.substring(r.keyPrefix.length)),e}));return l(r,e),r}function Ft(t){var e=this,n=e.ready().then((function(){for(var t=e._dbInfo,n=localStorage.length,r=[],i=0;i<n;i++){var o=localStorage.key(i);0===o.indexOf(t.keyPrefix)&&r.push(o.substring(t.keyPrefix.length))}return r}));return l(n,t),n}function qt(t){var e=this.keys().then((function(t){return t.length}));return l(e,t),e}function jt(t,e){var n=this;t=f(t);var r=n.ready().then((function(){localStorage.removeItem(n._dbInfo.keyPrefix+t)}));return l(r,e),r}function Vt(t,e,n){var r=this;t=f(t);var i=r.ready().then((function(){void 0===e&&(e=null);var n=e;return new c((function(i,o){var s=r._dbInfo;s.serializer.serialize(e,(function(e,r){if(r)o(r);else try{localStorage.setItem(s.keyPrefix+t,e),i(n)}catch(t){"QuotaExceededError"!==t.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==t.name||o(t),o(t)}}))}))}));return l(i,n),i}function Wt(t,e){if(e=d.apply(this,arguments),!(t="function"!=typeof t&&t||{}).name){var n=this.config();t.name=t.name||n.name,t.storeName=t.storeName||n.storeName}var r,i=this;return r=t.name?new c((function(e){e(t.storeName?Mt(t,i._defaultConfig):t.name+"/")})).then((function(t){for(var e=localStorage.length-1;e>=0;e--){var n=localStorage.key(e);0===n.indexOf(t)&&localStorage.removeItem(n)}})):c.reject("Invalid arguments"),l(r,e),r}var Yt={_driver:"localStorageWrapper",_initStorage:Ut,_support:Pt(),iterate:zt,getItem:Ht,setItem:Vt,removeItem:jt,clear:Bt,length:qt,key:Gt,keys:Ft,dropInstance:Wt},Zt=function(t,e){return t===e||"number"==typeof t&&"number"==typeof e&&isNaN(t)&&isNaN(e)},Kt=function(t,e){for(var n=t.length,r=0;r<n;){if(Zt(t[r],e))return!0;r++}return!1},$t=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},Qt={},Xt={},Jt={INDEXEDDB:Y,WEBSQL:Lt,LOCALSTORAGE:Yt},te=[Jt.INDEXEDDB._driver,Jt.WEBSQL._driver,Jt.LOCALSTORAGE._driver],ee=["dropInstance"],ne=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ee),re={description:"",driver:te.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function ie(t,e){t[e]=function(){var n=arguments;return t.ready().then((function(){return t[e].apply(t,n)}))}}function oe(){for(var t=1;t<arguments.length;t++){var e=arguments[t];if(e)for(var n in e)e.hasOwnProperty(n)&&(arguments[0][n]=$t(e[n])?e[n].slice():e[n])}return arguments[0]}var se=function(){function t(e){for(var n in i(this,t),Jt)if(Jt.hasOwnProperty(n)){var r=Jt[n],o=r._driver;this[n]=o,Qt[o]||this.defineDriver(r)}this._defaultConfig=oe({},re),this._config=oe({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return t.prototype.config=function(t){if("object"===(void 0===t?"undefined":r(t))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var e in t){if("storeName"===e&&(t[e]=t[e].replace(/\W/g,"_")),"version"===e&&"number"!=typeof t[e])return new Error("Database version must be a number.");this._config[e]=t[e]}return!("driver"in t)||!t.driver||this.setDriver(this._config.driver)}return"string"==typeof t?this._config[t]:this._config},t.prototype.defineDriver=function(t,e,n){var r=new c((function(e,n){try{var r=t._driver,i=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver)return void n(i);for(var o=ne.concat("_initStorage"),s=0,a=o.length;s<a;s++){var u=o[s];if((!Kt(ee,u)||t[u])&&"function"!=typeof t[u])return void n(i)}var h=function(){for(var e=function(t){return function(){var e=new Error("Method "+t+" is not implemented by the current driver"),n=c.reject(e);return l(n,arguments[arguments.length-1]),n}},n=0,r=ee.length;n<r;n++){var i=ee[n];t[i]||(t[i]=e(i))}};h();var f=function(n){Qt[r]&&console.info("Redefining LocalForage driver: "+r),Qt[r]=t,Xt[r]=n,e()};"_support"in t?t._support&&"function"==typeof t._support?t._support().then(f,n):f(!!t._support):f(!0)}catch(t){n(t)}}));return h(r,e,n),r},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(t,e,n){var r=Qt[t]?c.resolve(Qt[t]):c.reject(new Error("Driver not found."));return h(r,e,n),r},t.prototype.getSerializer=function(t){var e=c.resolve(mt);return h(e,t),e},t.prototype.ready=function(t){var e=this,n=e._driverSet.then((function(){return null===e._ready&&(e._ready=e._initDriver()),e._ready}));return h(n,t,t),n},t.prototype.setDriver=function(t,e,n){var r=this;$t(t)||(t=[t]);var i=this._getSupportedDrivers(t);function o(){r._config.driver=r.driver()}function s(t){return r._extend(t),o(),r._ready=r._initStorage(r._config),r._ready}function a(t){return function(){var e=0;function n(){for(;e<t.length;){var i=t[e];return e++,r._dbInfo=null,r._ready=null,r.getDriver(i).then(s).catch(n)}o();var a=new Error("No available storage method found.");return r._driverSet=c.reject(a),r._driverSet}return n()}}var u=null!==this._driverSet?this._driverSet.catch((function(){return c.resolve()})):c.resolve();return this._driverSet=u.then((function(){var t=i[0];return r._dbInfo=null,r._ready=null,r.getDriver(t).then((function(t){r._driver=t._driver,o(),r._wrapLibraryMethodsWithReady(),r._initDriver=a(i)}))})).catch((function(){o();var t=new Error("No available storage method found.");return r._driverSet=c.reject(t),r._driverSet})),h(this._driverSet,e,n),this._driverSet},t.prototype.supports=function(t){return!!Xt[t]},t.prototype._extend=function(t){oe(this,t)},t.prototype._getSupportedDrivers=function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];this.supports(i)&&e.push(i)}return e},t.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,e=ne.length;t<e;t++)ie(this,ne[t])},t.prototype.createInstance=function(e){return new t(e)},t}(),ae=new se;e.exports=ae},{3:3}]},{},[4])(4)},782:function(t,e,n){"use strict";t.exports=n(4656)},4656:function(t,e,n){"use strict";var r=e;function i(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=n(8401),r.BufferWriter=n(4927),r.Reader=n(4961),r.BufferReader=n(6794),r.util=n(7775),r.rpc=n(2786),r.roots=n(8885),r.configure=i,i()},4961:function(t,e,n){"use strict";t.exports=u;var r,i=n(7775),o=i.LongBits,s=i.utf8;function a(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function u(t){this.buf=t,this.pos=0,this.len=t.length}var c,l="undefined"!=typeof Uint8Array?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new u(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new u(t);throw Error("illegal buffer")},h=function(){return i.Buffer?function(t){return(u.create=function(t){return i.Buffer.isBuffer(t)?new r(t):l(t)})(t)}:l};function f(){var t=new o(0,0),e=0;if(!(this.len-this.pos>4)){for(;e<3;++e){if(this.pos>=this.len)throw a(this);if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(127&this.buf[this.pos++])<<7*e)>>>0,t}for(;e<4;++e)if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(127&this.buf[this.pos])<<28)>>>0,t.hi=(t.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return t;if(e=0,this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw a(this);if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}function d(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}function p(){if(this.pos+8>this.len)throw a(this,8);return new o(d(this.buf,this.pos+=4),d(this.buf,this.pos+=4))}u.create=h(),u.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,u.prototype.uint32=(c=4294967295,function(){if(c=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return c;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return c}),u.prototype.int32=function(){return 0|this.uint32()},u.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(1&t)|0},u.prototype.bool=function(){return 0!==this.uint32()},u.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return d(this.buf,this.pos+=4)},u.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|d(this.buf,this.pos+=4)},u.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var t=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t},u.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var t=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t},u.prototype.bytes=function(){var t=this.uint32(),e=this.pos,n=this.pos+t;if(n>this.len)throw a(this,t);return this.pos+=t,Array.isArray(this.buf)?this.buf.slice(e,n):e===n?new this.buf.constructor(0):this._slice.call(this.buf,e,n)},u.prototype.string=function(){var t=this.bytes();return s.read(t,0,t.length)},u.prototype.skip=function(t){if("number"==typeof t){if(this.pos+t>this.len)throw a(this,t);this.pos+=t}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},u.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(t=7&this.uint32());)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this},u._configure=function(t){r=t,u.create=h(),r._configure();var e=i.Long?"toLong":"toNumber";i.merge(u.prototype,{int64:function(){return f.call(this)[e](!1)},uint64:function(){return f.call(this)[e](!0)},sint64:function(){return f.call(this).zzDecode()[e](!1)},fixed64:function(){return p.call(this)[e](!0)},sfixed64:function(){return p.call(this)[e](!1)}})}},6794:function(t,e,n){"use strict";t.exports=o;var r=n(4961);(o.prototype=Object.create(r.prototype)).constructor=o;var i=n(7775);function o(t){r.call(this,t)}o._configure=function(){i.Buffer&&(o.prototype._slice=i.Buffer.prototype.slice)},o.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))},o._configure()},8885:function(t){"use strict";t.exports={}},2786:function(t,e,n){"use strict";e.Service=n(1266)},1266:function(t,e,n){"use strict";t.exports=i;var r=n(7775);function i(t,e,n){if("function"!=typeof t)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(n)}(i.prototype=Object.create(r.EventEmitter.prototype)).constructor=i,i.prototype.rpcCall=function t(e,n,i,o,s){if(!o)throw TypeError("request must be specified");var a=this;if(!s)return r.asPromise(t,a,e,n,i,o);if(a.rpcImpl)try{return a.rpcImpl(e,n[a.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(t,n){if(t)return a.emit("error",t,e),s(t);if(null!==n){if(!(n instanceof i))try{n=i[a.responseDelimited?"decodeDelimited":"decode"](n)}catch(t){return a.emit("error",t,e),s(t)}return a.emit("data",n,e),s(null,n)}a.end(!0)}))}catch(t){return a.emit("error",t,e),void setTimeout((function(){s(t)}),0)}else setTimeout((function(){s(Error("already ended"))}),0)},i.prototype.end=function(t){return this.rpcImpl&&(t||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},3686:function(t,e,n){"use strict";t.exports=i;var r=n(7775);function i(t,e){this.lo=t>>>0,this.hi=e>>>0}var o=i.zero=new i(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var s=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(t){if(0===t)return o;var e=t<0;e&&(t=-t);var n=t>>>0,r=(t-n)/4294967296>>>0;return e&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new i(n,r)},i.from=function(t){if("number"==typeof t)return i.fromNumber(t);if(r.isString(t)){if(!r.Long)return i.fromNumber(parseInt(t,10));t=r.Long.fromString(t)}return t.low||t.high?new i(t.low>>>0,t.high>>>0):o},i.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var e=1+~this.lo>>>0,n=~this.hi>>>0;return e||(n=n+1>>>0),-(e+4294967296*n)}return this.lo+4294967296*this.hi},i.prototype.toLong=function(t){return r.Long?new r.Long(0|this.lo,0|this.hi,Boolean(t)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(t)}};var a=String.prototype.charCodeAt;i.fromHash=function(t){return t===s?o:new i((a.call(t,0)|a.call(t,1)<<8|a.call(t,2)<<16|a.call(t,3)<<24)>>>0,(a.call(t,4)|a.call(t,5)<<8|a.call(t,6)<<16|a.call(t,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this},i.prototype.zzDecode=function(){var t=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this},i.prototype.length=function(){var t=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===e?t<16384?t<128?1:2:t<2097152?3:4:e<16384?e<128?5:6:e<2097152?7:8:n<128?9:10}},7775:function(t,e,n){"use strict";var r=e;function i(t,e,n){for(var r=Object.keys(e),i=0;i<r.length;++i)void 0!==t[r[i]]&&n||(t[r[i]]=e[r[i]]);return t}function o(t){function e(t,n){if(!(this instanceof e))return new e(t,n);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&i(this,n)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return t}}),e.prototype.toString=function(){return this.name+": "+this.message},e}r.asPromise=n(1679),r.base64=n(1420),r.EventEmitter=n(138),r.float=n(3209),r.inquire=n(4556),r.utf8=n(2482),r.pool=n(3794),r.LongBits=n(3686),r.isNode=Boolean(void 0!==n.g&&n.g&&n.g.process&&n.g.process.versions&&n.g.process.versions.node),r.global=r.isNode&&n.g||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},r.isString=function(t){return"string"==typeof t||t instanceof String},r.isObject=function(t){return t&&"object"==typeof t},r.isset=r.isSet=function(t,e){var n=t[e];return!(null==n||!t.hasOwnProperty(e))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},r.Buffer=function(){try{var t=r.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch(t){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(t){return"number"==typeof t?r.Buffer?r._Buffer_allocUnsafe(t):new r.Array(t):r.Buffer?r._Buffer_from(t):"undefined"==typeof Uint8Array?t:new Uint8Array(t)},r.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(t){return t?r.LongBits.from(t).toHash():r.LongBits.zeroHash},r.longFromHash=function(t,e){var n=r.LongBits.fromHash(t);return r.Long?r.Long.fromBits(n.lo,n.hi,e):n.toNumber(Boolean(e))},r.merge=i,r.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)},r.newError=o,r.ProtocolError=o("ProtocolError"),r.oneOfGetter=function(t){for(var e={},n=0;n<t.length;++n)e[t[n]]=1;return function(){for(var t=Object.keys(this),n=t.length-1;n>-1;--n)if(1===e[t[n]]&&null!=this[t[n]])return t[n]}},r.oneOfSetter=function(t){return function(e){for(var n=0;n<t.length;++n)t[n]!==e&&delete this[t[n]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var t=r.Buffer;t?(r._Buffer_from=t.from!==Uint8Array.from&&t.from||function(e,n){return new t(e,n)},r._Buffer_allocUnsafe=t.allocUnsafe||function(e){return new t(e)}):r._Buffer_from=r._Buffer_allocUnsafe=null}},8401:function(t,e,n){"use strict";t.exports=h;var r,i=n(7775),o=i.LongBits,s=i.base64,a=i.utf8;function u(t,e,n){this.fn=t,this.len=e,this.next=void 0,this.val=n}function c(){}function l(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function h(){this.len=0,this.head=new u(c,0,0),this.tail=this.head,this.states=null}var f=function(){return i.Buffer?function(){return(h.create=function(){return new r})()}:function(){return new h}};function d(t,e,n){e[n]=255&t}function p(t,e){this.len=t,this.next=void 0,this.val=e}function g(t,e,n){for(;t.hi;)e[n++]=127&t.lo|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[n++]=127&t.lo|128,t.lo=t.lo>>>7;e[n++]=t.lo}function _(t,e,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24}h.create=f(),h.alloc=function(t){return new i.Array(t)},i.Array!==Array&&(h.alloc=i.pool(h.alloc,i.Array.prototype.subarray)),h.prototype._push=function(t,e,n){return this.tail=this.tail.next=new u(t,e,n),this.len+=e,this},(p.prototype=Object.create(u.prototype)).fn=function(t,e,n){for(;t>127;)e[n++]=127&t|128,t>>>=7;e[n]=t},h.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new p((t>>>=0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this},h.prototype.int32=function(t){return t<0?this._push(g,10,o.fromNumber(t)):this.uint32(t)},h.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)},h.prototype.int64=h.prototype.uint64=function(t){var e=o.from(t);return this._push(g,e.length(),e)},h.prototype.sint64=function(t){var e=o.from(t).zzEncode();return this._push(g,e.length(),e)},h.prototype.bool=function(t){return this._push(d,1,t?1:0)},h.prototype.sfixed32=h.prototype.fixed32=function(t){return this._push(_,4,t>>>0)},h.prototype.sfixed64=h.prototype.fixed64=function(t){var e=o.from(t);return this._push(_,4,e.lo)._push(_,4,e.hi)},h.prototype.float=function(t){return this._push(i.float.writeFloatLE,4,t)},h.prototype.double=function(t){return this._push(i.float.writeDoubleLE,8,t)};var m=i.Array.prototype.set?function(t,e,n){e.set(t,n)}:function(t,e,n){for(var r=0;r<t.length;++r)e[n+r]=t[r]};h.prototype.bytes=function(t){var e=t.length>>>0;if(!e)return this._push(d,1,0);if(i.isString(t)){var n=h.alloc(e=s.length(t));s.decode(t,n,0),t=n}return this.uint32(e)._push(m,e,t)},h.prototype.string=function(t){var e=a.length(t);return e?this.uint32(e)._push(a.write,e,t):this._push(d,1,0)},h.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new u(c,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new u(c,0,0),this.len=0),this},h.prototype.ldelim=function(){var t=this.head,e=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=t.next,this.tail=e,this.len+=n),this},h.prototype.finish=function(){for(var t=this.head.next,e=this.constructor.alloc(this.len),n=0;t;)t.fn(t.val,e,n),n+=t.len,t=t.next;return e},h._configure=function(t){r=t,h.create=f(),r._configure()}},4927:function(t,e,n){"use strict";t.exports=o;var r=n(8401);(o.prototype=Object.create(r.prototype)).constructor=o;var i=n(7775);function o(){r.call(this)}function s(t,e,n){t.length<40?i.utf8.write(t,e,n):e.utf8Write?e.utf8Write(t,n):e.write(t,n)}o._configure=function(){o.alloc=i._Buffer_allocUnsafe,o.writeBytesBuffer=i.Buffer&&i.Buffer.prototype instanceof Uint8Array&&"set"===i.Buffer.prototype.set.name?function(t,e,n){e.set(t,n)}:function(t,e,n){if(t.copy)t.copy(e,n,0,t.length);else for(var r=0;r<t.length;)e[n++]=t[r++]}},o.prototype.bytes=function(t){i.isString(t)&&(t=i._Buffer_from(t,"base64"));var e=t.length>>>0;return this.uint32(e),e&&this._push(o.writeBytesBuffer,e,t),this},o.prototype.string=function(t){var e=i.Buffer.byteLength(t);return this.uint32(e),e&&this._push(s,e,t),this},o._configure()}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var n=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t].call(n.exports,n,n.exports,__webpack_require__),n.exports}__webpack_require__.d=function(t,e){for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),__webpack_require__.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},__webpack_require__.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var __webpack_exports__={};return function(){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{StreamCompositor:function(){return X}});var t,e={code:1100001,message:"input param error."},n={code:1103074,message:"video track is not readable"},r={code:1103076,message:"audio track is not readable"},i={code:1103077,message:"compositor blur not support."},o=function(){function t(t,e,n){this.logger=t,this.stateCenter=e,this.streamCenter=n,this.fps=15,this.outputBitrate=1500,this.hasPortrait=!1,this.isClear=!1,this.canvasEl=document.createElement("canvas"),this.ctx=this.canvasEl.getContext("2d")}return t.prototype.setVideoConfig=function(t){var e=t.height,n=t.frameRate,r=t.bitrate;this.canvasEl.width=t.width,this.canvasEl.height=e,n&&(this.fps=n),r&&(this.outputBitrate=r)},t.prototype.setInputsOption=function(t){var e=this;this.isClear=!0,this.layers=t.filter((function(t){var e=t.stream,r=t.option,i=t.source instanceof HTMLImageElement,o=void 0!==r.contentType&&["ALL","VIDEO"].includes(r.contentType),s=!r.contentType||o,a=e&&e.getVideoTracks();if(0==(null==a?void 0:a.length)&&o)throw n;return i||s&&a&&(null==a?void 0:a.length)>0})).map((function(t){var n,r=t.source,i=t.stream,o=t.option;if(i&&"safari"===e.stateCenter.browser){var s=e.streamCenter.checkPreview(i);s.backgroundProcessor?(n=s.backgroundProcessor.getCanvas(),e.bgProcessor=s.backgroundProcessor,e.hasPortrait=!0):e.hasPortrait=!1}return{source:r,option:o,canvas:n}})),this.layers.sort((function(t,e){var n,r;return void 0!==(null===(n=t.option.layout)||void 0===n?void 0:n.zOrder)&&void 0!==(null===(r=e.option.layout)||void 0===r?void 0:r.zOrder)?t.option.layout.zOrder-e.option.layout.zOrder:-1}))},t.prototype.checkVideoInputs=function(t){var e=!0;return t.forEach((function(t){var n=t.stream,r=t.option,i=void 0!==r.contentType&&["ALL","VIDEO"].includes(r.contentType),o=n&&n.getVideoTracks();0==(null==o?void 0:o.length)&&i&&(e=!1)})),e},t.prototype.generateVideoTrack=function(){var t,e=this;if(this.hasPortrait?null===(t=this.bgProcessor)||void 0===t||t.setDrawBack((function(){e.draw()})):this.intervalId||(this.intervalId=setInterval((function(){e.draw()}),1e3/this.fps)),!this.canvasTrack){var n=this.canvasEl.captureStream(this.fps);this.canvasTrack=n.getVideoTracks()[0]}return this.canvasTrack},t.prototype.stopOutputStream=function(){var t;this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null),this.layers.forEach((function(t){t.source&&t.source instanceof HTMLVideoElement&&(t.source.pause(),t.source.remove(),t.source.srcObject=null,t.source=null)})),null===(t=this.canvasTrack)||void 0===t||t.stop(),this.canvasTrack=null,this.ctx=null,this.layers=[]},t.prototype.draw=function(){var t,e;if(this.ctx){this.ctx.clearRect(0,0,this.canvasEl.width,this.canvasEl.height);for(var n=0;n<this.layers.length;n++){var r=this.layers[n],i=r.source,o=r.option,s=r.canvas;if(o.layout){var a=o.layout,u=a.x,c=a.y,l=a.width,h=a.height,f=i instanceof HTMLVideoElement?i.videoWidth:i instanceof HTMLImageElement?i.naturalWidth:0,d=i instanceof HTMLVideoElement?i.videoHeight:i instanceof HTMLImageElement?i.naturalHeight:0;if(0==f||0==d)continue;var p=s||i;switch(o.objectFit){case"contain":if(l/h<=f/d){var g=(h-(m=l*d/f))/2;null===(t=this.ctx)||void 0===t||t.drawImage(p,u,c+g,l,m)}else{g=(l-(_=h*f/d))/2;null===(e=this.ctx)||void 0===e||e.drawImage(p,u+g,c,_,h)}break;case"cover":var _,m;if(l/h<=f/d)this.ctx.drawImage(p,(f-(_=l*d/h))/2,0,_,d,u,c,l,h);else this.ctx.drawImage(p,0,(d-(m=f*h/l))/2,f,m,u,c,l,h);break;case"fill":this.ctx.drawImage(p,u,c,l,h)}}}}},t}(),s=function(){function t(t,e,n){this.logger=t,this.ac=e,this.streamCenter=n,this.inputs=[],this.descNode=this.ac.createMediaStreamDestination()}return t.prototype.setInputsOption=function(t){var e=this;this.inputs=t.filter((function(t){var n=t.stream,i=t.option,o=n&&n.getAudioTracks(),s=e.streamCenter.checkPreview(n),a=void 0!==i.contentType&&["ALL","AUDIO"].includes(i.contentType);if((0==(null==o?void 0:o.length)||(null==s?void 0:s.hasEmptyAudioTrack))&&a)throw r;return o&&(null==o?void 0:o.length)>0})),this.inputs.forEach((function(t){var e,n,r=t.audioNodes,i=t.option;(void 0===t.option.volume&&(t.option.volume=100),r)&&(!i.contentType||["ALL","AUDIO"].includes(i.contentType)?(!r.hasAudio&&(null===(e=null==r?void 0:r.srcNode)||void 0===e||e.connect(r.volumeNode)),r.hasAudio=!0,"number"==typeof t.option.volume&&(r.volumeNode.gain.value=t.option.volume/100)):(null===(n=null==r?void 0:r.srcNode)||void 0===n||n.disconnect(r.volumeNode),r.hasAudio=!1))}))},t.prototype.checkAudioInputs=function(t){var e=this,n=!0;return t.forEach((function(t){var r=t.stream,i=t.option,o=r&&r.getAudioTracks(),s=e.streamCenter.checkPreview(r),a=void 0!==i.contentType&&["ALL","AUDIO"].includes(i.contentType);(0==(null==o?void 0:o.length)||(null==s?void 0:s.hasEmptyAudioTrack))&&a&&(n=!1)})),n},t.prototype.generateAudioTrack=function(){for(var t,e=0;e<this.inputs.length;e++){var n=this.inputs[e],r=n.stream,i=n.option,o=!i.contentType||["ALL","AUDIO"].includes(i.contentType),s=this.createAudioNode(r,n.option.volume),a=s.srcNode,u=s.volumeNode;o&&(null==a||a.connect(u)),n.audioNodes={srcNode:a,volumeNode:u,hasAudio:o}}var c=null===(t=this.descNode)||void 0===t?void 0:t.stream.getAudioTracks();return c&&c.length>0?c[0]:(this.ac.resume(),null)},t.prototype.createAudioNode=function(t,e){var n=this.ac.createMediaStreamSource(t),r=this.ac.createGain();return r.gain.value=e/100,r.connect(this.descNode),{srcNode:n,volumeNode:r}},t.prototype.stopAudioCompositor=function(){for(var t=0;t<this.inputs.length;t++){var e=this.inputs[t],n=e.audioNodes,r=e.option;if(n){var i=n.srcNode,o=n.volumeNode;(!r.contentType||["ALL","AUDIO"].includes(r.contentType))&&(null==i||i.disconnect(o),null==o||o.disconnect(this.descNode)),n.volumeNode=null,n.srcNode=null}this.descNode=null}this.inputs=[]},t.prototype.replaceSource=function(t){var e=this;this.inputs.forEach((function(n){var r=n.stream,i=n.audioNodes;if(t===r&&i){var o=i.srcNode,s=i.volumeNode,a=i.hasAudio,u=e.ac.createMediaStreamSource(r);a&&(null==o||o.disconnect(s),u.connect(s)),i.srcNode=u}}))},t}();!function(t){t.STREAM_COMPOSITOR_MODULE="zc.scm.0"}(t||(t={}));var a,u,c=function(t){return t},l=function(t){return t},h={event:"/sdk/init"},f={event:"/sdk/create_stream_compositor"},d={event:"/sdk/start_compositing_stream",error:{},media_stream_id:l,compose_stream_conf:c};__webpack_require__(4545);!function(t){t[t.debug=0]="debug",t[t.info=1]="info",t[t.warn=2]="warn",t[t.error=3]="error",t[t.report=99]="report",t[t.disable=100]="disable"}(a||(a={})),function(t){t[t.CN=2]="CN",t[t.NA=3]="NA",t[t.EU=4]="EU",t[t.AS=5]="AS",t[t.IN=6]="IN",t[t.NCN=7]="NCN"}(u||(u={}));var p,g;!function(t){t[t.disable=0]="disable",t[t.websocket=1]="websocket",t[t.https=2]="https"}(p||(p={})),function(t){t[t.SDKProject_Other=0]="SDKProject_Other",t[t.SDKProject_ZegoExpressVideo=1]="SDKProject_ZegoExpressVideo",t[t.SDKProject_ZegoExpressAudio=2]="SDKProject_ZegoExpressAudio",t[t.SDKProject_ZegoLiveRoom=3]="SDKProject_ZegoLiveRoom",t[t.SDKProject_ZegoAudioRoom=4]="SDKProject_ZegoAudioRoom",t[t.SDKProject_ZegoAVKit=5]="SDKProject_ZegoAVKit",t[t.SDKProject_ZegoWebRTC=6]="SDKProject_ZegoWebRTC",t[t.SDKProject_ZegoMiniProgram=7]="SDKProject_ZegoMiniProgram"}(g||(g={}));var _;!function(t){t[t.disconnected=0]="disconnected",t[t.connecting=1]="connecting",t[t.connected=2]="connected"}(_||(_={}));var m,v,y;!function(t){t[t.tryProbe=0]="tryProbe",t[t.probed=2]="probed"}(m||(m={})),function(t){t[t.CDN=0]="CDN",t[t.RTC=1]="RTC",t[t.L3=2]="L3",t[t.DG=3]="DG"}(v||(v={})),function(t){t[t.UDP=0]="UDP",t[t.RTMP=1]="RTMP",t[t.FLV=2]="FLV",t[t.HLS=3]="HLS",t[t.WEBRTC=4]="WEBRTC"}(y||(y={}));var b,S,E;!function(t){t[t.logout=0]="logout",t[t.trylogin=1]="trylogin",t[t.login=2]="login"}(b||(b={})),function(t){t[t.logout=0]="logout",t[t.trylogin=1]="trylogin",t[t.login=2]="login",t[t.reconnect=3]="reconnect"}(S||(S={})),function(t){t[t.offline=0]="offline",t[t.online=1]="online"}(E||(E={}));var T;!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.CDN=1]="CDN",t[t.RTC=2]="RTC",t[t.L3=3]="L3"}(T||(T={}));var C;!function(t){t[t.low=1]="low",t[t.stantard=2]="stantard",t[t.hight=3]="hight",t[t.custome=4]="custome"}(C||(C={}));var w,R,I,k,O,N;!function(t){t[t.captureFpsToLow=1001]="captureFpsToLow",t[t.captureVolumeToLow=1002]="captureVolumeToLow",t[t.sendVideoBitrateToLow=1003]="sendVideoBitrateToLow",t[t.sendFpsToLow=1004]="sendFpsToLow",t[t.sendAudioBitrateToLow=1005]="sendAudioBitrateToLow",t[t.receiveVolumeToLow=1006]="receiveVolumeToLow",t[t.receiveAudioDecodedFail=1007]="receiveAudioDecodedFail",t[t.receiveVideoDecodedFail=1008]="receiveVideoDecodedFail",t[t.receiveVideoFpsDecodedToLow=1009]="receiveVideoFpsDecodedToLow",t[t.renderVideoFpsToLow=1010]="renderVideoFpsToLow",t[t.captureFpsNormal=2001]="captureFpsNormal",t[t.captureVolumeNormal=2002]="captureVolumeNormal",t[t.sendVideoBitrateNormal=2003]="sendVideoBitrateNormal",t[t.sendFpsNormal=2004]="sendFpsNormal",t[t.sendAudioBitrateNormal=2005]="sendAudioBitrateNormal",t[t.receiveVolumeNormal=2006]="receiveVolumeNormal",t[t.receiveAudioDecodedNormal=2007]="receiveAudioDecodedNormal",t[t.receiveVideoDecodedNormal=2008]="receiveVideoDecodedNormal",t[t.receiveVideoFpsDecodedNormal=2009]="receiveVideoFpsDecodedNormal",t[t.renderVideoFpsNormal=2010]="renderVideoFpsNormal"}(w||(w={})),function(t){t[t.cdn=0]="cdn",t[t.ultra=1]="ultra"}(R||(R={})),function(t){t[t.stop=0]="stop",t[t.start=1]="start"}(I||(I={})),function(t){t[t.cdn=0]="cdn",t[t.ultra=1]="ultra",t[t.customUrl=2]="customUrl"}(k||(k={})),function(t){t[t.CDN=0]="CDN",t[t.BGP=1]="BGP"}(O||(O={})),function(t){t[t.ClientType_None=0]="ClientType_None",t[t.ClientType_H5=1]="ClientType_H5",t[t.ClientType_SmallPragram=2]="ClientType_SmallPragram",t[t.ClientType_Webrtc=3]="ClientType_Webrtc"}(N||(N={}));var A,L,P,M,D,x,U,B,H,z,G,F,q=function(){function t(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this._id=null,this.next=null,this.prev=null,this._id=t,this._data=e}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id?this._id:null},set:function(t){this._id=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t},enumerable:!1,configurable:!0}),t.prototype.hasNext=function(){return this.next&&this.next.id},t.prototype.hasPrev=function(){return this.prev&&this.prev.id},t}();!function(){function t(){this.start=new q,this.end=new q,this._idCounter=0,this._numNodes=0,this.start.next=this.end,this.start.prev=null,this.end.prev=this.start,this.end.next=null}t.prototype.insertBefore=function(t,e){var n=new q(this._idCounter,e);return n.next=t,n.prev=t.prev,t.prev&&(t.prev.next=n),t.prev=n,++this._idCounter,++this._numNodes,n},t.prototype.addLast=function(t){return this.insertBefore(this.end,t)},t.prototype.add=function(t){return this.addLast(t)},t.prototype.getFirst=function(){return 0===this._numNodes?null:this.start.next},t.prototype.getLast=function(){return 0===this._numNodes?null:this.end.prev},t.prototype.size=function(){return this._numNodes},t.prototype.getFromFirst=function(t){var e=0,n=this.start.next;if(t>=0)for(;e<t&&null!==n;)n=n.next,++e;else n=null;if(null===n)throw"Index out of bounds.";return n},t.prototype.get=function(t){return 0===t?this.getFirst():t===this._numNodes-1?this.getLast():this.getFromFirst(t)},t.prototype.remove=function(t){return t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),--this._numNodes,t},t.prototype.removeFirst=function(){var t=null;return this._numNodes>0&&this.start.next&&(t=this.remove(this.start.next)),t},t.prototype.removeLast=function(){var t=null;return this._numNodes>0&&this.end.prev&&(t=this.remove(this.end.prev)),t},t.prototype.removeAll=function(){this.start.next=this.end,this.end.prev=this.start,this._numNodes=0,this._idCounter=0},t.prototype.each=function(t){for(var e=this.start;e.hasNext();)t(e=e.next)},t.prototype.find=function(t){for(var e=this.start,n=!1,r=null;e.hasNext()&&!n;)t(e=e.next)&&(r=e,n=!0);return r},t.prototype.map=function(t){for(var e=this.start,n=[];e.hasNext();)t(e=e.next)&&n.push(e);return n},t.prototype.push=function(t){return this.addLast(t)},t.prototype.unshift=function(t){this.insertBefore(this._numNodes>0?this.start.next:this.end,t)},t.prototype.pop=function(){return this.removeLast()},t.prototype.shift=function(){return this.removeFirst()}}();!function(t){t[t.Unknown=-1]="Unknown",t[t.Excellent=0]="Excellent",t[t.Good=1]="Good",t[t.Middle=2]="Middle",t[t.Poor=3]="Poor",t[t.Die=4]="Die"}(A||(A={})),function(t){t[t.MinQuality=0]="MinQuality",t[t.DieQuality=0]="DieQuality",t[t.PoorMinQuality=1]="PoorMinQuality",t[t.MiddleMinQuality=30]="MiddleMinQuality",t[t.GoodMinQuality=60]="GoodMinQuality",t[t.ExcellentMinQuality=85]="ExcellentMinQuality",t[t.MaxQuality=100]="MaxQuality"}(L||(L={})),function(t){t[t.ZegoDefined=0]="ZegoDefined",t[t.UserUnregister=1]="UserUnregister"}(P||(P={})),function(t){t[t.CDN=0]="CDN",t[t.L3=1]="L3"}(M||(M={})),function(t){t[t.RTC=0]="RTC",t[t.CDN=1]="CDN",t[t.L3=2]="L3",t[t.DG=3]="DG"}(D||(D={})),function(t){t[t.PortraitSegmentation=0]="PortraitSegmentation"}(x||(x={})),function(t){t[t.Default=3]="Default",t[t.StandardVideoCall=4]="StandardVideoCall",t[t.HighVideoCall=5]="HighVideoCall",t[t.StandardChatroom=6]="StandardChatroom",t[t.HighQualityChatroom=7]="HighQualityChatroom",t[t.Broadcast=8]="Broadcast"}(U||(U={})),function(t){t[t.I=0]="I",t[t.H=10]="H",t[t.M=100]="M",t[t.L=1e3]="L"}(B||(B={})),function(t){t[t.BASE_LINE=1]="BASE_LINE",t[t.MAIN=2]="MAIN",t[t.HIGH=3]="HIGH"}(H||(H={})),function(t){t.ONLY_BASELINE="only_baseline",t.HARD_SOFT_ENCODEC_FIRST="hard_or_soft_encodec_first",t.HIGH_PROFILE_FIRST="high_profile_first"}(z||(z={})),function(t){t[t.useAnalyzer=0]="useAnalyzer",t[t.useWorklet=1]="useWorklet"}(G||(G={})),function(t){t[t.None=0]="None",t[t.Vocalist=1]="Vocalist",t[t.BackingSinging=2]="BackingSinging"}(F||(F={}));var j;!function(t){t.WIN32="WIN32",t.MAC="Mac",t.ANDROID="Android",t.LINUX="Linux",t.IOS="iOS",t.UNKNOWN="WTF"}(j||(j={}));var V,W=function(){return W=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},W.apply(this,arguments)},Y=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},Z=function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},K=function(){function a(t,e,n,r){this.logger=t,this.stateCenter=e,this.streamCenter=n,this.ac=r,this.mixOutputConfig={width:0,height:0,frameRate:15,bitrate:2500},this.inputStreamOptions=[],this.fit="cover",this.videoCompositor=new o(t,e,n),this.audioCompositor=new s(t,r,n)}return a.prototype.setOutputConfig=function(t){if("number"!=typeof t.width)throw Error("param width error");if("number"!=typeof t.height)throw Error("param height error");if(void 0!==t.frameRate&&"number"!=typeof t.frameRate)throw Error("param frameRate error");if(void 0!==t.bitrate&&"number"!=typeof t.bitrate)throw Error("param bitrate error");this.mixOutputConfig=W(W({},this.mixOutputConfig),t),this.videoCompositor.setVideoConfig(this.mixOutputConfig)},a.prototype.setInputEndpoint=function(t,e){return Y(this,void 0,void 0,(function(){var i,o,s;return Z(this,(function(a){switch(a.label){case 0:if(i=function(t,e){if(t&&!(t instanceof MediaStream)&&t.zegoStream){if(e.info("cu.gs type:zego"),t.stream instanceof MediaStream)return t.stream;throw new Error("The ZegoLocalStream type requires first calling the capture api to capture the stream")}return t}(t,this.logger),!this.checkStreamIsLocal(i))throw Error("stream is not from zego");return o=this.inputStreamOptions.find((function(t){return t.stream===i})),this.checkInputOption(e,!!o),o?(o.option=this.assignObj(o.option,e),[3,3]):[3,1];case 1:return[4,this.createVideo(i)];case 2:s=a.sent(),this.addInputLayer({source:s,stream:i,option:W({objectFit:this.fit},e)}),a.label=3;case 3:if(!this.videoCompositor.checkVideoInputs(this.inputStreamOptions))throw n;if(!this.audioCompositor.checkAudioInputs(this.inputStreamOptions))throw r;return this.videoCompositor.setInputsOption(this.inputStreamOptions),this.audioCompositor.setInputsOption(this.inputStreamOptions),[2]}}))}))},a.prototype.addImage=function(t,e){this.checkImg(t);var n=this.inputStreamOptions.find((function(e){return e.source===t}));this.checkInputOption(e,!!n),n?n.option=this.assignObj(n.option,e):this.addInputLayer({source:t,option:W({objectFit:this.fit},e)}),this.videoCompositor.setInputsOption(this.inputStreamOptions)},a.prototype.removeImage=function(t){this.checkImg(t);var e=this.inputStreamOptions.findIndex((function(e){return e.source===t}));e>0&&(this.inputStreamOptions.splice(e,1),this.videoCompositor.setInputsOption(this.inputStreamOptions))},a.prototype.startComposingStream=function(){var t=this;return new Promise((function(n,r){if(!t.checkOutputs())return t.logger.error("zc.sc.scs.0 output config error"),void r(e);if(!t.checkInputs())return t.logger.error("zc.sc.scs.0 input params error"),void r(e);if(!t.checkBrowserSupport())return t.logger.error("zc.sc.scs.0 browser not support compositor"),void r(i);t.videoCompositor.setInputsOption(t.inputStreamOptions);var o=t.videoCompositor.generateVideoTrack();t.audioCompositor.setInputsOption(t.inputStreamOptions);var s=t.audioCompositor.generateAudioTrack();t.uploadEvent();var a=[o];s&&a.push(s);var u=new MediaStream(a);t.outputStream=u,t.streamCenter.createCompositingPreviewer(u,t.mixOutputConfig,t.inputStreamOptions),n(u)}))},a.prototype.stopComposingStream=function(){var t=this;return new Promise((function(e){var n,r;if(t.outputStream){var i=t.streamCenter.checkPreview(t.outputStream);i&&(null===(n=i.rtcViewer)||void 0===n||n.destroy(),i.streamCompositor=null,t.streamCenter.removePreview(i)),null===(r=t.outputStream)||void 0===r||r.getTracks().forEach((function(t){return t.stop()}))}try{t.videoCompositor.stopOutputStream(),t.audioCompositor.stopAudioCompositor()}catch(t){e(!1)}t.inputStreamOptions=[],e(!0)}))},a.prototype.checkInputs=function(){var t=this.mixOutputConfig,e=t.width,n=t.height;return this.inputStreamOptions.every((function(t){var r=t.option.layout;return r.x<=e&&r.y<=n&&r.x+r.width<=e&&r.y+r.height<=n&&r.width<=e&&r.height<=n}))},a.prototype.checkOutputs=function(){var t=this.mixOutputConfig;return t.width>0&&t.height>0&&t.frameRate>0&&t.bitrate>0},a.prototype.uploadEvent=function(){var t=this.stateCenter.reporter.createSpan(V.H,{key:h.event},{key:""},d.event),e=this.inputStreamOptions.map((function(t){var e=t.option,n=e.layout,r=e.objectFit,i=e.contentType;return{content_control:"AUDIO"===i?1:"VIDEO"===i?2:0,x:n.x,y:n.y,w:n.width,h:n.height,order:n.zOrder,render_mode:"cover"===r?0:"contain"===r?1:2}})),n=this.mixOutputConfig;t.setAttributes({compose_stream_conf:d.compose_stream_conf({fps:n.frameRate,bitrate:n.bitrate,w:n.width,h:n.height,stream_cnt:e.length,input_stream_list:e})}),t.end()},a.prototype.checkImg=function(e){if(!(e&&e instanceof HTMLImageElement&&e.naturalWidth))throw this.logger.error(t.STREAM_COMPOSITOR_MODULE+" source must be image and loaded"),Error("source must be image and loaded")},a.prototype.checkInputOption=function(t,e){var n=this;if(void 0!==t.layout){if("object"!=typeof t.layout)throw Error("param layout error");["x","y","width","height"].forEach((function(r){n.checkNumParam(t.layout,r,e)})),this.checkOptionalNumOptParam(t.layout,"zOrder")}if(void 0!==t.objectFit&&!["cover","contain","fill"].includes(t.objectFit))throw Error("param objectFit error");if(void 0!==t.contentType&&!["ALL","VIDEO","AUDIO"].includes(t.contentType))throw Error("param contentType error");this.checkOptionalNumOptParam(t,"volume")},a.prototype.checkNumParam=function(t,e,n){if(n&&void 0===t[e]);else if("number"!=typeof t[e])throw Error("param ".concat(e," error"))},a.prototype.checkOptionalNumOptParam=function(t,e){if(void 0!==t[e]&&"number"!=typeof t[e])throw Error("param ".concat(e," error"))},a.prototype.checkStreamIsLocal=function(t){var e=this.streamCenter.checkPreview(t),n=this.streamCenter.checkPlayer(t);return e&&(e.streamCompositor=this),!!e||!!n},a.prototype.addInputLayer=function(t){var e,n=t.option;void 0===(null===(e=n.layout)||void 0===e?void 0:e.zOrder)&&(n.layout.zOrder=0),this.inputStreamOptions.push(t)},a.prototype.createVideo=function(t){return Y(this,void 0,void 0,(function(){var e=this;return Z(this,(function(r){return[2,new Promise((function(r,i){return Y(e,void 0,void 0,(function(){var e,o,s,a,u=this;return Z(this,(function(c){return(e=document.createElement("video")).setAttribute("autoplay","autoplay"),e.setAttribute("muted","true"),e.muted=!0,e.setAttribute("playsinline","playsinline"),e.setAttribute("style","display:none"),o=null,s=function(){o&&(clearTimeout(o),o=null),e.play().catch((function(t){console.error(t)})),o=window.setTimeout((function(){u.logger.warn("zc.sc.cv  video track error"),i(n)}),1e3)},a=function(){o&&clearTimeout(o),e&&e.removeEventListener("playing",a),r(e)},e&&e.addEventListener("playing",a),e.srcObject=t,e.play().catch((function(t){console.error(t)})),o=window.setTimeout((function(){s()}),1e3),[2]}))}))}))]}))}))},a.prototype.assignObj=function(t,e){void 0===t&&(t={});var n=t;if("object"!=typeof t||"object"!=typeof e)return e;for(var r in e)n[r]=t.hasOwnProperty(r)?this.assignObj(t[r],e[r]):e[r];return n},a.prototype.replaceSource=function(t){this.audioCompositor.replaceSource(t)},a.prototype.checkBrowserSupport=function(){var t=!0,e=navigator.userAgent.toLowerCase().match(/cpu iphone os (.*?) like mac os/);return e&&e[1]&&e[1].includes("14_6")&&(t=!1),t},a}(),$=function(){function t(t){this.compositor=t}return t.prototype.addImage=function(t,e){this.compositor.addImage(t,e)},t.prototype.removeImage=function(t){this.compositor.removeImage(t)},t.prototype.setInputEndpoint=function(t,e){return this.compositor.setInputEndpoint(t,e)},t.prototype.setOutputConfig=function(t){this.compositor.setOutputConfig(t)},t.prototype.startComposingStream=function(){return this.compositor.startComposingStream()},t.prototype.stopComposingStream=function(){return this.compositor.stopComposingStream()},t}();!function(t){t[t.I=0]="I",t[t.H=10]="H",t[t.M=100]="M",t[t.L=1e3]="L"}(V||(V={}));var Q={createStreamCompositor:function(){var t=this.stateCenter.reporter.createSpan(V.H,{key:h.event},{key:""},f.event),e=new K(this.logger,this.stateCenter,this.streamCenter,this.ac);return t.end(),new $(e)}},X={install:function(t){for(var e in Q)Object.defineProperty(t.prototype,e,{value:Q[e],writable:!1})},get type(){return"StreamCompositor"}}}(),__webpack_exports__}()}));